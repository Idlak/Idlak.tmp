<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Kaldi: CuMatrixBase&lt; Real &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" /> 
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
 <td id="projectlogo"><a href="http://kaldi-asr.org/"><img alt="Logo" src="KaldiTextAndLogoSmall.png"/ style="padding: 3px 5px 1px 5px"></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname" style="display:none">Kaldi
   </div>
  </td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief" style="display:none"></div>
    </td>
   <!--END PROJECT_BRIEF-->
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classkaldi_1_1CuMatrixBase.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classkaldi_1_1CuMatrixBase-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">CuMatrixBase&lt; Real &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classkaldi_1_1Matrix.html" title="A class for storing matrices. ">Matrix</a> for CUDA computing.  
 <a href="classkaldi_1_1CuMatrixBase.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="matrix-common_8h_source.html">matrix-common.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for CuMatrixBase&lt; Real &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classkaldi_1_1CuMatrixBase__inherit__graph.png" border="0" usemap="#CuMatrixBase_3_01Real_01_4_inherit__map" alt="Inheritance graph"/></div>
<map name="CuMatrixBase_3_01Real_01_4_inherit__map" id="CuMatrixBase_3_01Real_01_4_inherit__map">
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for CuMatrixBase&lt; Real &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classkaldi_1_1CuMatrixBase__coll__graph.png" border="0" usemap="#CuMatrixBase_3_01Real_01_4_coll__map" alt="Collaboration graph"/></div>
<map name="CuMatrixBase_3_01Real_01_4_coll__map" id="CuMatrixBase_3_01Real_01_4_coll__map">
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a100c3bb9789f8626e5c92b8757933a11"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a100c3bb9789f8626e5c92b8757933a11">CopyCols</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;src, const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> &gt; &amp;indexes)</td></tr>
<tr class="memdesc:a100c3bb9789f8626e5c92b8757933a11"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies column r from column indexes[r] of src.  <a href="#a100c3bb9789f8626e5c92b8757933a11">More...</a><br /></td></tr>
<tr class="separator:a100c3bb9789f8626e5c92b8757933a11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a2daa4c7bed9fadb6d14d277955fa45"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a3a2daa4c7bed9fadb6d14d277955fa45">AddCols</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;src, const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> &gt; &amp;indices)</td></tr>
<tr class="memdesc:a3a2daa4c7bed9fadb6d14d277955fa45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add column indices[r] of src to column r.  <a href="#a3a2daa4c7bed9fadb6d14d277955fa45">More...</a><br /></td></tr>
<tr class="separator:a3a2daa4c7bed9fadb6d14d277955fa45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3c837bb106bfab035db4ea22906acef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ab3c837bb106bfab035db4ea22906acef">CopyRows</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;src, const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> &gt; &amp;indexes)</td></tr>
<tr class="memdesc:ab3c837bb106bfab035db4ea22906acef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies row r from row indexes[r] of src.  <a href="#ab3c837bb106bfab035db4ea22906acef">More...</a><br /></td></tr>
<tr class="separator:ab3c837bb106bfab035db4ea22906acef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5139d83372ab4c1095b1eacf94cad066"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a5139d83372ab4c1095b1eacf94cad066">CopyRows</a> (const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; const Real *&gt; &amp;src)</td></tr>
<tr class="memdesc:a5139d83372ab4c1095b1eacf94cad066"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies row r of this matrix from an array of floats at the location given by src[r], where src[r] is assumed to be obtained from the <a class="el" href="classkaldi_1_1CuMatrixBase.html#aca92364bdcb38c7e30f390340d072bf4" title="Get raw row pointer (const). ">RowData()</a> function of another <a class="el" href="classkaldi_1_1CuMatrix.html" title="This class represents a matrix that&#39;s stored on the GPU if we have one, and in memory if not...">CuMatrix</a>, or from <a class="el" href="classkaldi_1_1CuVectorBase.html#abda573212fad06ec61fd3f428a0992c7" title="Returns a pointer to the start of the vector&#39;s data. ">CuVector::Data()</a> (the point is: the data it points to should be on the GPU if we're using a GPU, and on a CPU otherwise).  <a href="#a5139d83372ab4c1095b1eacf94cad066">More...</a><br /></td></tr>
<tr class="separator:a5139d83372ab4c1095b1eacf94cad066"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad44a3f39df227b02bf84d0df0ad8f550"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ad44a3f39df227b02bf84d0df0ad8f550">CopyToRows</a> (const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; Real *&gt; &amp;dst) const</td></tr>
<tr class="memdesc:ad44a3f39df227b02bf84d0df0ad8f550"><td class="mdescLeft">&#160;</td><td class="mdescRight">For each row r of this matrix, copies it to the array of floats at the location given by dst[r], where dst[r] is assumed to be obtained from the <a class="el" href="classkaldi_1_1CuMatrixBase.html#aca92364bdcb38c7e30f390340d072bf4" title="Get raw row pointer (const). ">RowData()</a> function of another <a class="el" href="classkaldi_1_1CuMatrix.html" title="This class represents a matrix that&#39;s stored on the GPU if we have one, and in memory if not...">CuMatrix</a>, or from <a class="el" href="classkaldi_1_1CuVectorBase.html#abda573212fad06ec61fd3f428a0992c7" title="Returns a pointer to the start of the vector&#39;s data. ">CuVector::Data()</a> (i.e.  <a href="#ad44a3f39df227b02bf84d0df0ad8f550">More...</a><br /></td></tr>
<tr class="separator:ad44a3f39df227b02bf84d0df0ad8f550"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62c46e6440ae6045cb2f0af43f26c1d5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a62c46e6440ae6045cb2f0af43f26c1d5">AddRows</a> (Real alpha, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;src, const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> &gt; &amp;indexes)</td></tr>
<tr class="memdesc:a62c46e6440ae6045cb2f0af43f26c1d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does for each row r, this.Row(r) += alpha * src.row(indexes[r]).  <a href="#a62c46e6440ae6045cb2f0af43f26c1d5">More...</a><br /></td></tr>
<tr class="separator:a62c46e6440ae6045cb2f0af43f26c1d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05ab5a8d45ac27726d551dcfed8fbfeb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a05ab5a8d45ac27726d551dcfed8fbfeb">MulRows</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;src, const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> &gt; &amp;indexes)</td></tr>
<tr class="memdesc:a05ab5a8d45ac27726d551dcfed8fbfeb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does for each row r, this.Row(r) *= alpha * src.row(indexes[r]), where '*=' is elementwise multiplication.  <a href="#a05ab5a8d45ac27726d551dcfed8fbfeb">More...</a><br /></td></tr>
<tr class="separator:a05ab5a8d45ac27726d551dcfed8fbfeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a774e069c4eb05063f4197163e82ee034"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a774e069c4eb05063f4197163e82ee034">AddRows</a> (Real alpha, const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; const Real *&gt; &amp;src)</td></tr>
<tr class="memdesc:a774e069c4eb05063f4197163e82ee034"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does for each row r, this.Row(r) += alpha * src[r], treating src[r] as the beginning of a region of memory representing a vector of floats, of the same length as this.NumCols().  <a href="#a774e069c4eb05063f4197163e82ee034">More...</a><br /></td></tr>
<tr class="separator:a774e069c4eb05063f4197163e82ee034"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d5da0115fcbde3f88d4d17043906ae6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a3d5da0115fcbde3f88d4d17043906ae6">AddToRows</a> (Real alpha, const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> &gt; &amp;indexes, <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; *dst) const</td></tr>
<tr class="memdesc:a3d5da0115fcbde3f88d4d17043906ae6"><td class="mdescLeft">&#160;</td><td class="mdescRight">For each row i of *this, adds this-&gt;Row(i) to dst-&gt;Row(indexes(i)) if indexes(i) &gt;= 0, else do nothing.  <a href="#a3d5da0115fcbde3f88d4d17043906ae6">More...</a><br /></td></tr>
<tr class="separator:a3d5da0115fcbde3f88d4d17043906ae6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d5a76874f291b7f59d2370a91148334"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a1d5a76874f291b7f59d2370a91148334">AddToRows</a> (Real alpha, const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; Real *&gt; &amp;dst) const</td></tr>
<tr class="memdesc:a1d5a76874f291b7f59d2370a91148334"><td class="mdescLeft">&#160;</td><td class="mdescRight">For each row r of this matrix, adds it (times alpha) to the array of floats at the location given by dst[r], where dst[r] is assumed to be obtained from the <a class="el" href="classkaldi_1_1CuMatrixBase.html#aca92364bdcb38c7e30f390340d072bf4" title="Get raw row pointer (const). ">RowData()</a> function of another <a class="el" href="classkaldi_1_1CuMatrix.html" title="This class represents a matrix that&#39;s stored on the GPU if we have one, and in memory if not...">CuMatrix</a>, or from <a class="el" href="classkaldi_1_1CuVectorBase.html#abda573212fad06ec61fd3f428a0992c7" title="Returns a pointer to the start of the vector&#39;s data. ">CuVector::Data()</a> (i.e.  <a href="#a1d5a76874f291b7f59d2370a91148334">More...</a><br /></td></tr>
<tr class="separator:a1d5a76874f291b7f59d2370a91148334"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98157a233bc5fd222414eeeeaa5f19a4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a98157a233bc5fd222414eeeeaa5f19a4">SumColumnRanges</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;src, const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; <a class="el" href="structInt32Pair.html">Int32Pair</a> &gt; &amp;indexes)</td></tr>
<tr class="memdesc:a98157a233bc5fd222414eeeeaa5f19a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">For each row r of this and for each column c, sets (*this)(r, c) to the sum  src(r, j), where j ranges from indexes[c].first through indexes[c].second - 1.  <a href="#a98157a233bc5fd222414eeeeaa5f19a4">More...</a><br /></td></tr>
<tr class="separator:a98157a233bc5fd222414eeeeaa5f19a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4eb60ca0d96773b8e5b33df26d8595f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ae4eb60ca0d96773b8e5b33df26d8595f">AddRowRanges</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;src, const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; <a class="el" href="structInt32Pair.html">Int32Pair</a> &gt; &amp;indexes)</td></tr>
<tr class="memdesc:ae4eb60ca0d96773b8e5b33df26d8595f"><td class="mdescLeft">&#160;</td><td class="mdescRight">For each row r of this and for each column c, do (*this)(r, c) +=  src(j, c), where j ranges from indexes[r].first through indexes[r].second - 1.  <a href="#ae4eb60ca0d96773b8e5b33df26d8595f">More...</a><br /></td></tr>
<tr class="separator:ae4eb60ca0d96773b8e5b33df26d8595f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8e87b09ccd8a23d31dbc415a60da637"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ae8e87b09ccd8a23d31dbc415a60da637">AddToDiag</a> (Real value)</td></tr>
<tr class="memdesc:ae8e87b09ccd8a23d31dbc415a60da637"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds "value" to the diagonal elements of the matrix.  <a href="#ae8e87b09ccd8a23d31dbc415a60da637">More...</a><br /></td></tr>
<tr class="separator:ae8e87b09ccd8a23d31dbc415a60da637"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01cf7fccddf8deddc75b34408144ded1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a> () const</td></tr>
<tr class="memdesc:a01cf7fccddf8deddc75b34408144ded1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dimensions.  <a href="#a01cf7fccddf8deddc75b34408144ded1">More...</a><br /></td></tr>
<tr class="separator:a01cf7fccddf8deddc75b34408144ded1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd4c9f53536602585f5aff9e8005299a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a> () const</td></tr>
<tr class="separator:acd4c9f53536602585f5aff9e8005299a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a180e10f97fa838f9c1ae125ba164dd77"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a180e10f97fa838f9c1ae125ba164dd77">Stride</a> () const</td></tr>
<tr class="separator:a180e10f97fa838f9c1ae125ba164dd77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05174128bcd0c73d49c8ebdb7735aa94"><td class="memItemLeft" align="right" valign="top">::<a class="el" href="cu-matrixdim_8h.html#a8d5aae09b817446d2ffe45f3490afc51">MatrixDim</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a> () const</td></tr>
<tr class="separator:a05174128bcd0c73d49c8ebdb7735aa94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8bb668abdc6122cec89dc1f01f73554"><td class="memItemLeft" align="right" valign="top">Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ac8bb668abdc6122cec89dc1f01f73554">FrobeniusNorm</a> () const</td></tr>
<tr class="separator:ac8bb668abdc6122cec89dc1f01f73554"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8942de74bc673faeba1fba05a4a9ab9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ac8942de74bc673faeba1fba05a4a9ab9">IsUnit</a> (Real tol=0.001) const</td></tr>
<tr class="separator:ac8942de74bc673faeba1fba05a4a9ab9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81e9903967b7f6743057aaf7e2126309"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a81e9903967b7f6743057aaf7e2126309">ApproxEqual</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;other, <a class="el" href="classfloat.html">float</a> tol=0.01) const</td></tr>
<tr class="memdesc:a81e9903967b7f6743057aaf7e2126309"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if ((*this)-other).<a class="el" href="classkaldi_1_1CuMatrixBase.html#ac8bb668abdc6122cec89dc1f01f73554">FrobeniusNorm()</a> &lt;= tol * this-&gt;<a class="el" href="classkaldi_1_1CuMatrixBase.html#ac8bb668abdc6122cec89dc1f01f73554">FrobeniusNorm()</a>  <a href="#a81e9903967b7f6743057aaf7e2126309">More...</a><br /></td></tr>
<tr class="separator:a81e9903967b7f6743057aaf7e2126309"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2444c253ce3e836b558d3817edd3fc42"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a2444c253ce3e836b558d3817edd3fc42">SizeInBytes</a> () const</td></tr>
<tr class="memdesc:a2444c253ce3e836b558d3817edd3fc42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get size of matrix in bytes.  <a href="#a2444c253ce3e836b558d3817edd3fc42">More...</a><br /></td></tr>
<tr class="separator:a2444c253ce3e836b558d3817edd3fc42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79817f1cbd9d8478d4137d6dd815a584"><td class="memTemplParams" colspan="2">template&lt;typename OtherReal &gt; </td></tr>
<tr class="memitem:a79817f1cbd9d8478d4137d6dd815a584"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a79817f1cbd9d8478d4137d6dd815a584">CopyFromMat</a> (const <a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; <a class="el" href="classkaldi_1_1OtherReal.html">OtherReal</a> &gt; &amp;src, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> trans=<a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>)</td></tr>
<tr class="separator:a79817f1cbd9d8478d4137d6dd815a584"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a025ce20bb4a818392993e8c36fa9ac3b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a025ce20bb4a818392993e8c36fa9ac3b">CopyFromGeneralMat</a> (const <a class="el" href="classkaldi_1_1GeneralMatrix.html">GeneralMatrix</a> &amp;src, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> trans=<a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>)</td></tr>
<tr class="separator:a025ce20bb4a818392993e8c36fa9ac3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6dff75e1b716efce7cf78911cf420e5e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a6dff75e1b716efce7cf78911cf420e5e">CopyFromMat</a> (const <a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; Real &gt; &amp;src, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> trans=<a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>)</td></tr>
<tr class="separator:a6dff75e1b716efce7cf78911cf420e5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45b60b630fe0bfdd71b4065f1fdee8f0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a45b60b630fe0bfdd71b4065f1fdee8f0">CopyFromSp</a> (const <a class="el" href="classkaldi_1_1CuSpMatrix.html">CuSpMatrix</a>&lt; Real &gt; &amp;M)</td></tr>
<tr class="separator:a45b60b630fe0bfdd71b4065f1fdee8f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4df008a5298765a0a004c25b49bf62c0"><td class="memTemplParams" colspan="2">template&lt;typename OtherReal &gt; </td></tr>
<tr class="memitem:a4df008a5298765a0a004c25b49bf62c0"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a4df008a5298765a0a004c25b49bf62c0">CopyFromTp</a> (const <a class="el" href="classkaldi_1_1CuTpMatrix.html">CuTpMatrix</a>&lt; <a class="el" href="classkaldi_1_1OtherReal.html">OtherReal</a> &gt; &amp;M, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> trans=<a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>)</td></tr>
<tr class="separator:a4df008a5298765a0a004c25b49bf62c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe90d984db20e190d2817357ba300bf1"><td class="memTemplParams" colspan="2">template&lt;typename OtherReal &gt; </td></tr>
<tr class="memitem:abe90d984db20e190d2817357ba300bf1"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#abe90d984db20e190d2817357ba300bf1">CopyFromMat</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="classkaldi_1_1OtherReal.html">OtherReal</a> &gt; &amp;M, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> trans=<a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>)</td></tr>
<tr class="separator:abe90d984db20e190d2817357ba300bf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae67f2eab6adb41c8851873ac493d7f37"><td class="memTemplParams" colspan="2">template&lt;typename OtherReal &gt; </td></tr>
<tr class="memitem:ae67f2eab6adb41c8851873ac493d7f37"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ae67f2eab6adb41c8851873ac493d7f37">CopyToMat</a> (<a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; <a class="el" href="classkaldi_1_1OtherReal.html">OtherReal</a> &gt; *dst, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> trans=<a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>) const</td></tr>
<tr class="separator:ae67f2eab6adb41c8851873ac493d7f37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2f0948568047c75ffeef9aa6ea590ac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ae2f0948568047c75ffeef9aa6ea590ac">CopyRowsFromVec</a> (const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;v)</td></tr>
<tr class="memdesc:ae2f0948568047c75ffeef9aa6ea590ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function has two modes of operation.  <a href="#ae2f0948568047c75ffeef9aa6ea590ac">More...</a><br /></td></tr>
<tr class="separator:ae2f0948568047c75ffeef9aa6ea590ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0db477a6b3daf0a83142ae056256e1e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a0db477a6b3daf0a83142ae056256e1e3">CopyRowsFromVec</a> (const <a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a>&lt; Real &gt; &amp;v)</td></tr>
<tr class="memdesc:a0db477a6b3daf0a83142ae056256e1e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Version of <a class="el" href="classkaldi_1_1CuMatrixBase.html#ae2f0948568047c75ffeef9aa6ea590ac" title="This function has two modes of operation. ">CopyRowsFromVec()</a> that takes a CPU-based vector.  <a href="#a0db477a6b3daf0a83142ae056256e1e3">More...</a><br /></td></tr>
<tr class="separator:a0db477a6b3daf0a83142ae056256e1e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a104a0d1e35056c8efeb5b9ff3e0cb7e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a104a0d1e35056c8efeb5b9ff3e0cb7e7">CopyColsFromVec</a> (const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;v)</td></tr>
<tr class="memdesc:a104a0d1e35056c8efeb5b9ff3e0cb7e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies vector into matrix, column-by-column.  <a href="#a104a0d1e35056c8efeb5b9ff3e0cb7e7">More...</a><br /></td></tr>
<tr class="separator:a104a0d1e35056c8efeb5b9ff3e0cb7e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85585428bff19297f65515617c79f833"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a85585428bff19297f65515617c79f833">CopyColFromVec</a> (const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;v, const <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> col)</td></tr>
<tr class="memdesc:a85585428bff19297f65515617c79f833"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy vector into specific column of matrix.  <a href="#a85585428bff19297f65515617c79f833">More...</a><br /></td></tr>
<tr class="separator:a85585428bff19297f65515617c79f833"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae5806cc9e96c577cec331f3a915017d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#aae5806cc9e96c577cec331f3a915017d">Sigmoid</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;src)</td></tr>
<tr class="memdesc:aae5806cc9e96c577cec331f3a915017d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set each element to the sigmoid of the corresponding element of "src": element by element, x = 1 / (1 + exp(-x))  <a href="#aae5806cc9e96c577cec331f3a915017d">More...</a><br /></td></tr>
<tr class="separator:aae5806cc9e96c577cec331f3a915017d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae82afecb83b55a59388b8c55b958e6bf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ae82afecb83b55a59388b8c55b958e6bf">Heaviside</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;src)</td></tr>
<tr class="memdesc:ae82afecb83b55a59388b8c55b958e6bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set each element to the Heaviside function of the corresponding element of "src", which we define as the function (x &gt; 0 ? 1.0 : 0.0) [note: in general, there are different ways to deal with the situation when x==0.  <a href="#ae82afecb83b55a59388b8c55b958e6bf">More...</a><br /></td></tr>
<tr class="separator:ae82afecb83b55a59388b8c55b958e6bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af19362cd0ed9de3b0a74bc9616e68dd1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#af19362cd0ed9de3b0a74bc9616e68dd1">SoftHinge</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;src)</td></tr>
<tr class="memdesc:af19362cd0ed9de3b0a74bc9616e68dd1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply the function y = log(1 + exp(x)), to each element.  <a href="#af19362cd0ed9de3b0a74bc9616e68dd1">More...</a><br /></td></tr>
<tr class="separator:af19362cd0ed9de3b0a74bc9616e68dd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6d41b3236bb08ae2e30a1553045a23c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ae6d41b3236bb08ae2e30a1553045a23c">GroupPnorm</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;src, Real pow)</td></tr>
<tr class="memdesc:ae6d41b3236bb08ae2e30a1553045a23c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply the function y(i) = (sum_{j = i*G}^{(i+1)*G-1} x_j ^ (power)) ^ (1 / p) where G = x.NumCols() / y.NumCols() must be an integer.  <a href="#ae6d41b3236bb08ae2e30a1553045a23c">More...</a><br /></td></tr>
<tr class="separator:ae6d41b3236bb08ae2e30a1553045a23c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae66b901bbaf7c4f954b36b2245047bdd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ae66b901bbaf7c4f954b36b2245047bdd">DiffGroupPnorm</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;in_value, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;out_value, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;out_deriv, Real power)</td></tr>
<tr class="memdesc:ae66b901bbaf7c4f954b36b2245047bdd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Differentiate backward through the GroupPnorm function.  <a href="#ae66b901bbaf7c4f954b36b2245047bdd">More...</a><br /></td></tr>
<tr class="separator:ae66b901bbaf7c4f954b36b2245047bdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbd817b31bc0a35fda44edbe94a4080b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#adbd817b31bc0a35fda44edbe94a4080b">GroupMax</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;src)</td></tr>
<tr class="memdesc:adbd817b31bc0a35fda44edbe94a4080b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply the function y(i) = (max_{j = i*G}^{(i+1)*G-1} x_j where G = x.NumCols() / y.NumCols() must be an integer.  <a href="#adbd817b31bc0a35fda44edbe94a4080b">More...</a><br /></td></tr>
<tr class="separator:adbd817b31bc0a35fda44edbe94a4080b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbddc0667daba04ecd6201e1ee028e8d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#adbddc0667daba04ecd6201e1ee028e8d">GroupMaxDeriv</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;input, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;output)</td></tr>
<tr class="memdesc:adbddc0667daba04ecd6201e1ee028e8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate derivatives for the GroupMax function above, where "input" is the input to the GroupMax function above (i.e.  <a href="#adbddc0667daba04ecd6201e1ee028e8d">More...</a><br /></td></tr>
<tr class="separator:adbddc0667daba04ecd6201e1ee028e8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2eb5b471c0eab9cf8a92482782827d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ad2eb5b471c0eab9cf8a92482782827d1">ParametricRelu</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;src, const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;alpha, const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;beta)</td></tr>
<tr class="memdesc:ad2eb5b471c0eab9cf8a92482782827d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the parametric rectified linear unit function; element by element, *this = src * (src &gt; 0 ? alpha : beta)  <a href="#ad2eb5b471c0eab9cf8a92482782827d1">More...</a><br /></td></tr>
<tr class="separator:ad2eb5b471c0eab9cf8a92482782827d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1e9318b82d532a574d9782b7323c4da"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ab1e9318b82d532a574d9782b7323c4da">DiffParametricRelu</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;value, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;diff, const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;alpha, const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;beta)</td></tr>
<tr class="memdesc:ab1e9318b82d532a574d9782b7323c4da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Differentiate backward through the parametric relu function.  <a href="#ab1e9318b82d532a574d9782b7323c4da">More...</a><br /></td></tr>
<tr class="separator:ab1e9318b82d532a574d9782b7323c4da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac21c2992057adbce518977e8131d3e3f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ac21c2992057adbce518977e8131d3e3f">Tanh</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;src)</td></tr>
<tr class="memdesc:ac21c2992057adbce518977e8131d3e3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the hyperbolic tangent (tanh) function; element by element, *this = tanh(src).  <a href="#ac21c2992057adbce518977e8131d3e3f">More...</a><br /></td></tr>
<tr class="separator:ac21c2992057adbce518977e8131d3e3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50495cd2ff9a2480bd0370bccd662a8b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a50495cd2ff9a2480bd0370bccd662a8b">DiffSigmoid</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;value, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;diff)</td></tr>
<tr class="memdesc:a50495cd2ff9a2480bd0370bccd662a8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Differentiate backward through the sigmoid function.  <a href="#a50495cd2ff9a2480bd0370bccd662a8b">More...</a><br /></td></tr>
<tr class="separator:a50495cd2ff9a2480bd0370bccd662a8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa96216e7ba0877d0db608a3b57e32aba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#aa96216e7ba0877d0db608a3b57e32aba">DiffTanh</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;value, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;diff)</td></tr>
<tr class="memdesc:aa96216e7ba0877d0db608a3b57e32aba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Differentiate backward through the tanh function.  <a href="#aa96216e7ba0877d0db608a3b57e32aba">More...</a><br /></td></tr>
<tr class="separator:aa96216e7ba0877d0db608a3b57e32aba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d8a3fcf077a2f3b155940cddb0dac3a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a4d8a3fcf077a2f3b155940cddb0dac3a">DiffSoftmaxPerRow</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;value, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;diff)</td></tr>
<tr class="memdesc:a4d8a3fcf077a2f3b155940cddb0dac3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Differentiate backward through the softmax function.  <a href="#a4d8a3fcf077a2f3b155940cddb0dac3a">More...</a><br /></td></tr>
<tr class="separator:a4d8a3fcf077a2f3b155940cddb0dac3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa180015860cdd28a24b27984b816762d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#aa180015860cdd28a24b27984b816762d">DiffLogSoftmaxPerRow</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;out_value, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;out_deriv)</td></tr>
<tr class="memdesc:aa180015860cdd28a24b27984b816762d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Differentiate backward through the log softmax function.  <a href="#aa180015860cdd28a24b27984b816762d">More...</a><br /></td></tr>
<tr class="separator:aa180015860cdd28a24b27984b816762d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ec6983d85cf6b1cb8016cbd6dc16a7d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a8ec6983d85cf6b1cb8016cbd6dc16a7d">DiffXent</a> (const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; int32 &gt; &amp;tgt, <a class="el" href="classkaldi_1_1CuVector.html">CuVector</a>&lt; Real &gt; *log_post_tgt)</td></tr>
<tr class="memdesc:a8ec6983d85cf6b1cb8016cbd6dc16a7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Differentiate the block [softmax+cross-entropy] : dE/da = posterior_mat - target_mat, 'E' is error function, 'a' is activation on softmax input.  <a href="#a8ec6983d85cf6b1cb8016cbd6dc16a7d">More...</a><br /></td></tr>
<tr class="separator:a8ec6983d85cf6b1cb8016cbd6dc16a7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22d93ed1d61d46b5b6f5eb27d3a748f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a22d93ed1d61d46b5b6f5eb27d3a748f5">Cholesky</a> (<a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; *inv_cholesky=NULL)</td></tr>
<tr class="memdesc:a22d93ed1d61d46b5b6f5eb27d3a748f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function does sets *this to the Cholesky factor of *this (i.e.  <a href="#a22d93ed1d61d46b5b6f5eb27d3a748f5">More...</a><br /></td></tr>
<tr class="separator:a22d93ed1d61d46b5b6f5eb27d3a748f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7590e6a76e5d8757d361703ff47bbb0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ab7590e6a76e5d8757d361703ff47bbb0">SymInvertPosDef</a> ()</td></tr>
<tr class="memdesc:ab7590e6a76e5d8757d361703ff47bbb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inversion for positive definite symmetric matrices.  <a href="#ab7590e6a76e5d8757d361703ff47bbb0">More...</a><br /></td></tr>
<tr class="separator:ab7590e6a76e5d8757d361703ff47bbb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36c241f895530869d9e5a3c7bdedb25e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a36c241f895530869d9e5a3c7bdedb25e">ApplyPow</a> (Real power)</td></tr>
<tr class="separator:a36c241f895530869d9e5a3c7bdedb25e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ffea48966b732aa55c452781538cd1c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a4ffea48966b732aa55c452781538cd1c">ApplyPowAbs</a> (Real power, <a class="el" href="classbool.html">bool</a> include_sign=false)</td></tr>
<tr class="memdesc:a4ffea48966b732aa55c452781538cd1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply power to the absolute value of each element.  <a href="#a4ffea48966b732aa55c452781538cd1c">More...</a><br /></td></tr>
<tr class="separator:a4ffea48966b732aa55c452781538cd1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae33e21e5fc98e4d380967e75d470f6fd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ae33e21e5fc98e4d380967e75d470f6fd">ApplyHeaviside</a> ()</td></tr>
<tr class="memdesc:ae33e21e5fc98e4d380967e75d470f6fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">For each element, sets x = (x &gt; 0 ? 1.0 : 0.0).  <a href="#ae33e21e5fc98e4d380967e75d470f6fd">More...</a><br /></td></tr>
<tr class="separator:ae33e21e5fc98e4d380967e75d470f6fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55e848f0d312e1cc0014117787406e5d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a55e848f0d312e1cc0014117787406e5d">ApplyFloor</a> (Real floor_val)</td></tr>
<tr class="separator:a55e848f0d312e1cc0014117787406e5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d4a6173e58467a1ddeb21c8aa46f271"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a7d4a6173e58467a1ddeb21c8aa46f271">ApplyCeiling</a> (Real ceiling_val)</td></tr>
<tr class="separator:a7d4a6173e58467a1ddeb21c8aa46f271"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d9dc70920bff8a7d995679d7ba2d81b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a7d9dc70920bff8a7d995679d7ba2d81b">ApplyExp</a> ()</td></tr>
<tr class="separator:a7d9dc70920bff8a7d995679d7ba2d81b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad256eff0fc05e41dfe1a0d4edce43ac9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ad256eff0fc05e41dfe1a0d4edce43ac9">ApplyExpLimited</a> (Real lower_limit, Real upper_limit)</td></tr>
<tr class="memdesc:ad256eff0fc05e41dfe1a0d4edce43ac9"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is equivalent to running: ApplyFloor(lower_limit); ApplyCeiling(upper_limit); <a class="el" href="classkaldi_1_1CuMatrixBase.html#a7d9dc70920bff8a7d995679d7ba2d81b">ApplyExp()</a>  <a href="#ad256eff0fc05e41dfe1a0d4edce43ac9">More...</a><br /></td></tr>
<tr class="separator:ad256eff0fc05e41dfe1a0d4edce43ac9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5353ff81c33e8f224463dff1e8f8fead"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a5353ff81c33e8f224463dff1e8f8fead">ApplyExpSpecial</a> ()</td></tr>
<tr class="memdesc:a5353ff81c33e8f224463dff1e8f8fead"><td class="mdescLeft">&#160;</td><td class="mdescRight">For each element x of the matrix, set it to (x &lt; 0 ? exp(x) : x + 1).  <a href="#a5353ff81c33e8f224463dff1e8f8fead">More...</a><br /></td></tr>
<tr class="separator:a5353ff81c33e8f224463dff1e8f8fead"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6dfdeffc05cb0e5e4c4a7ed8edf42886"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a6dfdeffc05cb0e5e4c4a7ed8edf42886">ApplySoftMaxPerRow</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;src)</td></tr>
<tr class="memdesc:a6dfdeffc05cb0e5e4c4a7ed8edf42886"><td class="mdescLeft">&#160;</td><td class="mdescRight">Softmax nonlinearity Y = Softmax(X) : Yij = e^Xij / sum_k(e^Xik), done to each row, with attention to avoiding overflow or underflow.  <a href="#a6dfdeffc05cb0e5e4c4a7ed8edf42886">More...</a><br /></td></tr>
<tr class="separator:a6dfdeffc05cb0e5e4c4a7ed8edf42886"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3241a69c779b7de9b3a5d26f81d4b504"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a3241a69c779b7de9b3a5d26f81d4b504">ApplyLogSoftMaxPerRow</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;src)</td></tr>
<tr class="memdesc:a3241a69c779b7de9b3a5d26f81d4b504"><td class="mdescLeft">&#160;</td><td class="mdescRight">LogSoftmax nonlinearity Y = LogSoftmax(X) : Yij = Xij - log(sum_k(e^Xik)), done to each row, with attention to avoiding overflow or underflow.  <a href="#a3241a69c779b7de9b3a5d26f81d4b504">More...</a><br /></td></tr>
<tr class="separator:a3241a69c779b7de9b3a5d26f81d4b504"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee193f379988f1242a44d2a0d13e5171"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#aee193f379988f1242a44d2a0d13e5171">FindRowMaxId</a> (<a class="el" href="classkaldi_1_1CuArray.html">CuArray</a>&lt; int32 &gt; *id) const</td></tr>
<tr class="memdesc:aee193f379988f1242a44d2a0d13e5171"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the id of the maximal element for each row (resizes the 'id' array to the appropriate size).  <a href="#aee193f379988f1242a44d2a0d13e5171">More...</a><br /></td></tr>
<tr class="separator:aee193f379988f1242a44d2a0d13e5171"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae57e5aca5db002545e4b9335c8d9dbfa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ae57e5aca5db002545e4b9335c8d9dbfa">SetZero</a> ()</td></tr>
<tr class="memdesc:ae57e5aca5db002545e4b9335c8d9dbfa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Math operations, some calling kernels.  <a href="#ae57e5aca5db002545e4b9335c8d9dbfa">More...</a><br /></td></tr>
<tr class="separator:ae57e5aca5db002545e4b9335c8d9dbfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6869c723f58973838a83d4b60d4b433"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ac6869c723f58973838a83d4b60d4b433">Set</a> (Real value)</td></tr>
<tr class="separator:ac6869c723f58973838a83d4b60d4b433"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92b8db063dbc1ca69795d167c5f31a4d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a92b8db063dbc1ca69795d167c5f31a4d">Add</a> (Real value)</td></tr>
<tr class="separator:a92b8db063dbc1ca69795d167c5f31a4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73be15df483d1ef6c08cea5adc15bc3f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a73be15df483d1ef6c08cea5adc15bc3f">SetZeroAboveDiag</a> ()</td></tr>
<tr class="memdesc:a73be15df483d1ef6c08cea5adc15bc3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Zeroes all elements for which col &gt; row.  <a href="#a73be15df483d1ef6c08cea5adc15bc3f">More...</a><br /></td></tr>
<tr class="separator:a73be15df483d1ef6c08cea5adc15bc3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac54802d75d4c9025310b579e3fcea00c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ac54802d75d4c9025310b579e3fcea00c">Scale</a> (Real value)</td></tr>
<tr class="separator:ac54802d75d4c9025310b579e3fcea00c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95f20890747a5e1041269502faac50a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a95f20890747a5e1041269502faac50a8">ApplyLog</a> ()</td></tr>
<tr class="separator:a95f20890747a5e1041269502faac50a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93f1ecf679bf0ab28200c1cec33bd1ba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a93f1ecf679bf0ab28200c1cec33bd1ba">MulElements</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;A)</td></tr>
<tr class="memdesc:a93f1ecf679bf0ab28200c1cec33bd1ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Multiply two matrices elementwise: C = C .* A.  <a href="#a93f1ecf679bf0ab28200c1cec33bd1ba">More...</a><br /></td></tr>
<tr class="separator:a93f1ecf679bf0ab28200c1cec33bd1ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09846db9a782e71477e9ce75229a5168"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a09846db9a782e71477e9ce75229a5168">DivElements</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;A)</td></tr>
<tr class="memdesc:a09846db9a782e71477e9ce75229a5168"><td class="mdescLeft">&#160;</td><td class="mdescRight">Divide two matrices elementwise: C = A ./ A.  <a href="#a09846db9a782e71477e9ce75229a5168">More...</a><br /></td></tr>
<tr class="separator:a09846db9a782e71477e9ce75229a5168"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6881fe49b9f43a0a337eb1878e0d5721"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a6881fe49b9f43a0a337eb1878e0d5721">Max</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;A)</td></tr>
<tr class="memdesc:a6881fe49b9f43a0a337eb1878e0d5721"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do, elementwise, *this = max(*this, A).  <a href="#a6881fe49b9f43a0a337eb1878e0d5721">More...</a><br /></td></tr>
<tr class="separator:a6881fe49b9f43a0a337eb1878e0d5721"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a055340b299b3ffbf460d4f73a5175d07"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a055340b299b3ffbf460d4f73a5175d07">Min</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;A)</td></tr>
<tr class="memdesc:a055340b299b3ffbf460d4f73a5175d07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do, elementwise, *this = min(*this, A).  <a href="#a055340b299b3ffbf460d4f73a5175d07">More...</a><br /></td></tr>
<tr class="separator:a055340b299b3ffbf460d4f73a5175d07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f6c664e96c310dca11dc987a3c1632c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a6f6c664e96c310dca11dc987a3c1632c">MulColsVec</a> (const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;scale)</td></tr>
<tr class="memdesc:a6f6c664e96c310dca11dc987a3c1632c"><td class="mdescLeft">&#160;</td><td class="mdescRight">scale i'th column by scale[i]  <a href="#a6f6c664e96c310dca11dc987a3c1632c">More...</a><br /></td></tr>
<tr class="separator:a6f6c664e96c310dca11dc987a3c1632c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9316d4a8c6a73dfadbf9e8417e70a514"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a9316d4a8c6a73dfadbf9e8417e70a514">MulRowsVec</a> (const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;scale)</td></tr>
<tr class="memdesc:a9316d4a8c6a73dfadbf9e8417e70a514"><td class="mdescLeft">&#160;</td><td class="mdescRight">scale i'th row by scale[i]  <a href="#a9316d4a8c6a73dfadbf9e8417e70a514">More...</a><br /></td></tr>
<tr class="separator:a9316d4a8c6a73dfadbf9e8417e70a514"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bb9285c3b3d6c789c70da92831ae344"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a0bb9285c3b3d6c789c70da92831ae344">MulRowsGroupMat</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;src)</td></tr>
<tr class="memdesc:a0bb9285c3b3d6c789c70da92831ae344"><td class="mdescLeft">&#160;</td><td class="mdescRight">divide each row into src.NumCols() groups, and then scale i'th row's jth group of elements by src[i, j].  <a href="#a0bb9285c3b3d6c789c70da92831ae344">More...</a><br /></td></tr>
<tr class="separator:a0bb9285c3b3d6c789c70da92831ae344"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e00be526b78792f7bf8edfe207f6d59"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a2e00be526b78792f7bf8edfe207f6d59">DivRowsVec</a> (const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;div)</td></tr>
<tr class="memdesc:a2e00be526b78792f7bf8edfe207f6d59"><td class="mdescLeft">&#160;</td><td class="mdescRight">divide i'th row by scale[i]  <a href="#a2e00be526b78792f7bf8edfe207f6d59">More...</a><br /></td></tr>
<tr class="separator:a2e00be526b78792f7bf8edfe207f6d59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48ca3ab8b1fd73a49e5c7ee2870f36af"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a48ca3ab8b1fd73a49e5c7ee2870f36af">InvertElements</a> ()</td></tr>
<tr class="memdesc:a48ca3ab8b1fd73a49e5c7ee2870f36af"><td class="mdescLeft">&#160;</td><td class="mdescRight">invert the matrix by elements.  <a href="#a48ca3ab8b1fd73a49e5c7ee2870f36af">More...</a><br /></td></tr>
<tr class="separator:a48ca3ab8b1fd73a49e5c7ee2870f36af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bce9eaec860cf9d9a8aee7e440b976b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a4bce9eaec860cf9d9a8aee7e440b976b">AddMat</a> (Real alpha, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;A, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> trans=<a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>)</td></tr>
<tr class="memdesc:a4bce9eaec860cf9d9a8aee7e440b976b"><td class="mdescLeft">&#160;</td><td class="mdescRight">*this += alpha * A  <a href="#a4bce9eaec860cf9d9a8aee7e440b976b">More...</a><br /></td></tr>
<tr class="separator:a4bce9eaec860cf9d9a8aee7e440b976b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4e47f8bb3cf8fc753d6a8bc79da118d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#af4e47f8bb3cf8fc753d6a8bc79da118d">AddSmat</a> (Real alpha, const <a class="el" href="classkaldi_1_1CuSparseMatrix.html">CuSparseMatrix</a>&lt; Real &gt; &amp;A, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> trans=<a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>)</td></tr>
<tr class="memdesc:af4e47f8bb3cf8fc753d6a8bc79da118d"><td class="mdescLeft">&#160;</td><td class="mdescRight">*this += alpha * A.  <a href="#af4e47f8bb3cf8fc753d6a8bc79da118d">More...</a><br /></td></tr>
<tr class="separator:af4e47f8bb3cf8fc753d6a8bc79da118d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c0b0b2d6973581565453c81d068b5e6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a4c0b0b2d6973581565453c81d068b5e6">AddSmatMat</a> (Real alpha, const <a class="el" href="classkaldi_1_1CuSparseMatrix.html">CuSparseMatrix</a>&lt; Real &gt; &amp;A, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> transA, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;B, Real beta)</td></tr>
<tr class="memdesc:a4c0b0b2d6973581565453c81d068b5e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">(*this) = alpha * op(A) * B + beta * (*this), where A is sparse.  <a href="#a4c0b0b2d6973581565453c81d068b5e6">More...</a><br /></td></tr>
<tr class="separator:a4c0b0b2d6973581565453c81d068b5e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7e288e026f0c9ae310071406bdb5812"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ad7e288e026f0c9ae310071406bdb5812">AddMatSmat</a> (Real alpha, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;A, const <a class="el" href="classkaldi_1_1CuSparseMatrix.html">CuSparseMatrix</a>&lt; Real &gt; &amp;B, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> transB, Real beta)</td></tr>
<tr class="memdesc:ad7e288e026f0c9ae310071406bdb5812"><td class="mdescLeft">&#160;</td><td class="mdescRight">(*this) = alpha * A * op(B) + beta * (*this), where B is sparse and op(B) is either B or trans(B) depending on the 'transB' argument.  <a href="#ad7e288e026f0c9ae310071406bdb5812">More...</a><br /></td></tr>
<tr class="separator:ad7e288e026f0c9ae310071406bdb5812"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb9cf49b8cc2e213de8a8efb6c9dad77"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#acb9cf49b8cc2e213de8a8efb6c9dad77">AddToElements</a> (Real alpha, const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; int32 &gt; &amp;elements)</td></tr>
<tr class="memdesc:acb9cf49b8cc2e213de8a8efb6c9dad77"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is a rather special purpose function; we might generalize it later by adding a transpose-type option.  <a href="#acb9cf49b8cc2e213de8a8efb6c9dad77">More...</a><br /></td></tr>
<tr class="separator:acb9cf49b8cc2e213de8a8efb6c9dad77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5195b469c721f95359411d2c6ff503aa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a5195b469c721f95359411d2c6ff503aa">AddMatBlocks</a> (Real alpha, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;A, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> trans=<a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>)</td></tr>
<tr class="memdesc:a5195b469c721f95359411d2c6ff503aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is like AddMat (it does *this += alpha * src), except that it supports cases where *this and src have different dimension.  <a href="#a5195b469c721f95359411d2c6ff503aa">More...</a><br /></td></tr>
<tr class="separator:a5195b469c721f95359411d2c6ff503aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a4dc2595cb8eace4937a22e03c7be18"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a8a4dc2595cb8eace4937a22e03c7be18">AddVecToCols</a> (Real alpha, const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;col, Real beta=1.0)</td></tr>
<tr class="memdesc:a8a4dc2595cb8eace4937a22e03c7be18"><td class="mdescLeft">&#160;</td><td class="mdescRight">(for each column c of *this), c = alpha * col + beta * c  <a href="#a8a4dc2595cb8eace4937a22e03c7be18">More...</a><br /></td></tr>
<tr class="separator:a8a4dc2595cb8eace4937a22e03c7be18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d4bcaf73515787cf3c40710e8557e48"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a5d4bcaf73515787cf3c40710e8557e48">AddVecToRows</a> (Real alpha, const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;row, Real beta=1.0)</td></tr>
<tr class="memdesc:a5d4bcaf73515787cf3c40710e8557e48"><td class="mdescLeft">&#160;</td><td class="mdescRight">(for each row r of *this), r = alpha * row + beta * r  <a href="#a5d4bcaf73515787cf3c40710e8557e48">More...</a><br /></td></tr>
<tr class="separator:a5d4bcaf73515787cf3c40710e8557e48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6680e67841f62c6cf1b52d13b58546d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ac6680e67841f62c6cf1b52d13b58546d">AddMatMat</a> (Real alpha, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;A, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> transA, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;B, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> transB, Real beta)</td></tr>
<tr class="memdesc:ac6680e67841f62c6cf1b52d13b58546d"><td class="mdescLeft">&#160;</td><td class="mdescRight">C = alpha * A(^T)*B(^T) + beta * C.  <a href="#ac6680e67841f62c6cf1b52d13b58546d">More...</a><br /></td></tr>
<tr class="separator:ac6680e67841f62c6cf1b52d13b58546d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a496e97d381fa331033ef85df55860898"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a496e97d381fa331033ef85df55860898">AddVecVec</a> (Real alpha, const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;x, const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;y)</td></tr>
<tr class="memdesc:a496e97d381fa331033ef85df55860898"><td class="mdescLeft">&#160;</td><td class="mdescRight">A = alpha * x * y^T + A .  <a href="#a496e97d381fa331033ef85df55860898">More...</a><br /></td></tr>
<tr class="separator:a496e97d381fa331033ef85df55860898"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77216f592a9fd9eb20bcc750c71cc87a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a77216f592a9fd9eb20bcc750c71cc87a">SetMatMatDivMat</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;A, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;B, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;C)</td></tr>
<tr class="memdesc:a77216f592a9fd9eb20bcc750c71cc87a"><td class="mdescLeft">&#160;</td><td class="mdescRight">*this = a * b / c (by element; when c = 0, *this = a) *this can be an alias of a, b or c safely and get expected result.  <a href="#a77216f592a9fd9eb20bcc750c71cc87a">More...</a><br /></td></tr>
<tr class="separator:a77216f592a9fd9eb20bcc750c71cc87a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b29a25c5f85d5a970594c2fcbb3c044"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a9b29a25c5f85d5a970594c2fcbb3c044">SymAddMat2</a> (const Real alpha, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;M, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> transA, Real beta)</td></tr>
<tr class="memdesc:a9b29a25c5f85d5a970594c2fcbb3c044"><td class="mdescLeft">&#160;</td><td class="mdescRight">*this = beta * *this + alpha * M M^T, for symmetric matrices.  <a href="#a9b29a25c5f85d5a970594c2fcbb3c044">More...</a><br /></td></tr>
<tr class="separator:a9b29a25c5f85d5a970594c2fcbb3c044"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f033384afda592570cca2cb5310fc55"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a5f033384afda592570cca2cb5310fc55">AddMatBlock</a> (Real alpha, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;A, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> transA, const <a class="el" href="classkaldi_1_1CuBlockMatrix.html">CuBlockMatrix</a>&lt; Real &gt; &amp;B, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> transB, Real beta)</td></tr>
<tr class="memdesc:a5f033384afda592570cca2cb5310fc55"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is like AddMatMat but for where the second argument is of type <a class="el" href="classkaldi_1_1CuBlockMatrix.html" title="The class CuBlockMatrix holds a vector of objects of type CuMatrix, say, M_1, M_2, . ">CuBlockMatrix</a> (a block-diagonal matrix of blocks).  <a href="#a5f033384afda592570cca2cb5310fc55">More...</a><br /></td></tr>
<tr class="separator:a5f033384afda592570cca2cb5310fc55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5550d8bed0a0d47b57bcffde4c655330"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a5550d8bed0a0d47b57bcffde4c655330">AddDiagVecMat</a> (const Real alpha, const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;v, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;M, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> transM, Real beta=1.0)</td></tr>
<tr class="memdesc:a5550d8bed0a0d47b57bcffde4c655330"><td class="mdescLeft">&#160;</td><td class="mdescRight">*this = beta * *this + alpha * diag(v) * M [or M^T].  <a href="#a5550d8bed0a0d47b57bcffde4c655330">More...</a><br /></td></tr>
<tr class="separator:a5550d8bed0a0d47b57bcffde4c655330"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab159ba96e9b7479896ef9ef2428995be"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ab159ba96e9b7479896ef9ef2428995be">AddMatDiagVec</a> (const Real alpha, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;M, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> transM, <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;v, Real beta=1.0)</td></tr>
<tr class="separator:ab159ba96e9b7479896ef9ef2428995be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08082e5de32e8746483bf146883e117e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a08082e5de32e8746483bf146883e117e">AddMatMatElements</a> (const Real alpha, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;A, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;B, const Real beta)</td></tr>
<tr class="memdesc:a08082e5de32e8746483bf146883e117e"><td class="mdescLeft">&#160;</td><td class="mdescRight">*this = beta * *this + alpha * A .* B (.* element by element multiplication)  <a href="#a08082e5de32e8746483bf146883e117e">More...</a><br /></td></tr>
<tr class="separator:a08082e5de32e8746483bf146883e117e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefb01cffa1d14588b5b45be320ddf399"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#aefb01cffa1d14588b5b45be320ddf399">AddMatSp</a> (const Real alpha, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;A, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> transA, const <a class="el" href="classkaldi_1_1CuSpMatrix.html">CuSpMatrix</a>&lt; Real &gt; &amp;B, const Real beta)</td></tr>
<tr class="memdesc:aefb01cffa1d14588b5b45be320ddf399"><td class="mdescLeft">&#160;</td><td class="mdescRight">this &lt;&ndash; beta*this + alpha*A*B  <a href="#aefb01cffa1d14588b5b45be320ddf399">More...</a><br /></td></tr>
<tr class="separator:aefb01cffa1d14588b5b45be320ddf399"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50adea14dc19dd2c438443e8d8394914"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a50adea14dc19dd2c438443e8d8394914">AddSpMat</a> (const Real alpha, const <a class="el" href="classkaldi_1_1CuSpMatrix.html">CuSpMatrix</a>&lt; Real &gt; &amp;A, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;B, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> transB, const Real beta)</td></tr>
<tr class="memdesc:a50adea14dc19dd2c438443e8d8394914"><td class="mdescLeft">&#160;</td><td class="mdescRight">this &lt;&ndash; beta*this + alpha*SpA*B  <a href="#a50adea14dc19dd2c438443e8d8394914">More...</a><br /></td></tr>
<tr class="separator:a50adea14dc19dd2c438443e8d8394914"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2df34bd49d0ef4203f72129f629509b4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a2df34bd49d0ef4203f72129f629509b4">AddTpMat</a> (const Real alpha, const <a class="el" href="classkaldi_1_1CuTpMatrix.html">CuTpMatrix</a>&lt; Real &gt; &amp;A, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> transA, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;B, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> transB, const Real beta)</td></tr>
<tr class="memdesc:a2df34bd49d0ef4203f72129f629509b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">this &lt;&ndash; beta*this + alpha*A*B.  <a href="#a2df34bd49d0ef4203f72129f629509b4">More...</a><br /></td></tr>
<tr class="separator:a2df34bd49d0ef4203f72129f629509b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe00ad6248cef735670f93a60b64e3d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#abe00ad6248cef735670f93a60b64e3d7">AddMatTp</a> (const Real alpha, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;A, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> transA, const <a class="el" href="classkaldi_1_1CuTpMatrix.html">CuTpMatrix</a>&lt; Real &gt; &amp;B, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> transB, const Real beta)</td></tr>
<tr class="memdesc:abe00ad6248cef735670f93a60b64e3d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">this &lt;&ndash; beta*this + alpha*A*B.  <a href="#abe00ad6248cef735670f93a60b64e3d7">More...</a><br /></td></tr>
<tr class="separator:abe00ad6248cef735670f93a60b64e3d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f7132192b26f99bd804c02bb99d3aa3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a4f7132192b26f99bd804c02bb99d3aa3">CopyFromBlock</a> (const <a class="el" href="classkaldi_1_1CuBlockMatrix.html">CuBlockMatrix</a>&lt; Real &gt; &amp;B, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> trans=<a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>)</td></tr>
<tr class="separator:a4f7132192b26f99bd804c02bb99d3aa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae71f2e6355f884d16edf9539e24adbb5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ae71f2e6355f884d16edf9539e24adbb5">CopyLowerToUpper</a> ()</td></tr>
<tr class="separator:ae71f2e6355f884d16edf9539e24adbb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dcb1f41ec37f0a92007a949f3a2044f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a0dcb1f41ec37f0a92007a949f3a2044f">CopyUpperToLower</a> ()</td></tr>
<tr class="separator:a0dcb1f41ec37f0a92007a949f3a2044f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7979d7cdf1210cad66fc7ec6861ea9d4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1CuSubMatrix.html">CuSubMatrix</a>&lt; Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a7979d7cdf1210cad66fc7ec6861ea9d4">Range</a> (const <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> row_offset, const <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> num_rows, const <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> col_offset, const <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> num_cols) const</td></tr>
<tr class="separator:a7979d7cdf1210cad66fc7ec6861ea9d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab997ee20e572278dabbfe92987fbed75"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1CuSubMatrix.html">CuSubMatrix</a>&lt; Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ab997ee20e572278dabbfe92987fbed75">RowRange</a> (const <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> row_offset, const <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> num_rows) const</td></tr>
<tr class="separator:ab997ee20e572278dabbfe92987fbed75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e9d059d3ae53886b856791e6c522665"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1CuSubMatrix.html">CuSubMatrix</a>&lt; Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a9e9d059d3ae53886b856791e6c522665">ColRange</a> (const <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> col_offset, const <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> num_cols) const</td></tr>
<tr class="separator:a9e9d059d3ae53886b856791e6c522665"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2063a15b24ba24887ffaa92f44e1d4bf"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classkaldi_1_1CuSubVector.html">CuSubVector</a>&lt; Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a2063a15b24ba24887ffaa92f44e1d4bf">Row</a> (<a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> i) const</td></tr>
<tr class="separator:a2063a15b24ba24887ffaa92f44e1d4bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8758c1ca7743191d82980dc361216654"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1CuSubVector.html">CuSubVector</a>&lt; Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a8758c1ca7743191d82980dc361216654">Row</a> (<a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> i)</td></tr>
<tr class="separator:a8758c1ca7743191d82980dc361216654"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a65339454ef3aaede4a426fa9848975"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1CuValue.html">CuValue</a>&lt; Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a7a65339454ef3aaede4a426fa9848975">operator()</a> (<a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> r, <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> c)</td></tr>
<tr class="separator:a7a65339454ef3aaede4a426fa9848975"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d7d41d94134d70668760ab75bf7d132"><td class="memItemLeft" align="right" valign="top">Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a9d7d41d94134d70668760ab75bf7d132">operator()</a> (<a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> r, <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> c) const</td></tr>
<tr class="separator:a9d7d41d94134d70668760ab75bf7d132"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7089fd656218302336300dc42ae55c1"><td class="memItemLeft" align="right" valign="top">Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ae7089fd656218302336300dc42ae55c1">Sum</a> () const</td></tr>
<tr class="separator:ae7089fd656218302336300dc42ae55c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6259d05a6903a4c8c9bd72f4bbc116c1"><td class="memItemLeft" align="right" valign="top">Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a6259d05a6903a4c8c9bd72f4bbc116c1">Max</a> () const</td></tr>
<tr class="separator:a6259d05a6903a4c8c9bd72f4bbc116c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71501acda04fb82ed3ec279ddda43e28"><td class="memItemLeft" align="right" valign="top">Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a71501acda04fb82ed3ec279ddda43e28">Min</a> () const</td></tr>
<tr class="separator:a71501acda04fb82ed3ec279ddda43e28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c7007b65327e6c20f96b576c3725881"><td class="memItemLeft" align="right" valign="top">Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a4c7007b65327e6c20f96b576c3725881">Trace</a> (<a class="el" href="classbool.html">bool</a> check_square=true) const</td></tr>
<tr class="memdesc:a4c7007b65327e6c20f96b576c3725881"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the trace. If check_square = true, will crash if matrix is not square.  <a href="#a4c7007b65327e6c20f96b576c3725881">More...</a><br /></td></tr>
<tr class="separator:a4c7007b65327e6c20f96b576c3725881"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40c5a82d6d015bdcc0079b535b1e9a23"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a40c5a82d6d015bdcc0079b535b1e9a23">SetRandn</a> ()</td></tr>
<tr class="separator:a40c5a82d6d015bdcc0079b535b1e9a23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b416db95082dda652bb230f89cdbfbf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a8b416db95082dda652bb230f89cdbfbf">SetRandUniform</a> ()</td></tr>
<tr class="separator:a8b416db95082dda652bb230f89cdbfbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68f354fd5f096134162f01719096e6fc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a68f354fd5f096134162f01719096e6fc">Write</a> (std::ostream &amp;os, <a class="el" href="classbool.html">bool</a> binary) const</td></tr>
<tr class="separator:a68f354fd5f096134162f01719096e6fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53a6a04e510c4a667bcddfc38cefa2d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a53a6a04e510c4a667bcddfc38cefa2d7">AddElements</a> (Real alpha, const std::vector&lt; <a class="el" href="structMatrixElement.html">MatrixElement</a>&lt; Real &gt; &gt; &amp;input)</td></tr>
<tr class="separator:a53a6a04e510c4a667bcddfc38cefa2d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a320bd9f43f247df80fcd2319f092f5c5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a320bd9f43f247df80fcd2319f092f5c5">AddElements</a> (Real alpha, const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; <a class="el" href="structInt32Pair.html">Int32Pair</a> &gt; &amp;indexes, const Real *input)</td></tr>
<tr class="separator:a320bd9f43f247df80fcd2319f092f5c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14d5fa17b88435baf999fd60195859bb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a14d5fa17b88435baf999fd60195859bb">Lookup</a> (const std::vector&lt; <a class="el" href="structInt32Pair.html">Int32Pair</a> &gt; &amp;indexes, Real *output) const</td></tr>
<tr class="separator:a14d5fa17b88435baf999fd60195859bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad35003f6f281f76d0590a4b040e99bb3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ad35003f6f281f76d0590a4b040e99bb3">Lookup</a> (const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; <a class="el" href="structInt32Pair.html">Int32Pair</a> &gt; &amp;indexes, Real *output) const</td></tr>
<tr class="separator:ad35003f6f281f76d0590a4b040e99bb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa99dbec163e4cde44071fa636654fa4a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#aa99dbec163e4cde44071fa636654fa4a">EqualElementMask</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;mat, <a class="el" href="classkaldi_1_1CuMatrix.html">CuMatrix</a>&lt; Real &gt; *mask) const</td></tr>
<tr class="separator:aa99dbec163e4cde44071fa636654fa4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca92364bdcb38c7e30f390340d072bf4"><td class="memItemLeft" align="right" valign="top">const Real *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#aca92364bdcb38c7e30f390340d072bf4">RowData</a> (<a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> r) const</td></tr>
<tr class="memdesc:aca92364bdcb38c7e30f390340d072bf4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get raw row pointer (const).  <a href="#aca92364bdcb38c7e30f390340d072bf4">More...</a><br /></td></tr>
<tr class="separator:aca92364bdcb38c7e30f390340d072bf4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98378a2a16c2d62cc61c89755e4cb78e"><td class="memItemLeft" align="right" valign="top">Real *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a98378a2a16c2d62cc61c89755e4cb78e">RowData</a> (<a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> r)</td></tr>
<tr class="memdesc:a98378a2a16c2d62cc61c89755e4cb78e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get raw row pointer.  <a href="#a98378a2a16c2d62cc61c89755e4cb78e">More...</a><br /></td></tr>
<tr class="separator:a98378a2a16c2d62cc61c89755e4cb78e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5a0f4f5fe999cc628776f18ef9138b3"><td class="memItemLeft" align="right" valign="top">const Real *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#aa5a0f4f5fe999cc628776f18ef9138b3">Data</a> () const</td></tr>
<tr class="memdesc:aa5a0f4f5fe999cc628776f18ef9138b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return data pointer (const).  <a href="#aa5a0f4f5fe999cc628776f18ef9138b3">More...</a><br /></td></tr>
<tr class="separator:aa5a0f4f5fe999cc628776f18ef9138b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abda573212fad06ec61fd3f428a0992c7"><td class="memItemLeft" align="right" valign="top">Real *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#abda573212fad06ec61fd3f428a0992c7">Data</a> ()</td></tr>
<tr class="memdesc:abda573212fad06ec61fd3f428a0992c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return data pointer.  <a href="#abda573212fad06ec61fd3f428a0992c7">More...</a><br /></td></tr>
<tr class="separator:abda573212fad06ec61fd3f428a0992c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ae27d8d38f2a7651c76b4f102867dee"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; Real &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a> () const</td></tr>
<tr class="separator:a1ae27d8d38f2a7651c76b4f102867dee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f8090e690bdcb5cddbaa3884506c6ae"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; Real &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a9f8090e690bdcb5cddbaa3884506c6ae">Mat</a> ()</td></tr>
<tr class="separator:a9f8090e690bdcb5cddbaa3884506c6ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a908f658b3675aa2a8f8440ccad2cd869"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a908f658b3675aa2a8f8440ccad2cd869">CuMatrixBase</a> ()</td></tr>
<tr class="separator:a908f658b3675aa2a8f8440ccad2cd869"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c40940cfbf456ea2796ff4211ae39a8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a2c40940cfbf456ea2796ff4211ae39a8">CuMatrixBase</a> (Real *data, <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> num_rows, <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> num_cols, <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> stride)</td></tr>
<tr class="memdesc:a2c40940cfbf456ea2796ff4211ae39a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">This constructor takes the #rows, #cols and stride; it's called from the constructor of <a class="el" href="classkaldi_1_1CuSubMatrix.html" title="This class is used for a piece of a CuMatrix. ">CuSubMatrix</a>.  <a href="#a2c40940cfbf456ea2796ff4211ae39a8">More...</a><br /></td></tr>
<tr class="separator:a2c40940cfbf456ea2796ff4211ae39a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ac2f903c4d28be2d76febeb70c49bbd0b"><td class="memItemLeft" align="right" valign="top">Real *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a></td></tr>
<tr class="memdesc:ac2f903c4d28be2d76febeb70c49bbd0b"><td class="mdescLeft">&#160;</td><td class="mdescRight">GPU data pointer (or regular matrix data pointer,.  <a href="#ac2f903c4d28be2d76febeb70c49bbd0b">More...</a><br /></td></tr>
<tr class="separator:ac2f903c4d28be2d76febeb70c49bbd0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a450082748d9b4882d1ce074d1af59a17"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a></td></tr>
<tr class="separator:a450082748d9b4882d1ce074d1af59a17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67d96c77dd3e450528faf1755002e42b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a></td></tr>
<tr class="separator:a67d96c77dd3e450528faf1755002e42b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cb3ee02262893923716e6764439f359"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">stride_</a></td></tr>
<tr class="separator:a7cb3ee02262893923716e6764439f359"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:af4bab2818ebf715b87fd30ebd13d0ba3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#af4bab2818ebf715b87fd30ebd13d0ba3">KALDI_DISALLOW_COPY_AND_ASSIGN</a> (<a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>)</td></tr>
<tr class="separator:af4bab2818ebf715b87fd30ebd13d0ba3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a1bf318054a935deec9c192109580dd58"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a1bf318054a935deec9c192109580dd58">CuMatrixBase&lt; float &gt;</a></td></tr>
<tr class="separator:a1bf318054a935deec9c192109580dd58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae917fa9b12583d4279496c32782ad8a6"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ae917fa9b12583d4279496c32782ad8a6">CuMatrixBase&lt; double &gt;</a></td></tr>
<tr class="separator:ae917fa9b12583d4279496c32782ad8a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2a7950adac175fe23c5e9212dc0897d"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ac2a7950adac175fe23c5e9212dc0897d">CuVectorBase&lt; float &gt;</a></td></tr>
<tr class="separator:ac2a7950adac175fe23c5e9212dc0897d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79628e1864f029ca5e7bff6f90c51ac2"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a79628e1864f029ca5e7bff6f90c51ac2">CuVectorBase&lt; double &gt;</a></td></tr>
<tr class="separator:a79628e1864f029ca5e7bff6f90c51ac2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81e2ad38d9196b98a379223e4383572d"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a81e2ad38d9196b98a379223e4383572d">VectorBase&lt; Real &gt;</a></td></tr>
<tr class="separator:a81e2ad38d9196b98a379223e4383572d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bacd18e4e259c776cc1bc2b6a94e21e"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a5bacd18e4e259c776cc1bc2b6a94e21e">CuSpMatrix&lt; Real &gt;</a></td></tr>
<tr class="separator:a5bacd18e4e259c776cc1bc2b6a94e21e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f44971f4ba5f51965bd7f7365571699"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a9f44971f4ba5f51965bd7f7365571699">CuTpMatrix&lt; float &gt;</a></td></tr>
<tr class="separator:a9f44971f4ba5f51965bd7f7365571699"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa090cca3755862c6cc08f338f49bb7d0"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#aa090cca3755862c6cc08f338f49bb7d0">CuTpMatrix&lt; double &gt;</a></td></tr>
<tr class="separator:aa090cca3755862c6cc08f338f49bb7d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abea3cd763f21985be450c62ad5877540"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#abea3cd763f21985be450c62ad5877540">CuVectorBase&lt; Real &gt;</a></td></tr>
<tr class="separator:abea3cd763f21985be450c62ad5877540"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac85bb7380dfaafef6fc9b91b508756e0"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ac85bb7380dfaafef6fc9b91b508756e0">CuSubMatrix&lt; Real &gt;</a></td></tr>
<tr class="separator:ac85bb7380dfaafef6fc9b91b508756e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf5339e82134d0ac259966e0f0f67ab9"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#acf5339e82134d0ac259966e0f0f67ab9">CuRand&lt; Real &gt;</a></td></tr>
<tr class="separator:acf5339e82134d0ac259966e0f0f67ab9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ccc176ff1e8f53ca4ff702f2c6e8064"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a4ccc176ff1e8f53ca4ff702f2c6e8064">CuSubVector&lt; Real &gt;</a></td></tr>
<tr class="separator:a4ccc176ff1e8f53ca4ff702f2c6e8064"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55ada0f1e6790e16880aa0058c5b0145"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a55ada0f1e6790e16880aa0058c5b0145">CuBlockMatrix&lt; Real &gt;</a></td></tr>
<tr class="separator:a55ada0f1e6790e16880aa0058c5b0145"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab554e7a1d4f5edfc8a0132ed5dbe7903"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#ab554e7a1d4f5edfc8a0132ed5dbe7903">CuSparseMatrix&lt; float &gt;</a></td></tr>
<tr class="separator:ab554e7a1d4f5edfc8a0132ed5dbe7903"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3a3bfb0bbb0a225871e391ee3ec8ac3"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#aa3a3bfb0bbb0a225871e391ee3ec8ac3">CuSparseMatrix&lt; double &gt;</a></td></tr>
<tr class="separator:aa3a3bfb0bbb0a225871e391ee3ec8ac3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafe563db9faef3e8ee4d7a830e8b32b4"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#aafe563db9faef3e8ee4d7a830e8b32b4">CuSparseMatrix&lt; Real &gt;</a></td></tr>
<tr class="separator:aafe563db9faef3e8ee4d7a830e8b32b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66bed104430bbbde5005c244cf0387f7"><td class="memItemLeft" align="right" valign="top">Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a66bed104430bbbde5005c244cf0387f7">TraceMatMat</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;A, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;B, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> trans)</td></tr>
<tr class="separator:a66bed104430bbbde5005c244cf0387f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cb54da2ae21c43f23b18486b608e73e"><td class="memItemLeft" align="right" valign="top">Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#a0cb54da2ae21c43f23b18486b608e73e">TraceMatSmat</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;A, const <a class="el" href="classkaldi_1_1CuSparseMatrix.html">CuSparseMatrix</a>&lt; Real &gt; &amp;B, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> trans)</td></tr>
<tr class="separator:a0cb54da2ae21c43f23b18486b608e73e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa02376f1de9d497e87b756fe5af8a315"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1CuMatrixBase.html#aa02376f1de9d497e87b756fe5af8a315">AddMatMatBatched</a> (const Real alpha, std::vector&lt; <a class="el" href="classkaldi_1_1CuSubMatrix.html">CuSubMatrix</a>&lt; Real &gt; * &gt; &amp;C, const std::vector&lt; <a class="el" href="classkaldi_1_1CuSubMatrix.html">CuSubMatrix</a>&lt; Real &gt; * &gt; &amp;A, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> transA, const std::vector&lt; <a class="el" href="classkaldi_1_1CuSubMatrix.html">CuSubMatrix</a>&lt; Real &gt; * &gt; &amp;B, <a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a> transB, const Real beta)</td></tr>
<tr class="memdesc:aa02376f1de9d497e87b756fe5af8a315"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does multiple matrix multiplications, executing them in parallel using cuBLAS's gemmBatched if we are using a GPU.  <a href="#aa02376f1de9d497e87b756fe5af8a315">More...</a><br /></td></tr>
<tr class="separator:aa02376f1de9d497e87b756fe5af8a315"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename Real&gt;<br />
class kaldi::CuMatrixBase&lt; Real &gt;</h3>

<p><a class="el" href="classkaldi_1_1Matrix.html" title="A class for storing matrices. ">Matrix</a> for CUDA computing. </p>
<p>Does the computation on the CUDA card when CUDA is compiled in and we have a suitable GPU (CuDevice::Instantiate().Enabled() == true); otherwise, does it on the CPU. </p>

<p class="definition">Definition at line <a class="el" href="matrix-common_8h_source.html#l00069">69</a> of file <a class="el" href="matrix-common_8h_source.html">matrix-common.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a908f658b3675aa2a8f8440ccad2cd869"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a908f658b3675aa2a8f8440ccad2cd869">&#9670;&nbsp;</a></span>CuMatrixBase() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00710">710</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;: <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>(NULL), <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>(0), <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>(0), <a class="code" href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">stride_</a>(0) { }</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a7cb3ee02262893923716e6764439f359"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">kaldi::CuMatrixBase::stride_</a></div><div class="ttdeci">MatrixIndexT stride_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00730">cu-matrix.h:730</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2c40940cfbf456ea2796ff4211ae39a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c40940cfbf456ea2796ff4211ae39a8">&#9670;&nbsp;</a></span>CuMatrixBase() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a> </td>
          <td>(</td>
          <td class="paramtype">Real *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a>&#160;</td>
          <td class="paramname"><em>num_rows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a>&#160;</td>
          <td class="paramname"><em>num_cols</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a>&#160;</td>
          <td class="paramname"><em>stride</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This constructor takes the #rows, #cols and stride; it's called from the constructor of <a class="el" href="classkaldi_1_1CuSubMatrix.html" title="This class is used for a piece of a CuMatrix. ">CuSubMatrix</a>. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00714">714</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                                   :</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>(data), <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>(num_cols), <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>(num_rows), <a class="code" href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">stride_</a>(stride) { }</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a7cb3ee02262893923716e6764439f359"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">kaldi::CuMatrixBase::stride_</a></div><div class="ttdeci">MatrixIndexT stride_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00730">cu-matrix.h:730</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a92b8db063dbc1ca69795d167c5f31a4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92b8db063dbc1ca69795d167c5f31a4d">&#9670;&nbsp;</a></span>Add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Add </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00548">548</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-general-component_8cc_source.html#l01098">BackpropTruncationComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00664">TanhComponent::Backprop()</a>, <a class="el" href="cu-compressed-matrix-test_8cc_source.html#l00054">kaldi::CuCompressedMatrixTestNonnegative()</a>, <a class="el" href="cu-compressed-matrix-test_8cc_source.html#l00107">kaldi::CuCompressedMatrixTestSymmetric()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l01682">GeneralDropoutComponent::GetMemo()</a>, <a class="el" href="nnet-forward_8cc_source.html#l00030">main()</a>, <a class="el" href="cu-rand-speed-test_8cc_source.html#l00049">kaldi::MeanVariance()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l01412">DropoutMaskComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03531">DropoutComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00738">ClipGradientComponent::RepairGradients()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00941">TanhComponent::StoreStats()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00308">kaldi::TestCuMatrixCompObjfAndDeriv()</a>, <a class="el" href="_2nnet-component-test_8cc_source.html#l00210">kaldi::nnet3::TestSimpleComponentPropagateProperties()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00258">kaldi::UnitTestCuMatrixAdd()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01804">kaldi::UnitTestCuMatrixAdd2()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02905">kaldi::UnitTestCuMatrixEqualElementMask()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02774">kaldi::UnitTestCuMatrixObjfDeriv()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02670">kaldi::UnitTestCuMatrixSetRandUniform()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l00076">kaldi::UnitTestCuMatrixTraceMatMat()</a>.</p>
<div class="fragment"><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                                       {</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    CuTimer tim;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    cuda_add(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, value, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="preprocessor">  #endif</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  {</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().Add(value);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  }</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3a2daa4c7bed9fadb6d14d277955fa45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a2daa4c7bed9fadb6d14d277955fa45">&#9670;&nbsp;</a></span>AddCols()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddCols </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>indices</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add column indices[r] of src to column r. </p>
<p>As a special case, if indexes[i] == -1, skip column i indices.size() must equal this-&gt;<a class="el" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols()</a>, and src.NumRows() must equal this.NumRows() </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02668">2668</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="_2nnet-component_8cc_source.html#l03966">Convolutional1dComponent::Backprop()</a>, <a class="el" href="nnet-convolutional-component_8h_source.html#l00368">ConvolutionalComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l04299">ConvolutionComponent::InderivPatchesToInderiv()</a>, and <a class="el" href="nnet-simple-component_8cc_source.html#l04739">MaxpoolingComponent::InderivPatchesToInderiv()</a>.</p>
<div class="fragment"><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;                                                                           {</div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(indices.Dim() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>());</div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == src.NumRows());</div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;    cuda_add_cols(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, src.Data(), indices.Data(),</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;                  <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), src.Stride());</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;  {</div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().AddCols(src.Mat(), indices.Data());</div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;  }</div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5550d8bed0a0d47b57bcffde4c655330"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5550d8bed0a0d47b57bcffde4c655330">&#9670;&nbsp;</a></span>AddDiagVecMat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddDiagVecMat </td>
          <td>(</td>
          <td class="paramtype">const Real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>transM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>beta</em> = <code>1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>*this = beta * *this + alpha * diag(v) * M [or M^T]. </p>
<p>The same as adding M but scaling each row M_i by v(i). </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01369">1369</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="attention_8cc_source.html#l00076">kaldi::nnet3::attention::ApplyScalesToInput()</a>, <a class="el" href="attention_8cc_source.html#l00055">kaldi::nnet3::attention::ApplyScalesToOutput()</a>, <a class="el" href="nnet-activation_8h_source.html#l00087">HiddenSoftmax::BackpropagateFnc()</a>, <a class="el" href="nnet-multibasis-component_8h_source.html#l00338">MultiBasisComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-precondition-online_8cc_source.html#l00501">OnlinePreconditioner::ComputeWt1()</a>, <a class="el" href="natural-gradient-online_8cc_source.html#l00482">OnlineNaturalGradient::ComputeWt1()</a>, <a class="el" href="cu-math_8cc_source.html#l00349">kaldi::cu::DiffNormalizePerRow()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01852">CuMatrixBase&lt; float &gt;::DiffSoftmaxPerRow()</a>, <a class="el" href="nnet-multibasis-component_8h_source.html#l00298">MultiBasisComponent::PropagateFnc()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, and <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00265">kaldi::TestCuMatrixAddDiagVecMat()</a>.</p>
<div class="fragment"><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;               {</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    <span class="keywordflow">if</span> (transM == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>) {</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">SameDim</a>(*<span class="keyword">this</span>, M));</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(M.NumRows() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>() &amp;&amp; M.NumCols() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>());</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    }</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(v.Dim() == this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>());</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    CuTimer tim;</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    dim3 dimBlock(<a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>);</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    dim3 dimGrid(n_blocks(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>),</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                 n_blocks(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>));</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> M_row_stride = M.Stride(), M_col_stride = 1;</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    <span class="keywordflow">if</span> (transM == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>)</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;      <a class="code" href="namespacekaldi.html#aa3e99328db564bc2bf6397fa1eaee4d7">std::swap</a>(M_row_stride, M_col_stride);</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    cuda_add_diag_vec_mat(dimGrid, dimBlock, alpha, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(),</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                          v.Data(), M.Data(), M_row_stride, M_col_stride, beta);</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;  {</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().AddDiagVecMat(alpha, v.Vec(), M.Mat(), transM, beta);</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;  }</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa3e99328db564bc2bf6397fa1eaee4d7"><div class="ttname"><a href="namespacekaldi.html#aa3e99328db564bc2bf6397fa1eaee4d7">kaldi::swap</a></div><div class="ttdeci">void swap(basic_filebuf&lt; CharT, Traits &gt; &amp;x, basic_filebuf&lt; CharT, Traits &gt; &amp;y)</div><div class="ttdef"><b>Definition:</b> <a href="basic-filebuf_8h_source.html#l00275">basic-filebuf.h:275</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00033">matrix-common.h:33</a></div></div>
<div class="ttc" id="group__matrix__funcs__io_html_ga07b147212efb08775c252cd4cc7453fe"><div class="ttname"><a href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">kaldi::SameDim</a></div><div class="ttdeci">bool SameDim(const MatrixBase&lt; Real &gt; &amp;M, const MatrixBase&lt; Real &gt; &amp;N)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l01065">kaldi-matrix.h:1065</a></div></div>
<div class="ttc" id="namespacekaldi_html_aac2c220416519a2b0a7ad822ee2ef972"><div class="ttname"><a href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">kaldi::MatrixIndexT</a></div><div class="ttdeci">int32 MatrixIndexT</div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00098">matrix-common.h:98</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00034">matrix-common.h:34</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a84acd86e193bca04fb719c476fbcbe5b"><div class="ttname"><a href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a></div><div class="ttdeci">#define CU2DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00067">cu-matrixdim.h:67</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a53a6a04e510c4a667bcddfc38cefa2d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53a6a04e510c4a667bcddfc38cefa2d7">&#9670;&nbsp;</a></span>AddElements() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddElements </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structMatrixElement.html">MatrixElement</a>&lt; Real &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>input</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l03244">3244</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-precondition-online_8cc_source.html#l00045">OnlinePreconditioner::InitOrthonormalSpecial()</a>, <a class="el" href="natural-gradient-online_8cc_source.html#l00046">OnlineNaturalGradient::InitOrthonormalSpecial()</a>, <a class="el" href="cu-matrix_8h_source.html#l00633">CuMatrixBase&lt; float &gt;::operator()()</a>, <a class="el" href="discriminative-training_8cc_source.html#l00326">DiscriminativeComputation::ProcessPosteriors()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l02815">kaldi::UnitTestCuMatrixAddElements()</a>.</p>
<div class="fragment"><div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;                                                                                   {</div><div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;  <span class="comment">// Checks the dimension.</span></div><div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;  <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> num_rows = this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, num_cols = this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>;</div><div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;  <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; input.size(); ++<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(input[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].row &lt; num_rows &amp;&amp; input[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].row &gt;= 0 &amp;&amp;</div><div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;                 input[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].column &lt; num_cols &amp;&amp; input[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].column &gt;= 0);</div><div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;  }</div><div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;    <span class="keywordtype">void</span> *addr = CuDevice::Instantiate().Malloc(input.size() * <span class="keyword">sizeof</span>(<a class="code" href="structMatrixElement.html">MatrixElement&lt;Real&gt;</a>));</div><div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;    CU_SAFE_CALL(cudaMemcpy(addr, input.data(),</div><div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;                        input.size() * <span class="keyword">sizeof</span>(<a class="code" href="structMatrixElement.html">MatrixElement&lt;Real&gt;</a>),</div><div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;                            cudaMemcpyHostToDevice));</div><div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;</div><div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;    CuTimer tim;</div><div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;    <span class="keywordtype">int</span> dimBlock(<a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a>);</div><div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;    <span class="keywordtype">int</span> dimGrid(n_blocks(input.size(), <a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a>));</div><div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;</div><div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;    cuda_matrix_add_elements(dimGrid, dimBlock, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(),</div><div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;                             alpha, (<a class="code" href="structMatrixElement.html">MatrixElement&lt;Real&gt;</a>*)addr, input.size());</div><div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;    CuDevice::Instantiate().Free(addr);</div><div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;  {</div><div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;    <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; input.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;      (*this)(input[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].row, input[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].column) += alpha * input[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].weight;</div><div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;    }</div><div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;  }</div><div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;}</div><div class="ttc" id="structMatrixElement_html"><div class="ttname"><a href="structMatrixElement.html">MatrixElement</a></div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00041">cu-matrixdim.h:41</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="namespacekaldi_html_aac2c220416519a2b0a7ad822ee2ef972"><div class="ttname"><a href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">kaldi::MatrixIndexT</a></div><div class="ttdeci">int32 MatrixIndexT</div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00098">matrix-common.h:98</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a6dbdf9d0385c92d6d915b96eaf9ce99e"><div class="ttname"><a href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a></div><div class="ttdeci">#define CU1DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00063">cu-matrixdim.h:63</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a320bd9f43f247df80fcd2319f092f5c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a320bd9f43f247df80fcd2319f092f5c5">&#9670;&nbsp;</a></span>AddElements() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddElements </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; <a class="el" href="structInt32Pair.html">Int32Pair</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>indexes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Real *&#160;</td>
          <td class="paramname"><em>input</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l03278">3278</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;                                                        {</div><div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;  <span class="keywordflow">if</span> (indexes.<a class="code" href="classkaldi_1_1CuArrayBase.html#af3d58f15749a15d89b0ec5819dd7b7f2">Dim</a>() == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(input != NULL);</div><div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;</div><div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;    CuTimer tim;</div><div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;    CuVector&lt;Real&gt; tmp_vec(indexes.<a class="code" href="classkaldi_1_1CuArrayBase.html#af3d58f15749a15d89b0ec5819dd7b7f2">Dim</a>(), <a class="code" href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kUndefined</a>);</div><div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;    CU_SAFE_CALL(cudaMemcpy(tmp_vec.Data(), input, indexes.<a class="code" href="classkaldi_1_1CuArrayBase.html#af3d58f15749a15d89b0ec5819dd7b7f2">Dim</a>() * <span class="keyword">sizeof</span>(Real),</div><div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;                            cudaMemcpyHostToDevice));</div><div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;</div><div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;    <span class="keywordtype">int</span> dimBlock(<a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a>);</div><div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;    <span class="keywordtype">int</span> dimGrid = n_blocks(indexes.<a class="code" href="classkaldi_1_1CuArrayBase.html#af3d58f15749a15d89b0ec5819dd7b7f2">Dim</a>(), <a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a>);</div><div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;    cuda_matrix_add_indexed_values(dimGrid, dimBlock, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), alpha,</div><div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;                                   indexes.<a class="code" href="classkaldi_1_1CuArrayBase.html#a368b2398825ede0c99248a432c6fdc7b">Data</a>(), tmp_vec.Data(), indexes.<a class="code" href="classkaldi_1_1CuArrayBase.html#af3d58f15749a15d89b0ec5819dd7b7f2">Dim</a>(), this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>);</div><div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;  {</div><div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;    <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> num_rows = this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, num_cols = this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>;</div><div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;    <span class="keyword">const</span> <a class="code" href="structInt32Pair.html">Int32Pair</a> *index = indexes.<a class="code" href="classkaldi_1_1CuArrayBase.html#a368b2398825ede0c99248a432c6fdc7b">Data</a>();</div><div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;    <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; indexes.<a class="code" href="classkaldi_1_1CuArrayBase.html#af3d58f15749a15d89b0ec5819dd7b7f2">Dim</a>(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(index[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].first &lt; num_rows &amp;&amp; index[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].first &gt;= 0 &amp;&amp;</div><div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;                   index[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].second &lt; num_cols &amp;&amp; index[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].second &gt;= 0);</div><div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;      (*this)(index[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="structInt32Pair.html#a9b288b26b67b6a87162a9e1ab5b35dbf">first</a>, index[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="structInt32Pair.html#a03a67f151bb1afcfcafab8870b75acff">second</a>) += alpha * input[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;    }</div><div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;  }</div><div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;}</div><div class="ttc" id="namespacekaldi_html_ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126"><div class="ttname"><a href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kaldi::kUndefined</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00039">matrix-common.h:39</a></div></div>
<div class="ttc" id="classkaldi_1_1CuArrayBase_html_a368b2398825ede0c99248a432c6fdc7b"><div class="ttname"><a href="classkaldi_1_1CuArrayBase.html#a368b2398825ede0c99248a432c6fdc7b">kaldi::CuArrayBase::Data</a></div><div class="ttdeci">const T * Data() const</div><div class="ttdoc">Get raw pointer. </div><div class="ttdef"><b>Definition:</b> <a href="cu-array_8h_source.html#l00052">cu-array.h:52</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="namespacekaldi_html_aac2c220416519a2b0a7ad822ee2ef972"><div class="ttname"><a href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">kaldi::MatrixIndexT</a></div><div class="ttdeci">int32 MatrixIndexT</div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00098">matrix-common.h:98</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a6dbdf9d0385c92d6d915b96eaf9ce99e"><div class="ttname"><a href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a></div><div class="ttdeci">#define CU1DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00063">cu-matrixdim.h:63</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="structInt32Pair_html"><div class="ttname"><a href="structInt32Pair.html">Int32Pair</a></div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00084">cu-matrixdim.h:84</a></div></div>
<div class="ttc" id="structInt32Pair_html_a03a67f151bb1afcfcafab8870b75acff"><div class="ttname"><a href="structInt32Pair.html#a03a67f151bb1afcfcafab8870b75acff">Int32Pair::second</a></div><div class="ttdeci">int32_cuda second</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00086">cu-matrixdim.h:86</a></div></div>
<div class="ttc" id="classkaldi_1_1CuArrayBase_html_af3d58f15749a15d89b0ec5819dd7b7f2"><div class="ttname"><a href="classkaldi_1_1CuArrayBase.html#af3d58f15749a15d89b0ec5819dd7b7f2">kaldi::CuArrayBase::Dim</a></div><div class="ttdeci">MatrixIndexT Dim() const</div><div class="ttdoc">Return the vector dimension. </div><div class="ttdef"><b>Definition:</b> <a href="cu-array_8h_source.html#l00049">cu-array.h:49</a></div></div>
<div class="ttc" id="structInt32Pair_html_a9b288b26b67b6a87162a9e1ab5b35dbf"><div class="ttname"><a href="structInt32Pair.html#a9b288b26b67b6a87162a9e1ab5b35dbf">Int32Pair::first</a></div><div class="ttdeci">int32_cuda first</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00085">cu-matrixdim.h:85</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4bce9eaec860cf9d9a8aee7e440b976b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bce9eaec860cf9d9a8aee7e440b976b">&#9670;&nbsp;</a></span>AddMat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddMat </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>trans</em> = <code><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>*this += alpha * A </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00941">941</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8cc_source.html#l00261">RestrictedAttentionComponent::Add()</a>, <a class="el" href="cu-rand_8cc_source.html#l00204">CuRand&lt; float &gt;::AddGaussNoise()</a>, <a class="el" href="cu-sparse-matrix_8cc_source.html#l00679">GeneralMatrix::AddToMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02120">CuMatrixBase&lt; float &gt;::ApproxEqual()</a>, <a class="el" href="attention_8cc_source.html#l00154">kaldi::nnet3::attention::AttentionBackward()</a>, <a class="el" href="attention_8cc_source.html#l00097">kaldi::nnet3::attention::AttentionForward()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00622">SigmoidComponent::Backprop()</a>, <a class="el" href="nnet-various_8h_source.html#l00111">Splice::BackpropagateFnc()</a>, <a class="el" href="nnet-average-pooling-component_8h_source.html#l00122">AveragePoolingComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-average-pooling-2d-component_8h_source.html#l00151">AveragePooling2DComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-convolutional-2d-component_8h_source.html#l00324">Convolutional2DComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-multibasis-component_8h_source.html#l00338">MultiBasisComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00896">kaldi::nnet3::ConstrainOrthonormalInternal()</a>, <a class="el" href="cu-compressed-matrix-test_8cc_source.html#l00054">kaldi::CuCompressedMatrixTestNonnegative()</a>, <a class="el" href="cu-compressed-matrix-test_8cc_source.html#l00107">kaldi::CuCompressedMatrixTestSymmetric()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01887">CuMatrixBase&lt; float &gt;::DiffLogSoftmaxPerRow()</a>, <a class="el" href="nnet-loss_8cc_source.html#l00062">Xent::Eval()</a>, <a class="el" href="nnet-loss_8cc_source.html#l00228">Mse::Eval()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00210">NnetComputer::ExecuteCommand()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03619">AdditiveNoiseComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00738">ClipGradientComponent::RepairGradients()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00200">RestrictedAttentionComponent::StoreStats()</a>, <a class="el" href="attention-test_8cc_source.html#l00120">kaldi::nnet3::attention::TestAttentionForwardBackward()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01368">kaldi::UnitTestCuMatrixAddMat()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01426">kaldi::UnitTestCuMatrixAddMatBlocks1()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01453">kaldi::UnitTestCuMatrixAddMatBlocks1Trans()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01483">kaldi::UnitTestCuMatrixAddMatBlocks2()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01274">kaldi::UnitTestCuMatrixAddMatDiagVec()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01302">kaldi::UnitTestCuMatrixAddMatMatElements()</a>, <a class="el" href="cu-math-test_8cc_source.html#l00213">kaldi::UnitTestLstmNonlinearity()</a>, and <a class="el" href="nnet-derivative-test_8cc_source.html#l00246">kaldi::nnet3::UnitTestNnetInputDerivatives()</a>.</p>
<div class="fragment"><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                                                            {</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="keywordflow">if</span> (transA == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>) {</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(A.NumRows() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> &amp;&amp; A.NumCols() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>);</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(A.NumCols() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> &amp;&amp; A.NumRows() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>);</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    }</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    CuTimer tim;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="comment">// This block dimension seems to work better than the</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="comment">// one from GetBlockSizesForSimpleMatrixOperation().</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    dim3 dimBlock(<a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>);</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    dim3 dimGrid(n_blocks(<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(), <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>),</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                 n_blocks(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>));</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    cuda_add_mat(dimGrid, dimBlock, alpha, A.data_,</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                 <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), A.Stride(),</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                 (transA == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a> ? 1 : 0));</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  {</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().AddMat(alpha, A.Mat(), transA);</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  }</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00033">matrix-common.h:33</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00034">matrix-common.h:34</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a84acd86e193bca04fb719c476fbcbe5b"><div class="ttname"><a href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a></div><div class="ttdeci">#define CU2DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00067">cu-matrixdim.h:67</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5f033384afda592570cca2cb5310fc55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f033384afda592570cca2cb5310fc55">&#9670;&nbsp;</a></span>AddMatBlock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddMatBlock </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>transA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuBlockMatrix.html">CuBlockMatrix</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>transB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is like AddMatMat but for where the second argument is of type <a class="el" href="classkaldi_1_1CuBlockMatrix.html" title="The class CuBlockMatrix holds a vector of objects of type CuMatrix, say, M_1, M_2, . ">CuBlockMatrix</a> (a block-diagonal matrix of blocks). </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l03172">3172</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, and <a class="el" href="cu-block-matrix-test_8cc_source.html#l00076">kaldi::UnitTestCuBlockMatrixAddMatBlock()</a>.</p>
<div class="fragment"><div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;               {</div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;  <span class="comment">// Check dimensions</span></div><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;  int32 A_num_rows = A.NumRows(), A_num_cols = A.NumCols(),</div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;      A_row_stride = A.Stride(), A_col_stride = 1,</div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;      B_num_rows = B.NumRows(), B_num_cols = B.NumCols();</div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;  <span class="keywordflow">if</span> (transA == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>) {</div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;    <a class="code" href="namespacekaldi.html#aa3e99328db564bc2bf6397fa1eaee4d7">std::swap</a>(A_num_rows, A_num_cols);</div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;    <a class="code" href="namespacekaldi.html#aa3e99328db564bc2bf6397fa1eaee4d7">std::swap</a>(A_row_stride, A_col_stride);</div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;  }</div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;  <span class="keywordflow">if</span> (transB == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>) {</div><div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;    <a class="code" href="namespacekaldi.html#aa3e99328db564bc2bf6397fa1eaee4d7">std::swap</a>(B_num_rows, B_num_cols);</div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;  }</div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;  <span class="comment">// At this point the {A,B}_{rows,cols} variables are</span></div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;  <span class="comment">// after any transposition.</span></div><div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == A_num_rows &amp;&amp; <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>() == B_num_cols);</div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(A_num_cols == B_num_rows);</div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;  int32 B_num_blocks = B.NumBlocks();</div><div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;</div><div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;    CuTimer tim;</div><div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;    <a class="code" href="structMatrixDim__.html">MatrixDim</a> this_dim = <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>();</div><div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;</div><div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;    dim3 dimBlock(<a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>);</div><div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;    <span class="comment">// (x,y) indices will be (row of *this, block of B)</span></div><div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;    dim3 dimGrid(n_blocks(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>),</div><div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;                 n_blocks(B_num_blocks, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>));</div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;</div><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;    <span class="comment">// caution: the use of x as the row-index is not good, but</span></div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;    <span class="comment">// this code is not much used, so I&#39;m not updating it.a</span></div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;    cuda_add_mat_blockmat(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, this_dim, A.Data(),</div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;                          A_num_rows, A_num_cols, A_row_stride, A_col_stride,</div><div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;                          B.CuData(), B_num_blocks, alpha, beta,</div><div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;                          (transB == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a> ? 1 : 0));</div><div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;</div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;</div><div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;  {</div><div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;    <span class="comment">// &quot;row_offset&quot; and &quot;col_offset&quot; are offsets into B (or into B^T, if</span></div><div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;    <span class="comment">// transB == kTrans).</span></div><div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;    int32 row_offset = 0, col_offset = 0;</div><div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;    <span class="keywordflow">for</span> (int32 b = 0; b &lt; B_num_blocks; b++) {</div><div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;      <span class="keyword">const</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac85bb7380dfaafef6fc9b91b508756e0">CuSubMatrix&lt;Real&gt;</a> this_block = B.Block(b);</div><div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;      int32 this_num_rows = this_block.NumRows(),</div><div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;          this_num_cols = this_block.NumCols();</div><div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;      <span class="keywordflow">if</span> (transB == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>) <a class="code" href="namespacekaldi.html#aa3e99328db564bc2bf6397fa1eaee4d7">std::swap</a>(this_num_rows, this_num_cols);</div><div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;      <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac85bb7380dfaafef6fc9b91b508756e0">CuSubMatrix&lt;Real&gt;</a> this_part(*<span class="keyword">this</span>, 0, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>,</div><div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;                                  col_offset, this_num_cols);</div><div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;      <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac85bb7380dfaafef6fc9b91b508756e0">CuSubMatrix&lt;Real&gt;</a> A_part = (transA == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a> ?</div><div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;                                  <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac85bb7380dfaafef6fc9b91b508756e0">CuSubMatrix&lt;Real&gt;</a>(A, 0, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>,</div><div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;                                                    row_offset, this_num_rows) :</div><div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;                                  <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac85bb7380dfaafef6fc9b91b508756e0">CuSubMatrix&lt;Real&gt;</a>(A, row_offset, this_num_rows,</div><div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;                                                    0, num_rows_));</div><div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;      this_part.AddMatMat(alpha, A_part, transA, this_block, transB, beta);</div><div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;      row_offset += this_num_rows;</div><div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;      col_offset += this_num_cols;</div><div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;    }</div><div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;    <span class="comment">// Note: the values being compared below are all after applying any</span></div><div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;    <span class="comment">// transposition to B.</span></div><div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(row_offset == B_num_rows &amp;&amp; col_offset == B_num_cols);</div><div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;  }</div><div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;}</div><div class="ttc" id="structMatrixDim___html"><div class="ttname"><a href="structMatrixDim__.html">MatrixDim_</a></div><div class="ttdoc">Structure containing size of the matrix plus stride. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00052">cu-matrixdim.h:52</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa3e99328db564bc2bf6397fa1eaee4d7"><div class="ttname"><a href="namespacekaldi.html#aa3e99328db564bc2bf6397fa1eaee4d7">kaldi::swap</a></div><div class="ttdeci">void swap(basic_filebuf&lt; CharT, Traits &gt; &amp;x, basic_filebuf&lt; CharT, Traits &gt; &amp;y)</div><div class="ttdef"><b>Definition:</b> <a href="basic-filebuf_8h_source.html#l00275">basic-filebuf.h:275</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00033">matrix-common.h:33</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac85bb7380dfaafef6fc9b91b508756e0"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac85bb7380dfaafef6fc9b91b508756e0">kaldi::CuMatrixBase::CuSubMatrix&lt; Real &gt;</a></div><div class="ttdeci">friend class CuSubMatrix&lt; Real &gt;</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00089">cu-matrix.h:89</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00034">matrix-common.h:34</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a84acd86e193bca04fb719c476fbcbe5b"><div class="ttname"><a href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a></div><div class="ttdeci">#define CU2DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00067">cu-matrixdim.h:67</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5195b469c721f95359411d2c6ff503aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5195b469c721f95359411d2c6ff503aa">&#9670;&nbsp;</a></span>AddMatBlocks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddMatBlocks </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>trans</em> = <code><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is like AddMat (it does *this += alpha * src), except that it supports cases where *this and src have different dimension. </p>
<p>There are two allowed cases:</p>
<p>(1) *this is larger than src; we do a broadcasting operation. *this must have <a class="el" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1" title="Dimensions. ">NumRows()</a> == a * src.NumRows() and <a class="el" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols()</a> == b * src.NumCols() for integer a &gt;= 1, b &gt;= 1. *this will be treated as a being made up of of blocks with the same size as src, and to each block we'll add alpha * src. This case does not support trans == kTrans.</p>
<p>(2) *this is smaller than src; we sum. src.NumRows() must == a * this-&gt;<a class="el" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1" title="Dimensions. ">NumRows()</a>, and src.NumCols() must == b * this-&gt;<a class="el" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols()</a>, for a &gt;= 1, b &gt;= 1. In this case, src will be treated as being made up of blocks with the same size as *this, and to *this we will add the summation of all of those blocks. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01106">1106</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-simple-component_8cc_source.html#l05977">SumBlockComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l05967">SumBlockComponent::Propagate()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01426">kaldi::UnitTestCuMatrixAddMatBlocks1()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01453">kaldi::UnitTestCuMatrixAddMatBlocks1Trans()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01483">kaldi::UnitTestCuMatrixAddMatBlocks2()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l04162">Convolutional1dComponent::Update()</a>, and <a class="el" href="nnet-simple-component_8cc_source.html#l04422">ConvolutionComponent::Update()</a>.</p>
<div class="fragment"><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                                                                  {</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == 0 || <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a> == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  <span class="keywordflow">if</span> (A.NumRows() &gt;= (transA == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a> ? <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> : <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>) &amp;&amp;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      A.NumCols() &gt;= (transA == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a> ? <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a> : <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>)) {</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="comment">// This is the &quot;summing&quot;, not broadcasting, version of AddMatBlocks.</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="comment">// It supports both regular and transposed operation.</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    int32 num_row_blocks, num_col_blocks;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="keywordflow">if</span> (transA == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>) {</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(A.NumRows() % <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == 0 &amp;&amp; A.NumCols() % <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a> == 0);</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      num_row_blocks = A.Mat().NumRows() / <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      num_col_blocks = A.Mat().NumCols() / <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(A.NumRows() % <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a> == 0 &amp;&amp; A.NumCols() % <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == 0);</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;      num_row_blocks = A.Mat().NumRows() / <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>;</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      num_col_blocks = A.Mat().NumCols() / <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    }</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;      CuTimer tim;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      dim3 dimGrid, dimBlock;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                                            &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;      cuda_add_mat_blocks(dimGrid, dimBlock, alpha, A.data_, num_row_blocks,</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                          num_col_blocks, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), A.Stride(),</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                          (transA == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a> ? 1 : 0));</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;      CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;      CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    } <span class="keywordflow">else</span></div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    {</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;      int32 nr, nc;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;      <span class="keywordflow">if</span> (transA == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>) {</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        nr = <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        nc = <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        nr = <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>;</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        nc = <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>;</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      }</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; num_row_blocks; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; num_col_blocks; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;          <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().AddMat(alpha, SubMatrix&lt;Real&gt;(A.Mat(), <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> * nr, nr, <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> * nc, nc),</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                       transA);</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;        }</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      }</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    }</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <span class="comment">// This is the &quot;broadcasting&quot; version of AddMatBlocks, where</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="comment">// *this is larger than src.</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="keywordflow">if</span> (transA != <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>)</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Transposed operation not supported currently.&quot;</span>;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <span class="keywordflow">if</span> (!(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> % A.NumRows() == 0 &amp;&amp; <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a> % A.NumCols() == 0))</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Invalid sizes of arguments&quot;</span>;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;      CuTimer tim;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      dim3 dimGrid, dimBlock;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                                            &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      cuda_add_mat_repeated(dimGrid, dimBlock, alpha,</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                            A.data_, A.Dim(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    } <span class="keywordflow">else</span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    {</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;      <span class="keyword">const</span> MatrixBase&lt;Real&gt; &amp;src_mat = A.Mat(),</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;          &amp;this_mat = this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>();</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;      <span class="keywordflow">for</span> (int32 row_offset = 0; row_offset &lt; <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>();</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;           row_offset += src_mat.NumRows()) {</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        <span class="keywordflow">for</span> (int32 col_offset = 0; col_offset &lt; <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>();</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;             col_offset += src_mat.NumCols()) {</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;          SubMatrix&lt;Real&gt; this_part(this_mat,</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                                    row_offset, src_mat.NumRows(),</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                                    col_offset, src_mat.NumCols());</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;          this_part.AddMat(alpha, src_mat);</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        }</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      }</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    }</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  }</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00033">matrix-common.h:33</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00126">kaldi-error.h:126</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00034">matrix-common.h:34</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab159ba96e9b7479896ef9ef2428995be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab159ba96e9b7479896ef9ef2428995be">&#9670;&nbsp;</a></span>AddMatDiagVec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddMatDiagVec </td>
          <td>(</td>
          <td class="paramtype">const Real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>transM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>beta</em> = <code>1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01402">1402</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-normalize-component_8cc_source.html#l00466">BatchNormComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00343">SigmoidComponent::RepairGradients()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00849">TanhComponent::RepairGradients()</a>, and <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>.</p>
<div class="fragment"><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;               {</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <span class="keywordflow">if</span> (transM == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>) {</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">SameDim</a>(*<span class="keyword">this</span>, M));</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(M.NumRows() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>() &amp;&amp; M.NumCols() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>());</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    }</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(v.Dim() == this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>());</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    CuTimer tim;</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> M_row_stride = M.Stride(), M_col_stride = 1;</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <span class="keywordflow">if</span> (transM == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>) <a class="code" href="namespacekaldi.html#aa3e99328db564bc2bf6397fa1eaee4d7">std::swap</a>(M_row_stride, M_col_stride);</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    cuda_add_mat_diag_vec(dimGrid, dimBlock, alpha, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(),</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                          M.Data(), M_row_stride, M_col_stride, v.Data(),  beta);</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;  {</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().AddMatDiagVec(alpha, M.Mat(), transM, v.Vec(), beta);</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;  }</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa3e99328db564bc2bf6397fa1eaee4d7"><div class="ttname"><a href="namespacekaldi.html#aa3e99328db564bc2bf6397fa1eaee4d7">kaldi::swap</a></div><div class="ttdeci">void swap(basic_filebuf&lt; CharT, Traits &gt; &amp;x, basic_filebuf&lt; CharT, Traits &gt; &amp;y)</div><div class="ttdef"><b>Definition:</b> <a href="basic-filebuf_8h_source.html#l00275">basic-filebuf.h:275</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00033">matrix-common.h:33</a></div></div>
<div class="ttc" id="group__matrix__funcs__io_html_ga07b147212efb08775c252cd4cc7453fe"><div class="ttname"><a href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">kaldi::SameDim</a></div><div class="ttdeci">bool SameDim(const MatrixBase&lt; Real &gt; &amp;M, const MatrixBase&lt; Real &gt; &amp;N)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l01065">kaldi-matrix.h:1065</a></div></div>
<div class="ttc" id="namespacekaldi_html_aac2c220416519a2b0a7ad822ee2ef972"><div class="ttname"><a href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">kaldi::MatrixIndexT</a></div><div class="ttdeci">int32 MatrixIndexT</div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00098">matrix-common.h:98</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00034">matrix-common.h:34</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac6680e67841f62c6cf1b52d13b58546d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6680e67841f62c6cf1b52d13b58546d">&#9670;&nbsp;</a></span>AddMatMat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddMatMat </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>transA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>transB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>C = alpha * A(^T)*B(^T) + beta * C. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01278">1278</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8cc_source.html#l03172">CuMatrixBase&lt; float &gt;::AddMatBlock()</a>, <a class="el" href="cu-block-matrix_8cc_source.html#l00211">CuBlockMatrix&lt; Real &gt;::AddMatMat()</a>, <a class="el" href="cu-matrix_8h_source.html#l00557">CuMatrixBase&lt; float &gt;::AddMatSp()</a>, <a class="el" href="cu-matrix_8h_source.html#l00584">CuMatrixBase&lt; float &gt;::AddMatTp()</a>, <a class="el" href="cu-matrix_8h_source.html#l00566">CuMatrixBase&lt; float &gt;::AddSpMat()</a>, <a class="el" href="cu-matrix_8h_source.html#l00575">CuMatrixBase&lt; float &gt;::AddTpMat()</a>, <a class="el" href="nnet-tdnn-component_8cc_source.html#l00213">TdnnComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01454">RepeatedAffineComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l01176">AffineComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l03216">LinearComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03214">FixedLinearComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03300">FixedAffineComponent::Backprop()</a>, <a class="el" href="nnet-linear-transform_8h_source.html#l00161">LinearTransform::BackpropagateFnc()</a>, <a class="el" href="nnet-affine-transform_8h_source.html#l00170">AffineTransform::BackpropagateFnc()</a>, <a class="el" href="nnet-recurrent_8h_source.html#l00243">RecurrentComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-convolutional-component_8h_source.html#l00368">ConvolutionalComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-lstm-projected_8h_source.html#l00475">LstmProjected::BackpropagateFnc()</a>, <a class="el" href="nnet-blstm-projected_8h_source.html#l00720">BlstmProjected::BackpropagateFnc()</a>, <a class="el" href="nnet-utils_8cc_source.html#l01668">ModelCollapser::CollapseComponentsAffine()</a>, <a class="el" href="nnet-precondition-online_8cc_source.html#l00501">OnlinePreconditioner::ComputeWt1()</a>, <a class="el" href="natural-gradient-online_8cc_source.html#l00482">OnlineNaturalGradient::ComputeWt1()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00896">kaldi::nnet3::ConstrainOrthonormalInternal()</a>, <a class="el" href="convolution_8cc_source.html#l00603">kaldi::nnet3::time_height_convolution::ConvolveBackwardDataInternal()</a>, <a class="el" href="convolution_8cc_source.html#l00763">kaldi::nnet3::time_height_convolution::ConvolveBackwardParamsInternal()</a>, <a class="el" href="convolution_8cc_source.html#l00448">kaldi::nnet3::time_height_convolution::ConvolveForwardInternal()</a>, <a class="el" href="cu-vector-test_8cc_source.html#l00692">kaldi::CuVectorUnitTestAddDiagMatMat()</a>, <a class="el" href="nnet-precondition-online_8cc_source.html#l00045">OnlinePreconditioner::InitOrthonormalSpecial()</a>, <a class="el" href="nnet-precondition_8cc_source.html#l00026">kaldi::nnet2::PreconditionDirections()</a>, <a class="el" href="nnet-precondition-online_8cc_source.html#l00300">OnlinePreconditioner::PreconditionDirectionsInternal()</a>, <a class="el" href="natural-gradient-online_8cc_source.html#l00323">OnlineNaturalGradient::PreconditionDirectionsInternal()</a>, <a class="el" href="nnet-tdnn-component_8cc_source.html#l00181">TdnnComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l01155">AffineComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l03209">LinearComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03053">DctComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03203">FixedLinearComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03288">FixedAffineComponent::Propagate()</a>, <a class="el" href="nnet-kl-hmm_8h_source.html#l00050">KlHmm::PropagateFnc()</a>, <a class="el" href="nnet-linear-transform_8h_source.html#l00155">LinearTransform::PropagateFnc()</a>, <a class="el" href="nnet-affine-transform_8h_source.html#l00162">AffineTransform::PropagateFnc()</a>, <a class="el" href="nnet-recurrent_8h_source.html#l00207">RecurrentComponent::PropagateFnc()</a>, <a class="el" href="nnet-rbm_8h_source.html#l00226">Rbm::PropagateFnc()</a>, <a class="el" href="nnet-lstm-projected_8h_source.html#l00365">LstmProjected::PropagateFnc()</a>, <a class="el" href="nnet-blstm-projected_8h_source.html#l00532">BlstmProjected::PropagateFnc()</a>, <a class="el" href="nnet-rbm_8h_source.html#l00239">Rbm::Reconstruct()</a>, <a class="el" href="nnet-precondition-online_8cc_source.html#l00184">OnlinePreconditioner::ReorthogonalizeXt1()</a>, <a class="el" href="natural-gradient-online_8cc_source.html#l00200">OnlineNaturalGradient::ReorthogonalizeXt1()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00212">kaldi::TestCuMatrixMatMat()</a>, <a class="el" href="cu-block-matrix-test_8cc_source.html#l00116">kaldi::UnitTestCuBlockMatrixAddMatMat()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00112">kaldi::UnitTestCuCholesky()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01661">kaldi::UnitTestCuMatrixAddMatMat()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01584">kaldi::UnitTestCuMatrixSymAddMat2()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01614">kaldi::UnitTestCuMatrixSymInvertPosDef()</a>, <a class="el" href="cu-sp-matrix-test_8cc_source.html#l00152">kaldi::UnitTestCuSpMatrixInvert()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l02253">BlockAffineComponentPreconditioned::Update()</a>, <a class="el" href="nnet-tdnn-component_8cc_source.html#l00261">TdnnComponent::UpdateSimple()</a>, and <a class="el" href="_2nnet-component_8cc_source.html#l02012">BlockAffineComponent::UpdateSimple()</a>.</p>
<div class="fragment"><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                                                                        {</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    <span class="comment">// CUBLAS is col-major, cudamatrix is row-major, how to do the mapping?</span></div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="comment">// keep trans..., just swap A&amp;B matrices: A-&gt;B B-&gt;A</span></div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> m = ((transB==<a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>)? B.NumRows() : B.NumCols());</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> <a class="code" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">n</a> = ((transA==<a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>)? A.NumCols() : A.NumRows());</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> k = ((transB==<a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>)? B.NumCols() : B.NumRows());</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> k1 = ((transA==<a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>)? A.NumRows() : A.NumCols());</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(m == <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>());</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(n == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>());</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(k == k1);</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <span class="keywordflow">if</span> (m == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    CuTimer tim;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    CUBLAS_SAFE_CALL(cublas_gemm(GetCublasHandle(),</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                             (transB==<a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>? CUBLAS_OP_T:CUBLAS_OP_N),</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                             (transA==<a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>? CUBLAS_OP_T:CUBLAS_OP_N),</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                             m, n, k, alpha, B.data_, B.Stride(),</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                             A.data_, A.Stride(), beta, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a180e10f97fa838f9c1ae125ba164dd77">Stride</a>()));</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  {</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().AddMatMat(alpha, A.Mat(), transA, B.Mat(), transB, beta);</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;  }</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a180e10f97fa838f9c1ae125ba164dd77"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a180e10f97fa838f9c1ae125ba164dd77">kaldi::CuMatrixBase::Stride</a></div><div class="ttdeci">MatrixIndexT Stride() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00216">cu-matrix.h:216</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00033">matrix-common.h:33</a></div></div>
<div class="ttc" id="namespacekaldi_html_aac2c220416519a2b0a7ad822ee2ef972"><div class="ttname"><a href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">kaldi::MatrixIndexT</a></div><div class="ttdeci">int32 MatrixIndexT</div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00098">matrix-common.h:98</a></div></div>
<div class="ttc" id="namespacernnlm_html_ab4871778d570f724a07823e0a2fb9884"><div class="ttname"><a href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@11::@12 n</div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a08082e5de32e8746483bf146883e117e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08082e5de32e8746483bf146883e117e">&#9670;&nbsp;</a></span>AddMatMatElements()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddMatMatElements </td>
          <td>(</td>
          <td class="paramtype">const Real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Real&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>*this = beta * *this + alpha * A .* B (.* element by element multiplication) </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01434">1434</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-general-component_8cc_source.html#l00476">StatisticsExtractionComponent::Backprop()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00771">StatisticsPoolingComponent::Propagate()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l01320">kaldi::UnitTestCuMatrixSetMatMatDivMat()</a>.</p>
<div class="fragment"><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                                                                         {</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">SameDim</a>(*<span class="keyword">this</span>, A) &amp;&amp; <a class="code" href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">SameDim</a>(A, B));</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    CuTimer tim;</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    cuda_add_mat_mat_elements(dimGrid, dimBlock, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, A.Data(),</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                              B.Data(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), A.Stride(), B.Stride(), alpha, beta);</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;  {</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().AddMatMatElements(alpha, A.Mat(), B.Mat(), beta);</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;  }</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="group__matrix__funcs__io_html_ga07b147212efb08775c252cd4cc7453fe"><div class="ttname"><a href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">kaldi::SameDim</a></div><div class="ttdeci">bool SameDim(const MatrixBase&lt; Real &gt; &amp;M, const MatrixBase&lt; Real &gt; &amp;N)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l01065">kaldi-matrix.h:1065</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad7e288e026f0c9ae310071406bdb5812"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7e288e026f0c9ae310071406bdb5812">&#9670;&nbsp;</a></span>AddMatSmat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddMatSmat </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuSparseMatrix.html">CuSparseMatrix</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>transB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(*this) = alpha * A * op(B) + beta * (*this), where B is sparse and op(B) is either B or trans(B) depending on the 'transB' argument. </p>
<p>This is multiplication of a dense by a sparse matrix. See also AddSmatMat. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01067">1067</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l00814">kaldi::UnitTextCuMatrixAddMatSmat()</a>.</p>
<div class="fragment"><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                                                                           {</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="keywordflow">if</span> (transB == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>) {</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == A.NumRows());</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>() == B.NumCols());</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(A.NumCols() == B.NumRows());</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == A.NumRows());</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>() == B.NumRows());</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(A.NumCols() == B.NumCols());</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    }</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    CuTimer tim;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    cusparseMatDescr_t descr;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    CUSPARSE_SAFE_CALL(cusparseCreateMatDescr(&amp;descr));</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    CU_SAFE_CALL(</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        cusparse_csrmm(</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;            GetCusparseHandle(),</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            transB == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a> ?</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                CUSPARSE_OPERATION_TRANSPOSE : CUSPARSE_OPERATION_NON_TRANSPOSE,</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;            B.NumRows(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), B.NumCols(), B.NumElements(), &amp;alpha, descr,</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;            B.CsrVal(), B.CsrRowPtr(), B.CsrColIdx(), A.Data(), A.Stride(),</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;            &amp;beta, <a class="code" href="classkaldi_1_1CuMatrixBase.html#aa5a0f4f5fe999cc628776f18ef9138b3">Data</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#a180e10f97fa838f9c1ae125ba164dd77">Stride</a>()));</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    CUSPARSE_SAFE_CALL(cusparseDestroyMatDescr(descr));</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  {</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().AddMatSmat(alpha, A.Mat(), B.Smat(), transB, beta);</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  }</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a180e10f97fa838f9c1ae125ba164dd77"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a180e10f97fa838f9c1ae125ba164dd77">kaldi::CuMatrixBase::Stride</a></div><div class="ttdeci">MatrixIndexT Stride() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00216">cu-matrix.h:216</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00034">matrix-common.h:34</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_aa5a0f4f5fe999cc628776f18ef9138b3"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#aa5a0f4f5fe999cc628776f18ef9138b3">kaldi::CuMatrixBase::Data</a></div><div class="ttdeci">const Real * Data() const</div><div class="ttdoc">Return data pointer (const). </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00689">cu-matrix.h:689</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aefb01cffa1d14588b5b45be320ddf399"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefb01cffa1d14588b5b45be320ddf399">&#9670;&nbsp;</a></span>AddMatSp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void AddMatSp </td>
          <td>(</td>
          <td class="paramtype">const Real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>transA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuSpMatrix.html">CuSpMatrix</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Real&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>this &lt;&ndash; beta*this + alpha*A*B </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00557">557</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                                 {</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    CuMatrix&lt;Real&gt; M(B);</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac6680e67841f62c6cf1b52d13b58546d">AddMatMat</a>(alpha, A, transA, M, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, beta);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  }</div><div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00034">matrix-common.h:34</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac6680e67841f62c6cf1b52d13b58546d"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac6680e67841f62c6cf1b52d13b58546d">kaldi::CuMatrixBase::AddMatMat</a></div><div class="ttdeci">void AddMatMat(Real alpha, const CuMatrixBase&lt; Real &gt; &amp;A, MatrixTransposeType transA, const CuMatrixBase&lt; Real &gt; &amp;B, MatrixTransposeType transB, Real beta)</div><div class="ttdoc">C = alpha * A(^T)*B(^T) + beta * C. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l01278">cu-matrix.cc:1278</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abe00ad6248cef735670f93a60b64e3d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe00ad6248cef735670f93a60b64e3d7">&#9670;&nbsp;</a></span>AddMatTp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void AddMatTp </td>
          <td>(</td>
          <td class="paramtype">const Real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>transA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuTpMatrix.html">CuTpMatrix</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>transB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Real&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>this &lt;&ndash; beta*this + alpha*A*B. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00584">584</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix-test_8cc_source.html#l01850">kaldi::UnitTestCuMatrixAddMatTp()</a>.</p>
<div class="fragment"><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                                 {</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    CuMatrix&lt;Real&gt; M(B);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac6680e67841f62c6cf1b52d13b58546d">AddMatMat</a>(alpha, A, transA, M, transB, beta);</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  }</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac6680e67841f62c6cf1b52d13b58546d"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac6680e67841f62c6cf1b52d13b58546d">kaldi::CuMatrixBase::AddMatMat</a></div><div class="ttdeci">void AddMatMat(Real alpha, const CuMatrixBase&lt; Real &gt; &amp;A, MatrixTransposeType transA, const CuMatrixBase&lt; Real &gt; &amp;B, MatrixTransposeType transB, Real beta)</div><div class="ttdoc">C = alpha * A(^T)*B(^T) + beta * C. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l01278">cu-matrix.cc:1278</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae4eb60ca0d96773b8e5b33df26d8595f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4eb60ca0d96773b8e5b33df26d8595f">&#9670;&nbsp;</a></span>AddRowRanges()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddRowRanges </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; <a class="el" href="structInt32Pair.html">Int32Pair</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>indexes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For each row r of this and for each column c, do (*this)(r, c) +=  src(j, c), where j ranges from indexes[r].first through indexes[r].second - 1. </p>
<p>In general indexes must be &gt;= 0 and &lt; src.NumRows(); but to represent an empty range you may use the pair (-1, -1) or any pair of numbers (i, j) such that i &gt;= j. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02898">2898</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-general-component_8cc_source.html#l00820">StatisticsPoolingComponent::Backprop()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00210">NnetComputer::ExecuteCommand()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00771">StatisticsPoolingComponent::Propagate()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l00717">kaldi::UnitTestCuMatrixAddRowRanges()</a>.</p>
<div class="fragment"><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;                                                                             {</div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(static_cast&lt;MatrixIndexT&gt;(indexes.<a class="code" href="classkaldi_1_1CuArrayBase.html#af3d58f15749a15d89b0ec5819dd7b7f2">Dim</a>()) == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>());</div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(src.NumCols() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>());</div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;    cuda_add_row_ranges(dimGrid, dimBlock,</div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;                        <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), src.Data(), src.Dim(), indexes.<a class="code" href="classkaldi_1_1CuArrayBase.html#a368b2398825ede0c99248a432c6fdc7b">Data</a>());</div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;  { <span class="comment">// Implement here for the CPU..</span></div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;    int32 num_rows = this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, num_cols = this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>,</div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;          this_stride = this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">stride_</a>, src_stride = src.stride_;</div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;    Real *data = this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>;</div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;    <span class="keyword">const</span> Real *src_data = src.data_;</div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;    <span class="keyword">const</span> <a class="code" href="structInt32Pair.html">Int32Pair</a> *indexes_data = indexes.<a class="code" href="classkaldi_1_1CuArrayBase.html#a368b2398825ede0c99248a432c6fdc7b">Data</a>();</div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;    <span class="keywordflow">for</span> (int32 row = 0; row &lt; num_rows; row++) {</div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;      int32 start_row = indexes_data[row].<a class="code" href="structInt32Pair.html#a9b288b26b67b6a87162a9e1ab5b35dbf">first</a>,</div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;          end_row = indexes_data[row].<a class="code" href="structInt32Pair.html#a03a67f151bb1afcfcafab8870b75acff">second</a>;</div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;      <span class="keywordflow">for</span> (int32 col = 0; col &lt; num_cols; col++) {</div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;        Real sum = 0.0;</div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;        <span class="keywordflow">for</span> (int32 src_row = start_row; src_row &lt; end_row; src_row++)</div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;          sum += src_data[src_row * src_stride + col];</div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;        data[row * this_stride + col] += sum;</div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;      }</div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;    }</div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;  }</div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuArrayBase_html_a368b2398825ede0c99248a432c6fdc7b"><div class="ttname"><a href="classkaldi_1_1CuArrayBase.html#a368b2398825ede0c99248a432c6fdc7b">kaldi::CuArrayBase::Data</a></div><div class="ttdeci">const T * Data() const</div><div class="ttdoc">Get raw pointer. </div><div class="ttdef"><b>Definition:</b> <a href="cu-array_8h_source.html#l00052">cu-array.h:52</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a7cb3ee02262893923716e6764439f359"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">kaldi::CuMatrixBase::stride_</a></div><div class="ttdeci">MatrixIndexT stride_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00730">cu-matrix.h:730</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="structInt32Pair_html"><div class="ttname"><a href="structInt32Pair.html">Int32Pair</a></div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00084">cu-matrixdim.h:84</a></div></div>
<div class="ttc" id="structInt32Pair_html_a03a67f151bb1afcfcafab8870b75acff"><div class="ttname"><a href="structInt32Pair.html#a03a67f151bb1afcfcafab8870b75acff">Int32Pair::second</a></div><div class="ttdeci">int32_cuda second</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00086">cu-matrixdim.h:86</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="classkaldi_1_1CuArrayBase_html_af3d58f15749a15d89b0ec5819dd7b7f2"><div class="ttname"><a href="classkaldi_1_1CuArrayBase.html#af3d58f15749a15d89b0ec5819dd7b7f2">kaldi::CuArrayBase::Dim</a></div><div class="ttdeci">MatrixIndexT Dim() const</div><div class="ttdoc">Return the vector dimension. </div><div class="ttdef"><b>Definition:</b> <a href="cu-array_8h_source.html#l00049">cu-array.h:49</a></div></div>
<div class="ttc" id="structInt32Pair_html_a9b288b26b67b6a87162a9e1ab5b35dbf"><div class="ttname"><a href="structInt32Pair.html#a9b288b26b67b6a87162a9e1ab5b35dbf">Int32Pair::first</a></div><div class="ttdeci">int32_cuda first</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00085">cu-matrixdim.h:85</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a62c46e6440ae6045cb2f0af43f26c1d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62c46e6440ae6045cb2f0af43f26c1d5">&#9670;&nbsp;</a></span>AddRows() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddRows </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>indexes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Does for each row r, this.Row(r) += alpha * src.row(indexes[r]). </p>
<p>If indexes[r] &lt; 0, does not add anything. src.NumCols() must equal this.NumCols() </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02733">2733</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-general-component_8cc_source.html#l00476">StatisticsExtractionComponent::Backprop()</a>, and <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00210">NnetComputer::ExecuteCommand()</a>.</p>
<div class="fragment"><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;                                                                           {</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(static_cast&lt;MatrixIndexT&gt;(indexes.Dim()) == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>());</div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(src.NumCols() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>());</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;    cuda_add_rows(dimGrid, dimBlock, alpha,</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;                  <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, src.Data(), indexes.Data(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), src.Stride());</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;  {</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().AddRows(alpha, src.Mat(), indexes.Data());</div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;  }</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a774e069c4eb05063f4197163e82ee034"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a774e069c4eb05063f4197163e82ee034">&#9670;&nbsp;</a></span>AddRows() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddRows </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; const Real *&gt; &amp;&#160;</td>
          <td class="paramname"><em>src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Does for each row r, this.Row(r) += alpha * src[r], treating src[r] as the beginning of a region of memory representing a vector of floats, of the same length as this.NumCols(). </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02793">2793</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;                                                                                {</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(static_cast&lt;MatrixIndexT&gt;(src.Dim()) == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>());</div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;    cuda_add_rows(dimGrid, dimBlock, alpha, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, src.Data(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;  {</div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().AddRows(alpha, src.Data());</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;  }</div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af4e47f8bb3cf8fc753d6a8bc79da118d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4e47f8bb3cf8fc753d6a8bc79da118d">&#9670;&nbsp;</a></span>AddSmat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddSmat </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuSparseMatrix.html">CuSparseMatrix</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>trans</em> = <code><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>*this += alpha * A. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00972">972</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-sparse-matrix_8cc_source.html#l00679">GeneralMatrix::AddToMat()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l00782">kaldi::UnitTextCuMatrixAddSmat()</a>.</p>
<div class="fragment"><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                                                            {</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <span class="keywordflow">if</span> (trans == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>) {</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == A.NumRows());</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>() == A.NumCols());</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == A.NumCols());</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>() == A.NumRows());</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    }</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    CuTimer tim;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="comment">// We use warpSize threads per row to access only the nonzero elements.</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="comment">// Every CU1DBLOCK/warpSize rows share one thread block.</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="comment">// 1D grid to cover all rows of A.</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> warpSize = 32;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    dim3 dimBlock(warpSize, <a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a> / warpSize);</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    dim3 dimGrid(n_blocks(A.NumRows(), dimBlock.y));</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordflow">if</span> (trans == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>) {</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;      cuda_add_smat(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#aa5a0f4f5fe999cc628776f18ef9138b3">Data</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), alpha, A.CsrRowPtr(),</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                    A.CsrColIdx(), A.CsrVal());</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      cuda_add_smat_trans(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#aa5a0f4f5fe999cc628776f18ef9138b3">Data</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), alpha,</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;      A.CsrRowPtr(), A.CsrColIdx(), A.CsrVal());</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    }</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  {</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().AddSmat(alpha, A.Smat(), trans);</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  }</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a6dbdf9d0385c92d6d915b96eaf9ce99e"><div class="ttname"><a href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a></div><div class="ttdeci">#define CU1DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00063">cu-matrixdim.h:63</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00034">matrix-common.h:34</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_aa5a0f4f5fe999cc628776f18ef9138b3"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#aa5a0f4f5fe999cc628776f18ef9138b3">kaldi::CuMatrixBase::Data</a></div><div class="ttdeci">const Real * Data() const</div><div class="ttdoc">Return data pointer (const). </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00689">cu-matrix.h:689</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4c0b0b2d6973581565453c81d068b5e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c0b0b2d6973581565453c81d068b5e6">&#9670;&nbsp;</a></span>AddSmatMat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddSmatMat </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuSparseMatrix.html">CuSparseMatrix</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>transA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(*this) = alpha * op(A) * B + beta * (*this), where A is sparse. </p>
<p>Multiplication of sparse with dense matrix. See also AddMatSmat. Note: we recommend, for greatest efficiency, that transA be kNoTrans. Use <a class="el" href="classkaldi_1_1CuMatrixBase.html#ad7e288e026f0c9ae310071406bdb5812" title="(*this) = alpha * A * op(B) + beta * (*this), where B is sparse and op(B) is either B or trans(B) dep...">AddMatSmat()</a> for better efficiency, as 2 dense mat transpose ops are called in this API. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01011">1011</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l00852">kaldi::UnitTextCuMatrixAddSmatMat()</a>.</p>
<div class="fragment"><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                                                                            {</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <span class="keywordflow">if</span> (transA == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>) {</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == A.NumRows());</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>() == B.NumCols());</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(A.NumCols() == B.NumRows());</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == A.NumCols());</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>() == B.NumCols());</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(A.NumRows() == B.NumRows());</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    }</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    CuTimer tim;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="comment">// We have op(A) and BT in col-major (B in row-major).</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <span class="comment">// We first compute C in col-major (CT in row-major)</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="comment">// with C = op(A) * BT^T by cusparse_csrmm2,</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="comment">// then transpose CT to get C in row-major</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    CuMatrix&lt;Real&gt; CT(*<span class="keyword">this</span>, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>);</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    cusparseMatDescr_t descr;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    CUSPARSE_SAFE_CALL(cusparseCreateMatDescr(&amp;descr));</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="keywordflow">if</span> (transA == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>) {</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      <span class="comment">// Note: only op(A)=A is supported if op(B)=B^T according to cusparse doc</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      <span class="comment">// http://docs.nvidia.com/cuda/cusparse/index.html#cusparse-lt-t-gt-csrmm2</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      <a class="code" href="classkaldi_1_1CuMatrixBase.html#aafe563db9faef3e8ee4d7a830e8b32b4">CuSparseMatrix&lt;Real&gt;</a> AT(A, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>);</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      CU_SAFE_CALL(</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;          cusparse_csrmm2(GetCusparseHandle(), CUSPARSE_OPERATION_NON_TRANSPOSE,</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                          CUSPARSE_OPERATION_TRANSPOSE, AT.NumRows(),</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                          CT.NumRows(), AT.NumCols(), AT.NumElements(), &amp;alpha,</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                          descr, AT.CsrVal(), AT.CsrRowPtr(), AT.CsrColIdx(),</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                          B.Data(), B.Stride(), &amp;beta, CT.Data(), CT.Stride()));</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;      CU_SAFE_CALL(</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;          cusparse_csrmm2(GetCusparseHandle(), CUSPARSE_OPERATION_NON_TRANSPOSE,</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                          CUSPARSE_OPERATION_TRANSPOSE, A.NumRows(),</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                          CT.NumRows(), A.NumCols(), A.NumElements(), &amp;alpha,</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                          descr, A.CsrVal(), A.CsrRowPtr(), A.CsrColIdx(),</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                          B.Data(), B.Stride(), &amp;beta, CT.Data(), CT.Stride()));</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    }</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    CUSPARSE_SAFE_CALL(cusparseDestroyMatDescr(descr));</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a79817f1cbd9d8478d4137d6dd815a584">CopyFromMat</a>(CT, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>);</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  {</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().AddSmatMat(alpha, A.Smat(), transA, B.Mat(), beta);</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  }</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a79817f1cbd9d8478d4137d6dd815a584"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a79817f1cbd9d8478d4137d6dd815a584">kaldi::CuMatrixBase::CopyFromMat</a></div><div class="ttdeci">void CopyFromMat(const MatrixBase&lt; OtherReal &gt; &amp;src, MatrixTransposeType trans=kNoTrans)</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l00339">cu-matrix.cc:339</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_aafe563db9faef3e8ee4d7a830e8b32b4"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#aafe563db9faef3e8ee4d7a830e8b32b4">kaldi::CuMatrixBase::CuSparseMatrix&lt; Real &gt;</a></div><div class="ttdeci">friend class CuSparseMatrix&lt; Real &gt;</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00095">cu-matrix.h:95</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00033">matrix-common.h:33</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00034">matrix-common.h:34</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a50adea14dc19dd2c438443e8d8394914"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50adea14dc19dd2c438443e8d8394914">&#9670;&nbsp;</a></span>AddSpMat()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void AddSpMat </td>
          <td>(</td>
          <td class="paramtype">const Real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuSpMatrix.html">CuSpMatrix</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>transB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Real&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>this &lt;&ndash; beta*this + alpha*SpA*B </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00566">566</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                                 {</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    CuMatrix&lt;Real&gt; M(A);</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac6680e67841f62c6cf1b52d13b58546d">AddMatMat</a>(alpha, M, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, B, transB, beta);</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  }</div><div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00034">matrix-common.h:34</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac6680e67841f62c6cf1b52d13b58546d"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac6680e67841f62c6cf1b52d13b58546d">kaldi::CuMatrixBase::AddMatMat</a></div><div class="ttdeci">void AddMatMat(Real alpha, const CuMatrixBase&lt; Real &gt; &amp;A, MatrixTransposeType transA, const CuMatrixBase&lt; Real &gt; &amp;B, MatrixTransposeType transB, Real beta)</div><div class="ttdoc">C = alpha * A(^T)*B(^T) + beta * C. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l01278">cu-matrix.cc:1278</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae8e87b09ccd8a23d31dbc415a60da637"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8e87b09ccd8a23d31dbc415a60da637">&#9670;&nbsp;</a></span>AddToDiag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddToDiag </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds "value" to the diagonal elements of the matrix. </p>
<p>The matrix *this does not have to be square. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00570">570</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-utils_8cc_source.html#l00896">kaldi::nnet3::ConstrainOrthonormalInternal()</a>, <a class="el" href="nnet-precondition_8cc_source.html#l00026">kaldi::nnet2::PreconditionDirections()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00652">kaldi::TestCuMatrixCholesky()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l01790">kaldi::UnitTestCuMatrixAddToDiag()</a>.</p>
<div class="fragment"><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                                             {</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    CuTimer tim;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="comment">// We&#39;ll create a fake matrix with &quot;num_diag&quot; rows, one</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="comment">// columnn, and a stride of &quot;this_stride&quot;.  The y-value of</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="comment">// the grid/blocks corresponds to the row, in this kernel.</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> num_diag = std::min(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>),</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        this_stride = <a class="code" href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">stride_</a> + 1;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    dim3 dimBlock(1, <a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a>);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    dim3 dimGrid(1, n_blocks(num_diag, <a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a>));</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <a class="code" href="structMatrixDim__.html">::MatrixDim</a> <a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = { num_diag, 1, this_stride };</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    cuda_add(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, value, d);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="preprocessor">  #endif</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  {</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().AddToDiag(value);</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  }</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="structMatrixDim___html"><div class="ttname"><a href="structMatrixDim__.html">MatrixDim_</a></div><div class="ttdoc">Structure containing size of the matrix plus stride. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00052">cu-matrixdim.h:52</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a7cb3ee02262893923716e6764439f359"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">kaldi::CuMatrixBase::stride_</a></div><div class="ttdeci">MatrixIndexT stride_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00730">cu-matrix.h:730</a></div></div>
<div class="ttc" id="namespacekaldi_html_aac2c220416519a2b0a7ad822ee2ef972"><div class="ttname"><a href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">kaldi::MatrixIndexT</a></div><div class="ttdeci">int32 MatrixIndexT</div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00098">matrix-common.h:98</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a6dbdf9d0385c92d6d915b96eaf9ce99e"><div class="ttname"><a href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a></div><div class="ttdeci">#define CU1DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00063">cu-matrixdim.h:63</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="namespacernnlm_html_a873684cefeb665f3d5e6b495de57fc0d"><div class="ttname"><a href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">rnnlm::d</a></div><div class="ttdeci">double d</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00064">mikolov-rnnlm-lib.cc:64</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acb9cf49b8cc2e213de8a8efb6c9dad77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb9cf49b8cc2e213de8a8efb6c9dad77">&#9670;&nbsp;</a></span>AddToElements()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddToElements </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>elements</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is a rather special purpose function; we might generalize it later by adding a transpose-type option. </p>
<p>It expects 'elements.Dim()' to equal <a class="el" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1" title="Dimensions. ">NumRows()</a>, and for each elements[i] to be either -1, or 0 &lt;= element[i] &lt; <a class="el" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols()</a>. It adds alpha to each element (*this)(i, elements[i]) for 0 &lt;= i &lt; <a class="el" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1" title="Dimensions. ">NumRows()</a>. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l03310">3310</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l02852">kaldi::UnitTestCuMatrixAddToElements()</a>.</p>
<div class="fragment"><div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;                                                                                     {</div><div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(elements.<a class="code" href="classkaldi_1_1CuArrayBase.html#af3d58f15749a15d89b0ec5819dd7b7f2">Dim</a>() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>());</div><div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;    CuTimer tim;</div><div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;</div><div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;    dim3 dimBlock(<a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a>);</div><div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;    dim3 dimGrid(n_blocks(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a>));</div><div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;</div><div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;    cuda_matrix_add_to_elements(dimGrid, dimBlock, alpha, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), elements.<a class="code" href="classkaldi_1_1CuArrayBase.html#a368b2398825ede0c99248a432c6fdc7b">Data</a>());</div><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;  {</div><div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;    MatrixBase&lt;Real&gt; &amp;this_mat = this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>();</div><div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;    <span class="keyword">const</span> int32* row_to_col = elements.<a class="code" href="classkaldi_1_1CuArrayBase.html#a368b2398825ede0c99248a432c6fdc7b">Data</a>();</div><div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;    <span class="keywordflow">for</span> (int32 r = 0; r &lt; this_mat.NumRows(); r++) {</div><div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(row_to_col[r] &gt;= -1);</div><div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;      <span class="keywordflow">if</span> (row_to_col[r] &gt;= 0)</div><div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;        this_mat(r, row_to_col[r]) += alpha;</div><div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;    }</div><div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;  }</div><div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuArrayBase_html_a368b2398825ede0c99248a432c6fdc7b"><div class="ttname"><a href="classkaldi_1_1CuArrayBase.html#a368b2398825ede0c99248a432c6fdc7b">kaldi::CuArrayBase::Data</a></div><div class="ttdeci">const T * Data() const</div><div class="ttdoc">Get raw pointer. </div><div class="ttdef"><b>Definition:</b> <a href="cu-array_8h_source.html#l00052">cu-array.h:52</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a6dbdf9d0385c92d6d915b96eaf9ce99e"><div class="ttname"><a href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a></div><div class="ttdeci">#define CU1DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00063">cu-matrixdim.h:63</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="classkaldi_1_1CuArrayBase_html_af3d58f15749a15d89b0ec5819dd7b7f2"><div class="ttname"><a href="classkaldi_1_1CuArrayBase.html#af3d58f15749a15d89b0ec5819dd7b7f2">kaldi::CuArrayBase::Dim</a></div><div class="ttdeci">MatrixIndexT Dim() const</div><div class="ttdoc">Return the vector dimension. </div><div class="ttdef"><b>Definition:</b> <a href="cu-array_8h_source.html#l00049">cu-array.h:49</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3d5da0115fcbde3f88d4d17043906ae6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d5da0115fcbde3f88d4d17043906ae6">&#9670;&nbsp;</a></span>AddToRows() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddToRows </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>indexes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; *&#160;</td>
          <td class="paramname"><em>dst</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For each row i of *this, adds this-&gt;Row(i) to dst-&gt;Row(indexes(i)) if indexes(i) &gt;= 0, else do nothing. </p>
<p>Requires that all the indexes[i] that are &gt;= 0 be distinct, otherwise the behavior is undefined. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02836">2836</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00210">NnetComputer::ExecuteCommand()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l00598">kaldi::UnitTestCuMatrixAddToRows()</a>.</p>
<div class="fragment"><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;                                                                  {</div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(static_cast&lt;MatrixIndexT&gt;(indexes.Dim()) == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>());</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(dst-&gt;NumCols() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>());</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;    cuda_add_to_rows(dimGrid, dimBlock, alpha, dst-&gt;Data(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, indexes.Data(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), dst-&gt;Stride());</div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;  {</div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().AddToRows(alpha, indexes.Data(), &amp;(dst-&gt;Mat()));</div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;  }</div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1d5a76874f291b7f59d2370a91148334"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d5a76874f291b7f59d2370a91148334">&#9670;&nbsp;</a></span>AddToRows() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddToRows </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; Real *&gt; &amp;&#160;</td>
          <td class="paramname"><em>dst</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For each row r of this matrix, adds it (times alpha) to the array of floats at the location given by dst[r], where dst[r] is assumed to be obtained from the <a class="el" href="classkaldi_1_1CuMatrixBase.html#aca92364bdcb38c7e30f390340d072bf4" title="Get raw row pointer (const). ">RowData()</a> function of another <a class="el" href="classkaldi_1_1CuMatrix.html" title="This class represents a matrix that&#39;s stored on the GPU if we have one, and in memory if not...">CuMatrix</a>, or from <a class="el" href="classkaldi_1_1CuVectorBase.html#abda573212fad06ec61fd3f428a0992c7" title="Returns a pointer to the start of the vector&#39;s data. ">CuVector::Data()</a> (i.e. </p>
<p>it should point to memory on the GPU if we're using a GPU, or on the CPU otherwise). If dst[r] is NULL, does not do anything for that row. Requires that none of the memory regions pointed to by the pointers in "dst" overlap (e.g. none of the pointers should be the same). </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02814">2814</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;                                                                        {</div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(static_cast&lt;MatrixIndexT&gt;(dst.Dim()) == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>());</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;    cuda_add_to_rows(dimGrid, dimBlock, alpha, dst.Data(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;  {</div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().AddToRows(alpha, dst.Data());</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;  }</div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2df34bd49d0ef4203f72129f629509b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2df34bd49d0ef4203f72129f629509b4">&#9670;&nbsp;</a></span>AddTpMat()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void AddTpMat </td>
          <td>(</td>
          <td class="paramtype">const Real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuTpMatrix.html">CuTpMatrix</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>transA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>transB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Real&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>this &lt;&ndash; beta*this + alpha*A*B. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00575">575</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix-test_8cc_source.html#l01892">kaldi::UnitTestCuMatrixAddTpMat()</a>.</p>
<div class="fragment"><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                                 {</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    CuMatrix&lt;Real&gt; M(A);</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac6680e67841f62c6cf1b52d13b58546d">AddMatMat</a>(alpha, M, transA, B, transB, beta);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  }</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac6680e67841f62c6cf1b52d13b58546d"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac6680e67841f62c6cf1b52d13b58546d">kaldi::CuMatrixBase::AddMatMat</a></div><div class="ttdeci">void AddMatMat(Real alpha, const CuMatrixBase&lt; Real &gt; &amp;A, MatrixTransposeType transA, const CuMatrixBase&lt; Real &gt; &amp;B, MatrixTransposeType transB, Real beta)</div><div class="ttdoc">C = alpha * A(^T)*B(^T) + beta * C. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l01278">cu-matrix.cc:1278</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8a4dc2595cb8eace4937a22e03c7be18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a4dc2595cb8eace4937a22e03c7be18">&#9670;&nbsp;</a></span>AddVecToCols()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddVecToCols </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>beta</em> = <code>1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(for each column c of *this), c = alpha * col + beta * c </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01219">1219</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-kl-hmm_8h_source.html#l00050">KlHmm::PropagateFnc()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l01539">kaldi::UnitTestCuMatrixAddVecToCols()</a>.</p>
<div class="fragment"><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                                                 {</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  <span class="keywordflow">if</span> (col.Dim() != <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>()) {</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Non matching dimensions: Rows:&quot;</span> &lt;&lt; <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() &lt;&lt; <span class="stringliteral">&quot; VectorDim:&quot;</span> &lt;&lt; col.Dim();</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;  }</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="preprocessor">  #if HAVE_CUDA == 1</span></div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    CuTimer tim;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    cuda_add_vec_to_cols(dimGrid, dimBlock, alpha, col.data_, beta,</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                         <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="preprocessor">  #endif</span></div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;  {</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <span class="keywordflow">if</span> (beta != 1.0) <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().Scale(beta);</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().AddVecToCols(alpha, col.Vec());</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  }</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00126">kaldi-error.h:126</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5d4bcaf73515787cf3c40710e8557e48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d4bcaf73515787cf3c40710e8557e48">&#9670;&nbsp;</a></span>AddVecToRows()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddVecToRows </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>beta</em> = <code>1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(for each row r of *this), r = alpha * row + beta * r </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01248">1248</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="decodable-online-looped_8cc_source.html#l00112">DecodableNnetLoopedOnlineBase::AdvanceChunk()</a>, <a class="el" href="decodable-simple-looped_8cc_source.html#l00140">DecodableNnetSimpleLooped::AdvanceChunk()</a>, <a class="el" href="nnet-normalize-component_8cc_source.html#l00466">BatchNormComponent::Backprop()</a>, <a class="el" href="nnet-sentence-averaging-component_8h_source.html#l00137">SimpleSentenceAveragingComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02521">ScaleAndOffsetComponent::BackpropInternal()</a>, <a class="el" href="online-nnet2-decodable_8cc_source.html#l00081">DecodableNnet2Online::ComputeForFrame()</a>, <a class="el" href="nnet-am-decodable-simple_8cc_source.html#l00215">DecodableNnetSimple::DoNnetComputation()</a>, <a class="el" href="nnet-normalize-component_8cc_source.html#l00400">BatchNormComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03288">FixedAffineComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03438">FixedBiasComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02191">PerElementOffsetComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03819">Convolutional1dComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l04204">ConvolutionComponent::Propagate()</a>, <a class="el" href="nnet-sentence-averaging-component_8h_source.html#l00124">SimpleSentenceAveragingComponent::PropagateFnc()</a>, <a class="el" href="nnet-affine-transform_8h_source.html#l00162">AffineTransform::PropagateFnc()</a>, <a class="el" href="nnet-recurrent_8h_source.html#l00207">RecurrentComponent::PropagateFnc()</a>, <a class="el" href="nnet-rbm_8h_source.html#l00226">Rbm::PropagateFnc()</a>, <a class="el" href="nnet-convolutional-component_8h_source.html#l00258">ConvolutionalComponent::PropagateFnc()</a>, <a class="el" href="nnet-convolutional-2d-component_8h_source.html#l00259">Convolutional2DComponent::PropagateFnc()</a>, <a class="el" href="nnet-various_8h_source.html#l00366">AddShift::PropagateFnc()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02461">ScaleAndOffsetComponent::PropagateInternal()</a>, <a class="el" href="nnet-rbm_8h_source.html#l00239">Rbm::Reconstruct()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00343">SigmoidComponent::RepairGradients()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00989">RectifiedLinearComponent::RepairGradients()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="nnet-pdf-prior_8cc_source.html#l00076">PdfPrior::SubtractOnLogpost()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01562">kaldi::UnitTestCuMatrixAddVecToRows()</a>, and <a class="el" href="nnet-sentence-averaging-component_8h_source.html#l00277">SentenceAveragingComponent::Update()</a>.</p>
<div class="fragment"><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                                                 {</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  <span class="keywordflow">if</span> (row.Dim() != <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>()) {</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Non matching dimensions: Cols:&quot;</span> &lt;&lt; <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>() &lt;&lt; <span class="stringliteral">&quot; VectorDim:&quot;</span> &lt;&lt; row.Dim();</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  }</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    CuTimer tim;</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    cuda_add_vec_to_rows(dimGrid, dimBlock, alpha, row.data_, beta, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  {</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    <span class="keywordflow">if</span> (beta != 1.0) <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().Scale(beta);</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().AddVecToRows(alpha, row.Vec());</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  }</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00126">kaldi-error.h:126</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a496e97d381fa331033ef85df55860898"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a496e97d381fa331033ef85df55860898">&#9670;&nbsp;</a></span>AddVecVec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddVecVec </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A = alpha * x * y^T + A . </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01316">1316</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l01692">kaldi::UnitTestCuMatrixAddVecVec()</a>.</p>
<div class="fragment"><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                                                                          {</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> m = y.Dim();</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> <a class="code" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">n</a> = x.Dim();</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(m == <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>());</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(n == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>());</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    CuTimer tim;</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    CUBLAS_SAFE_CALL(cublas_ger(GetCublasHandle(), m, n, alpha,</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                     y.Data(), 1, x.Data(), 1, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a180e10f97fa838f9c1ae125ba164dd77">Stride</a>()));</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  {</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().AddVecVec(alpha, x.Vec(), y.Vec());</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;  }</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a180e10f97fa838f9c1ae125ba164dd77"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a180e10f97fa838f9c1ae125ba164dd77">kaldi::CuMatrixBase::Stride</a></div><div class="ttdeci">MatrixIndexT Stride() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00216">cu-matrix.h:216</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="namespacekaldi_html_aac2c220416519a2b0a7ad822ee2ef972"><div class="ttname"><a href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">kaldi::MatrixIndexT</a></div><div class="ttdeci">int32 MatrixIndexT</div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00098">matrix-common.h:98</a></div></div>
<div class="ttc" id="namespacernnlm_html_ab4871778d570f724a07823e0a2fb9884"><div class="ttname"><a href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@11::@12 n</div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7d4a6173e58467a1ddeb21c8aa46f271"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d4a6173e58467a1ddeb21c8aa46f271">&#9670;&nbsp;</a></span>ApplyCeiling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ApplyCeiling </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>ceiling_val</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02572">2572</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-simple-component_8cc_source.html#l00675">ClipGradientComponent::Backprop()</a>, <a class="el" href="nnet-recurrent_8h_source.html#l00243">RecurrentComponent::BackpropagateFnc()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l00937">kaldi::UnitTestCuMatrixApplyCeiling()</a>.</p>
<div class="fragment"><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;                                                      {</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;    cuda_apply_ceiling(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, ceiling_val, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;  {</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().ApplyCeiling(ceiling_val);</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;  }</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7d9dc70920bff8a7d995679d7ba2d81b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d9dc70920bff8a7d995679d7ba2d81b">&#9670;&nbsp;</a></span>ApplyExp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ApplyExp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02484">2484</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="discriminative-training_8cc_source.html#l00353">DiscriminativeComputation::Compute()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01887">CuMatrixBase&lt; float &gt;::DiffLogSoftmaxPerRow()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l00181">kaldi::UnitTestCuMatrixApplyExp()</a>.</p>
<div class="fragment"><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;                                  {</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;    cuda_apply_exp(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;  {</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().ApplyExp();</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;  }</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad256eff0fc05e41dfe1a0d4edce43ac9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad256eff0fc05e41dfe1a0d4edce43ac9">&#9670;&nbsp;</a></span>ApplyExpLimited()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ApplyExpLimited </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>lower_limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>upper_limit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is equivalent to running: ApplyFloor(lower_limit); ApplyCeiling(upper_limit); <a class="el" href="classkaldi_1_1CuMatrixBase.html#a7d9dc70920bff8a7d995679d7ba2d81b">ApplyExp()</a> </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02502">2502</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l00198">kaldi::UnitTestCuMatrixApplyExpLimited()</a>.</p>
<div class="fragment"><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;                                                                           {</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(upper_limit &gt; lower_limit);</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;    cuda_apply_exp_limited(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), lower_limit, upper_limit);</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;  {</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;    int32 num_rows = <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, num_cols = <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>;</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;    <span class="keywordflow">for</span> (int32 r = 0; r &lt; num_rows; r++) {</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;      Real *row_data = this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#aca92364bdcb38c7e30f390340d072bf4">RowData</a>(r);</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;      <span class="keywordflow">for</span> (int32 c = 0; c &lt; num_cols; c++) {</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;        Real x = row_data[c];</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;        <span class="keywordflow">if</span> (!(x &gt;= lower_limit))</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;          x = lower_limit;</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;        <span class="keywordflow">if</span> (x &gt; upper_limit)</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;          x = upper_limit;</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;        row_data[c] = <a class="code" href="namespacekaldi.html#acb7bb4ffd897a6d0ba3fa0cbd9093a9e">Exp</a>(x);</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;      }</div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;    }</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;  }</div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;}</div><div class="ttc" id="namespacekaldi_html_acb7bb4ffd897a6d0ba3fa0cbd9093a9e"><div class="ttname"><a href="namespacekaldi.html#acb7bb4ffd897a6d0ba3fa0cbd9093a9e">kaldi::Exp</a></div><div class="ttdeci">double Exp(double x)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8h_source.html#l00083">kaldi-math.h:83</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_aca92364bdcb38c7e30f390340d072bf4"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#aca92364bdcb38c7e30f390340d072bf4">kaldi::CuMatrixBase::RowData</a></div><div class="ttdeci">const Real * RowData(MatrixIndexT r) const</div><div class="ttdoc">Get raw row pointer (const). </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00683">cu-matrix.h:683</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5353ff81c33e8f224463dff1e8f8fead"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5353ff81c33e8f224463dff1e8f8fead">&#9670;&nbsp;</a></span>ApplyExpSpecial()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ApplyExpSpecial </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For each element x of the matrix, set it to (x &lt; 0 ? exp(x) : x + 1). </p>
<p>This function is used in our RNNLM training. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02533">2533</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l00164">kaldi::UnitTestCuMatrixApplyExpSpecial()</a>.</p>
<div class="fragment"><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;                                         {</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> warpSize = 32;</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;    dim3 dimBlock(<a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a> / warpSize, warpSize);</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;    dim3 dimGrid(n_blocks(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), dimBlock.x),</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;                 n_blocks(<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(), dimBlock.y));</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;    cuda_apply_exp_special(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#aa5a0f4f5fe999cc628776f18ef9138b3">Data</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#aa5a0f4f5fe999cc628776f18ef9138b3">Data</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#a180e10f97fa838f9c1ae125ba164dd77">Stride</a>());</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;  {</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().ApplyExpSpecial();</div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;  }</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a180e10f97fa838f9c1ae125ba164dd77"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a180e10f97fa838f9c1ae125ba164dd77">kaldi::CuMatrixBase::Stride</a></div><div class="ttdeci">MatrixIndexT Stride() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00216">cu-matrix.h:216</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a6dbdf9d0385c92d6d915b96eaf9ce99e"><div class="ttname"><a href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a></div><div class="ttdeci">#define CU1DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00063">cu-matrixdim.h:63</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_aa5a0f4f5fe999cc628776f18ef9138b3"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#aa5a0f4f5fe999cc628776f18ef9138b3">kaldi::CuMatrixBase::Data</a></div><div class="ttdeci">const Real * Data() const</div><div class="ttdoc">Return data pointer (const). </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00689">cu-matrix.h:689</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a55e848f0d312e1cc0014117787406e5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55e848f0d312e1cc0014117787406e5d">&#9670;&nbsp;</a></span>ApplyFloor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ApplyFloor </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>floor_val</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02554">2554</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-simple-component_8cc_source.html#l00675">ClipGradientComponent::Backprop()</a>, <a class="el" href="nnet-recurrent_8h_source.html#l00243">RecurrentComponent::BackpropagateFnc()</a>, <a class="el" href="online-nnet2-decodable_8cc_source.html#l00081">DecodableNnet2Online::ComputeForFrame()</a>, <a class="el" href="nnet2bin_2nnet-compute_8cc_source.html#l00027">main()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00771">StatisticsPoolingComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00769">RectifiedLinearComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00900">SoftmaxComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00949">LogSoftmaxComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00738">ClipGradientComponent::RepairGradients()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00200">RestrictedAttentionComponent::StoreStats()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00308">kaldi::TestCuMatrixCompObjfAndDeriv()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00916">kaldi::UnitTestCuMatrixApplyFloor()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02774">kaldi::UnitTestCuMatrixObjfDeriv()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l01320">kaldi::UnitTestCuMatrixSetMatMatDivMat()</a>.</p>
<div class="fragment"><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;                                                  {</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;    cuda_apply_floor(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, floor_val, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;  {</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().ApplyFloor(floor_val);</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;  }</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae33e21e5fc98e4d380967e75d470f6fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae33e21e5fc98e4d380967e75d470f6fd">&#9670;&nbsp;</a></span>ApplyHeaviside()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ApplyHeaviside </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For each element, sets x = (x &gt; 0 ? 1.0 : 0.0). </p>
<p>See also <a class="el" href="classkaldi_1_1CuMatrixBase.html#ae82afecb83b55a59388b8c55b958e6bf" title="Set each element to the Heaviside function of the corresponding element of &quot;src&quot;, which we define as ...">Heaviside()</a>. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02445">2445</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-general-component_8cc_source.html#l01098">BackpropTruncationComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00778">RectifiedLinearComponent::Backprop()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l01682">GeneralDropoutComponent::GetMemo()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l01412">DropoutMaskComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03531">DropoutComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00343">SigmoidComponent::RepairGradients()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00849">TanhComponent::RepairGradients()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00738">ClipGradientComponent::RepairGradients()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00427">kaldi::TestCuMatrixHeaviside()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l00958">kaldi::UnitTestCuMatrixApplyHeaviside()</a>.</p>
<div class="fragment"><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;                                        {</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;    cuda_apply_heaviside(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;  {</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().ApplyHeaviside();</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;  }</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a95f20890747a5e1041269502faac50a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95f20890747a5e1041269502faac50a8">&#9670;&nbsp;</a></span>ApplyLog()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ApplyLog </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00632">632</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="online-nnet2-decodable_8cc_source.html#l00081">DecodableNnet2Online::ComputeForFrame()</a>, <a class="el" href="nnet2bin_2nnet-compute_8cc_source.html#l00027">main()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00200">RestrictedAttentionComponent::StoreStats()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00308">kaldi::TestCuMatrixCompObjfAndDeriv()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00143">kaldi::UnitTestCuMatrixApplyLog()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l02774">kaldi::UnitTestCuMatrixObjfDeriv()</a>.</p>
<div class="fragment"><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                                  {</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="preprocessor">  #if HAVE_CUDA == 1</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    CuTimer tim;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    cuda_apply_log(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="preprocessor">  #endif</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  {</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().ApplyLog();</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  }</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3241a69c779b7de9b3a5d26f81d4b504"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3241a69c779b7de9b3a5d26f81d4b504">&#9670;&nbsp;</a></span>ApplyLogSoftMaxPerRow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ApplyLogSoftMaxPerRow </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>src</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>LogSoftmax nonlinearity Y = LogSoftmax(X) : Yij = Xij - log(sum_k(e^Xik)), done to each row, with attention to avoiding overflow or underflow. </p>
<p>Supports in-place operation (i.e. this == &amp;src). </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01724">1724</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="_2nnet-component_8cc_source.html#l00949">LogSoftmaxComponent::Propagate()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00518">kaldi::TestCuMatrixLogSoftmax()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l02408">kaldi::UnitTestCuLogSoftmax()</a>.</p>
<div class="fragment"><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                                                                            {</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">SameDim</a>(*<span class="keyword">this</span>, src));</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    CuTimer tim;</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    <span class="keywordtype">size_t</span> dimBlock = <a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a>;</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <span class="keywordtype">size_t</span> dimGrid = src.num_rows_;</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    cuda_log_softmax_reduce(dimGrid, dimBlock,</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                            <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, src.data_, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), src.Stride());</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;  {</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    MatrixBase&lt;Real&gt; &amp;mat(this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>());</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    mat.CopyFromMat(src.Mat());</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> r = 0; r &lt; mat.NumRows(); r++) {</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;      mat.Row(r).ApplyLogSoftMax();</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    }</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;  }</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="group__matrix__funcs__io_html_ga07b147212efb08775c252cd4cc7453fe"><div class="ttname"><a href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">kaldi::SameDim</a></div><div class="ttdeci">bool SameDim(const MatrixBase&lt; Real &gt; &amp;M, const MatrixBase&lt; Real &gt; &amp;N)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l01065">kaldi-matrix.h:1065</a></div></div>
<div class="ttc" id="namespacekaldi_html_aac2c220416519a2b0a7ad822ee2ef972"><div class="ttname"><a href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">kaldi::MatrixIndexT</a></div><div class="ttdeci">int32 MatrixIndexT</div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00098">matrix-common.h:98</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a6dbdf9d0385c92d6d915b96eaf9ce99e"><div class="ttname"><a href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a></div><div class="ttdeci">#define CU1DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00063">cu-matrixdim.h:63</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a36c241f895530869d9e5a3c7bdedb25e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36c241f895530869d9e5a3c7bdedb25e">&#9670;&nbsp;</a></span>ApplyPow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ApplyPow </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>power</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02409">2409</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="_2nnet-component_8cc_source.html#l00664">TanhComponent::Backprop()</a>, <a class="el" href="cu-rand-speed-test_8cc_source.html#l00049">kaldi::MeanVariance()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00447">StatisticsExtractionComponent::Propagate()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00771">StatisticsPoolingComponent::Propagate()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00941">TanhComponent::StoreStats()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00353">kaldi::UnitTestCuMatrixApplyPow()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02623">kaldi::UnitTestCuMatrixSetRandn()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l02670">kaldi::UnitTestCuMatrixSetRandUniform()</a>.</p>
<div class="fragment"><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;                                            {</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;    cuda_apply_pow(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, power, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;  {</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().ApplyPow(power);</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;  }</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4ffea48966b732aa55c452781538cd1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ffea48966b732aa55c452781538cd1c">&#9670;&nbsp;</a></span>ApplyPowAbs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ApplyPowAbs </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>power</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>include_sign</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply power to the absolute value of each element. </p>
<p>If include_sign is true, the result will be multiplied with the sign of the input value. If the power is negative and the input to the power is zero, The output will be set zero. If include_sign is true, it will multiply the result by the sign of the input. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02427">2427</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="_2nnet-component_8cc_source.html#l00726">PowerComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00713">PowerComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00738">ClipGradientComponent::RepairGradients()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l00377">kaldi::UnitTestCuMatrixApplyPowAbs()</a>.</p>
<div class="fragment"><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;                                                                  {</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;    cuda_apply_pow_abs(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, power, include_sign, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;  {</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().ApplyPowAbs(power, include_sign);</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;  }</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6dfdeffc05cb0e5e4c4a7ed8edf42886"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6dfdeffc05cb0e5e4c4a7ed8edf42886">&#9670;&nbsp;</a></span>ApplySoftMaxPerRow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ApplySoftMaxPerRow </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>src</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Softmax nonlinearity Y = Softmax(X) : Yij = e^Xij / sum_k(e^Xik), done to each row, with attention to avoiding overflow or underflow. </p>
<p>Supports in-place operation (i.e. this == &amp;src). </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01701">1701</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="attention_8cc_source.html#l00097">kaldi::nnet3::attention::AttentionForward()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00900">SoftmaxComponent::Propagate()</a>, <a class="el" href="nnet-activation_8h_source.html#l00049">Softmax::PropagateFnc()</a>, <a class="el" href="nnet-activation_8h_source.html#l00081">HiddenSoftmax::PropagateFnc()</a>, <a class="el" href="nnet-activation_8h_source.html#l00160">BlockSoftmax::PropagateFnc()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00500">kaldi::TestCuMatrixSoftmax()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l02371">kaldi::UnitTestCuSoftmax()</a>.</p>
<div class="fragment"><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;                                                                         {</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">SameDim</a>(*<span class="keyword">this</span>, src));</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    CuTimer tim;</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    <span class="keywordtype">size_t</span> dimBlock = <a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a>;</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    <span class="keywordtype">size_t</span> dimGrid = src.num_rows_;</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    cuda_softmax_reduce(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, src.data_, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), src.Stride());</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;<span class="preprocessor">  #endif</span></div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  {</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    MatrixBase&lt;Real&gt; &amp;mat(this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>());</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    mat.CopyFromMat(src.Mat());</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> r = 0; r &lt; mat.NumRows(); r++) {</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;      mat.Row(r).ApplySoftMax();</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    }</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;  }</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="group__matrix__funcs__io_html_ga07b147212efb08775c252cd4cc7453fe"><div class="ttname"><a href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">kaldi::SameDim</a></div><div class="ttdeci">bool SameDim(const MatrixBase&lt; Real &gt; &amp;M, const MatrixBase&lt; Real &gt; &amp;N)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l01065">kaldi-matrix.h:1065</a></div></div>
<div class="ttc" id="namespacekaldi_html_aac2c220416519a2b0a7ad822ee2ef972"><div class="ttname"><a href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">kaldi::MatrixIndexT</a></div><div class="ttdeci">int32 MatrixIndexT</div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00098">matrix-common.h:98</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a6dbdf9d0385c92d6d915b96eaf9ce99e"><div class="ttname"><a href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a></div><div class="ttdeci">#define CU1DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00063">cu-matrixdim.h:63</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a81e9903967b7f6743057aaf7e2126309"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81e9903967b7f6743057aaf7e2126309">&#9670;&nbsp;</a></span>ApproxEqual()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> ApproxEqual </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>other</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfloat.html">float</a>&#160;</td>
          <td class="paramname"><em>tol</em> = <code>0.01</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>True if ((*this)-other).<a class="el" href="classkaldi_1_1CuMatrixBase.html#ac8bb668abdc6122cec89dc1f01f73554">FrobeniusNorm()</a> &lt;= tol * this-&gt;<a class="el" href="classkaldi_1_1CuMatrixBase.html#ac8bb668abdc6122cec89dc1f01f73554">FrobeniusNorm()</a> </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02120">2120</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8h_source.html#l00225">CuMatrixBase&lt; float &gt;::FrobeniusNorm()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00112">kaldi::UnitTestCuCholesky()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l02196">kaldi::UnitTestCuCopy()</a>.</p>
<div class="fragment"><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;                                                      {</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;  CuMatrix&lt;Real&gt; diff(*<span class="keyword">this</span>);</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;  diff.AddMat(-1.0, other);</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;  <span class="keywordflow">return</span> (diff.FrobeniusNorm() &lt;= tol * (*this).FrobeniusNorm());</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a22d93ed1d61d46b5b6f5eb27d3a748f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22d93ed1d61d46b5b6f5eb27d3a748f5">&#9670;&nbsp;</a></span>Cholesky()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Cholesky </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; *&#160;</td>
          <td class="paramname"><em>inv_cholesky</em> = <code>NULL</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function does sets *this to the Cholesky factor of *this (i.e. </p>
<p>the C satisfying *this = C C^T), and sets "inv_cholesky" (if supplied) to its inverse. *this is treated as a symmetric matrix but only the lower triangle is accessed. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01971">1971</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-tp-matrix_8cc_source.html#l00048">CuTpMatrix&lt; Real &gt;::Cholesky()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01971">CuMatrixBase&lt; float &gt;::Cholesky()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00652">kaldi::TestCuMatrixCholesky()</a>, <a class="el" href="cu-test_8cc_source.html#l00087">kaldi::UnitTestCholesky()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l00112">kaldi::UnitTestCuCholesky()</a>.</p>
<div class="fragment"><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;                                                                  {</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>());</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;  <span class="keyword">const</span> int32 block_size = 64;  <span class="comment">// We can tune this.</span></div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;  <span class="keywordtype">bool</span> have_gpu = CuDevice::Instantiate().Enabled();</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;  <span class="keywordtype">bool</span> have_gpu = <span class="keyword">false</span>;</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == 0) {</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;  }</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;  <span class="keywordflow">if</span> (inv_cholesky == NULL &amp;&amp; this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() &gt;= block_size * 2 &amp;&amp; have_gpu) {</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    <span class="comment">// Even if the user did not request the inverse Cholesky, for large enough</span></div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    <span class="comment">// matrices (on GPUs) it&#39;s going to be more efficient to compute it anyway</span></div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    <span class="comment">// as the recursion depends on it.</span></div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    CuMatrix&lt;Real&gt; inv(this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>());</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a22d93ed1d61d46b5b6f5eb27d3a748f5">Cholesky</a>(&amp;inv);</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;  }</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() &lt;= block_size || inv_cholesky == NULL || !have_gpu) {</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;    <span class="comment">// Don&#39;t recurse: compute the Cholesky (and inverse Cholesky, if requested)</span></div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    <span class="comment">// directly, on the CPu.</span></div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    int32 dim = this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>();</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a5bacd18e4e259c776cc1bc2b6a94e21e">CuSpMatrix&lt;Real&gt;</a> this_sp(dim, <a class="code" href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kUndefined</a>);</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    this_sp.CopyFromMat(*<span class="keyword">this</span>, <a class="code" href="namespacekaldi.html#a1e7deac168cc2b1002cc25ab544d0f90ab23bc41c203345e3a080b4f011f7aa40">kTakeLower</a>);</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    SpMatrix&lt;Real&gt; this_sp_cpu(this_sp);</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    TpMatrix&lt;Real&gt; C_cpu(dim);</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    C_cpu.Cholesky(this_sp_cpu);</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    CuTpMatrix&lt;Real&gt; C(C_cpu);</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a4df008a5298765a0a004c25b49bf62c0">CopyFromTp</a>(C);</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    <span class="keywordflow">if</span> (inv_cholesky != NULL) {</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;      C_cpu.Invert();  <span class="comment">// Get inverse Cholesky on CPU.</span></div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;      C.CopyFromTp(C_cpu);</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;      inv_cholesky-&gt;CopyFromTp(C); <span class="comment">// Copy inverse Cholesky from CPU.</span></div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    }</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;  }</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;  <span class="comment">// At this point, if none of the other cases apply, we recurse.</span></div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;  <span class="comment">// The selection of dim1 is a heuristic.  We could also just take half.</span></div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;  int32 tot_dim = this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>();</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;  int32 dim1;</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;  <span class="comment">// Break it up into a whole number of blocks, for better memory alignment.</span></div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;  <span class="comment">// The line below, setting dim1 can be decided on a heuristic basis: from</span></div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;  <span class="comment">// the point of view of correctness, it can really be any value</span></div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;  <span class="comment">// 0 &lt; dim1 &lt; tot_dim.</span></div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;  dim1 = block_size * std::max&lt;int32&gt;(1, tot_dim / (2 * block_size));</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;  int32 dim2 = tot_dim - dim1;</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;  <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac85bb7380dfaafef6fc9b91b508756e0">CuSubMatrix&lt;Real&gt;</a> this_11(*<span class="keyword">this</span>, 0, dim1, 0, dim1),</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;      this_12(*<span class="keyword">this</span>, 0, dim1, dim1, dim2),</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;      this_21(*<span class="keyword">this</span>, dim1, dim2, 0, dim1),</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;      this_22(*<span class="keyword">this</span>, dim1, dim2, dim1, dim2);</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;  <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac85bb7380dfaafef6fc9b91b508756e0">CuSubMatrix&lt;Real&gt;</a> inv_11(*inv_cholesky, 0, dim1, 0, dim1),</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;      inv_12(*inv_cholesky, 0, dim1, dim1, dim2),</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;      inv_21(*inv_cholesky, dim1, dim2, 0, dim1),</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;      inv_22(*inv_cholesky, dim1, dim2, dim1, dim2);</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;<span class="comment">    Here is the math on block-wise Cholesky.  We&#39;ll use a Matlab-like notation for blocks of a matrix,</span></div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;<span class="comment">    e.g. [ A B; C D ], and also for transposes, e.g. A&#39; is the transpose of A.</span></div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;<span class="comment">    Let A be the input matrix; we want to compute both its Cholesky L and its inverse Cholesky, which</span></div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;<span class="comment">    we&#39;ll call M.</span></div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;<span class="comment">    OK. let  L = [ L11 0; L21 L22 ] be the Cholesky factor of A.</span></div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;<span class="comment">    We have A = L L&#39; = [ L11 0; L21 L22 ] * [ L11&#39; L21&#39;; 0 L22&#39; ].  Multiplying it out,</span></div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;<span class="comment">    if A = [ A11 A12; A21 A22 ]; then</span></div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;<span class="comment">    A11 = L11 L11&#39;,  A21 = L21 L11&#39;, A22 = L21 L21&#39; + L22 L22&#39;, and A12 = A21&#39;.</span></div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;<span class="comment">    We also want an expression for the inverse of L (we call this M).</span></div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;<span class="comment">    If M = [ M11 0; M21 M22 ], then it&#39;s not hard to see that</span></div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;<span class="comment">    M11 = inv(L11), M22 = inv(L22).</span></div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;<span class="comment">    We can work out M21 as follows.  We know that [ L11 0; L21 L22 ] [ M11 0; M21 M22 ] = [ I 0; 0 I ].</span></div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;<span class="comment">    Considering the zero on the bottom of the rhs, we have: L21 M11 + L22 M21 = 0, which gives us:</span></div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;<span class="comment">    M21 = - L22^{-1} L21 M11 = - M22 L21 M11.</span></div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;<span class="comment">    Next, we want expressions for L21 and L22.  From the equation A21 = L21 L11&#39;, we have:</span></div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="comment">    L21 = A21 inv(L11&#39;) = A21 M11&#39;</span></div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;<span class="comment">    We can compute L22 and M22 recursively by doing Cholesky (and computing the inverse Cholesky)</span></div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;<span class="comment">    on the quantity T = (A22 - L21 L21&#39;).   [we give it the name T just for easy reference.]</span></div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;<span class="comment">    Computationally, we do this as follows:</span></div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;<span class="comment">    (1) Recurse to get L11 and M11.</span></div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;<span class="comment">    (2) Compute L21 = A21 M11&#39;</span></div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;<span class="comment">    (3) Compute T = A22 - L21 L21&#39;</span></div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;<span class="comment">    (4) Recurse on T to get L22 and M22.</span></div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;<span class="comment">    (5) Compute M21 = -M22 L21 M11.</span></div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;<span class="comment">    Next, we have to consider the in-place nature of the computation, since L overwrites A</span></div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;<span class="comment">    [M has its own storage, in &quot;inv_cholesky&quot;].</span></div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;<span class="comment">    We address this here:</span></div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;<span class="comment">    (1) is in-place [L11 replaces A11, M11 has its own storage].</span></div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;<span class="comment">    (2) L21 gets written where M21 belongs.</span></div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;<span class="comment">    (3) T replaces A22.</span></div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;<span class="comment">    (4) is in-place [L22 replaces T where A22 was, M22 has its own storage]</span></div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;<span class="comment">    (5):(a)  we first compute the transpose of (L21 M11) is done in the upper part of A/L,</span></div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;<span class="comment">    where A12 or L12 would be.  Define a temporary expression</span></div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;<span class="comment">    U = (L21 M11)&#39; = M11&#39; L21&#39;; this goes where A12 or L12 would be.</span></div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;<span class="comment">    (b) copy L21 to where it should be, in *this.</span></div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;<span class="comment">    (c) Compute M21 = -M22 U&#39;, in the correct place for M21.</span></div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;<span class="comment">    (d) zero L12 and M12.  */</span></div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;  <span class="comment">// (1) compute L11 and M11.</span></div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;  this_11.Cholesky(&amp;inv_11);</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;  <span class="comment">// (2) compute L21 = A21 M11&#39;.  For now it&#39;s in the &quot;wrong place&quot;, where M21 should be.</span></div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;  inv_21.AddMatMat(1.0, this_21, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, inv_11, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>, 0.0);</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;  <span class="comment">// (3) compute T = A22 - L21 L21&#39;.  Note: only the lower triangle of T will be valid, but</span></div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;  <span class="comment">//      that&#39;s OK because Cholesky will ignore the upper part.</span></div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;  this_22.SymAddMat2(-1.0, inv_21, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, 1.0);</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;  <span class="comment">// (4) Recurse to compute L22 and M22.</span></div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;  this_22.Cholesky(&amp;inv_22);</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;  <span class="comment">// (5)(a) compute U = M11&#39; L21&#39;.  We use the storage of this_12 for this.  Note that L21 is</span></div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;  <span class="comment">//        currently where M21 should be.</span></div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;  this_12.AddMatMat(1.0, inv_11, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>, inv_21, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>, 0.0);</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;  <span class="comment">// (5)(b) copy L21 to where it should be.</span></div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;  this_21.CopyFromMat(inv_21);</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;  <span class="comment">// (5)(c) compute M21 = -M22 U&#39;.</span></div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;  inv_21.AddMatMat(-1.0, inv_22, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, this_12, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>, 0.0);</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;  <span class="comment">// (5)(d) zero L12 and M12.</span></div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;  this_12.SetZero();</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;  inv_12.SetZero();</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;}</div><div class="ttc" id="namespacekaldi_html_ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126"><div class="ttname"><a href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kaldi::kUndefined</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00039">matrix-common.h:39</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a5bacd18e4e259c776cc1bc2b6a94e21e"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a5bacd18e4e259c776cc1bc2b6a94e21e">kaldi::CuMatrixBase::CuSpMatrix&lt; Real &gt;</a></div><div class="ttdeci">friend class CuSpMatrix&lt; Real &gt;</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00085">cu-matrix.h:85</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00033">matrix-common.h:33</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac85bb7380dfaafef6fc9b91b508756e0"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac85bb7380dfaafef6fc9b91b508756e0">kaldi::CuMatrixBase::CuSubMatrix&lt; Real &gt;</a></div><div class="ttdeci">friend class CuSubMatrix&lt; Real &gt;</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00089">cu-matrix.h:89</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00034">matrix-common.h:34</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a22d93ed1d61d46b5b6f5eb27d3a748f5"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a22d93ed1d61d46b5b6f5eb27d3a748f5">kaldi::CuMatrixBase::Cholesky</a></div><div class="ttdeci">void Cholesky(CuMatrixBase&lt; Real &gt; *inv_cholesky=NULL)</div><div class="ttdoc">This function does sets *this to the Cholesky factor of *this (i.e. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l01971">cu-matrix.cc:1971</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a4df008a5298765a0a004c25b49bf62c0"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a4df008a5298765a0a004c25b49bf62c0">kaldi::CuMatrixBase::CopyFromTp</a></div><div class="ttdeci">void CopyFromTp(const CuTpMatrix&lt; OtherReal &gt; &amp;M, MatrixTransposeType trans=kNoTrans)</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l00277">cu-matrix.cc:277</a></div></div>
<div class="ttc" id="namespacekaldi_html_a1e7deac168cc2b1002cc25ab544d0f90ab23bc41c203345e3a080b4f011f7aa40"><div class="ttname"><a href="namespacekaldi.html#a1e7deac168cc2b1002cc25ab544d0f90ab23bc41c203345e3a080b4f011f7aa40">kaldi::kTakeLower</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00050">matrix-common.h:50</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9e9d059d3ae53886b856791e6c522665"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e9d059d3ae53886b856791e6c522665">&#9670;&nbsp;</a></span>ColRange()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1CuSubMatrix.html">CuSubMatrix</a>&lt;Real&gt; ColRange </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a>&#160;</td>
          <td class="paramname"><em>col_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a>&#160;</td>
          <td class="paramname"><em>num_cols</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00608">608</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-general-component_8cc_source.html#l00476">StatisticsExtractionComponent::Backprop()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00820">StatisticsPoolingComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l04318">MaxpoolingComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01766">BlockAffineComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03966">Convolutional1dComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l04355">ConvolutionComponent::Backprop()</a>, <a class="el" href="nnet-max-pooling-component_8h_source.html#l00121">MaxPoolingComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-average-pooling-component_8h_source.html#l00122">AveragePoolingComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-average-pooling-2d-component_8h_source.html#l00151">AveragePooling2DComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-max-pooling-2d-component_8h_source.html#l00153">MaxPooling2DComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-activation_8h_source.html#l00174">BlockSoftmax::BackpropagateFnc()</a>, <a class="el" href="nnet-parallel-component_8h_source.html#l00264">ParallelComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-sentence-averaging-component_8h_source.html#l00267">SentenceAveragingComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-convolutional-2d-component_8h_source.html#l00324">Convolutional2DComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-multibasis-component_8h_source.html#l00338">MultiBasisComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-convolutional-component_8h_source.html#l00368">ConvolutionalComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-blstm-projected_8h_source.html#l00720">BlstmProjected::BackpropagateFnc()</a>, <a class="el" href="nnet-loss_8cc_source.html#l00365">MultiTaskLoss::Eval()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00447">StatisticsExtractionComponent::Propagate()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00771">StatisticsPoolingComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l04295">MaxpoolingComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01731">BlockAffineComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03819">Convolutional1dComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l04204">ConvolutionComponent::Propagate()</a>, <a class="el" href="nnet-max-pooling-component_8h_source.html#l00103">MaxPoolingComponent::PropagateFnc()</a>, <a class="el" href="nnet-average-pooling-component_8h_source.html#l00103">AveragePoolingComponent::PropagateFnc()</a>, <a class="el" href="nnet-average-pooling-2d-component_8h_source.html#l00126">AveragePooling2DComponent::PropagateFnc()</a>, <a class="el" href="nnet-max-pooling-2d-component_8h_source.html#l00127">MaxPooling2DComponent::PropagateFnc()</a>, <a class="el" href="nnet-activation_8h_source.html#l00160">BlockSoftmax::PropagateFnc()</a>, <a class="el" href="nnet-frame-pooling-component_8h_source.html#l00216">FramePoolingComponent::PropagateFnc()</a>, <a class="el" href="nnet-parallel-component_8h_source.html#l00241">ParallelComponent::PropagateFnc()</a>, <a class="el" href="nnet-sentence-averaging-component_8h_source.html#l00248">SentenceAveragingComponent::PropagateFnc()</a>, <a class="el" href="nnet-convolutional-component_8h_source.html#l00258">ConvolutionalComponent::PropagateFnc()</a>, <a class="el" href="nnet-convolutional-2d-component_8h_source.html#l00259">Convolutional2DComponent::PropagateFnc()</a>, <a class="el" href="nnet-multibasis-component_8h_source.html#l00298">MultiBasisComponent::PropagateFnc()</a>, <a class="el" href="nnet-blstm-projected_8h_source.html#l00532">BlstmProjected::PropagateFnc()</a>, <a class="el" href="cu-math-test_8cc_source.html#l00213">kaldi::UnitTestLstmNonlinearity()</a>, <a class="el" href="nnet-frame-pooling-component_8h_source.html#l00241">FramePoolingComponent::Update()</a>, <a class="el" href="nnet-sentence-averaging-component_8h_source.html#l00277">SentenceAveragingComponent::Update()</a>, <a class="el" href="nnet-convolutional-component_8h_source.html#l00400">ConvolutionalComponent::Update()</a>, <a class="el" href="nnet-convolutional-2d-component_8h_source.html#l00415">Convolutional2DComponent::Update()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01594">NaturalGradientRepeatedAffineComponent::Update()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l04162">Convolutional1dComponent::Update()</a>, and <a class="el" href="nnet-simple-component_8cc_source.html#l04422">ConvolutionComponent::Update()</a>.</p>
<div class="fragment"><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                                                                       {</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac85bb7380dfaafef6fc9b91b508756e0">CuSubMatrix&lt;Real&gt;</a>(*<span class="keyword">this</span>, 0, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, col_offset, num_cols);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  }</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac85bb7380dfaafef6fc9b91b508756e0"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac85bb7380dfaafef6fc9b91b508756e0">kaldi::CuMatrixBase::CuSubMatrix&lt; Real &gt;</a></div><div class="ttdeci">friend class CuSubMatrix&lt; Real &gt;</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00089">cu-matrix.h:89</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a85585428bff19297f65515617c79f833"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85585428bff19297f65515617c79f833">&#9670;&nbsp;</a></span>CopyColFromVec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CopyColFromVec </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a>&#160;</td>
          <td class="paramname"><em>col</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copy vector into specific column of matrix. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02388">2388</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-math_8cc_source.html#l00280">kaldi::cu::NormalizePerRow()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00447">StatisticsExtractionComponent::Propagate()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l01412">DropoutMaskComponent::Propagate()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01594">NaturalGradientRepeatedAffineComponent::Update()</a>, and <a class="el" href="nnet-convolutional-component_8cc_source.html#l00353">TimeHeightConvolutionComponent::UpdateNaturalGradient()</a>.</p>
<div class="fragment"><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;                                                                {</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(v.Dim() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> &amp;&amp;</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;               <span class="keyword">static_cast&lt;</span><a class="code" href="namespacekaldi.html#a40ea1f7a1695876e905aba52662137af">UnsignedMatrixIndexT</a><span class="keyword">&gt;</span>(col) &lt;</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;               static_cast&lt;UnsignedMatrixIndexT&gt;(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>));</div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;    cublas_copy(GetCublasHandle(),</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;                v.Dim(), v.Data(), 1,</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;                this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a> + col, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">stride_</a>);</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;  {</div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().CopyColFromVec(v.Vec(), col);</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;  }</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="namespacekaldi_html_a40ea1f7a1695876e905aba52662137af"><div class="ttname"><a href="namespacekaldi.html#a40ea1f7a1695876e905aba52662137af">kaldi::UnsignedMatrixIndexT</a></div><div class="ttdeci">uint32 UnsignedMatrixIndexT</div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00100">matrix-common.h:100</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a7cb3ee02262893923716e6764439f359"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">kaldi::CuMatrixBase::stride_</a></div><div class="ttdeci">MatrixIndexT stride_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00730">cu-matrix.h:730</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a100c3bb9789f8626e5c92b8757933a11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a100c3bb9789f8626e5c92b8757933a11">&#9670;&nbsp;</a></span>CopyCols()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CopyCols </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>indexes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copies column r from column indexes[r] of src. </p>
<p>As a special case, if indexes[i] == -1, sets column i to zero indexes.size() must equal this-&gt;<a class="el" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols()</a>, and src.NumRows() must equal this.NumRows() </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02623">2623</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="_2nnet-component_8cc_source.html#l02451">SumGroupComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l02350">PermuteComponent::Backprop()</a>, <a class="el" href="convolution_8cc_source.html#l00763">kaldi::nnet3::time_height_convolution::ConvolveBackwardParamsInternal()</a>, <a class="el" href="convolution_8cc_source.html#l00448">kaldi::nnet3::time_height_convolution::ConvolveForwardInternal()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l04157">ConvolutionComponent::InputToInputPatches()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l04678">MaxpoolingComponent::InputToInputPatches()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l02333">PermuteComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03819">Convolutional1dComponent::Propagate()</a>, and <a class="el" href="_2nnet-component_8cc_source.html#l04162">Convolutional1dComponent::Update()</a>.</p>
<div class="fragment"><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;                                                                            {</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(indices.Dim() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>());</div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == src.NumRows());</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;    cuda_copy_cols(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, src.Data(), indices.Data(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), src.Stride());</div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;  {</div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().CopyCols(src.Mat(), indices.Data());</div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;  }</div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a104a0d1e35056c8efeb5b9ff3e0cb7e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a104a0d1e35056c8efeb5b9ff3e0cb7e7">&#9670;&nbsp;</a></span>CopyColsFromVec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CopyColsFromVec </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copies vector into matrix, column-by-column. </p>
<p>Note that rv.Dim() must either equal <a class="el" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1" title="Dimensions. ">NumRows()</a>*NumCols() or <a class="el" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1" title="Dimensions. ">NumRows()</a>; this has two modes of operation. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02350">2350</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-simple-component_8cc_source.html#l00138">DropoutComponent::Propagate()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l00426">kaldi::UnitTestCuMatrixCopyColsFromVec()</a>.</p>
<div class="fragment"><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;                                                                     {</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;    <span class="keywordflow">if</span> (rv.Dim() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> * <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>) {</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;      <span class="comment">// treat rv as a matrix of the size (num_cols x num_rows_)</span></div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;      <span class="comment">// and use transposed copy to fill *this</span></div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;      <span class="comment">// see CuMatrixBase&lt;Real&gt;::CopyFromMat() for more detail of the impl</span></div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;      <a class="code" href="structMatrixDim__.html">MatrixDim</a> rv_dim = { <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, num_rows_ };</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;      <span class="keyword">const</span> int32 warpSize = 32;</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;      dim3 dimBlock(warpSize, <a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a> / warpSize);</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;      dim3 dimGrid(n_blocks(rv_dim.<a class="code" href="structMatrixDim__.html#a7eed2864b9fbd1149a08816e06641c67">cols</a>, warpSize),</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;                   n_blocks(rv_dim.<a class="code" href="structMatrixDim__.html#a9b2df668dbab2cda2e88da723d3065cf">rows</a>, warpSize));</div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;      cuda_copy_from_mat_trans(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, rv.Data(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(),</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;                               rv_dim);</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;      CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rv.Dim() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>) {</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;      <span class="comment">// use 2D block (8x32) and large enough grid to cover matrix *this</span></div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;      <span class="comment">// dimBlock.x need to be at least warpSize for coalesced memory access.</span></div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;      <span class="keyword">const</span> int32 warpSize = 32;</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;      dim3 dimBlock(warpSize, <a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a> / warpSize);</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;      dim3 dimGrid(n_blocks(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>, dimBlock.x),</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;                   n_blocks(num_rows_, dimBlock.y));</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;      cuda_copy_cols_from_vec(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#aa5a0f4f5fe999cc628776f18ef9138b3">Data</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), rv.Data());</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;      CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a>&lt;&lt; <span class="stringliteral">&quot;Wrong sized arguments&quot;</span>;</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;    }</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;  {</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().CopyColsFromVec(rv.Vec());</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;  }</div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="structMatrixDim___html_a9b2df668dbab2cda2e88da723d3065cf"><div class="ttname"><a href="structMatrixDim__.html#a9b2df668dbab2cda2e88da723d3065cf">MatrixDim_::rows</a></div><div class="ttdeci">int32_cuda rows</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00053">cu-matrixdim.h:53</a></div></div>
<div class="ttc" id="structMatrixDim___html"><div class="ttname"><a href="structMatrixDim__.html">MatrixDim_</a></div><div class="ttdoc">Structure containing size of the matrix plus stride. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00052">cu-matrixdim.h:52</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00126">kaldi-error.h:126</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a6dbdf9d0385c92d6d915b96eaf9ce99e"><div class="ttname"><a href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a></div><div class="ttdeci">#define CU1DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00063">cu-matrixdim.h:63</a></div></div>
<div class="ttc" id="structMatrixDim___html_a7eed2864b9fbd1149a08816e06641c67"><div class="ttname"><a href="structMatrixDim__.html#a7eed2864b9fbd1149a08816e06641c67">MatrixDim_::cols</a></div><div class="ttdeci">int32_cuda cols</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00054">cu-matrixdim.h:54</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_aa5a0f4f5fe999cc628776f18ef9138b3"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#aa5a0f4f5fe999cc628776f18ef9138b3">kaldi::CuMatrixBase::Data</a></div><div class="ttdeci">const Real * Data() const</div><div class="ttdoc">Return data pointer (const). </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00689">cu-matrix.h:689</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4f7132192b26f99bd804c02bb99d3aa3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f7132192b26f99bd804c02bb99d3aa3">&#9670;&nbsp;</a></span>CopyFromBlock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CopyFromBlock </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuBlockMatrix.html">CuBlockMatrix</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>trans</em> = <code><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00160">160</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8h_source.html#l00584">CuMatrixBase&lt; float &gt;::AddMatTp()</a>.</p>
<div class="fragment"><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                                                                  {</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#ae57e5aca5db002545e4b9335c8d9dbfa">SetZero</a>();</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keywordflow">if</span> (trans == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>) {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == B.NumRows() &amp;&amp; <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>() == B.NumCols());</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    int32 row_offset = 0, col_offset = 0;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">for</span> (int32 b = 0; b &lt; B.NumBlocks(); b++) {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="keyword">const</span> CuMatrixBase&lt;Real&gt; &amp;block = B.Block(b);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      int32 num_rows = block.NumRows(), num_cols = block.NumCols();</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac85bb7380dfaafef6fc9b91b508756e0">CuSubMatrix&lt;Real&gt;</a> this_block(*<span class="keyword">this</span>, row_offset, num_rows,</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                                   col_offset, num_cols);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      this_block.CopyFromMat(block);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      row_offset += num_rows;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      col_offset += num_cols;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    }</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(row_offset == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() &amp;&amp; col_offset == <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>());</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == B.NumCols() &amp;&amp; <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>() == B.NumRows());</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    int32 row_offset = 0, col_offset = 0;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">for</span> (int32 b = 0; b &lt; B.NumBlocks(); b++) {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keyword">const</span> CuMatrixBase&lt;Real&gt; &amp;block = B.Block(b);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      int32 num_rows = block.NumCols(), num_cols = block.NumRows();</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac85bb7380dfaafef6fc9b91b508756e0">CuSubMatrix&lt;Real&gt;</a> this_block(*<span class="keyword">this</span>, row_offset, num_rows,</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                                   col_offset, num_cols);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      this_block.CopyFromMat(block, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      row_offset += num_rows;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      col_offset += num_cols;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    }</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(row_offset == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() &amp;&amp; col_offset == <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>());</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;}</div><div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00033">matrix-common.h:33</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac85bb7380dfaafef6fc9b91b508756e0"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac85bb7380dfaafef6fc9b91b508756e0">kaldi::CuMatrixBase::CuSubMatrix&lt; Real &gt;</a></div><div class="ttdeci">friend class CuSubMatrix&lt; Real &gt;</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00089">cu-matrix.h:89</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ae57e5aca5db002545e4b9335c8d9dbfa"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ae57e5aca5db002545e4b9335c8d9dbfa">kaldi::CuMatrixBase::SetZero</a></div><div class="ttdeci">void SetZero()</div><div class="ttdoc">Math operations, some calling kernels. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l00476">cu-matrix.cc:476</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00034">matrix-common.h:34</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a025ce20bb4a818392993e8c36fa9ac3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a025ce20bb4a818392993e8c36fa9ac3b">&#9670;&nbsp;</a></span>CopyFromGeneralMat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CopyFromGeneralMat </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1GeneralMatrix.html">GeneralMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>trans</em> = <code><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l03063">3063</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00658">NnetComputer::AcceptInputs()</a>, <a class="el" href="nnet-training_8cc_source.html#l00370">kaldi::nnet3::ComputeObjectiveFunction()</a>, and <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>.</p>
<div class="fragment"><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;                                                                       {</div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;  <span class="keywordflow">switch</span> (src.Type()) {</div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__matrix__group.html#gga1b44c0ec7cf5c76c910fd41756787be3af872badd576ccf234e1bccf54f263863">kFullMatrix</a>: {</div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;      <span class="keyword">const</span> Matrix&lt;BaseFloat&gt; &amp;src_full_mat = src.GetFullMatrix();</div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;      this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a79817f1cbd9d8478d4137d6dd815a584">CopyFromMat</a>(src_full_mat, trans);</div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;    }</div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__matrix__group.html#gga1b44c0ec7cf5c76c910fd41756787be3a87ea862fefb9f41cf20a2de202b4a9f9">kCompressedMatrix</a>: {</div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;      Matrix&lt;BaseFloat&gt; mat;</div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;      src.GetMatrix(&amp;mat);</div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;      this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a79817f1cbd9d8478d4137d6dd815a584">CopyFromMat</a>(mat, trans);</div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;    }</div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__matrix__group.html#gga1b44c0ec7cf5c76c910fd41756787be3aef253b40b2456ff5af4ad398301f8aef">kSparseMatrix</a>: {</div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;      <span class="keyword">const</span> SparseMatrix&lt;BaseFloat&gt; &amp;smat = src.GetSparseMatrix();</div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;      <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;        <span class="comment">// only take this branch if we&#39;re actually using CUDA, or it would</span></div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;        <span class="comment">// entail a wasteful copy of the sparse matrix.</span></div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;        CuSparseMatrix&lt;BaseFloat&gt; cu_smat(smat);</div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;        cu_smat.CopyToMat(<span class="keyword">this</span>, trans);</div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;      }</div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;      smat.CopyToMat(&amp;(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>()), trans);</div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;    }</div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Invalid GeneralMatrix type.&quot;</span>;</div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;  }</div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a79817f1cbd9d8478d4137d6dd815a584"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a79817f1cbd9d8478d4137d6dd815a584">kaldi::CuMatrixBase::CopyFromMat</a></div><div class="ttdeci">void CopyFromMat(const MatrixBase&lt; OtherReal &gt; &amp;src, MatrixTransposeType trans=kNoTrans)</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l00339">cu-matrix.cc:339</a></div></div>
<div class="ttc" id="group__matrix__group_html_gga1b44c0ec7cf5c76c910fd41756787be3af872badd576ccf234e1bccf54f263863"><div class="ttname"><a href="group__matrix__group.html#gga1b44c0ec7cf5c76c910fd41756787be3af872badd576ccf234e1bccf54f263863">kaldi::kFullMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="sparse-matrix_8h_source.html#l00272">sparse-matrix.h:272</a></div></div>
<div class="ttc" id="group__matrix__group_html_gga1b44c0ec7cf5c76c910fd41756787be3aef253b40b2456ff5af4ad398301f8aef"><div class="ttname"><a href="group__matrix__group.html#gga1b44c0ec7cf5c76c910fd41756787be3aef253b40b2456ff5af4ad398301f8aef">kaldi::kSparseMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="sparse-matrix_8h_source.html#l00274">sparse-matrix.h:274</a></div></div>
<div class="ttc" id="group__matrix__group_html_gga1b44c0ec7cf5c76c910fd41756787be3a87ea862fefb9f41cf20a2de202b4a9f9"><div class="ttname"><a href="group__matrix__group.html#gga1b44c0ec7cf5c76c910fd41756787be3a87ea862fefb9f41cf20a2de202b4a9f9">kaldi::kCompressedMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="sparse-matrix_8h_source.html#l00273">sparse-matrix.h:273</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00126">kaldi-error.h:126</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a79817f1cbd9d8478d4137d6dd815a584"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79817f1cbd9d8478d4137d6dd815a584">&#9670;&nbsp;</a></span>CopyFromMat() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CopyFromMat </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; <a class="el" href="classkaldi_1_1OtherReal.html">OtherReal</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>trans</em> = <code><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00339">339</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="attention_8cc_source.html#l00097">kaldi::nnet3::attention::AttentionForward()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00273">ElementwiseProductComponent::Backprop()</a>, <a class="el" href="nnet-normalize-component_8cc_source.html#l00466">BatchNormComponent::Backprop()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l01098">BackpropTruncationComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00664">TanhComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00726">PowerComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00778">RectifiedLinearComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00845">ScaleComponent::Backprop()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l01578">GeneralDropoutComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l03677">FixedScaleComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l03751">FixedBiasComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00443">NoOpComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00675">ClipGradientComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02037">PerElementScaleComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02210">PerElementOffsetComponent::Backprop()</a>, <a class="el" href="nnet-activation_8h_source.html#l00055">Softmax::BackpropagateFnc()</a>, <a class="el" href="nnet-activation_8h_source.html#l00087">HiddenSoftmax::BackpropagateFnc()</a>, <a class="el" href="nnet-activation_8h_source.html#l00174">BlockSoftmax::BackpropagateFnc()</a>, <a class="el" href="nnet-parallel-component_8h_source.html#l00264">ParallelComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-sentence-averaging-component_8h_source.html#l00267">SentenceAveragingComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-various_8h_source.html#l00273">LengthNormComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-multibasis-component_8h_source.html#l00338">MultiBasisComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-activation_8h_source.html#l00342">Dropout::BackpropagateFnc()</a>, <a class="el" href="nnet-various_8h_source.html#l00373">AddShift::BackpropagateFnc()</a>, <a class="el" href="nnet-various_8h_source.html#l00486">Rescale::BackpropagateFnc()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02521">ScaleAndOffsetComponent::BackpropInternal()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01658">BlockAffineComponent::BlockAffineComponent()</a>, <a class="el" href="nnet-compute-online_8cc_source.html#l00035">NnetOnlineComputer::Compute()</a>, <a class="el" href="nnet-utils_8cc_source.html#l01022">kaldi::nnet3::ConstrainOrthonormal()</a>, <a class="el" href="convolution-test_8cc_source.html#l00218">kaldi::nnet3::time_height_convolution::ConvolveForwardSimple()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00160">CuMatrixBase&lt; float &gt;::CopyFromBlock()</a>, <a class="el" href="cu-block-matrix_8cc_source.html#l00296">CuBlockMatrix&lt; Real &gt;::CopyFromMat()</a>, <a class="el" href="cu-sparse-matrix_8cc_source.html#l00582">GeneralMatrix::CopyToMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01887">CuMatrixBase&lt; float &gt;::DiffLogSoftmaxPerRow()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01852">CuMatrixBase&lt; float &gt;::DiffSoftmaxPerRow()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00210">NnetComputer::ExecuteCommand()</a>, <a class="el" href="rescale-nnet_8cc_source.html#l00056">NnetRescaler::FormatInput()</a>, <a class="el" href="attention_8cc_source.html#l00032">kaldi::nnet3::attention::GetAttentionDotProducts()</a>, <a class="el" href="nnet-train-mmi-sequential_8cc_source.html#l00085">main()</a>, <a class="el" href="nnet2_2nnet-compute_8cc_source.html#l00160">kaldi::nnet2::NnetComputation()</a>, <a class="el" href="cu-math_8cc_source.html#l00280">kaldi::cu::NormalizePerRow()</a>, <a class="el" href="cu-matrix_8h_source.html#l00785">CuMatrix&lt; float &gt;::operator=()</a>, <a class="el" href="nnet-precondition_8cc_source.html#l00026">kaldi::nnet2::PreconditionDirections()</a>, <a class="el" href="nnet-precondition-online-test_8cc_source.html#l00067">OnlinePreconditionerSimple::PreconditionDirections()</a>, <a class="el" href="natural-gradient-online-test_8cc_source.html#l00067">OnlineNaturalGradientSimple::PreconditionDirections()</a>, <a class="el" href="nnet-precondition_8cc_source.html#l00138">kaldi::nnet2::PreconditionDirectionsAlphaRescaled()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00138">DropoutComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00255">ElementwiseProductComponent::Propagate()</a>, <a class="el" href="nnet-normalize-component_8cc_source.html#l00400">BatchNormComponent::Propagate()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l01087">BackpropTruncationComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00713">PowerComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00769">RectifiedLinearComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00837">ScaleComponent::Propagate()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l01545">GeneralDropoutComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l02847">SpliceMaxComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00436">NoOpComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00666">ClipGradientComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03368">FixedScaleComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02021">PerElementScaleComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03438">FixedBiasComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02191">PerElementOffsetComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03619">AdditiveNoiseComponent::Propagate()</a>, <a class="el" href="nnet-kl-hmm_8h_source.html#l00050">KlHmm::PropagateFnc()</a>, <a class="el" href="nnet-parallel-component_8h_source.html#l00241">ParallelComponent::PropagateFnc()</a>, <a class="el" href="nnet-various_8h_source.html#l00256">LengthNormComponent::PropagateFnc()</a>, <a class="el" href="nnet-activation_8h_source.html#l00329">Dropout::PropagateFnc()</a>, <a class="el" href="nnet-lstm-projected_8h_source.html#l00365">LstmProjected::PropagateFnc()</a>, <a class="el" href="nnet-various_8h_source.html#l00366">AddShift::PropagateFnc()</a>, <a class="el" href="nnet-various_8h_source.html#l00479">Rescale::PropagateFnc()</a>, <a class="el" href="nnet-blstm-projected_8h_source.html#l00532">BlstmProjected::PropagateFnc()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02461">ScaleAndOffsetComponent::PropagateInternal()</a>, <a class="el" href="nnet-utils_8h_source.html#l00164">kaldi::nnet1::RandGauss()</a>, <a class="el" href="cu-rand_8cc_source.html#l00113">CuRand&lt; float &gt;::RandGaussian()</a>, <a class="el" href="cu-rand_8cc_source.html#l00060">CuRand&lt; float &gt;::RandUniform()</a>, <a class="el" href="nnet-utils_8h_source.html#l00188">kaldi::nnet1::RandUniform()</a>, <a class="el" href="nnet-precondition-online_8cc_source.html#l00184">OnlinePreconditioner::ReorthogonalizeXt1()</a>, <a class="el" href="natural-gradient-online_8cc_source.html#l00200">OnlineNaturalGradient::ReorthogonalizeXt1()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00368">kaldi::TestCuFindRowMaxId()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00148">kaldi::TestCuMatrixTransposeCross()</a>, <a class="el" href="_2nnet-component-test_8cc_source.html#l00210">kaldi::nnet3::TestSimpleComponentPropagateProperties()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00286">kaldi::TestSymInvertPosDef()</a>, <a class="el" href="cu-test_8cc_source.html#l00151">kaldi::UnitInvert()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02515">kaldi::UnitTestCheck()</a>, <a class="el" href="cu-test_8cc_source.html#l00087">kaldi::UnitTestCholesky()</a>, <a class="el" href="cu-test_8cc_source.html#l00216">kaldi::UnitTestConstructor()</a>, <a class="el" href="cu-test_8cc_source.html#l00294">kaldi::UnitTestCopyFromMat()</a>, <a class="el" href="cu-test_8cc_source.html#l00242">kaldi::UnitTestCopySp()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02196">kaldi::UnitTestCuCopy()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02326">kaldi::UnitTestCuDiffLogSoftmax()</a>, <a class="el" href="cu-math-test_8cc_source.html#l00549">kaldi::UnitTestCuDiffNormalizePerRow()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02252">kaldi::UnitTestCuDiffSigmoid()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02282">kaldi::UnitTestCuDiffSoftmax()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02589">kaldi::UnitTestCuDiffTanh()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02479">kaldi::UnitTestCuDiffXent()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02445">kaldi::UnitTestCuFindRowMaxId()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02408">kaldi::UnitTestCuLogSoftmax()</a>, <a class="el" href="cu-math-test_8cc_source.html#l00479">kaldi::UnitTestCuMathNormalizePerRow()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01368">kaldi::UnitTestCuMatrixAddMat()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01274">kaldi::UnitTestCuMatrixAddMatDiagVec()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01661">kaldi::UnitTestCuMatrixAddMatMat()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01716">kaldi::UnitTestCuMatrixAddMatMatBatched()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01302">kaldi::UnitTestCuMatrixAddMatMatElements()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01539">kaldi::UnitTestCuMatrixAddVecToCols()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01562">kaldi::UnitTestCuMatrixAddVecToRows()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00640">kaldi::UnitTestCuMatrixCopyCross()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00662">kaldi::UnitTestCuMatrixCopyCross2()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01819">kaldi::UnitTestCuMatrixCopyFromMat()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01165">kaldi::UnitTestCuMatrixDiffGroupPnorm()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01022">kaldi::UnitTestCuMatrixDivElements()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01343">kaldi::UnitTestCuMatrixDivRowsVec()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01205">kaldi::UnitTestCuMatrixGroupMaxDeriv()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02094">kaldi::UnitTestCuMatrixInvertElements()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01047">kaldi::UnitTestCuMatrixMax()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01068">kaldi::UnitTestCuMatrixMin()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01091">kaldi::UnitTestCuMatrixMulColsVec()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00997">kaldi::UnitTestCuMatrixMulElements()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01139">kaldi::UnitTestCuMatrixMulRowsGroupMat()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01114">kaldi::UnitTestCuMatrixMulRowsVec()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02225">kaldi::UnitTestCuSigmoid()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02371">kaldi::UnitTestCuSoftmax()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02570">kaldi::UnitTestCuTanh()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02001">kaldi::UnitTestCuVectorAddColSumMat()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02049">kaldi::UnitTestCuVectorAddColSumMatLarge()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01942">kaldi::UnitTestCuVectorAddRowSumMat()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01973">kaldi::UnitTestCuVectorAddRowSumMatLarge()</a>, <a class="el" href="cu-test_8cc_source.html#l00185">kaldi::UnitTestInvert()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02529">kaldi::UnitTestSwapCu2Cu()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02550">kaldi::UnitTestSwapCu2M()</a>, and <a class="el" href="_2nnet-component_8cc_source.html#l02253">BlockAffineComponentPreconditioned::Update()</a>.</p>
<div class="fragment"><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                                                                {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  CuMatrix&lt;OtherReal&gt; temp(src);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a79817f1cbd9d8478d4137d6dd815a584">CopyFromMat</a>(temp, trans);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a79817f1cbd9d8478d4137d6dd815a584"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a79817f1cbd9d8478d4137d6dd815a584">kaldi::CuMatrixBase::CopyFromMat</a></div><div class="ttdeci">void CopyFromMat(const MatrixBase&lt; OtherReal &gt; &amp;src, MatrixTransposeType trans=kNoTrans)</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l00339">cu-matrix.cc:339</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6dff75e1b716efce7cf78911cf420e5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6dff75e1b716efce7cf78911cf420e5e">&#9670;&nbsp;</a></span>CopyFromMat() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CopyFromMat </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>trans</em> = <code><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00311">311</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                                                                {</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordflow">if</span> (trans == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>) {</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(src.NumRows() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> &amp;&amp; src.NumCols() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      CuTimer tim;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> dst_pitch = <a class="code" href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">stride_</a>*<span class="keyword">sizeof</span>(Real);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> src_pitch = src.Stride()*<span class="keyword">sizeof</span>(Real);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> width = src.NumCols()*<span class="keyword">sizeof</span>(Real);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      CU_SAFE_CALL(cudaMemcpy2D(<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, dst_pitch, src.Data(), src_pitch,</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                                width, src.NumRows(), cudaMemcpyHostToDevice));</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      CuDevice::Instantiate().AccuProfile(<span class="stringliteral">&quot;CuMatrixBase::CopyFromMat(from CPU)&quot;</span>, tim);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      CuMatrix&lt;Real&gt; trans_mat(src); <span class="comment">// Do the transpose on the GPU board.</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a79817f1cbd9d8478d4137d6dd815a584">CopyFromMat</a>(trans_mat, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    }</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().CopyFromMat(src, trans);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a79817f1cbd9d8478d4137d6dd815a584"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a79817f1cbd9d8478d4137d6dd815a584">kaldi::CuMatrixBase::CopyFromMat</a></div><div class="ttdeci">void CopyFromMat(const MatrixBase&lt; OtherReal &gt; &amp;src, MatrixTransposeType trans=kNoTrans)</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l00339">cu-matrix.cc:339</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a7cb3ee02262893923716e6764439f359"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">kaldi::CuMatrixBase::stride_</a></div><div class="ttdeci">MatrixIndexT stride_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00730">cu-matrix.h:730</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00033">matrix-common.h:33</a></div></div>
<div class="ttc" id="namespacekaldi_html_aac2c220416519a2b0a7ad822ee2ef972"><div class="ttname"><a href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">kaldi::MatrixIndexT</a></div><div class="ttdeci">int32 MatrixIndexT</div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00098">matrix-common.h:98</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00034">matrix-common.h:34</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abe90d984db20e190d2817357ba300bf1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe90d984db20e190d2817357ba300bf1">&#9670;&nbsp;</a></span>CopyFromMat() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CopyFromMat </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="classkaldi_1_1OtherReal.html">OtherReal</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>trans</em> = <code><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00207">207</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                                                                {</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(Real) == <span class="keyword">sizeof</span>(OtherReal) &amp;&amp;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      static_cast&lt;const void*&gt;(M.Data()) ==</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      static_cast&lt;const void*&gt;(this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#aa5a0f4f5fe999cc628776f18ef9138b3">Data</a>())) {</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">if</span> (M.Data() == NULL)</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">// CopyFromMat called on same data.  Nothing to do (except sanity checks)</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(trans == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a> &amp;&amp; M.NumRows() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() &amp;&amp;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                 M.NumCols() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>() &amp;&amp; M.Stride() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a180e10f97fa838f9c1ae125ba164dd77">Stride</a>());</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  }</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">if</span> (trans == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>) {</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(M.NumRows() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> &amp;&amp; M.NumCols() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(M.NumCols() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> &amp;&amp; M.NumRows() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">if</span> (M.num_rows_ == 0) <span class="keywordflow">return</span>; <span class="comment">// Nothing to do.</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    CuTimer tim;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(Real) == <span class="keyword">sizeof</span>(OtherReal) &amp;&amp; trans == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a> ) {</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> dst_pitch = <a class="code" href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">stride_</a> * <span class="keyword">sizeof</span>(Real);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> src_pitch = M.Stride() * <span class="keyword">sizeof</span>(Real);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> width = M.NumCols() * <span class="keyword">sizeof</span>(Real);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      CU_SAFE_CALL(cudaMemcpy2D(<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, dst_pitch, M.data_, src_pitch,</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                                width, M.num_rows_, cudaMemcpyDeviceToDevice));</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <span class="keywordflow">if</span> (trans == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>) {</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        dim3 dimGrid, dimBlock;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                                              &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        cuda_copy_from_mat(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, M.data_, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), M.Dim());</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="comment">// 2D thread block with warps (blockDim.x) along the row-dim of input M.</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="comment">// Each (8x32) thread block will transpose (32x32) data</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keyword">const</span> int32 warpSize = 32;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        dim3 dimBlock(warpSize, <a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a> / warpSize);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        dim3 dimGrid(n_blocks(M.NumCols(), warpSize),</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            n_blocks(M.NumRows(), warpSize));</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        cuda_copy_from_mat_trans(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, M.data_, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(),</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            M.Dim());</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      }</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    }</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    CuDevice::Instantiate().AccuProfile(<span class="stringliteral">&quot;CuMatrixBase::CopyFromMat(from other CuMatrixBase)&quot;</span>, tim);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().CopyFromMat(M.Mat(), trans);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  }</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a180e10f97fa838f9c1ae125ba164dd77"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a180e10f97fa838f9c1ae125ba164dd77">kaldi::CuMatrixBase::Stride</a></div><div class="ttdeci">MatrixIndexT Stride() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00216">cu-matrix.h:216</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a7cb3ee02262893923716e6764439f359"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">kaldi::CuMatrixBase::stride_</a></div><div class="ttdeci">MatrixIndexT stride_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00730">cu-matrix.h:730</a></div></div>
<div class="ttc" id="namespacekaldi_html_aac2c220416519a2b0a7ad822ee2ef972"><div class="ttname"><a href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">kaldi::MatrixIndexT</a></div><div class="ttdeci">int32 MatrixIndexT</div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00098">matrix-common.h:98</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a6dbdf9d0385c92d6d915b96eaf9ce99e"><div class="ttname"><a href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a></div><div class="ttdeci">#define CU1DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00063">cu-matrixdim.h:63</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00034">matrix-common.h:34</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_aa5a0f4f5fe999cc628776f18ef9138b3"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#aa5a0f4f5fe999cc628776f18ef9138b3">kaldi::CuMatrixBase::Data</a></div><div class="ttdeci">const Real * Data() const</div><div class="ttdoc">Return data pointer (const). </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00689">cu-matrix.h:689</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a45b60b630fe0bfdd71b4065f1fdee8f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45b60b630fe0bfdd71b4065f1fdee8f0">&#9670;&nbsp;</a></span>CopyFromSp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CopyFromSp </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuSpMatrix.html">CuSpMatrix</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>M</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00355">355</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8h_source.html#l00767">CuMatrix&lt; float &gt;::CuMatrix()</a>, <a class="el" href="cu-sp-matrix_8cc_source.html#l00093">CuSpMatrix&lt; Real &gt;::Invert()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, and <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00712">kaldi::TestCuMatrixCopyFromSp()</a>.</p>
<div class="fragment"><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                                                             {</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == M.NumRows() &amp;&amp; <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a> == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == 0)</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    CuTimer tim;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    dim3 dimBlock(<a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    dim3 dimGrid(n_blocks(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>),</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                 n_blocks(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>));</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    cuda_copy_from_sp(dimGrid, dimBlock, M.Data(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    CuDevice::Instantiate().AccuProfile(<span class="stringliteral">&quot;CuMatrix::CopyFromSp&quot;</span>, tim);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  {</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().CopyFromSp(M.Mat());</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  }</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a84acd86e193bca04fb719c476fbcbe5b"><div class="ttname"><a href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a></div><div class="ttdeci">#define CU2DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00067">cu-matrixdim.h:67</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4df008a5298765a0a004c25b49bf62c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4df008a5298765a0a004c25b49bf62c0">&#9670;&nbsp;</a></span>CopyFromTp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">template void CopyFromTp </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuTpMatrix.html">CuTpMatrix</a>&lt; <a class="el" href="classkaldi_1_1OtherReal.html">OtherReal</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>trans</em> = <code><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00277">277</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8cc_source.html#l01971">CuMatrixBase&lt; float &gt;::Cholesky()</a>, <a class="el" href="cu-matrix_8h_source.html#l00774">CuMatrix&lt; float &gt;::CuMatrix()</a>, <a class="el" href="cu-tp-matrix_8cc_source.html#l00063">CuTpMatrix&lt; Real &gt;::Invert()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00688">kaldi::TestCuMatrixCopyFromTp()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l01834">kaldi::UnitTestCuMatrixCopyFromTp()</a>.</p>
<div class="fragment"><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                                                               {</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == M.NumRows() &amp;&amp; <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a> == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == 0)</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    CuTimer tim;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    dim3 dimBlock(<a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    dim3 dimGrid(n_blocks(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>),</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                 n_blocks(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>));</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">if</span> (trans == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>) {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      cuda_copy_from_tp(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, M.Data(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      cuda_copy_from_tp_trans(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, M.Data(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    }</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  {</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().CopyFromTp(M.Mat(), trans);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00034">matrix-common.h:34</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a84acd86e193bca04fb719c476fbcbe5b"><div class="ttname"><a href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a></div><div class="ttdeci">#define CU2DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00067">cu-matrixdim.h:67</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae71f2e6355f884d16edf9539e24adbb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae71f2e6355f884d16edf9539e24adbb5">&#9670;&nbsp;</a></span>CopyLowerToUpper()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CopyLowerToUpper </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02936">2936</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8h_source.html#l00584">CuMatrixBase&lt; float &gt;::AddMatTp()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00896">kaldi::nnet3::ConstrainOrthonormalInternal()</a>, <a class="el" href="nnet-precondition_8cc_source.html#l00026">kaldi::nnet2::PreconditionDirections()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00670">kaldi::TestCuMatrixCopyLowerToUpper()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00112">kaldi::UnitTestCuCholesky()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l02711">kaldi::UnitTestCuMatrixCopyLowerToUpper()</a>.</p>
<div class="fragment"><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;                                          {</div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a> == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>);</div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;    dim3 dimBlock(<a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>);</div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;    int32 dim = <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>;</div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;    dim3 dimGrid(n_blocks(dim, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>),</div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;                 n_blocks(dim, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>));</div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;    cuda_copy_low_upp(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;  {</div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().CopyLowerToUpper();</div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;  }</div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a84acd86e193bca04fb719c476fbcbe5b"><div class="ttname"><a href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a></div><div class="ttdeci">#define CU2DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00067">cu-matrixdim.h:67</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab3c837bb106bfab035db4ea22906acef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3c837bb106bfab035db4ea22906acef">&#9670;&nbsp;</a></span>CopyRows() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CopyRows </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>indexes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copies row r from row indexes[r] of src. </p>
<p>As a special case, if indexes[i] &lt; 0, sets row i to zero. src.NumCols() must equal this.NumCols() </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02645">2645</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-general-component_8cc_source.html#l00476">StatisticsExtractionComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l02662">SpliceComponent::Backprop()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00210">NnetComputer::ExecuteCommand()</a>, <a class="el" href="nnet-train-frmshuff-tgtmat_8cc_source.html#l00030">main()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00180">DistributeComponent::Propagate()</a>, and <a class="el" href="_2nnet-component_8cc_source.html#l02847">SpliceMaxComponent::Propagate()</a>.</p>
<div class="fragment"><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;                                                                            {</div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(static_cast&lt;MatrixIndexT&gt;(indices.Dim()) == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>());</div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>() == src.NumCols());</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;    cuda_copy_rows(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, src.Data(), indices.Data(),</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;                   <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), src.Stride());</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;  {</div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().CopyRows(src.Mat(), indices.Data());</div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;  }</div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5139d83372ab4c1095b1eacf94cad066"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5139d83372ab4c1095b1eacf94cad066">&#9670;&nbsp;</a></span>CopyRows() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CopyRows </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; const Real *&gt; &amp;&#160;</td>
          <td class="paramname"><em>src</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copies row r of this matrix from an array of floats at the location given by src[r], where src[r] is assumed to be obtained from the <a class="el" href="classkaldi_1_1CuMatrixBase.html#aca92364bdcb38c7e30f390340d072bf4" title="Get raw row pointer (const). ">RowData()</a> function of another <a class="el" href="classkaldi_1_1CuMatrix.html" title="This class represents a matrix that&#39;s stored on the GPU if we have one, and in memory if not...">CuMatrix</a>, or from <a class="el" href="classkaldi_1_1CuVectorBase.html#abda573212fad06ec61fd3f428a0992c7" title="Returns a pointer to the start of the vector&#39;s data. ">CuVector::Data()</a> (the point is: the data it points to should be on the GPU if we're using a GPU, and on a CPU otherwise). </p>
<p>src.size() must equal this.NumRows(), and if any src[r] is NULL then this.Row(r) will be set to zero. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02690">2690</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;                                                                     {</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(static_cast&lt;MatrixIndexT&gt;(src.Dim()) == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>());</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;    dim3 dimBlock(<a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>);</div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;    dim3 dimGrid(n_blocks(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>),</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;                 n_blocks(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>));</div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;    cuda_copy_rows(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, src.Data(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;  {</div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().CopyRows(src.Data());</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;  }</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a84acd86e193bca04fb719c476fbcbe5b"><div class="ttname"><a href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a></div><div class="ttdeci">#define CU2DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00067">cu-matrixdim.h:67</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae2f0948568047c75ffeef9aa6ea590ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2f0948568047c75ffeef9aa6ea590ac">&#9670;&nbsp;</a></span>CopyRowsFromVec() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CopyRowsFromVec </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function has two modes of operation. </p>
<p>If v.Dim() == <a class="el" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1" title="Dimensions. ">NumRows()</a> * <a class="el" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols()</a>, then treats the vector as a row-by-row concatenation of a matrix and copies to *this. if v.Dim() == <a class="el" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols()</a>, it sets each row of *this to a copy of v. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02282">2282</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-vector-test_8cc_source.html#l00375">kaldi::CuVectorUnitTestCopyFromMat()</a>, <a class="el" href="nnet-compute-online_8cc_source.html#l00120">NnetOnlineComputer::Flush()</a>, <a class="el" href="rescale-nnet_8cc_source.html#l00056">NnetRescaler::FormatInput()</a>, <a class="el" href="nnet-convolutional-component_8cc_source.html#l00282">TimeHeightConvolutionComponent::Propagate()</a>, <a class="el" href="nnet-tdnn-component_8cc_source.html#l00181">TdnnComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01428">RepeatedAffineComponent::Propagate()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l01225">ConstantComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l01155">AffineComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l03376">FixedAffineComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l01974">BlockAffineComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02601">ConstantFunctionComponent::Propagate()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l00399">kaldi::UnitTestCuMatrixCopyRowsFromVec()</a>.</p>
<div class="fragment"><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;                                                                    {</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;    <span class="keywordflow">if</span> (v.Dim() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>*<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>) {</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">stride_</a> == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>) {</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;        <span class="keyword">const</span> Real* v_data = v.Data();</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;        CU_SAFE_CALL(cudaMemcpy(<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, v_data,</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;                                <span class="keyword">sizeof</span>(Real)*<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>*<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>,</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;                                cudaMemcpyDeviceToDevice));</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;        CU_SAFE_CALL(cudaMemcpy2D(<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">stride_</a> * <span class="keyword">sizeof</span>(Real), v.Data(),</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;                                  <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>*<span class="keyword">sizeof</span>(Real), <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>*<span class="keyword">sizeof</span>(Real),</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;                                  <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>,</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;                                  cudaMemcpyDeviceToDevice));</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;      }</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (v.Dim() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>) {</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;      dim3 dimGrid, dimBlock;</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;      GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;                                            &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;      cuda_copy_rows_from_vec(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), v.Data());</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;      CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Wrong sized arguments&quot;</span>;</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    }</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;  {</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().CopyRowsFromVec(v.Vec());</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;  }</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a7cb3ee02262893923716e6764439f359"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">kaldi::CuMatrixBase::stride_</a></div><div class="ttdeci">MatrixIndexT stride_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00730">cu-matrix.h:730</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00126">kaldi-error.h:126</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0db477a6b3daf0a83142ae056256e1e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0db477a6b3daf0a83142ae056256e1e3">&#9670;&nbsp;</a></span>CopyRowsFromVec() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CopyRowsFromVec </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Version of <a class="el" href="classkaldi_1_1CuMatrixBase.html#ae2f0948568047c75ffeef9aa6ea590ac" title="This function has two modes of operation. ">CopyRowsFromVec()</a> that takes a CPU-based vector. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02316">2316</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;                                                                  {</div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;    <span class="keywordflow">if</span> (v.Dim() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>*<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>) {</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">stride_</a> == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>) {</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;        <span class="keyword">const</span> Real* v_data = v.Data();</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;        cudaMemcpy(<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, v_data, <span class="keyword">sizeof</span>(Real)*<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>*<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>, cudaMemcpyHostToDevice);</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;        <span class="keyword">const</span> Real *v_data = v.Data();</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> r = 0; r &lt; <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>; r++) {</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;          Real *row_data = <a class="code" href="classkaldi_1_1CuMatrixBase.html#aca92364bdcb38c7e30f390340d072bf4">RowData</a>(r);</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;          cudaMemcpy(row_data, v_data, <span class="keyword">sizeof</span>(Real)*<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>, cudaMemcpyHostToDevice);</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;          v_data += <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>;</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;        }</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;      }</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (v.Dim() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>) {</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;      dim3 dimGrid, dimBlock;</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;      GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;                                            &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;      cuda_copy_rows_from_vec(dimGrid, dimBlock, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), v.Data());</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;      CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Wrong sized arguments&quot;</span>;</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;    }</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;  {</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().CopyRowsFromVec(v);</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;  }</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a7cb3ee02262893923716e6764439f359"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">kaldi::CuMatrixBase::stride_</a></div><div class="ttdeci">MatrixIndexT stride_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00730">cu-matrix.h:730</a></div></div>
<div class="ttc" id="namespacekaldi_html_aac2c220416519a2b0a7ad822ee2ef972"><div class="ttname"><a href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">kaldi::MatrixIndexT</a></div><div class="ttdeci">int32 MatrixIndexT</div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00098">matrix-common.h:98</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00126">kaldi-error.h:126</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_aca92364bdcb38c7e30f390340d072bf4"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#aca92364bdcb38c7e30f390340d072bf4">kaldi::CuMatrixBase::RowData</a></div><div class="ttdeci">const Real * RowData(MatrixIndexT r) const</div><div class="ttdoc">Get raw row pointer (const). </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00683">cu-matrix.h:683</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae67f2eab6adb41c8851873ac493d7f37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae67f2eab6adb41c8851873ac493d7f37">&#9670;&nbsp;</a></span>CopyToMat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">template void CopyToMat </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; <a class="el" href="classkaldi_1_1OtherReal.html">OtherReal</a> &gt; *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>trans</em> = <code><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00415">415</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet3-compute-from-egs_8cc_source.html#l00041">NnetComputerFromEg::Compute()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00415">CuMatrixBase&lt; float &gt;::CopyToMat()</a>, <a class="el" href="nnet-utils_8h_source.html#l00122">kaldi::nnet1::MomentStatistics()</a>, <a class="el" href="cu-matrix_8cc_source.html#l03430">kaldi::operator&lt;&lt;()</a>, <a class="el" href="nnet-kl-hmm_8h_source.html#l00050">KlHmm::PropagateFnc()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="cu-test_8cc_source.html#l00151">kaldi::UnitInvert()</a>, <a class="el" href="cu-test_8cc_source.html#l00087">kaldi::UnitTestCholesky()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02326">kaldi::UnitTestCuDiffLogSoftmax()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02252">kaldi::UnitTestCuDiffSigmoid()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02282">kaldi::UnitTestCuDiffSoftmax()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02589">kaldi::UnitTestCuDiffTanh()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02479">kaldi::UnitTestCuDiffXent()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01368">kaldi::UnitTestCuMatrixAddMat()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01661">kaldi::UnitTestCuMatrixAddMatMat()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01539">kaldi::UnitTestCuMatrixAddVecToCols()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01562">kaldi::UnitTestCuMatrixAddVecToRows()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01692">kaldi::UnitTestCuMatrixAddVecVec()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01165">kaldi::UnitTestCuMatrixDiffGroupPnorm()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01022">kaldi::UnitTestCuMatrixDivElements()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01343">kaldi::UnitTestCuMatrixDivRowsVec()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01205">kaldi::UnitTestCuMatrixGroupMaxDeriv()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02094">kaldi::UnitTestCuMatrixInvertElements()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01047">kaldi::UnitTestCuMatrixMax()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01068">kaldi::UnitTestCuMatrixMin()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01091">kaldi::UnitTestCuMatrixMulColsVec()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00997">kaldi::UnitTestCuMatrixMulElements()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01139">kaldi::UnitTestCuMatrixMulRowsGroupMat()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01114">kaldi::UnitTestCuMatrixMulRowsVec()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02225">kaldi::UnitTestCuSigmoid()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02570">kaldi::UnitTestCuTanh()</a>, <a class="el" href="cu-test_8cc_source.html#l00185">kaldi::UnitTestInvert()</a>, <a class="el" href="cu-test_8cc_source.html#l00338">kaldi::UnitTestMatrix()</a>, <a class="el" href="nnet-randomizer-test_8cc_source.html#l00081">UnitTestMatrixRandomizer()</a>, <a class="el" href="cu-test_8cc_source.html#l00060">kaldi::UnitTestSetZeroAboveDiag()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02529">kaldi::UnitTestSwapCu2Cu()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l02550">kaldi::UnitTestSwapCu2M()</a>.</p>
<div class="fragment"><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                                                                    {</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">if</span> (trans == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a> || <span class="keyword">sizeof</span>(OtherReal) != <span class="keyword">sizeof</span>(Real)) {</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      CuMatrix&lt;OtherReal&gt; this_trans(*<span class="keyword">this</span>, trans);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      this_trans.CopyToMat(dst, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(dst-&gt;NumRows() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() &amp;&amp; dst-&gt;NumCols() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>());</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      CuTimer tim;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> src_pitch = <a class="code" href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">stride_</a>*<span class="keyword">sizeof</span>(Real);</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> dst_pitch = dst-&gt;Stride()*<span class="keyword">sizeof</span>(Real);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> width = <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>()*<span class="keyword">sizeof</span>(Real);</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      CU_SAFE_CALL(cudaMemcpy2D(dst-&gt;Data(), dst_pitch, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, src_pitch,</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                                width, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, cudaMemcpyDeviceToHost));</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      CuDevice::Instantiate().AccuProfile(<span class="stringliteral">&quot;CuMatrix::CopyToMatD2H&quot;</span>, tim);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    }</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="preprocessor">  #endif</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  {</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    dst-&gt;CopyFromMat(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>(), trans);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  }</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a7cb3ee02262893923716e6764439f359"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">kaldi::CuMatrixBase::stride_</a></div><div class="ttdeci">MatrixIndexT stride_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00730">cu-matrix.h:730</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00033">matrix-common.h:33</a></div></div>
<div class="ttc" id="namespacekaldi_html_aac2c220416519a2b0a7ad822ee2ef972"><div class="ttname"><a href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">kaldi::MatrixIndexT</a></div><div class="ttdeci">int32 MatrixIndexT</div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00098">matrix-common.h:98</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00034">matrix-common.h:34</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad44a3f39df227b02bf84d0df0ad8f550"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad44a3f39df227b02bf84d0df0ad8f550">&#9670;&nbsp;</a></span>CopyToRows()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CopyToRows </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; Real *&gt; &amp;&#160;</td>
          <td class="paramname"><em>dst</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For each row r of this matrix, copies it to the array of floats at the location given by dst[r], where dst[r] is assumed to be obtained from the <a class="el" href="classkaldi_1_1CuMatrixBase.html#aca92364bdcb38c7e30f390340d072bf4" title="Get raw row pointer (const). ">RowData()</a> function of another <a class="el" href="classkaldi_1_1CuMatrix.html" title="This class represents a matrix that&#39;s stored on the GPU if we have one, and in memory if not...">CuMatrix</a>, or from <a class="el" href="classkaldi_1_1CuVectorBase.html#abda573212fad06ec61fd3f428a0992c7" title="Returns a pointer to the start of the vector&#39;s data. ">CuVector::Data()</a> (i.e. </p>
<p>it should point to memory on the GPU if we're using a GPU, or on the CPU otherwise). If dst[r] is NULL, does not copy anywhere. Requires that none of the memory regions pointed to by the pointers in "dst" overlap (e.g. none of the pointers should be the same). </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02711">2711</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-general-component_8cc_source.html#l00194">DistributeComponent::Backprop()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00210">NnetComputer::ExecuteCommand()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l00487">kaldi::UnitTestCuMatrixCopyToRows()</a>.</p>
<div class="fragment"><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;                                                                       {</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(static_cast&lt;MatrixIndexT&gt;(dst.Dim()) == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>());</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;    dim3 dimBlock(<a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>);</div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;    dim3 dimGrid(n_blocks(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>),</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;                 n_blocks(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>));</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;    cuda_copy_to_rows(dimGrid, dimBlock, dst.Data(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;  {</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().CopyToRows(dst.Data());</div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;  }</div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a84acd86e193bca04fb719c476fbcbe5b"><div class="ttname"><a href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a></div><div class="ttdeci">#define CU2DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00067">cu-matrixdim.h:67</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0dcb1f41ec37f0a92007a949f3a2044f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0dcb1f41ec37f0a92007a949f3a2044f">&#9670;&nbsp;</a></span>CopyUpperToLower()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CopyUpperToLower </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02957">2957</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8h_source.html#l00584">CuMatrixBase&lt; float &gt;::AddMatTp()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00736">kaldi::TestCuMatrixCopyUpperToLower()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l02752">kaldi::UnitTestCuMatrixCopyUpperToLower()</a>.</p>
<div class="fragment"><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;                                          {</div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a> == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>);</div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;    int32 dim = this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>;</div><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;    dim3 dimBlock(<a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>);</div><div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;    dim3 dimGrid(n_blocks(dim, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>),</div><div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;                 n_blocks(dim, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>));</div><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;    cuda_copy_upp_low(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;  {</div><div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().CopyUpperToLower();</div><div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;  }</div><div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a84acd86e193bca04fb719c476fbcbe5b"><div class="ttname"><a href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a></div><div class="ttdeci">#define CU2DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00067">cu-matrixdim.h:67</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa5a0f4f5fe999cc628776f18ef9138b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5a0f4f5fe999cc628776f18ef9138b3">&#9670;&nbsp;</a></span>Data() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const Real* Data </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return data pointer (const). </p>
<p>Warning: may return a pointer to GPU memory. Use at your own risk. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00689">689</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8cc_source.html#l02668">CuMatrixBase&lt; float &gt;::AddCols()</a>, <a class="el" href="cu-vector_8cc_source.html#l01254">CuVectorBase&lt; float &gt;::AddColSumMat()</a>, <a class="el" href="cu-vector_8cc_source.html#l00583">CuVectorBase&lt; float &gt;::AddDiagMatMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01369">CuMatrixBase&lt; float &gt;::AddDiagVecMat()</a>, <a class="el" href="cu-sp-matrix_8cc_source.html#l00130">CuSpMatrix&lt; Real &gt;::AddMat2()</a>, <a class="el" href="cu-matrix_8cc_source.html#l03172">CuMatrixBase&lt; float &gt;::AddMatBlock()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01402">CuMatrixBase&lt; float &gt;::AddMatDiagVec()</a>, <a class="el" href="cu-block-matrix_8cc_source.html#l00211">CuBlockMatrix&lt; Real &gt;::AddMatMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01434">CuMatrixBase&lt; float &gt;::AddMatMatElements()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01067">CuMatrixBase&lt; float &gt;::AddMatSmat()</a>, <a class="el" href="cu-vector_8cc_source.html#l00478">CuVectorBase&lt; float &gt;::AddMatVec()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02898">CuMatrixBase&lt; float &gt;::AddRowRanges()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02733">CuMatrixBase&lt; float &gt;::AddRows()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01011">CuMatrixBase&lt; float &gt;::AddSmatMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02836">CuMatrixBase&lt; float &gt;::AddToRows()</a>, <a class="el" href="nnet-normalize-component_8cc_source.html#l00177">NormalizeComponent::Backprop()</a>, <a class="el" href="nnet-normalize-component_8cc_source.html#l00466">BatchNormComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01454">RepeatedAffineComponent::Backprop()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l01578">GeneralDropoutComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02037">PerElementScaleComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02210">PerElementOffsetComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02474">ScaleAndOffsetComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02521">ScaleAndOffsetComponent::BackpropInternal()</a>, <a class="el" href="cu-math_8cc_source.html#l00768">kaldi::cu::BackpropLstmNonlinearity()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01648">CuMatrix&lt; float &gt;::CompObjfAndDeriv()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00134">DistributeComponent::ComputeInputPointers()</a>, <a class="el" href="cu-math_8cc_source.html#l00489">kaldi::cu::ComputeLstmNonlinearity()</a>, <a class="el" href="convolution_8cc_source.html#l00682">kaldi::nnet3::time_height_convolution::ConvolveBackwardData()</a>, <a class="el" href="convolution_8cc_source.html#l00603">kaldi::nnet3::time_height_convolution::ConvolveBackwardDataInternal()</a>, <a class="el" href="convolution_8cc_source.html#l00840">kaldi::nnet3::time_height_convolution::ConvolveBackwardParams()</a>, <a class="el" href="convolution_8cc_source.html#l00763">kaldi::nnet3::time_height_convolution::ConvolveBackwardParamsInternal()</a>, <a class="el" href="convolution_8cc_source.html#l00524">kaldi::nnet3::time_height_convolution::ConvolveForward()</a>, <a class="el" href="convolution_8cc_source.html#l00448">kaldi::nnet3::time_height_convolution::ConvolveForwardInternal()</a>, <a class="el" href="cu-math_8cc_source.html#l00173">kaldi::cu::Copy()</a>, <a class="el" href="cu-vector_8cc_source.html#l00102">CuVectorBase&lt; float &gt;::CopyColFromMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02623">CuMatrixBase&lt; float &gt;::CopyCols()</a>, <a class="el" href="cu-vector_8cc_source.html#l01163">CuVectorBase&lt; float &gt;::CopyDiagFromMat()</a>, <a class="el" href="cu-vector_8cc_source.html#l01296">CuVectorBase&lt; float &gt;::CopyElements()</a>, <a class="el" href="cu-tp-matrix_8cc_source.html#l00089">CuTpMatrix&lt; Real &gt;::CopyFromMat()</a>, <a class="el" href="cu-compressed-matrix_8cc_source.html#l00065">CuCompressedMatrix&lt; I &gt;::CopyFromMat()</a>, <a class="el" href="cu-sp-matrix_8cc_source.html#l00039">CuSpMatrix&lt; Real &gt;::CopyFromMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00207">CuMatrixBase&lt; float &gt;::CopyFromMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02645">CuMatrixBase&lt; float &gt;::CopyRows()</a>, <a class="el" href="cu-vector_8cc_source.html#l00163">CuVectorBase&lt; float &gt;::CopyRowsFromMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02591">VectorBase&lt; float &gt;::CopyRowsFromMat()</a>, <a class="el" href="cu-sparse-matrix_8cc_source.html#l00622">CuSparseMatrix&lt; Real &gt;::CopyToMat()</a>, <a class="el" href="cu-compressed-matrix_8cc_source.html#l00102">CuCompressedMatrix&lt; I &gt;::CopyToMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00828">CuMatrixBase&lt; float &gt;::DiffGroupPnorm()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01887">CuMatrixBase&lt; float &gt;::DiffLogSoftmaxPerRow()</a>, <a class="el" href="cu-math_8cc_source.html#l00349">kaldi::cu::DiffNormalizePerRow()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01852">CuMatrixBase&lt; float &gt;::DiffSoftmaxPerRow()</a>, <a class="el" href="cu-math_8cc_source.html#l00209">kaldi::cu::EnsureNonzero()</a>, <a class="el" href="cu-matrix_8cc_source.html#l03395">CuMatrixBase&lt; float &gt;::EqualElementMask()</a>, <a class="el" href="nnet-tdnn-component_8cc_source.html#l00497">TdnnComponent::GetInputPart()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00457">NnetComputer::GetPointers()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00861">CuMatrixBase&lt; float &gt;::GroupMaxDeriv()</a>, <a class="el" href="cu-tp-matrix_8cc_source.html#l00063">CuTpMatrix&lt; Real &gt;::Invert()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02757">CuMatrixBase&lt; float &gt;::MulRows()</a>, <a class="el" href="cu-math_8cc_source.html#l00280">kaldi::cu::NormalizePerRow()</a>, <a class="el" href="nnet-normalize-component_8cc_source.html#l00132">NormalizeComponent::Propagate()</a>, <a class="el" href="nnet-normalize-component_8cc_source.html#l00400">BatchNormComponent::Propagate()</a>, <a class="el" href="nnet-convolutional-component_8cc_source.html#l00282">TimeHeightConvolutionComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01428">RepeatedAffineComponent::Propagate()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l01545">GeneralDropoutComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02191">PerElementOffsetComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02440">ScaleAndOffsetComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02461">ScaleAndOffsetComponent::PropagateInternal()</a>, <a class="el" href="cu-rand_8cc_source.html#l00139">CuRand&lt; float &gt;::RandGaussian()</a>, <a class="el" href="cu-math_8cc_source.html#l00080">kaldi::cu::Randomize()</a>, <a class="el" href="cu-rand_8cc_source.html#l00083">CuRand&lt; float &gt;::RandUniform()</a>, <a class="el" href="cu-math_8cc_source.html#l00037">kaldi::cu::RegularizeL1()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00989">RectifiedLinearComponent::RepairGradients()</a>, <a class="el" href="cu-block-matrix_8cc_source.html#l00122">CuBlockMatrix&lt; Real &gt;::SetCudaData()</a>, <a class="el" href="cu-math_8cc_source.html#l00132">kaldi::cu::Splice()</a>, <a class="el" href="nnet-normalize-component_8cc_source.html#l00549">BatchNormComponent::StoreStats()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02860">CuMatrixBase&lt; float &gt;::SumColumnRanges()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01340">CuMatrixBase&lt; float &gt;::SymAddMat2()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02128">kaldi::TraceMatMat()</a>, <a class="el" href="cu-sparse-matrix_8cc_source.html#l00524">kaldi::TraceMatSmat()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01495">RepeatedAffineComponent::Update()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01594">NaturalGradientRepeatedAffineComponent::Update()</a>, <a class="el" href="nnet-convolutional-component_8cc_source.html#l00353">TimeHeightConvolutionComponent::UpdateNaturalGradient()</a>, and <a class="el" href="nnet-convolutional-component_8cc_source.html#l00333">TimeHeightConvolutionComponent::UpdateSimple()</a>.</p>
<div class="fragment"><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>; }</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abda573212fad06ec61fd3f428a0992c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abda573212fad06ec61fd3f428a0992c7">&#9670;&nbsp;</a></span>Data() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real* Data </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return data pointer. </p>
<p>Warning: may return a pointer to GPU memory. Use at your own risk. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00692">692</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>; }</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae66b901bbaf7c4f954b36b2245047bdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae66b901bbaf7c4f954b36b2245047bdd">&#9670;&nbsp;</a></span>DiffGroupPnorm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DiffGroupPnorm </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>in_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>out_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>out_deriv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>power</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Differentiate backward through the GroupPnorm function. </p>
<p>It is a combination of GroupPnormDeriv and MulRowsGroupMat. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00828">828</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="_2nnet-component_8cc_source.html#l00524">PnormComponent::Backprop()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l01165">kaldi::UnitTestCuMatrixDiffGroupPnorm()</a>.</p>
<div class="fragment"><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                                                    {</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(out_value.NumCols() &gt; 0);</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(out_value.NumCols() == out_deriv.NumCols());</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  <span class="keywordtype">int</span> group_size = this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>() / out_value.NumCols();</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>() == out_value.NumCols() * group_size);</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    CuTimer tim;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> kWarpSize = 32;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    dim3 dimBlock(kWarpSize, <a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a> / kWarpSize);</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    dim3 dimGrid(n_blocks(<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(), dimBlock.x),</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                 n_blocks(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), dimBlock.y));</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keywordflow">if</span> (dimGrid.x * dimGrid.y &gt; 1024) {</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      dimGrid.y = std::max(1024 / dimGrid.x, <span class="keywordtype">unsigned</span>(1));</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    }</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    cuda_diff_group_pnorm(dimGrid, dimBlock, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, in_value.Data(),</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                          out_value.Data(), out_deriv.Data(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(),</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                          in_value.Stride(), out_value.Stride(),</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                          out_deriv.Stride(), group_size, power);</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  {</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().GroupPnormDeriv(in_value.Mat(), out_value.Mat(), power);</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a0bb9285c3b3d6c789c70da92831ae344">MulRowsGroupMat</a>(out_deriv);</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  }</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a6dbdf9d0385c92d6d915b96eaf9ce99e"><div class="ttname"><a href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a></div><div class="ttdeci">#define CU1DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00063">cu-matrixdim.h:63</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a0bb9285c3b3d6c789c70da92831ae344"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a0bb9285c3b3d6c789c70da92831ae344">kaldi::CuMatrixBase::MulRowsGroupMat</a></div><div class="ttdeci">void MulRowsGroupMat(const CuMatrixBase&lt; Real &gt; &amp;src)</div><div class="ttdoc">divide each row into src.NumCols() groups, and then scale i&amp;#39;th row&amp;#39;s jth group of elements by src[i...</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l00803">cu-matrix.cc:803</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa180015860cdd28a24b27984b816762d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa180015860cdd28a24b27984b816762d">&#9670;&nbsp;</a></span>DiffLogSoftmaxPerRow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DiffLogSoftmaxPerRow </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>out_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>out_deriv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Differentiate backward through the log softmax function. </p>
<p>Here, "out_value" is the log softmax output. Does, for each row i, *this(i) = out_deriv(i) - sum(out_deriv(i)) .* exp(out_value(i)) xxxx(i) is row-vector. Supports in-place operation, this == &amp;out_deriv. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01887">1887</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="_2nnet-component_8cc_source.html#l00965">LogSoftmaxComponent::Backprop()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01887">CuMatrixBase&lt; float &gt;::DiffLogSoftmaxPerRow()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l02326">kaldi::UnitTestCuDiffLogSoftmax()</a>.</p>
<div class="fragment"><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;                                                                              {</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">SameDim</a>(out_value, out_deriv) &amp;&amp; <a class="code" href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">SameDim</a>(out_value, *<span class="keyword">this</span>) &amp;&amp;</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;               <span class="keyword">this</span> != &amp;out_value);</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    CuTimer tim;</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    <span class="comment">// CUDA thread layout: one thread block per matrix-row.</span></div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    dim3 dimBlock(<a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a>);</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    dim3 dimGrid(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>);</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    cuda_diff_log_softmax(dimGrid, dimBlock, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), out_value.Data(),</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;                          out_value.Stride(), out_deriv.Data(),</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;                          out_deriv.Stride(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>);</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;  {</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">this</span> == &amp;out_deriv) {</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;      <span class="comment">// the code below doesn&#39;t work for in-place, so make a copy and recurse.</span></div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;      CuMatrix&lt;Real&gt; temp(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(), <a class="code" href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kUndefined</a>);</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;      temp.DiffLogSoftmaxPerRow(out_value, out_deriv);</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;      <a class="code" href="classkaldi_1_1CuMatrixBase.html#a79817f1cbd9d8478d4137d6dd815a584">CopyFromMat</a>(temp);</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    }</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;<span class="comment">     Let the output be y, then</span></div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;<span class="comment">     y_i = x_i - log(sum_i exp(x_i))</span></div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;<span class="comment">     where x_i is the input to the component. The Jacobian matrix of this</span></div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;<span class="comment">     function is</span></div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;<span class="comment">     J = I - 1 exp(y^T)</span></div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;<span class="comment">     where 1 is a vector of ones. Let the derivative vector at the output be e,</span></div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;<span class="comment">     and at the input be d, then we have</span></div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;<span class="comment">     d = e - exp(y) Sum(e)</span></div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;<span class="comment">     d_i = e_i - exp(y_i) Sum(e)</span></div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    <span class="keyword">const</span> CuMatrixBase&lt;Real&gt; &amp;Y(out_value), &amp;E(out_deriv);</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    CuMatrixBase&lt;Real&gt; &amp;D(*<span class="keyword">this</span>);</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    D.CopyFromMat(Y);</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    D.ApplyExp();                           <span class="comment">// exp(y)</span></div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    CuVector&lt;Real&gt; E_sum(D.NumRows()); <span class="comment">// Initializes to zero</span></div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    E_sum.AddColSumMat(1.0, E);             <span class="comment">// Sum(e)</span></div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    D.MulRowsVec(E_sum);                    <span class="comment">// exp(y) Sum(e)</span></div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    D.Scale(-1.0);                          <span class="comment">// - exp(y) Sum(e)</span></div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    D.AddMat(1.0, E, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>);             <span class="comment">// e - exp(y_i) Sum(e)</span></div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;  }</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a79817f1cbd9d8478d4137d6dd815a584"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a79817f1cbd9d8478d4137d6dd815a584">kaldi::CuMatrixBase::CopyFromMat</a></div><div class="ttdeci">void CopyFromMat(const MatrixBase&lt; OtherReal &gt; &amp;src, MatrixTransposeType trans=kNoTrans)</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l00339">cu-matrix.cc:339</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126"><div class="ttname"><a href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kaldi::kUndefined</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00039">matrix-common.h:39</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="group__matrix__funcs__io_html_ga07b147212efb08775c252cd4cc7453fe"><div class="ttname"><a href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">kaldi::SameDim</a></div><div class="ttdeci">bool SameDim(const MatrixBase&lt; Real &gt; &amp;M, const MatrixBase&lt; Real &gt; &amp;N)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l01065">kaldi-matrix.h:1065</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a6dbdf9d0385c92d6d915b96eaf9ce99e"><div class="ttname"><a href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a></div><div class="ttdeci">#define CU1DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00063">cu-matrixdim.h:63</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00034">matrix-common.h:34</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab1e9318b82d532a574d9782b7323c4da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1e9318b82d532a574d9782b7323c4da">&#9670;&nbsp;</a></span>DiffParametricRelu()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DiffParametricRelu </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>diff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Differentiate backward through the parametric relu function. </p>
<p>Here the "value" is the Relu input. Does, element-by-element. *this = diff * (value &gt; 0 ? alpha : beta) </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01488">1488</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-parametric-relu_8h_source.html#l00158">ParametricRelu::BackpropagateFnc()</a>, and <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>.</p>
<div class="fragment"><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                                     {</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    CuTimer tim;</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    dim3 dimBlock(<a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>);</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    dim3 dimGrid(n_blocks(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>), n_blocks(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>));</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    cuda_diff_parametric_relu(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, diff.data_, value.data_,</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                              <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), diff.Stride(), value.Stride(),</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                              alpha.data_, beta.data_);</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;  {</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    <span class="comment">// Do it on CPU,</span></div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> r = 0; r &lt; <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(); r++) {</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> c = 0; c &lt; <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(); c++) {</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;        Real value_elem = value.Mat()(r,c);</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>()(r,c) = diff.Mat()(r,c) *</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;          (value_elem &gt;= 0.0 ? alpha.Vec()(c) : beta.Vec()(c));</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;      }</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    }</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;  }</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="namespacekaldi_html_aac2c220416519a2b0a7ad822ee2ef972"><div class="ttname"><a href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">kaldi::MatrixIndexT</a></div><div class="ttdeci">int32 MatrixIndexT</div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00098">matrix-common.h:98</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a84acd86e193bca04fb719c476fbcbe5b"><div class="ttname"><a href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a></div><div class="ttdeci">#define CU2DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00067">cu-matrixdim.h:67</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a50495cd2ff9a2480bd0370bccd662a8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50495cd2ff9a2480bd0370bccd662a8b">&#9670;&nbsp;</a></span>DiffSigmoid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DiffSigmoid </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>diff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Differentiate backward through the sigmoid function. </p>
<p>Here, "value" is the sigmoid output. Does, element-by-element, *this = diff * value * (1 - value). </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01748">1748</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-simple-component_8cc_source.html#l00325">SigmoidComponent::Backprop()</a>, <a class="el" href="nnet-activation_8h_source.html#l00229">Sigmoid::BackpropagateFnc()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l02252">kaldi::UnitTestCuDiffSigmoid()</a>.</p>
<div class="fragment"><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;                                                                     {</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">SameDim</a>(*<span class="keyword">this</span>, value) &amp;&amp; <a class="code" href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">SameDim</a>(*<span class="keyword">this</span>, diff));</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    CuTimer tim;</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    cuda_diff_sigmoid(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, diff.data_, value.data_, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), diff.Stride(), value.Stride());</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;  {</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().DiffSigmoid(value.Mat(), diff.Mat());</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;  }</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="group__matrix__funcs__io_html_ga07b147212efb08775c252cd4cc7453fe"><div class="ttname"><a href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">kaldi::SameDim</a></div><div class="ttdeci">bool SameDim(const MatrixBase&lt; Real &gt; &amp;M, const MatrixBase&lt; Real &gt; &amp;N)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l01065">kaldi-matrix.h:1065</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4d8a3fcf077a2f3b155940cddb0dac3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d8a3fcf077a2f3b155940cddb0dac3a">&#9670;&nbsp;</a></span>DiffSoftmaxPerRow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DiffSoftmaxPerRow </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>diff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Differentiate backward through the softmax function. </p>
<p>Here, "value" is the softmax output. Does, for each row i, *this(i) = diff(i) * diag(value(i)) - diff(i) * (value(i)^T * value(i)) xxxx(i) is row-vector; '*' and '-' are matrix operations. Supports in-place operation, this == &amp;diff. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01852">1852</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="attention_8cc_source.html#l00154">kaldi::nnet3::attention::AttentionBackward()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00919">SoftmaxComponent::Backprop()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l02282">kaldi::UnitTestCuDiffSoftmax()</a>.</p>
<div class="fragment"><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;                                                                           {</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">SameDim</a>(value, diff) &amp;&amp; <a class="code" href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">SameDim</a>(value, *<span class="keyword">this</span>) &amp;&amp;</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;               <span class="keyword">this</span> != &amp;value);</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    CuTimer tim;</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    <span class="comment">// CUDA thread layout: one thread block per matrix-row.</span></div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    dim3 dimBlock(<a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a>);</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    dim3 dimGrid(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>);</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    cuda_diff_softmax(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), value.Data(),</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;        value.Stride(), diff.Data(), diff.Stride());</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;  {</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    <span class="keyword">const</span> CuMatrixBase&lt;Real&gt; &amp;P(value), &amp;E(diff);</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;    CuMatrixBase&lt;Real&gt; &amp;D(*<span class="keyword">this</span>);</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    CuVector&lt;Real&gt; pe_vec(D.NumRows()); <span class="comment">// For each row i, the dot product (p_t . e_t).</span></div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    pe_vec.AddDiagMatMat(1.0, P, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, E, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>, 0.0);</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    D.CopyFromMat(E);</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;    D.MulElements(P);</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    <span class="comment">// At this point, D = P .* E (in matlab notation)</span></div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    D.AddDiagVecMat(-1.0, pe_vec, P, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, 1.0); <span class="comment">// does D -= diag(pe_vec) * P.</span></div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;  }</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00033">matrix-common.h:33</a></div></div>
<div class="ttc" id="group__matrix__funcs__io_html_ga07b147212efb08775c252cd4cc7453fe"><div class="ttname"><a href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">kaldi::SameDim</a></div><div class="ttdeci">bool SameDim(const MatrixBase&lt; Real &gt; &amp;M, const MatrixBase&lt; Real &gt; &amp;N)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l01065">kaldi-matrix.h:1065</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a6dbdf9d0385c92d6d915b96eaf9ce99e"><div class="ttname"><a href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a></div><div class="ttdeci">#define CU1DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00063">cu-matrixdim.h:63</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00034">matrix-common.h:34</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa96216e7ba0877d0db608a3b57e32aba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa96216e7ba0877d0db608a3b57e32aba">&#9670;&nbsp;</a></span>DiffTanh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DiffTanh </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>diff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Differentiate backward through the tanh function. </p>
<p>Here, "value" is the tanh output. Does, element-by-element, *this = diff * (1 - value^2). </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01793">1793</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-simple-component_8cc_source.html#l00915">TanhComponent::Backprop()</a>, <a class="el" href="nnet-recurrent_8h_source.html#l00243">RecurrentComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-activation_8h_source.html#l00258">Tanh::BackpropagateFnc()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l02589">kaldi::UnitTestCuDiffTanh()</a>.</p>
<div class="fragment"><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;                                                                  {</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    CuTimer tim;</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    cuda_diff_tanh(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, diff.data_, value.data_, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), diff.Stride(), value.Stride());</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;  {</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().DiffTanh(value.Mat(), diff.Mat());</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  }</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8ec6983d85cf6b1cb8016cbd6dc16a7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ec6983d85cf6b1cb8016cbd6dc16a7d">&#9670;&nbsp;</a></span>DiffXent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DiffXent </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>tgt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1CuVector.html">CuVector</a>&lt; Real &gt; *&#160;</td>
          <td class="paramname"><em>log_post_tgt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Differentiate the block [softmax+cross-entropy] : dE/da = posterior_mat - target_mat, 'E' is error function, 'a' is activation on softmax input. </p>
<p>Interface: tgt ... index vector, encodes the matrix of targets net_out_or_diff ... before invocation net output, after diff dE/da log_post_tgt ... per-frame statistics for cross-entropy computations : log(sum_row(posterior_mat .* target_mat)) </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01941">1941</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l02479">kaldi::UnitTestCuDiffXent()</a>.</p>
<div class="fragment"><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;                                                                {</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(tgt.<a class="code" href="classkaldi_1_1CuArrayBase.html#af3d58f15749a15d89b0ec5819dd7b7f2">Dim</a>() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>);</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;  log_post_tgt-&gt;Resize(tgt.<a class="code" href="classkaldi_1_1CuArrayBase.html#af3d58f15749a15d89b0ec5819dd7b7f2">Dim</a>());</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    CuTimer tim;</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    dim3 dimBlock(1, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>*8);</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    dim3 dimGrid(1, n_blocks(tgt.<a class="code" href="classkaldi_1_1CuArrayBase.html#af3d58f15749a15d89b0ec5819dd7b7f2">Dim</a>(), <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>*8));</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    cuda_diff_xent(dimGrid, dimBlock, tgt.<a class="code" href="classkaldi_1_1CuArrayBase.html#a368b2398825ede0c99248a432c6fdc7b">Data</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>,</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;                   log_post_tgt-&gt;data_, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;  {</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> num_rows = <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>;</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <span class="keywordflow">for</span>(int32 r = 0; r &lt; num_rows; r++) {</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;      int32 col_tgt = tgt.<a class="code" href="classkaldi_1_1CuArrayBase.html#a368b2398825ede0c99248a432c6fdc7b">Data</a>()[r];</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;      Real &amp;value = <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>()(r, col_tgt);</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;      log_post_tgt-&gt;Vec()(r) = <a class="code" href="namespacekaldi.html#af75c4606b108091c348102660de63180">Log</a>(value);</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;      value -= 1.0;</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    }</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;  }</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuArrayBase_html_a368b2398825ede0c99248a432c6fdc7b"><div class="ttname"><a href="classkaldi_1_1CuArrayBase.html#a368b2398825ede0c99248a432c6fdc7b">kaldi::CuArrayBase::Data</a></div><div class="ttdeci">const T * Data() const</div><div class="ttdoc">Get raw pointer. </div><div class="ttdef"><b>Definition:</b> <a href="cu-array_8h_source.html#l00052">cu-array.h:52</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="namespacekaldi_html_aac2c220416519a2b0a7ad822ee2ef972"><div class="ttname"><a href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">kaldi::MatrixIndexT</a></div><div class="ttdeci">int32 MatrixIndexT</div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00098">matrix-common.h:98</a></div></div>
<div class="ttc" id="namespacekaldi_html_af75c4606b108091c348102660de63180"><div class="ttname"><a href="namespacekaldi.html#af75c4606b108091c348102660de63180">kaldi::Log</a></div><div class="ttdeci">double Log(double x)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8h_source.html#l00100">kaldi-math.h:100</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a84acd86e193bca04fb719c476fbcbe5b"><div class="ttname"><a href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a></div><div class="ttdeci">#define CU2DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00067">cu-matrixdim.h:67</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuArrayBase_html_af3d58f15749a15d89b0ec5819dd7b7f2"><div class="ttname"><a href="classkaldi_1_1CuArrayBase.html#af3d58f15749a15d89b0ec5819dd7b7f2">kaldi::CuArrayBase::Dim</a></div><div class="ttdeci">MatrixIndexT Dim() const</div><div class="ttdoc">Return the vector dimension. </div><div class="ttdef"><b>Definition:</b> <a href="cu-array_8h_source.html#l00049">cu-array.h:49</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a05174128bcd0c73d49c8ebdb7735aa94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05174128bcd0c73d49c8ebdb7735aa94">&#9670;&nbsp;</a></span>Dim()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">::<a class="el" href="cu-matrixdim_8h.html#a8d5aae09b817446d2ffe45f3490afc51">MatrixDim</a> Dim </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00220">220</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-vector_8cc_source.html#l01254">CuVectorBase&lt; float &gt;::AddColSumMat()</a>, <a class="el" href="cu-vector_8cc_source.html#l00583">CuVectorBase&lt; float &gt;::AddDiagMatMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01106">CuMatrixBase&lt; float &gt;::AddMatBlocks()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02898">CuMatrixBase&lt; float &gt;::AddRowRanges()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01648">CuMatrix&lt; float &gt;::CompObjfAndDeriv()</a>, <a class="el" href="cu-math_8cc_source.html#l00173">kaldi::cu::Copy()</a>, <a class="el" href="cu-vector_8cc_source.html#l00121">CuVectorBase&lt; float &gt;::CopyColFromMat()</a>, <a class="el" href="cu-tp-matrix_8cc_source.html#l00089">CuTpMatrix&lt; Real &gt;::CopyFromMat()</a>, <a class="el" href="cu-compressed-matrix_8cc_source.html#l00065">CuCompressedMatrix&lt; I &gt;::CopyFromMat()</a>, <a class="el" href="cu-sp-matrix_8cc_source.html#l00039">CuSpMatrix&lt; Real &gt;::CopyFromMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00207">CuMatrixBase&lt; float &gt;::CopyFromMat()</a>, <a class="el" href="cu-sparse-matrix_8cc_source.html#l00622">CuSparseMatrix&lt; Real &gt;::CopyToMat()</a>, <a class="el" href="cu-compressed-matrix_8cc_source.html#l00102">CuCompressedMatrix&lt; I &gt;::CopyToMat()</a>, <a class="el" href="cu-math_8cc_source.html#l00349">kaldi::cu::DiffNormalizePerRow()</a>, <a class="el" href="cu-math_8cc_source.html#l00209">kaldi::cu::EnsureNonzero()</a>, <a class="el" href="cu-tp-matrix_8cc_source.html#l00063">CuTpMatrix&lt; Real &gt;::Invert()</a>, <a class="el" href="cu-math_8cc_source.html#l00280">kaldi::cu::NormalizePerRow()</a>, <a class="el" href="cu-math_8cc_source.html#l00080">kaldi::cu::Randomize()</a>, <a class="el" href="cu-math_8cc_source.html#l00037">kaldi::cu::RegularizeL1()</a>, <a class="el" href="cu-block-matrix_8cc_source.html#l00122">CuBlockMatrix&lt; Real &gt;::SetCudaData()</a>, <a class="el" href="cu-math_8cc_source.html#l00132">kaldi::cu::Splice()</a>, <a class="el" href="nnet-component-itf_8cc_source.html#l00340">NonlinearComponent::StoreStatsInternal()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02860">CuMatrixBase&lt; float &gt;::SumColumnRanges()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02128">kaldi::TraceMatMat()</a>, <a class="el" href="cu-sparse-matrix_8cc_source.html#l00524">kaldi::TraceMatSmat()</a>, and <a class="el" href="_2nnet-component_8cc_source.html#l00329">NonlinearComponent::UpdateStats()</a>.</p>
<div class="fragment"><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                        {</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="structMatrixDim__.html">::MatrixDim</a> <a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = { <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">stride_</a> };</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  }</div><div class="ttc" id="structMatrixDim___html"><div class="ttname"><a href="structMatrixDim__.html">MatrixDim_</a></div><div class="ttdoc">Structure containing size of the matrix plus stride. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00052">cu-matrixdim.h:52</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a7cb3ee02262893923716e6764439f359"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">kaldi::CuMatrixBase::stride_</a></div><div class="ttdeci">MatrixIndexT stride_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00730">cu-matrix.h:730</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="namespacernnlm_html_a873684cefeb665f3d5e6b495de57fc0d"><div class="ttname"><a href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">rnnlm::d</a></div><div class="ttdeci">double d</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00064">mikolov-rnnlm-lib.cc:64</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a09846db9a782e71477e9ce75229a5168"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09846db9a782e71477e9ce75229a5168">&#9670;&nbsp;</a></span>DivElements()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DivElements </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Divide two matrices elementwise: C = A ./ A. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00678">678</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-vector_8cc_source.html#l00829">CuVectorBase&lt; float &gt;::DivElements()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01022">kaldi::UnitTestCuMatrixDivElements()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l01320">kaldi::UnitTestCuMatrixSetMatMatDivMat()</a>.</p>
<div class="fragment"><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                                                                {</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="preprocessor">  #if HAVE_CUDA == 1</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    CuTimer tim;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a> == A.NumCols());</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == A.NumRows());</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    cuda_div_elements(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, A.data_, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), A.Stride());</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="preprocessor">  #endif</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  {</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().DivElements(A.Mat());</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  }</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2e00be526b78792f7bf8edfe207f6d59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e00be526b78792f7bf8edfe207f6d59">&#9670;&nbsp;</a></span>DivRowsVec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DivRowsVec </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>div</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>divide i'th row by scale[i] </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00886">886</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-general-component_8cc_source.html#l00820">StatisticsPoolingComponent::Backprop()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00771">StatisticsPoolingComponent::Propagate()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00097">kaldi::TestCuMatrixDivRowsVec()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l01343">kaldi::UnitTestCuMatrixDivRowsVec()</a>.</p>
<div class="fragment"><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                                                                 {</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    CuTimer tim;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(div.Dim() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>());</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="comment">// For large matrix we do more work per thread by limiting the</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="comment">// the grid size to reduce the block launching overhead.</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="keywordflow">if</span> (dimGrid.x * dimGrid.y &gt; 1024) {</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      dimGrid.x = 1024 / dimGrid.y;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      <span class="keywordflow">if</span> (dimGrid.x == 0) {</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        dimGrid.x = 1;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      }</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    }</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    cuda_div_rows_vec(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, div.data_, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  {</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    Vector&lt;Real&gt; temp(div.Vec()); <span class="comment">// will copy.</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    temp.InvertElements();</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().MulRowsVec(temp);</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  }</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa99dbec163e4cde44071fa636654fa4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa99dbec163e4cde44071fa636654fa4a">&#9670;&nbsp;</a></span>EqualElementMask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EqualElementMask </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1CuMatrix.html">CuMatrix</a>&lt; Real &gt; *&#160;</td>
          <td class="paramname"><em>mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l03395">3395</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="_2nnet-component_8cc_source.html#l04318">MaxpoolingComponent::Backprop()</a>, <a class="el" href="nnet-max-pooling-component_8h_source.html#l00121">MaxPoolingComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-max-pooling-2d-component_8h_source.html#l00153">MaxPooling2DComponent::BackpropagateFnc()</a>, and <a class="el" href="cu-matrix_8h_source.html#l00633">CuMatrixBase&lt; float &gt;::operator()()</a>.</p>
<div class="fragment"><div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;                                                                                                   {</div><div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;  <span class="comment">// Check the inputs:</span></div><div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(mat.NumRows() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() &amp;&amp; mat.NumCols() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>());</div><div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(mask != NULL);</div><div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;  <span class="comment">// Resizes the output matrix:</span></div><div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;  mask-&gt;Resize(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(), <a class="code" href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80bae9d0df3a51f0394dd8e041960265c112">kSetZero</a>);</div><div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;</div><div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;    CuTimer tim;</div><div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;    cuda_equal_element_mask(dimGrid, dimBlock, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, mat.Data(),</div><div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;                            mask-&gt;Data(), this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), mat.Stride(),</div><div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;                            mask-&gt;Stride());</div><div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;</div><div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;  {</div><div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;    <span class="keywordflow">for</span> (int32 r = 0; r &lt; <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(); r++) {</div><div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;      <span class="keywordflow">for</span> (int32 c = 0; c &lt; <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(); c++) {</div><div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;        (*mask)(r,c) = ((*<span class="keyword">this</span>)(r,c) ==  mat(r,c) ? 1.0 : 0.0);</div><div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;      }</div><div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;    }</div><div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;  }</div><div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab4ace1fea44c7724ab9a76d70abad80bae9d0df3a51f0394dd8e041960265c112"><div class="ttname"><a href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80bae9d0df3a51f0394dd8e041960265c112">kaldi::kSetZero</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00038">matrix-common.h:38</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aee193f379988f1242a44d2a0d13e5171"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee193f379988f1242a44d2a0d13e5171">&#9670;&nbsp;</a></span>FindRowMaxId()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FindRowMaxId </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1CuArray.html">CuArray</a>&lt; int32 &gt; *&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the id of the maximal element for each row (resizes the 'id' array to the appropriate size). </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01813">1813</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-diagnostics_8cc_source.html#l00206">kaldi::nnet3::ComputeAccuracy()</a>, <a class="el" href="nnet-update_8cc_source.html#l00161">NnetUpdater::ComputeTotAccuracy()</a>, <a class="el" href="nnet-loss_8cc_source.html#l00062">Xent::Eval()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00368">kaldi::TestCuFindRowMaxId()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l02445">kaldi::UnitTestCuFindRowMaxId()</a>.</p>
<div class="fragment"><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;                                                              {</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    CuTimer tim;</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    <span class="keywordtype">id</span>-&gt;Resize(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>);</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    <a class="code" href="structMatrixDim__.html">MatrixDim</a> <a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>();</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    <span class="comment">// CUDA thread layout: one thread block per matrix-row.</span></div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    dim3 dimBlock(<a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a>);</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    dim3 dimGrid(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>);</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;    cuda_find_row_max_id(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, NULL, id-&gt;<a class="code" href="classkaldi_1_1CuArrayBase.html#a368b2398825ede0c99248a432c6fdc7b">Data</a>(), <a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>);</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    <span class="comment">// now we have the indices!</span></div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;  {</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    <span class="comment">// allocate index buffer</span></div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    <span class="keywordtype">id</span>-&gt;Resize(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>);</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    <span class="keywordtype">id</span>-&gt;Set(-1);</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    <span class="comment">// find maxima</span></div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> num_rows = <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, num_cols = <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>;</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> r = 0; r &lt; num_rows; r++) {</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;      Real max = -1e21;</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;      int32 max_id = -1;</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;      <span class="keyword">const</span> Real *row_data = <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().RowData(r);</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> c = 0; c &lt; num_cols; c++) {</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;        <span class="keywordflow">if</span> (max &lt; row_data[c]) {</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;          max = row_data[c];</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;          max_id = c;</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;        }</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;      }</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;      <span class="keywordtype">id</span>-&gt;Data()[r] = max_id;</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    }</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;  }</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="structMatrixDim___html"><div class="ttname"><a href="structMatrixDim__.html">MatrixDim_</a></div><div class="ttdoc">Structure containing size of the matrix plus stride. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00052">cu-matrixdim.h:52</a></div></div>
<div class="ttc" id="classkaldi_1_1CuArrayBase_html_a368b2398825ede0c99248a432c6fdc7b"><div class="ttname"><a href="classkaldi_1_1CuArrayBase.html#a368b2398825ede0c99248a432c6fdc7b">kaldi::CuArrayBase::Data</a></div><div class="ttdeci">const T * Data() const</div><div class="ttdoc">Get raw pointer. </div><div class="ttdef"><b>Definition:</b> <a href="cu-array_8h_source.html#l00052">cu-array.h:52</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="namespacekaldi_html_aac2c220416519a2b0a7ad822ee2ef972"><div class="ttname"><a href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">kaldi::MatrixIndexT</a></div><div class="ttdeci">int32 MatrixIndexT</div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00098">matrix-common.h:98</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a6dbdf9d0385c92d6d915b96eaf9ce99e"><div class="ttname"><a href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a></div><div class="ttdeci">#define CU1DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00063">cu-matrixdim.h:63</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="namespacernnlm_html_a873684cefeb665f3d5e6b495de57fc0d"><div class="ttname"><a href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">rnnlm::d</a></div><div class="ttdeci">double d</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00064">mikolov-rnnlm-lib.cc:64</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac8bb668abdc6122cec89dc1f01f73554"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8bb668abdc6122cec89dc1f01f73554">&#9670;&nbsp;</a></span>FrobeniusNorm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real FrobeniusNorm </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00225">225</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8cc_source.html#l02120">CuMatrixBase&lt; float &gt;::ApproxEqual()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00896">kaldi::nnet3::ConstrainOrthonormalInternal()</a>, and <a class="el" href="cu-sparse-matrix-test_8cc_source.html#l00181">kaldi::UnitTestCuSparseMatrixFrobeniusNorm()</a>.</p>
<div class="fragment"><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;{ <span class="keywordflow">return</span> sqrt(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a66bed104430bbbde5005c244cf0387f7">TraceMatMat</a>(*<span class="keyword">this</span>, *<span class="keyword">this</span>, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>)); }</div><div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00033">matrix-common.h:33</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a66bed104430bbbde5005c244cf0387f7"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a66bed104430bbbde5005c244cf0387f7">kaldi::CuMatrixBase::TraceMatMat</a></div><div class="ttdeci">friend Real TraceMatMat(const CuMatrixBase&lt; Real &gt; &amp;A, const CuMatrixBase&lt; Real &gt; &amp;B, MatrixTransposeType trans)</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l02128">cu-matrix.cc:2128</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adbd817b31bc0a35fda44edbe94a4080b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbd817b31bc0a35fda44edbe94a4080b">&#9670;&nbsp;</a></span>GroupMax()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GroupMax </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>src</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply the function y(i) = (max_{j = i*G}^{(i+1)*G-1} x_j where G = x.NumCols() / y.NumCols() must be an integer. </p>
<p>[note: y corresponds to *this and x to src, so src.NumCols() / this-&gt;<a class="el" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols()</a> must be an integer. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01604">1604</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="_2nnet-component_8cc_source.html#l00442">MaxoutComponent::Propagate()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00573">kaldi::TestCuMatrixGroupMax()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00589">kaldi::TestCuMatrixGroupMaxAllGroupSizes()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l00317">kaldi::UnitTestCuMatrixGroupMax()</a>.</p>
<div class="fragment"><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;                                                               {</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;  <span class="keywordtype">int</span> group_size = src.NumCols() / this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>();</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(src.NumCols() == this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>() * group_size &amp;&amp;</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;               this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == src.NumRows());</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    CuTimer tim;</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <span class="comment">// One thread block per row.</span></div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <span class="comment">// Use 2D block for small group size to simplify the calculation.</span></div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    <span class="comment">// Each group is reduced by threads_per_group threads.</span></div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    <span class="comment">// threads_per_group should be a power of 2 for fast tree reduction.</span></div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    <span class="comment">//        group size: 1 2 3 4 5 6 7 .. 12 13 .. 24 25 .. 48 ...</span></div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    <span class="comment">// threads_per_group: 1 1 1 2 2 2 4 ..  4  8 ..  8 16 .. 16 ...</span></div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    <span class="keywordtype">int</span> threads_per_group = <a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a>;</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    <span class="keywordflow">while</span> (threads_per_group * 3 / 2 &gt;= group_size) {</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;      threads_per_group &gt;&gt;= 1;</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    }</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    <span class="keywordflow">if</span> (group_size == 1) {</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;      threads_per_group = 1;</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    }</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    dim3 dimBlock(threads_per_group, <a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a> / threads_per_group);</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    dim3 dimGrid(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>());</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    cuda_group_max(dimGrid, dimBlock, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, src.data_, this-&gt;Dim(),</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;        src.Stride(), group_size);</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  {</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().GroupMax(src.Mat());</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;  }</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a6dbdf9d0385c92d6d915b96eaf9ce99e"><div class="ttname"><a href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a></div><div class="ttdeci">#define CU1DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00063">cu-matrixdim.h:63</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adbddc0667daba04ecd6201e1ee028e8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbddc0667daba04ecd6201e1ee028e8d">&#9670;&nbsp;</a></span>GroupMaxDeriv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GroupMaxDeriv </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate derivatives for the GroupMax function above, where "input" is the input to the GroupMax function above (i.e. </p>
<p>the "src" variable), and "output" is the result of the computation (i.e. the "this" of that function call), and *this must have the same dimension as "input". Each element of *this will be set to 1 if the corresponding input equals the output of the group, and 0 otherwise. The equals the function derivative where it is defined (it's not defined where multiple inputs in the group are equal to the output). </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00861">861</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="_2nnet-component_8cc_source.html#l00452">MaxoutComponent::Backprop()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00612">kaldi::TestCuMatrixGroupMaxDeriv()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l01205">kaldi::UnitTestCuMatrixGroupMaxDeriv()</a>.</p>
<div class="fragment"><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                                                                       {</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(src2.NumCols() &gt; 0);</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  <span class="keywordtype">int</span> group_size = this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>() / src2.NumCols();</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>() == src2.NumCols() * group_size);</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    CuTimer tim;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    dim3 dimBlock(<a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>);</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    dim3 dimGrid(n_blocks(<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(), <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>),</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                 n_blocks(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>));</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    cuda_calc_group_max_deriv(dimGrid, dimBlock, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, src1.Data(),</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                              src2.Data(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), src1.Stride(), src2.Stride(),</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                              group_size);</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  {</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().GroupMaxDeriv(src1.Mat(), src2.Mat());</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  }</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a84acd86e193bca04fb719c476fbcbe5b"><div class="ttname"><a href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a></div><div class="ttdeci">#define CU2DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00067">cu-matrixdim.h:67</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae6d41b3236bb08ae2e30a1553045a23c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6d41b3236bb08ae2e30a1553045a23c">&#9670;&nbsp;</a></span>GroupPnorm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GroupPnorm </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>pow</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply the function y(i) = (sum_{j = i*G}^{(i+1)*G-1} x_j ^ (power)) ^ (1 / p) where G = x.NumCols() / y.NumCols() must be an integer. </p>
<p>[note: y corresponds to *this and x to src, so src.NumCols() / this-&gt;<a class="el" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols()</a> must be an integer. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01563">1563</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="_2nnet-component_8cc_source.html#l00513">PnormComponent::Propagate()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00553">kaldi::TestCuMatrixDiffGroupPnorm()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00536">kaldi::TestCuMatrixGroupPnorm()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l00292">kaldi::UnitTestCuMatrixGroupPnorm()</a>.</p>
<div class="fragment"><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;                                                                             {</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  <span class="keywordtype">int</span> group_size = src.NumCols() / this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>();</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(src.NumCols() == this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>() * group_size &amp;&amp;</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;               this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == src.NumRows());</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    CuTimer tim;</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    <span class="keywordflow">if</span> (power == Real(0) || power == Real(1) || power == Real(2)</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;        || power == std::numeric_limits&lt;Real&gt;::infinity()) {</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;      <span class="comment">// One thread block per row.</span></div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;      <span class="comment">// Use 2D block for small group size to simplify the calculation</span></div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;      <span class="comment">// Each group is reduced by threads_per_group threads.</span></div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;      <span class="comment">// threads_per_group should be a power of 2 for fast tree reduction.</span></div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;      <span class="keywordtype">int</span> threads_per_group = <a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a>;</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;      <span class="keywordflow">while</span> (threads_per_group * 3 / 2 &gt;= group_size) {</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;        threads_per_group &gt;&gt;= 1;</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;      }</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;      <span class="keywordflow">if</span> (group_size == 1) {</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        threads_per_group = 1;</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;      }</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;      dim3 dimBlock(threads_per_group, <a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a> / threads_per_group);</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;      dim3 dimGrid(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>());</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;      cuda_group_spec_pnorm(dimGrid, dimBlock, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, src.data_,</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;                            this-&gt;Dim(), src.Stride(), group_size, power);</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;      dim3 dimBlock(<a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>);</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;      dim3 dimGrid(n_blocks(<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(), <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>),</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;                   n_blocks(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>));</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;      cuda_group_pnorm(dimGrid, dimBlock, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, src.data_, this-&gt;Dim(),</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;                       src.Stride(), group_size, power);</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    }</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;  {</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().GroupPnorm(src.Mat(), power);</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;  }</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a6dbdf9d0385c92d6d915b96eaf9ce99e"><div class="ttname"><a href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a></div><div class="ttdeci">#define CU1DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00063">cu-matrixdim.h:63</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a84acd86e193bca04fb719c476fbcbe5b"><div class="ttname"><a href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a></div><div class="ttdeci">#define CU2DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00067">cu-matrixdim.h:67</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae82afecb83b55a59388b8c55b958e6bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae82afecb83b55a59388b8c55b958e6bf">&#9670;&nbsp;</a></span>Heaviside()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Heaviside </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>src</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set each element to the Heaviside function of the corresponding element of "src", which we define as the function (x &gt; 0 ? 1.0 : 0.0) [note: in general, there are different ways to deal with the situation when x==0. </p>
<p>] </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02463">2463</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-simple-component_8cc_source.html#l00967">RectifiedLinearComponent::Backprop()</a>, <a class="el" href="cu-rand_8cc_source.html#l00194">CuRand&lt; float &gt;::BinarizeProbs()</a>, <a class="el" href="cu-compressed-matrix-test_8cc_source.html#l00034">kaldi::CuCompressedMatrixTestSign()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01076">RectifiedLinearComponent::StoreStats()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l00978">kaldi::UnitTestCuMatrixHeaviside()</a>.</p>
<div class="fragment"><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;                                                                {</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">SameDim</a>(*<span class="keyword">this</span>, src));</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;    cuda_heaviside(dimGrid, dimBlock, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, src.data_, this-&gt;Dim(),</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;                   src.Stride());</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;<span class="preprocessor">  #endif</span></div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;  {</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().Heaviside(src.Mat());</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;  }</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="group__matrix__funcs__io_html_ga07b147212efb08775c252cd4cc7453fe"><div class="ttname"><a href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">kaldi::SameDim</a></div><div class="ttdeci">bool SameDim(const MatrixBase&lt; Real &gt; &amp;M, const MatrixBase&lt; Real &gt; &amp;N)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l01065">kaldi-matrix.h:1065</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a48ca3ab8b1fd73a49e5c7ee2870f36af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48ca3ab8b1fd73a49e5c7ee2870f36af">&#9670;&nbsp;</a></span>InvertElements()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void InvertElements </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>invert the matrix by elements. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00919">919</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00308">kaldi::TestCuMatrixCompObjfAndDeriv()</a>, <a class="el" href="train-nnet-ensemble_8cc_source.html#l00050">NnetEnsembleTrainer::TrainOneMinibatch()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02094">kaldi::UnitTestCuMatrixInvertElements()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l02774">kaldi::UnitTestCuMatrixObjfDeriv()</a>.</p>
<div class="fragment"><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                                        {</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    CuTimer tim;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    cuda_invert_elements(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  {</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().InvertElements();</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  }</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac8942de74bc673faeba1fba05a4a9ab9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8942de74bc673faeba1fba05a4a9ab9">&#9670;&nbsp;</a></span>IsUnit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> IsUnit </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>tol</em> = <code>0.001</code></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00595">595</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8h_source.html#l00225">CuMatrixBase&lt; float &gt;::FrobeniusNorm()</a>, <a class="el" href="nnet-precondition-online_8cc_source.html#l00045">OnlinePreconditioner::InitOrthonormalSpecial()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01614">kaldi::UnitTestCuMatrixSymInvertPosDef()</a>, and <a class="el" href="cu-sp-matrix-test_8cc_source.html#l00152">kaldi::UnitTestCuSpMatrixInvert()</a>.</p>
<div class="fragment"><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                                              {</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="comment">// want to return:</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="comment">//FrobeniusNorm(*this - I) &lt;= tol * NumRows(), i.e.:</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="comment">//sqrt (trace((*this - I)(*this-I)) &lt;= tol * NumRows()</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="comment">//    trace((*this - I)(*this - I)) &lt;= tol * NumRows()</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="comment">// trace(*this * *this) + trace(I) - 2 * trace(*this) &lt;= tol * NumRows()</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="comment">// trace(*this * *this) + dim - 2*this.Trace() &lt;= tol * NumRows()</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>());</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="keywordflow">return</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a66bed104430bbbde5005c244cf0387f7">TraceMatMat</a>(*<span class="keyword">this</span>, *<span class="keyword">this</span>, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>) + this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() - 2.0 * this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a4c7007b65327e6c20f96b576c3725881">Trace</a>() &lt;=</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;          tol * this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>());</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a4c7007b65327e6c20f96b576c3725881"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a4c7007b65327e6c20f96b576c3725881">kaldi::CuMatrixBase::Trace</a></div><div class="ttdeci">Real Trace(bool check_square=true) const</div><div class="ttdoc">Return the trace. If check_square = true, will crash if matrix is not square. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l03042">cu-matrix.cc:3042</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00033">matrix-common.h:33</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a66bed104430bbbde5005c244cf0387f7"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a66bed104430bbbde5005c244cf0387f7">kaldi::CuMatrixBase::TraceMatMat</a></div><div class="ttdeci">friend Real TraceMatMat(const CuMatrixBase&lt; Real &gt; &amp;A, const CuMatrixBase&lt; Real &gt; &amp;B, MatrixTransposeType trans)</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l02128">cu-matrix.cc:2128</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af4bab2818ebf715b87fd30ebd13d0ba3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4bab2818ebf715b87fd30ebd13d0ba3">&#9670;&nbsp;</a></span>KALDI_DISALLOW_COPY_AND_ASSIGN()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">KALDI_DISALLOW_COPY_AND_ASSIGN </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a14d5fa17b88435baf999fd60195859bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14d5fa17b88435baf999fd60195859bb">&#9670;&nbsp;</a></span>Lookup() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Lookup </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structInt32Pair.html">Int32Pair</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>indexes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real *&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l03336">3336</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-compute-discriminative_8cc_source.html#l00178">NnetDiscriminativeUpdater::LatticeComputations()</a>, <a class="el" href="cu-matrix_8h_source.html#l00633">CuMatrixBase&lt; float &gt;::operator()()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00782">kaldi::TestCuMatrixLookup()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l02874">kaldi::UnitTestCuMatrixLookup()</a>.</p>
<div class="fragment"><div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;                                                    {</div><div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;  <span class="comment">// Checks the dimension.</span></div><div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;  <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> num_rows = this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, num_cols = this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>;</div><div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;  <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; indices.size(); ++<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(indices[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].first &lt; num_rows &amp;&amp; indices[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].first &gt;= 0 &amp;&amp;</div><div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;                 indices[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].second &lt; num_cols &amp;&amp; indices[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].second &gt;= 0);</div><div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;  }</div><div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;  <span class="keywordflow">if</span> (indices.size() == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(output != NULL);</div><div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;</div><div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;    CuArray&lt;Int32Pair&gt; cuda_indices(indices);</div><div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a14d5fa17b88435baf999fd60195859bb">Lookup</a>(cuda_indices, output);</div><div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;  {</div><div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;    <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; indices.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;      output[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] = (*this)(indices[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].first, indices[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].second);</div><div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;    }</div><div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;  }</div><div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a14d5fa17b88435baf999fd60195859bb"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a14d5fa17b88435baf999fd60195859bb">kaldi::CuMatrixBase::Lookup</a></div><div class="ttdeci">void Lookup(const std::vector&lt; Int32Pair &gt; &amp;indexes, Real *output) const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l03336">cu-matrix.cc:3336</a></div></div>
<div class="ttc" id="namespacekaldi_html_aac2c220416519a2b0a7ad822ee2ef972"><div class="ttname"><a href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">kaldi::MatrixIndexT</a></div><div class="ttdeci">int32 MatrixIndexT</div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00098">matrix-common.h:98</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad35003f6f281f76d0590a4b040e99bb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad35003f6f281f76d0590a4b040e99bb3">&#9670;&nbsp;</a></span>Lookup() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Lookup </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; <a class="el" href="structInt32Pair.html">Int32Pair</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>indexes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real *&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l03361">3361</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;                                                    {</div><div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;  int32 num_elements = indices.Dim();</div><div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;  <span class="keywordflow">if</span> (num_elements == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(output != NULL);</div><div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;</div><div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;    CuArray&lt;Real&gt; cuda_output(num_elements);</div><div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;    CuTimer tim;</div><div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;    dim3 dimBlock(<a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a>, 1);</div><div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;    dim3 dimGrid(n_blocks(num_elements, <a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a>), 1);</div><div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;</div><div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;    cuda_matrix_lookup(dimGrid, dimBlock, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(),</div><div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;                       indices.Data(), num_elements, cuda_output.Data());</div><div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;</div><div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;    cuda_output.CopyToHost(output);</div><div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;  {</div><div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;    <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> num_rows = this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, num_cols = this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>;</div><div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;    <span class="keyword">const</span> <a class="code" href="structInt32Pair.html">Int32Pair</a> *index = indices.Data();</div><div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;    <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; num_elements; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(index[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].first &lt; num_rows &amp;&amp; index[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].first &gt;= 0 &amp;&amp;</div><div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;                   index[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].second &lt; num_cols &amp;&amp; index[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].second &gt;= 0);</div><div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;      output[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] = (*this)(index[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="structInt32Pair.html#a9b288b26b67b6a87162a9e1ab5b35dbf">first</a>, index[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="structInt32Pair.html#a03a67f151bb1afcfcafab8870b75acff">second</a>);</div><div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;    }</div><div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;  }</div><div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="namespacekaldi_html_aac2c220416519a2b0a7ad822ee2ef972"><div class="ttname"><a href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">kaldi::MatrixIndexT</a></div><div class="ttdeci">int32 MatrixIndexT</div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00098">matrix-common.h:98</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a6dbdf9d0385c92d6d915b96eaf9ce99e"><div class="ttname"><a href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a></div><div class="ttdeci">#define CU1DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00063">cu-matrixdim.h:63</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="structInt32Pair_html"><div class="ttname"><a href="structInt32Pair.html">Int32Pair</a></div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00084">cu-matrixdim.h:84</a></div></div>
<div class="ttc" id="structInt32Pair_html_a03a67f151bb1afcfcafab8870b75acff"><div class="ttname"><a href="structInt32Pair.html#a03a67f151bb1afcfcafab8870b75acff">Int32Pair::second</a></div><div class="ttdeci">int32_cuda second</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00086">cu-matrixdim.h:86</a></div></div>
<div class="ttc" id="structInt32Pair_html_a9b288b26b67b6a87162a9e1ab5b35dbf"><div class="ttname"><a href="structInt32Pair.html#a9b288b26b67b6a87162a9e1ab5b35dbf">Int32Pair::first</a></div><div class="ttdeci">int32_cuda first</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00085">cu-matrixdim.h:85</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1ae27d8d38f2a7651c76b4f102867dee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ae27d8d38f2a7651c76b4f102867dee">&#9670;&nbsp;</a></span>Mat() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt;Real&gt;&amp; Mat </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00698">698</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8cc_source.html#l02668">CuMatrixBase&lt; float &gt;::AddCols()</a>, <a class="el" href="cu-vector_8cc_source.html#l01254">CuVectorBase&lt; float &gt;::AddColSumMat()</a>, <a class="el" href="cu-vector_8cc_source.html#l00567">CuVectorBase&lt; float &gt;::AddDiagMat2()</a>, <a class="el" href="cu-vector_8cc_source.html#l00583">CuVectorBase&lt; float &gt;::AddDiagMatMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01369">CuMatrixBase&lt; float &gt;::AddDiagVecMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00941">CuMatrixBase&lt; float &gt;::AddMat()</a>, <a class="el" href="cu-sp-matrix_8cc_source.html#l00130">CuSpMatrix&lt; Real &gt;::AddMat2()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01106">CuMatrixBase&lt; float &gt;::AddMatBlocks()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01402">CuMatrixBase&lt; float &gt;::AddMatDiagVec()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01278">CuMatrixBase&lt; float &gt;::AddMatMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01434">CuMatrixBase&lt; float &gt;::AddMatMatElements()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01067">CuMatrixBase&lt; float &gt;::AddMatSmat()</a>, <a class="el" href="cu-vector_8cc_source.html#l00478">CuVectorBase&lt; float &gt;::AddMatVec()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02733">CuMatrixBase&lt; float &gt;::AddRows()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01011">CuMatrixBase&lt; float &gt;::AddSmatMat()</a>, <a class="el" href="cu-sparse-matrix_8cc_source.html#l00679">GeneralMatrix::AddToMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02836">CuMatrixBase&lt; float &gt;::AddToRows()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01724">CuMatrixBase&lt; float &gt;::ApplyLogSoftMaxPerRow()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01701">CuMatrixBase&lt; float &gt;::ApplySoftMaxPerRow()</a>, <a class="el" href="cu-math_8cc_source.html#l00768">kaldi::cu::BackpropLstmNonlinearity()</a>, <a class="el" href="cu-math_8cc_source.html#l00489">kaldi::cu::ComputeLstmNonlinearity()</a>, <a class="el" href="cu-math_8cc_source.html#l00173">kaldi::cu::Copy()</a>, <a class="el" href="cu-vector_8cc_source.html#l00102">CuVectorBase&lt; float &gt;::CopyColFromMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02623">CuMatrixBase&lt; float &gt;::CopyCols()</a>, <a class="el" href="cu-vector_8cc_source.html#l01296">CuVectorBase&lt; float &gt;::CopyElements()</a>, <a class="el" href="cu-tp-matrix_8cc_source.html#l00089">CuTpMatrix&lt; Real &gt;::CopyFromMat()</a>, <a class="el" href="cu-sp-matrix_8cc_source.html#l00039">CuSpMatrix&lt; Real &gt;::CopyFromMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00207">CuMatrixBase&lt; float &gt;::CopyFromMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02645">CuMatrixBase&lt; float &gt;::CopyRows()</a>, <a class="el" href="cu-vector_8cc_source.html#l00163">CuVectorBase&lt; float &gt;::CopyRowsFromMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02591">VectorBase&lt; float &gt;::CopyRowsFromMat()</a>, <a class="el" href="cu-sparse-matrix_8cc_source.html#l00622">CuSparseMatrix&lt; Real &gt;::CopyToMat()</a>, <a class="el" href="cu-sparse-matrix_8cc_source.html#l00582">GeneralMatrix::CopyToMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00828">CuMatrixBase&lt; float &gt;::DiffGroupPnorm()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01488">CuMatrixBase&lt; float &gt;::DiffParametricRelu()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01748">CuMatrixBase&lt; float &gt;::DiffSigmoid()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01793">CuMatrixBase&lt; float &gt;::DiffTanh()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00678">CuMatrixBase&lt; float &gt;::DivElements()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01604">CuMatrixBase&lt; float &gt;::GroupMax()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00861">CuMatrixBase&lt; float &gt;::GroupMaxDeriv()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01563">CuMatrixBase&lt; float &gt;::GroupPnorm()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02463">CuMatrixBase&lt; float &gt;::Heaviside()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00702">CuMatrixBase&lt; float &gt;::Max()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00727">CuMatrixBase&lt; float &gt;::Min()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00654">CuMatrixBase&lt; float &gt;::MulElements()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02757">CuMatrixBase&lt; float &gt;::MulRows()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00803">CuMatrixBase&lt; float &gt;::MulRowsGroupMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01454">CuMatrixBase&lt; float &gt;::ParametricRelu()</a>, <a class="el" href="cu-rand_8cc_source.html#l00113">CuRand&lt; float &gt;::RandGaussian()</a>, <a class="el" href="cu-math_8cc_source.html#l00080">kaldi::cu::Randomize()</a>, <a class="el" href="cu-rand_8cc_source.html#l00060">CuRand&lt; float &gt;::RandUniform()</a>, <a class="el" href="cu-math_8cc_source.html#l00037">kaldi::cu::RegularizeL1()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01193">CuMatrixBase&lt; float &gt;::SetMatMatDivMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01521">CuMatrixBase&lt; float &gt;::Sigmoid()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01542">CuMatrixBase&lt; float &gt;::SoftHinge()</a>, <a class="el" href="cu-math_8cc_source.html#l00132">kaldi::cu::Splice()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01340">CuMatrixBase&lt; float &gt;::SymAddMat2()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01770">CuMatrixBase&lt; float &gt;::Tanh()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02128">kaldi::TraceMatMat()</a>, and <a class="el" href="cu-sparse-matrix_8cc_source.html#l00524">kaldi::TraceMatSmat()</a>.</p>
<div class="fragment"><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                                             {</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keywordflow">return</span> *(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>MatrixBase&lt;Real&gt;* <span class="keyword">&gt;</span>(<span class="keyword">this</span>));</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  }</div></div><!-- fragment -->
</div>
</div>
<a id="a9f8090e690bdcb5cddbaa3884506c6ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f8090e690bdcb5cddbaa3884506c6ae">&#9670;&nbsp;</a></span>Mat() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt;Real&gt;&amp; Mat </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00701">701</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                                 {</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keywordflow">return</span> *(<span class="keyword">reinterpret_cast&lt;</span>MatrixBase&lt;Real&gt;* <span class="keyword">&gt;</span>(<span class="keyword">this</span>));</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  }</div></div><!-- fragment -->
</div>
</div>
<a id="a6881fe49b9f43a0a337eb1878e0d5721"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6881fe49b9f43a0a337eb1878e0d5721">&#9670;&nbsp;</a></span>Max() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Max </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Do, elementwise, *this = max(*this, A). </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00702">702</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-compressed-matrix-test_8cc_source.html#l00054">kaldi::CuCompressedMatrixTestNonnegative()</a>, <a class="el" href="cu-compressed-matrix-test_8cc_source.html#l00107">kaldi::CuCompressedMatrixTestSymmetric()</a>, <a class="el" href="nnet-forward_8cc_source.html#l00030">main()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l02847">SpliceMaxComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l04721">MaxpoolingComponent::Propagate()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00063">kaldi::TestCuMatrixMax()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01047">kaldi::UnitTestCuMatrixMax()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l01521">kaldi::UnitTestCuMatrixReduceMax()</a>.</p>
<div class="fragment"><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                                                        {</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="preprocessor">  #if HAVE_CUDA == 1</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    CuTimer tim;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a> == A.NumCols());</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == A.NumRows());</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    cuda_max(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, A.data_, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), A.Stride());</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="preprocessor">  #endif</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  {</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().Max(A.Mat());</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  }</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6259d05a6903a4c8c9bd72f4bbc116c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6259d05a6903a4c8c9bd72f4bbc116c1">&#9670;&nbsp;</a></span>Max() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Real Max </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l03000">3000</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8h_source.html#l00633">CuMatrixBase&lt; float &gt;::operator()()</a>, and <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>.</p>
<div class="fragment"><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;                                   {</div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> &gt; 0 &amp;&amp; <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a> &gt; 0);</div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;    CuTimer tim;</div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;</div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;    CuVector&lt;Real&gt; col_max(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, <a class="code" href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kUndefined</a>);</div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;    cuda_max_mat_cols(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, <a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a>, col_max.Data(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;    Real ans = col_max.Max();</div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;</div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;    <span class="keywordflow">return</span> ans;</div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;  {</div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().Max();</div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;  }</div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126"><div class="ttname"><a href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kaldi::kUndefined</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00039">matrix-common.h:39</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a6dbdf9d0385c92d6d915b96eaf9ce99e"><div class="ttname"><a href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a></div><div class="ttdeci">#define CU1DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00063">cu-matrixdim.h:63</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a055340b299b3ffbf460d4f73a5175d07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a055340b299b3ffbf460d4f73a5175d07">&#9670;&nbsp;</a></span>Min() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Min </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Do, elementwise, *this = min(*this, A). </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00727">727</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-compressed-matrix-test_8cc_source.html#l00054">kaldi::CuCompressedMatrixTestNonnegative()</a>, <a class="el" href="cu-compressed-matrix-test_8cc_source.html#l00107">kaldi::CuCompressedMatrixTestSymmetric()</a>, <a class="el" href="nnet-forward_8cc_source.html#l00030">main()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00080">kaldi::TestCuMatrixMin()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01068">kaldi::UnitTestCuMatrixMin()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l01530">kaldi::UnitTestCuMatrixReduceMin()</a>.</p>
<div class="fragment"><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                                                        {</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="preprocessor">  #if HAVE_CUDA == 1</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    CuTimer tim;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a> == A.NumCols());</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == A.NumRows());</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    cuda_min(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, A.data_, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), A.Stride());</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="preprocessor">  #endif</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  {</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().Min(A.Mat());</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  }</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a71501acda04fb82ed3ec279ddda43e28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71501acda04fb82ed3ec279ddda43e28">&#9670;&nbsp;</a></span>Min() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Real Min </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l03021">3021</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8h_source.html#l00633">CuMatrixBase&lt; float &gt;::operator()()</a>, and <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>.</p>
<div class="fragment"><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;                                   {</div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> &gt; 0 &amp;&amp; <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a> &gt; 0);</div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;    CuTimer tim;</div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;</div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;    CuVector&lt;Real&gt; col_min(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, <a class="code" href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kUndefined</a>);</div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;    cuda_min_mat_cols(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, <a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a>, col_min.Data(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;    Real ans = col_min.Min();</div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;</div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;    <span class="keywordflow">return</span> ans;</div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;  {</div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().Min();</div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;  }</div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126"><div class="ttname"><a href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kaldi::kUndefined</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00039">matrix-common.h:39</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a6dbdf9d0385c92d6d915b96eaf9ce99e"><div class="ttname"><a href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a></div><div class="ttdeci">#define CU1DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00063">cu-matrixdim.h:63</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6f6c664e96c310dca11dc987a3c1632c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f6c664e96c310dca11dc987a3c1632c">&#9670;&nbsp;</a></span>MulColsVec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MulColsVec </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>scale</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>scale i'th column by scale[i] </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00752">752</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-normalize-component_8cc_source.html#l00466">BatchNormComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03376">FixedScaleComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02037">PerElementScaleComponent::Backprop()</a>, <a class="el" href="nnet-convolutional-2d-component_8h_source.html#l00324">Convolutional2DComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-various_8h_source.html#l00486">Rescale::BackpropagateFnc()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02521">ScaleAndOffsetComponent::BackpropInternal()</a>, <a class="el" href="nnet-utils_8cc_source.html#l01913">ModelCollapser::PreMultiplyAffineParameters()</a>, <a class="el" href="nnet-normalize-component_8cc_source.html#l00400">BatchNormComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03368">FixedScaleComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02021">PerElementScaleComponent::Propagate()</a>, <a class="el" href="nnet-various_8h_source.html#l00479">Rescale::PropagateFnc()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02461">ScaleAndOffsetComponent::PropagateInternal()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01274">kaldi::UnitTestCuMatrixAddMatDiagVec()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l01091">kaldi::UnitTestCuMatrixMulColsVec()</a>.</p>
<div class="fragment"><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                                                                   {</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    CuTimer tim;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(scale.Dim() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>());</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    cuda_mul_cols_vec(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, scale.data_, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  {</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().MulColsVec(scale.Vec());</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  }</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a93f1ecf679bf0ab28200c1cec33bd1ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93f1ecf679bf0ab28200c1cec33bd1ba">&#9670;&nbsp;</a></span>MulElements()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MulElements </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Multiply two matrices elementwise: C = C .* A. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00654">654</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-simple-component_8cc_source.html#l00273">ElementwiseProductComponent::Backprop()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l01098">BackpropTruncationComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00622">SigmoidComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00664">TanhComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00726">PowerComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00778">RectifiedLinearComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00810">SoftHingeComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l04786">MaxpoolingComponent::Backprop()</a>, <a class="el" href="nnet-activation_8h_source.html#l00087">HiddenSoftmax::BackpropagateFnc()</a>, <a class="el" href="nnet-activation_8h_source.html#l00342">Dropout::BackpropagateFnc()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02521">ScaleAndOffsetComponent::BackpropInternal()</a>, <a class="el" href="nnet-utils_8h_source.html#l00142">kaldi::nnet1::ComputeStdDev()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01852">CuMatrixBase&lt; float &gt;::DiffSoftmaxPerRow()</a>, <a class="el" href="nnet-loss_8cc_source.html#l00228">Mse::Eval()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00255">ElementwiseProductComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03531">DropoutComponent::Propagate()</a>, <a class="el" href="nnet-kl-hmm_8h_source.html#l00050">KlHmm::PropagateFnc()</a>, <a class="el" href="nnet-various_8h_source.html#l00256">LengthNormComponent::PropagateFnc()</a>, <a class="el" href="nnet-activation_8h_source.html#l00329">Dropout::PropagateFnc()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00738">ClipGradientComponent::RepairGradients()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="train-nnet-ensemble_8cc_source.html#l00050">NnetEnsembleTrainer::TrainOneMinibatch()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01302">kaldi::UnitTestCuMatrixAddMatMatElements()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00997">kaldi::UnitTestCuMatrixMulElements()</a>, <a class="el" href="nnet-component-test_8cc_source.html#l00054">kaldi::nnet1::UnitTestLengthNorm()</a>, <a class="el" href="nnet-affine-transform_8h_source.html#l00179">AffineTransform::Update()</a>, <a class="el" href="nnet-frame-pooling-component_8h_source.html#l00241">FramePoolingComponent::Update()</a>, <a class="el" href="nnet-convolutional-component_8h_source.html#l00400">ConvolutionalComponent::Update()</a>, <a class="el" href="nnet-various_8h_source.html#l00495">Rescale::Update()</a>, and <a class="el" href="nnet-simple-component_8cc_source.html#l03918">NaturalGradientPerElementScaleComponent::Update()</a>.</p>
<div class="fragment"><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                                                                {</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="preprocessor">  #if HAVE_CUDA == 1</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    CuTimer tim;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a> == A.NumCols());</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == A.NumRows());</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    cuda_mul_elements(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, A.data_, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), A.Stride());</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="preprocessor">  #endif</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  {</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().MulElements(A.Mat());</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  }</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a05ab5a8d45ac27726d551dcfed8fbfeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05ab5a8d45ac27726d551dcfed8fbfeb">&#9670;&nbsp;</a></span>MulRows()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MulRows </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>indexes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Does for each row r, this.Row(r) *= alpha * src.row(indexes[r]), where '*=' is elementwise multiplication. </p>
<p>If indexes[r] &lt; 0, does not add anything. src.NumCols() must equal this.NumCols() </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02757">2757</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-general-component_8cc_source.html#l01578">GeneralDropoutComponent::Backprop()</a>, and <a class="el" href="nnet-general-component_8cc_source.html#l01545">GeneralDropoutComponent::Propagate()</a>.</p>
<div class="fragment"><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;                                                                           {</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(static_cast&lt;MatrixIndexT&gt;(indexes.Dim()) == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>());</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(src.NumCols() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>());</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;    cuda_mul_rows(dimGrid, dimBlock,</div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;                  <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, src.Data(), indexes.Data(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), src.Stride());</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;  {</div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;    MatrixBase&lt;Real&gt; &amp;this_mat(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>());</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;    <span class="keyword">const</span> MatrixBase&lt;Real&gt; &amp;src_mat(src.Mat());</div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;    int32 num_rows = <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>();</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> *index_ptr = indexes.Data();</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;    <span class="keywordflow">for</span> (int32 r = 0; r &lt; num_rows; r++) {</div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;      int32 src_r = index_ptr[r];</div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;      <span class="keywordflow">if</span> (src_r &lt; 0)</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;      SubVector&lt;Real&gt; this_row(this_mat, r),</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;          src_row(src_mat, src_r);</div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;      this_row.MulElements(src_row);</div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;    }</div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;  }</div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="namespacekaldi_html_aac2c220416519a2b0a7ad822ee2ef972"><div class="ttname"><a href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">kaldi::MatrixIndexT</a></div><div class="ttdeci">int32 MatrixIndexT</div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00098">matrix-common.h:98</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0bb9285c3b3d6c789c70da92831ae344"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bb9285c3b3d6c789c70da92831ae344">&#9670;&nbsp;</a></span>MulRowsGroupMat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MulRowsGroupMat </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>src</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>divide each row into src.NumCols() groups, and then scale i'th row's jth group of elements by src[i, j]. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00803">803</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="_2nnet-component_8cc_source.html#l00452">MaxoutComponent::Backprop()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l01139">kaldi::UnitTestCuMatrixMulRowsGroupMat()</a>.</p>
<div class="fragment"><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                                                                      {</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(src.NumCols() &gt; 0);</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    CuTimer tim;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="keywordtype">int</span> group_size = this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>() / src.NumCols();</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    cuda_mul_rows_group_mat(dimGrid, dimBlock, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, src.data_,</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                            this-&gt;Dim(), src.Stride(), group_size);</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  {</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().MulRowsGroupMat(src.Mat());</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  }</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9316d4a8c6a73dfadbf9e8417e70a514"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9316d4a8c6a73dfadbf9e8417e70a514">&#9670;&nbsp;</a></span>MulRowsVec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MulRowsVec </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>scale</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>scale i'th row by scale[i] </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00779">779</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-general-component_8cc_source.html#l01098">BackpropTruncationComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00675">ClipGradientComponent::Backprop()</a>, <a class="el" href="nnet-activation_8h_source.html#l00174">BlockSoftmax::BackpropagateFnc()</a>, <a class="el" href="nnet-various_8h_source.html#l00273">LengthNormComponent::BackpropagateFnc()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01887">CuMatrixBase&lt; float &gt;::DiffLogSoftmaxPerRow()</a>, <a class="el" href="cu-math_8cc_source.html#l00349">kaldi::cu::DiffNormalizePerRow()</a>, <a class="el" href="nnet-loss_8cc_source.html#l00062">Xent::Eval()</a>, <a class="el" href="nnet-loss_8cc_source.html#l00228">Mse::Eval()</a>, <a class="el" href="nnet-precondition_8cc_source.html#l00026">kaldi::nnet2::PreconditionDirections()</a>, <a class="el" href="nnet-chain-training_8cc_source.html#l00283">NnetChainTrainer::ProcessOutputs()</a>, <a class="el" href="nnet-discriminative-training_8cc_source.html#l00109">NnetDiscriminativeTrainer::ProcessOutputs()</a>, <a class="el" href="nnet-various_8h_source.html#l00256">LengthNormComponent::PropagateFnc()</a>, <a class="el" href="nnet-precondition-online_8cc_source.html#l00184">OnlinePreconditioner::ReorthogonalizeXt1()</a>, <a class="el" href="natural-gradient-online_8cc_source.html#l00200">OnlineNaturalGradient::ReorthogonalizeXt1()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01114">kaldi::UnitTestCuMatrixMulRowsVec()</a>, and <a class="el" href="convolution-test_8cc_source.html#l00198">kaldi::nnet3::time_height_convolution::ZeroBlankRows()</a>.</p>
<div class="fragment"><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                                                                   {</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="preprocessor">  #if HAVE_CUDA == 1</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    CuTimer tim;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(scale.Dim() == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>());</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    cuda_mul_rows_vec(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, scale.data_, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="preprocessor">  #endif</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  {</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().MulRowsVec(scale.Vec());</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  }</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acd4c9f53536602585f5aff9e8005299a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd4c9f53536602585f5aff9e8005299a">&#9670;&nbsp;</a></span>NumCols()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> NumCols </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00215">215</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00542">NnetComputer::AcceptInput()</a>, <a class="el" href="nnet3-acc-lda-stats_8cc_source.html#l00065">NnetLdaStatsAccumulator::AccStatsFromOutput()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00261">RestrictedAttentionComponent::Add()</a>, <a class="el" href="nnet-randomizer_8cc_source.html#l00047">MatrixRandomizer::AddData()</a>, <a class="el" href="cu-vector_8cc_source.html#l00567">CuVectorBase&lt; float &gt;::AddDiagMat2()</a>, <a class="el" href="cu-vector_8cc_source.html#l00583">CuVectorBase&lt; float &gt;::AddDiagMatMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01369">CuMatrixBase&lt; float &gt;::AddDiagVecMat()</a>, <a class="el" href="cu-rand_8cc_source.html#l00204">CuRand&lt; float &gt;::AddGaussNoise()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00941">CuMatrixBase&lt; float &gt;::AddMat()</a>, <a class="el" href="cu-sp-matrix_8cc_source.html#l00130">CuSpMatrix&lt; Real &gt;::AddMat2()</a>, <a class="el" href="cu-matrix_8cc_source.html#l03172">CuMatrixBase&lt; float &gt;::AddMatBlock()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01106">CuMatrixBase&lt; float &gt;::AddMatBlocks()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01402">CuMatrixBase&lt; float &gt;::AddMatDiagVec()</a>, <a class="el" href="cu-block-matrix_8cc_source.html#l00211">CuBlockMatrix&lt; Real &gt;::AddMatMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01278">CuMatrixBase&lt; float &gt;::AddMatMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02190">kaldi::AddMatMatBatched()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01067">CuMatrixBase&lt; float &gt;::AddMatSmat()</a>, <a class="el" href="cu-vector_8cc_source.html#l00478">CuVectorBase&lt; float &gt;::AddMatVec()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02898">CuMatrixBase&lt; float &gt;::AddRowRanges()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02733">CuMatrixBase&lt; float &gt;::AddRows()</a>, <a class="el" href="cu-vector_8cc_source.html#l01242">CuVectorBase&lt; float &gt;::AddRowSumMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01011">CuMatrixBase&lt; float &gt;::AddSmatMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02836">CuMatrixBase&lt; float &gt;::AddToRows()</a>, <a class="el" href="attention_8cc_source.html#l00076">kaldi::nnet3::attention::ApplyScalesToInput()</a>, <a class="el" href="attention-test_8cc_source.html#l00072">kaldi::nnet3::attention::ApplyScalesToInputSimple()</a>, <a class="el" href="attention_8cc_source.html#l00055">kaldi::nnet3::attention::ApplyScalesToOutput()</a>, <a class="el" href="attention-test_8cc_source.html#l00052">kaldi::nnet3::attention::ApplyScalesToOutputSimple()</a>, <a class="el" href="attention_8cc_source.html#l00154">kaldi::nnet3::attention::AttentionBackward()</a>, <a class="el" href="attention_8cc_source.html#l00097">kaldi::nnet3::attention::AttentionForward()</a>, <a class="el" href="nnet-update_8cc_source.html#l00188">NnetUpdater::Backprop()</a>, <a class="el" href="nnet-normalize-component_8cc_source.html#l00466">BatchNormComponent::Backprop()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00476">StatisticsExtractionComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00452">MaxoutComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l04318">MaxpoolingComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00524">PnormComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00599">NormalizeComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01454">RepeatedAffineComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00622">SigmoidComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00664">TanhComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00726">PowerComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00778">RectifiedLinearComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00810">SoftHingeComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00845">ScaleComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00919">SoftmaxComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00965">LogSoftmaxComponent::Backprop()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l01578">GeneralDropoutComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l02662">SpliceComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l02891">SpliceMaxComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l02035">BlockAffineComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l02350">PermuteComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03086">DctComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03566">DropoutComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02210">PerElementOffsetComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03966">Convolutional1dComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02474">ScaleAndOffsetComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l04355">ConvolutionComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l05187">CompositeComponent::Backprop()</a>, <a class="el" href="nnet-component_8h_source.html#l00328">Component::Backpropagate()</a>, <a class="el" href="nnet-various_8h_source.html#l00111">Splice::BackpropagateFnc()</a>, <a class="el" href="nnet-sentence-averaging-component_8h_source.html#l00267">SentenceAveragingComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-convolutional-2d-component_8h_source.html#l00324">Convolutional2DComponent::BackpropagateFnc()</a>, <a class="el" href="cu-math_8cc_source.html#l00768">kaldi::cu::BackpropLstmNonlinearity()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00334">RestrictedAttentionComponent::BackpropOneHead()</a>, <a class="el" href="cu-rand_8cc_source.html#l00194">CuRand&lt; float &gt;::BinarizeProbs()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l02559">ChunkInfo::CheckSize()</a>, <a class="el" href="nnet-utils_8cc_source.html#l01668">ModelCollapser::CollapseComponentsAffine()</a>, <a class="el" href="nnet3-compute-from-egs_8cc_source.html#l00041">NnetComputerFromEg::Compute()</a>, <a class="el" href="nnet-compute-online_8cc_source.html#l00035">NnetOnlineComputer::Compute()</a>, <a class="el" href="nnet-diagnostics_8cc_source.html#l00206">kaldi::nnet3::ComputeAccuracy()</a>, <a class="el" href="nnet2_2nnet-compute_8cc_source.html#l00111">NnetComputer::ComputeLastLayerDeriv()</a>, <a class="el" href="cu-math_8cc_source.html#l00489">kaldi::cu::ComputeLstmNonlinearity()</a>, <a class="el" href="nnet-training_8cc_source.html#l00370">kaldi::nnet3::ComputeObjectiveFunction()</a>, <a class="el" href="nnet-utils_8h_source.html#l00142">kaldi::nnet1::ComputeStdDev()</a>, <a class="el" href="nnet-precondition-online_8cc_source.html#l00501">OnlinePreconditioner::ComputeWt1()</a>, <a class="el" href="natural-gradient-online_8cc_source.html#l00482">OnlineNaturalGradient::ComputeWt1()</a>, <a class="el" href="nnet-utils_8cc_source.html#l01022">kaldi::nnet3::ConstrainOrthonormal()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00896">kaldi::nnet3::ConstrainOrthonormalInternal()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l03967">ConvolutionComponent::ConvolutionComponent()</a>, <a class="el" href="convolution_8cc_source.html#l00682">kaldi::nnet3::time_height_convolution::ConvolveBackwardData()</a>, <a class="el" href="convolution_8cc_source.html#l00603">kaldi::nnet3::time_height_convolution::ConvolveBackwardDataInternal()</a>, <a class="el" href="convolution_8cc_source.html#l00840">kaldi::nnet3::time_height_convolution::ConvolveBackwardParams()</a>, <a class="el" href="convolution_8cc_source.html#l00763">kaldi::nnet3::time_height_convolution::ConvolveBackwardParamsInternal()</a>, <a class="el" href="convolution_8cc_source.html#l00524">kaldi::nnet3::time_height_convolution::ConvolveForward()</a>, <a class="el" href="convolution_8cc_source.html#l00448">kaldi::nnet3::time_height_convolution::ConvolveForwardInternal()</a>, <a class="el" href="cu-math_8cc_source.html#l00173">kaldi::cu::Copy()</a>, <a class="el" href="cu-vector_8cc_source.html#l00102">CuVectorBase&lt; float &gt;::CopyColFromMat()</a>, <a class="el" href="cu-vector_8cc_source.html#l01163">CuVectorBase&lt; float &gt;::CopyDiagFromMat()</a>, <a class="el" href="cu-vector_8cc_source.html#l01296">CuVectorBase&lt; float &gt;::CopyElements()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00160">CuMatrixBase&lt; float &gt;::CopyFromBlock()</a>, <a class="el" href="cu-tp-matrix_8cc_source.html#l00089">CuTpMatrix&lt; Real &gt;::CopyFromMat()</a>, <a class="el" href="cu-compressed-matrix_8cc_source.html#l00065">CuCompressedMatrix&lt; I &gt;::CopyFromMat()</a>, <a class="el" href="cu-sp-matrix_8cc_source.html#l00039">CuSpMatrix&lt; Real &gt;::CopyFromMat()</a>, <a class="el" href="cu-block-matrix_8cc_source.html#l00296">CuBlockMatrix&lt; Real &gt;::CopyFromMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00207">CuMatrixBase&lt; float &gt;::CopyFromMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02645">CuMatrixBase&lt; float &gt;::CopyRows()</a>, <a class="el" href="cu-vector_8cc_source.html#l00163">CuVectorBase&lt; float &gt;::CopyRowsFromMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02591">VectorBase&lt; float &gt;::CopyRowsFromMat()</a>, <a class="el" href="cu-sparse-matrix_8cc_source.html#l00622">CuSparseMatrix&lt; Real &gt;::CopyToMat()</a>, <a class="el" href="cu-compressed-matrix_8cc_source.html#l00102">CuCompressedMatrix&lt; I &gt;::CopyToMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00375">CuMatrix&lt; float &gt;::CuMatrix()</a>, <a class="el" href="cu-rand-speed-test_8cc_source.html#l00129">kaldi::CuRandGaussianMatrixBaseSpeedTest()</a>, <a class="el" href="cu-rand-speed-test_8cc_source.html#l00110">kaldi::CuRandGaussianMatrixSpeedTest()</a>, <a class="el" href="cu-rand-speed-test_8cc_source.html#l00091">kaldi::CuRandUniformMatrixBaseSpeedTest()</a>, <a class="el" href="cu-rand-speed-test_8cc_source.html#l00072">kaldi::CuRandUniformMatrixSpeedTest()</a>, <a class="el" href="cu-vector_8h_source.html#l00335">CuSubVector&lt; Real &gt;::CuSubVector()</a>, <a class="el" href="cu-tp-matrix_8cc_source.html#l00040">CuTpMatrix&lt; Real &gt;::CuTpMatrix()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00828">CuMatrixBase&lt; float &gt;::DiffGroupPnorm()</a>, <a class="el" href="cu-math_8cc_source.html#l00349">kaldi::cu::DiffNormalizePerRow()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00678">CuMatrixBase&lt; float &gt;::DivElements()</a>, <a class="el" href="cu-math_8cc_source.html#l00209">kaldi::cu::EnsureNonzero()</a>, <a class="el" href="cu-matrix_8cc_source.html#l03395">CuMatrixBase&lt; float &gt;::EqualElementMask()</a>, <a class="el" href="nnet-loss_8cc_source.html#l00062">Xent::Eval()</a>, <a class="el" href="nnet-loss_8cc_source.html#l00228">Mse::Eval()</a>, <a class="el" href="nnet-loss_8cc_source.html#l00365">MultiTaskLoss::Eval()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00210">NnetComputer::ExecuteCommand()</a>, <a class="el" href="attention_8cc_source.html#l00032">kaldi::nnet3::attention::GetAttentionDotProducts()</a>, <a class="el" href="attention-test_8cc_source.html#l00030">kaldi::nnet3::attention::GetAttentionDotProductsSimple()</a>, <a class="el" href="nnet-tdnn-component_8cc_source.html#l00497">TdnnComponent::GetInputPart()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00457">NnetComputer::GetPointers()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01604">CuMatrixBase&lt; float &gt;::GroupMax()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00861">CuMatrixBase&lt; float &gt;::GroupMaxDeriv()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01563">CuMatrixBase&lt; float &gt;::GroupPnorm()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l04299">ConvolutionComponent::InderivPatchesToInderiv()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l04739">MaxpoolingComponent::InderivPatchesToInderiv()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00032">RestrictedAttentionComponent::Info()</a>, <a class="el" href="nnet-precondition-online_8cc_source.html#l00123">OnlinePreconditioner::Init()</a>, <a class="el" href="natural-gradient-online_8cc_source.html#l00122">OnlineNaturalGradient::Init()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l01109">AffineComponent::Init()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l01426">AffineComponentPreconditioned::Init()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l01704">AffineComponentPreconditionedOnline::Init()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03245">FixedAffineComponent::Init()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03697">Convolutional1dComponent::Init()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l04033">ConvolutionComponent::Init()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02852">NaturalGradientAffineComponent::InitFromConfig()</a>, <a class="el" href="nnet-precondition-online_8cc_source.html#l00045">OnlinePreconditioner::InitOrthonormalSpecial()</a>, <a class="el" href="natural-gradient-online_8cc_source.html#l00046">OnlineNaturalGradient::InitOrthonormalSpecial()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l04157">ConvolutionComponent::InputToInputPatches()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l04678">MaxpoolingComponent::InputToInputPatches()</a>, <a class="el" href="nnet-compute-discriminative_8cc_source.html#l00178">NnetDiscriminativeUpdater::LatticeComputations()</a>, <a class="el" href="nnet-train-frmshuff-tgtmat_8cc_source.html#l00030">main()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00068">NnetComputer::MatrixStddev()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00702">CuMatrixBase&lt; float &gt;::Max()</a>, <a class="el" href="cu-rand-speed-test_8cc_source.html#l00049">kaldi::MeanVariance()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00727">CuMatrixBase&lt; float &gt;::Min()</a>, <a class="el" href="nnet-utils_8h_source.html#l00122">kaldi::nnet1::MomentStatistics()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00654">CuMatrixBase&lt; float &gt;::MulElements()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02757">CuMatrixBase&lt; float &gt;::MulRows()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00803">CuMatrixBase&lt; float &gt;::MulRowsGroupMat()</a>, <a class="el" href="nnet2_2nnet-compute_8cc_source.html#l00064">NnetComputer::NnetComputer()</a>, <a class="el" href="cu-math_8cc_source.html#l00280">kaldi::cu::NormalizePerRow()</a>, <a class="el" href="cu-matrix_8cc_source.html#l03430">kaldi::operator&lt;&lt;()</a>, <a class="el" href="cu-matrix_8h_source.html#l00791">CuMatrix&lt; float &gt;::operator=()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01454">CuMatrixBase&lt; float &gt;::ParametricRelu()</a>, <a class="el" href="nnet-precondition_8cc_source.html#l00026">kaldi::nnet2::PreconditionDirections()</a>, <a class="el" href="nnet-precondition-online_8cc_source.html#l00145">OnlinePreconditioner::PreconditionDirections()</a>, <a class="el" href="natural-gradient-online_8cc_source.html#l00159">OnlineNaturalGradient::PreconditionDirections()</a>, <a class="el" href="nnet-precondition_8cc_source.html#l00114">kaldi::nnet2::PreconditionDirectionsAlpha()</a>, <a class="el" href="nnet-precondition_8cc_source.html#l00138">kaldi::nnet2::PreconditionDirectionsAlphaRescaled()</a>, <a class="el" href="nnet-precondition-online_8cc_source.html#l00300">OnlinePreconditioner::PreconditionDirectionsInternal()</a>, <a class="el" href="natural-gradient-online_8cc_source.html#l00323">OnlineNaturalGradient::PreconditionDirectionsInternal()</a>, <a class="el" href="nnet-utils_8cc_source.html#l01913">ModelCollapser::PreMultiplyAffineParameters()</a>, <a class="el" href="nnet-parse_8cc_source.html#l00547">kaldi::nnet3::PrintParameterStats()</a>, <a class="el" href="nnet-diagnostics_8cc_source.html#l00097">NnetComputeProb::ProcessOutputs()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00180">DistributeComponent::Propagate()</a>, <a class="el" href="nnet-normalize-component_8cc_source.html#l00132">NormalizeComponent::Propagate()</a>, <a class="el" href="nnet-component_8h_source.html#l00314">Component::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00255">ElementwiseProductComponent::Propagate()</a>, <a class="el" href="nnet-normalize-component_8cc_source.html#l00400">BatchNormComponent::Propagate()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00447">StatisticsExtractionComponent::Propagate()</a>, <a class="el" href="nnet-convolutional-component_8cc_source.html#l00282">TimeHeightConvolutionComponent::Propagate()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00771">StatisticsPoolingComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01428">RepeatedAffineComponent::Propagate()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l01412">DropoutMaskComponent::Propagate()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l01545">GeneralDropoutComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l02577">SpliceComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l01974">BlockAffineComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l05967">SumBlockComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03053">DctComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03531">DropoutComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02191">PerElementOffsetComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03619">AdditiveNoiseComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03819">Convolutional1dComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02440">ScaleAndOffsetComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l04204">ConvolutionComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l05047">CompositeComponent::Propagate()</a>, <a class="el" href="nnet-kl-hmm_8h_source.html#l00050">KlHmm::PropagateFnc()</a>, <a class="el" href="nnet-frame-pooling-component_8h_source.html#l00216">FramePoolingComponent::PropagateFnc()</a>, <a class="el" href="nnet-sentence-averaging-component_8h_source.html#l00248">SentenceAveragingComponent::PropagateFnc()</a>, <a class="el" href="nnet-activation_8h_source.html#l00329">Dropout::PropagateFnc()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00160">RestrictedAttentionComponent::PropagateOneHead()</a>, <a class="el" href="nnet-utils_8h_source.html#l00164">kaldi::nnet1::RandGauss()</a>, <a class="el" href="cu-rand_8cc_source.html#l00113">CuRand&lt; float &gt;::RandGaussian()</a>, <a class="el" href="cu-math_8cc_source.html#l00080">kaldi::cu::Randomize()</a>, <a class="el" href="cu-rand_8cc_source.html#l00060">CuRand&lt; float &gt;::RandUniform()</a>, <a class="el" href="nnet-utils_8h_source.html#l00188">kaldi::nnet1::RandUniform()</a>, <a class="el" href="nnet-rbm_8h_source.html#l00262">Rbm::RbmUpdate()</a>, <a class="el" href="nnet-rbm_8h_source.html#l00239">Rbm::Reconstruct()</a>, <a class="el" href="cu-math_8cc_source.html#l00037">kaldi::cu::RegularizeL1()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03027">DctComponent::Reorder()</a>, <a class="el" href="nnet-precondition-online_8cc_source.html#l00184">OnlinePreconditioner::ReorthogonalizeXt1()</a>, <a class="el" href="natural-gradient-online_8cc_source.html#l00200">OnlineNaturalGradient::ReorthogonalizeXt1()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00989">RectifiedLinearComponent::RepairGradients()</a>, <a class="el" href="rescale-nnet_8cc_source.html#l00121">NnetRescaler::RescaleComponent()</a>, <a class="el" href="cu-matrix_8h_source.html#l00613">CuMatrixBase&lt; float &gt;::Row()</a>, <a class="el" href="nnet3-xvector-compute_8cc_source.html#l00033">kaldi::nnet3::RunNnetComputation()</a>, <a class="el" href="cu-block-matrix_8cc_source.html#l00122">CuBlockMatrix&lt; Real &gt;::SetCudaData()</a>, <a class="el" href="nnet-linear-transform_8h_source.html#l00196">LinearTransform::SetLinearity()</a>, <a class="el" href="nnet-affine-transform_8h_source.html#l00228">AffineTransform::SetLinearity()</a>, <a class="el" href="cu-math_8cc_source.html#l00132">kaldi::cu::Splice()</a>, <a class="el" href="nnet-component-itf_8cc_source.html#l00368">NonlinearComponent::StoreBackpropStats()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00200">RestrictedAttentionComponent::StoreStats()</a>, <a class="el" href="nnet-normalize-component_8cc_source.html#l00549">BatchNormComponent::StoreStats()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00417">SigmoidComponent::StoreStats()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01076">RectifiedLinearComponent::StoreStats()</a>, <a class="el" href="nnet-component-itf_8cc_source.html#l00340">NonlinearComponent::StoreStatsInternal()</a>, <a class="el" href="nnet-pdf-prior_8cc_source.html#l00076">PdfPrior::SubtractOnLogpost()</a>, <a class="el" href="attention-test_8cc_source.html#l00120">kaldi::nnet3::attention::TestAttentionForwardBackward()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02128">kaldi::TraceMatMat()</a>, <a class="el" href="cu-sparse-matrix_8cc_source.html#l00524">kaldi::TraceMatSmat()</a>, <a class="el" href="cu-math-test_8cc_source.html#l00097">kaldi::UnitTestCuMathCopy()</a>, <a class="el" href="cu-math-test_8cc_source.html#l00046">kaldi::UnitTestCuMathRandomize()</a>, <a class="el" href="cu-math-test_8cc_source.html#l00124">kaldi::UnitTestCuMathSplice()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02570">kaldi::UnitTestCuTanh()</a>, <a class="el" href="nnet-randomizer-test_8cc_source.html#l00081">UnitTestMatrixRandomizer()</a>, <a class="el" href="nnet2_2nnet-compute-test_8cc_source.html#l00029">kaldi::nnet2::UnitTestNnetCompute()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02529">kaldi::UnitTestSwapCu2Cu()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02550">kaldi::UnitTestSwapCu2M()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01495">RepeatedAffineComponent::Update()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01594">NaturalGradientRepeatedAffineComponent::Update()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02978">NaturalGradientAffineComponent::Update()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l01544">AffineComponentPreconditioned::Update()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l01869">AffineComponentPreconditionedOnline::Update()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l04162">Convolutional1dComponent::Update()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l04422">ConvolutionComponent::Update()</a>, <a class="el" href="nnet-convolutional-component_8cc_source.html#l00353">TimeHeightConvolutionComponent::UpdateNaturalGradient()</a>, <a class="el" href="nnet-tdnn-component_8cc_source.html#l00284">TdnnComponent::UpdateNaturalGradient()</a>, <a class="el" href="nnet-convolutional-component_8cc_source.html#l00333">TimeHeightConvolutionComponent::UpdateSimple()</a>, <a class="el" href="nnet-tdnn-component_8cc_source.html#l00261">TdnnComponent::UpdateSimple()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00329">NonlinearComponent::UpdateStats()</a>, and <a class="el" href="cu-vector_8cc_source.html#l00082">kaldi::VecMatVec()</a>.</p>
<div class="fragment"><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>;  }</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a01cf7fccddf8deddc75b34408144ded1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01cf7fccddf8deddc75b34408144ded1">&#9670;&nbsp;</a></span>NumRows()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> NumRows </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Dimensions. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00214">214</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00542">NnetComputer::AcceptInput()</a>, <a class="el" href="nnet3-acc-lda-stats_8cc_source.html#l00065">NnetLdaStatsAccumulator::AccStatsFromOutput()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00261">RestrictedAttentionComponent::Add()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02668">CuMatrixBase&lt; float &gt;::AddCols()</a>, <a class="el" href="cu-vector_8cc_source.html#l01254">CuVectorBase&lt; float &gt;::AddColSumMat()</a>, <a class="el" href="nnet-randomizer_8cc_source.html#l00047">MatrixRandomizer::AddData()</a>, <a class="el" href="cu-vector_8cc_source.html#l00567">CuVectorBase&lt; float &gt;::AddDiagMat2()</a>, <a class="el" href="cu-vector_8cc_source.html#l00583">CuVectorBase&lt; float &gt;::AddDiagMatMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01369">CuMatrixBase&lt; float &gt;::AddDiagVecMat()</a>, <a class="el" href="cu-rand_8cc_source.html#l00204">CuRand&lt; float &gt;::AddGaussNoise()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00941">CuMatrixBase&lt; float &gt;::AddMat()</a>, <a class="el" href="cu-sp-matrix_8cc_source.html#l00130">CuSpMatrix&lt; Real &gt;::AddMat2()</a>, <a class="el" href="cu-matrix_8cc_source.html#l03172">CuMatrixBase&lt; float &gt;::AddMatBlock()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01106">CuMatrixBase&lt; float &gt;::AddMatBlocks()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01402">CuMatrixBase&lt; float &gt;::AddMatDiagVec()</a>, <a class="el" href="cu-block-matrix_8cc_source.html#l00211">CuBlockMatrix&lt; Real &gt;::AddMatMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01278">CuMatrixBase&lt; float &gt;::AddMatMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02190">kaldi::AddMatMatBatched()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01067">CuMatrixBase&lt; float &gt;::AddMatSmat()</a>, <a class="el" href="cu-vector_8cc_source.html#l00478">CuVectorBase&lt; float &gt;::AddMatVec()</a>, <a class="el" href="cu-vector_8cc_source.html#l01242">CuVectorBase&lt; float &gt;::AddRowSumMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01011">CuMatrixBase&lt; float &gt;::AddSmatMat()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l01023">AffineComponent::AffineComponent()</a>, <a class="el" href="attention_8cc_source.html#l00076">kaldi::nnet3::attention::ApplyScalesToInput()</a>, <a class="el" href="attention-test_8cc_source.html#l00072">kaldi::nnet3::attention::ApplyScalesToInputSimple()</a>, <a class="el" href="attention_8cc_source.html#l00055">kaldi::nnet3::attention::ApplyScalesToOutput()</a>, <a class="el" href="attention-test_8cc_source.html#l00052">kaldi::nnet3::attention::ApplyScalesToOutputSimple()</a>, <a class="el" href="attention_8cc_source.html#l00154">kaldi::nnet3::attention::AttentionBackward()</a>, <a class="el" href="attention_8cc_source.html#l00097">kaldi::nnet3::attention::AttentionForward()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00194">DistributeComponent::Backprop()</a>, <a class="el" href="nnet-update_8cc_source.html#l00188">NnetUpdater::Backprop()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00292">RestrictedAttentionComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00273">ElementwiseProductComponent::Backprop()</a>, <a class="el" href="nnet-normalize-component_8cc_source.html#l00466">BatchNormComponent::Backprop()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00476">StatisticsExtractionComponent::Backprop()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00820">StatisticsPoolingComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00452">MaxoutComponent::Backprop()</a>, <a class="el" href="nnet-tdnn-component_8cc_source.html#l00213">TdnnComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l04318">MaxpoolingComponent::Backprop()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l01098">BackpropTruncationComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00524">PnormComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00599">NormalizeComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01454">RepeatedAffineComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00622">SigmoidComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00664">TanhComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00726">PowerComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00778">RectifiedLinearComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00810">SoftHingeComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00845">ScaleComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00919">SoftmaxComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00965">LogSoftmaxComponent::Backprop()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l01578">GeneralDropoutComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l01176">AffineComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l02662">SpliceComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l02891">SpliceMaxComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l02035">BlockAffineComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l02451">SumGroupComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l02350">PermuteComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00675">ClipGradientComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03086">DctComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03214">FixedLinearComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03300">FixedAffineComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03566">DropoutComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02210">PerElementOffsetComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03966">Convolutional1dComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02474">ScaleAndOffsetComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l04355">ConvolutionComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l05764">LstmNonlinearityComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l05187">CompositeComponent::Backprop()</a>, <a class="el" href="nnet-component_8h_source.html#l00328">Component::Backpropagate()</a>, <a class="el" href="nnet-activation_8h_source.html#l00087">HiddenSoftmax::BackpropagateFnc()</a>, <a class="el" href="nnet-various_8h_source.html#l00111">Splice::BackpropagateFnc()</a>, <a class="el" href="nnet-sentence-averaging-component_8h_source.html#l00137">SimpleSentenceAveragingComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-activation_8h_source.html#l00174">BlockSoftmax::BackpropagateFnc()</a>, <a class="el" href="nnet-recurrent_8h_source.html#l00243">RecurrentComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-convolutional-2d-component_8h_source.html#l00324">Convolutional2DComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-multibasis-component_8h_source.html#l00338">MultiBasisComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-lstm-projected_8h_source.html#l00475">LstmProjected::BackpropagateFnc()</a>, <a class="el" href="nnet-blstm-projected_8h_source.html#l00720">BlstmProjected::BackpropagateFnc()</a>, <a class="el" href="cu-math_8cc_source.html#l00768">kaldi::cu::BackpropLstmNonlinearity()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00334">RestrictedAttentionComponent::BackpropOneHead()</a>, <a class="el" href="cu-rand_8cc_source.html#l00194">CuRand&lt; float &gt;::BinarizeProbs()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l02559">ChunkInfo::CheckSize()</a>, <a class="el" href="nnet-utils_8cc_source.html#l01668">ModelCollapser::CollapseComponentsAffine()</a>, <a class="el" href="nnet3-compute-from-egs_8cc_source.html#l00041">NnetComputerFromEg::Compute()</a>, <a class="el" href="nnet-compute-online_8cc_source.html#l00035">NnetOnlineComputer::Compute()</a>, <a class="el" href="nnet-diagnostics_8cc_source.html#l00206">kaldi::nnet3::ComputeAccuracy()</a>, <a class="el" href="nnet2_2nnet-compute_8cc_source.html#l00111">NnetComputer::ComputeLastLayerDeriv()</a>, <a class="el" href="cu-math_8cc_source.html#l00489">kaldi::cu::ComputeLstmNonlinearity()</a>, <a class="el" href="nnet-training_8cc_source.html#l00370">kaldi::nnet3::ComputeObjectiveFunction()</a>, <a class="el" href="nnet-utils_8h_source.html#l00142">kaldi::nnet1::ComputeStdDev()</a>, <a class="el" href="nnet-update_8cc_source.html#l00161">NnetUpdater::ComputeTotAccuracy()</a>, <a class="el" href="nnet-utils_8cc_source.html#l01022">kaldi::nnet3::ConstrainOrthonormal()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00896">kaldi::nnet3::ConstrainOrthonormalInternal()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03642">Convolutional1dComponent::Convolutional1dComponent()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l03967">ConvolutionComponent::ConvolutionComponent()</a>, <a class="el" href="convolution_8cc_source.html#l00682">kaldi::nnet3::time_height_convolution::ConvolveBackwardData()</a>, <a class="el" href="convolution_8cc_source.html#l00603">kaldi::nnet3::time_height_convolution::ConvolveBackwardDataInternal()</a>, <a class="el" href="convolution_8cc_source.html#l00840">kaldi::nnet3::time_height_convolution::ConvolveBackwardParams()</a>, <a class="el" href="convolution_8cc_source.html#l00763">kaldi::nnet3::time_height_convolution::ConvolveBackwardParamsInternal()</a>, <a class="el" href="convolution_8cc_source.html#l00524">kaldi::nnet3::time_height_convolution::ConvolveForward()</a>, <a class="el" href="convolution_8cc_source.html#l00448">kaldi::nnet3::time_height_convolution::ConvolveForwardInternal()</a>, <a class="el" href="cu-math_8cc_source.html#l00173">kaldi::cu::Copy()</a>, <a class="el" href="cu-vector_8cc_source.html#l00102">CuVectorBase&lt; float &gt;::CopyColFromMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02623">CuMatrixBase&lt; float &gt;::CopyCols()</a>, <a class="el" href="cu-vector_8cc_source.html#l01163">CuVectorBase&lt; float &gt;::CopyDiagFromMat()</a>, <a class="el" href="cu-vector_8cc_source.html#l01296">CuVectorBase&lt; float &gt;::CopyElements()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00160">CuMatrixBase&lt; float &gt;::CopyFromBlock()</a>, <a class="el" href="cu-tp-matrix_8cc_source.html#l00089">CuTpMatrix&lt; Real &gt;::CopyFromMat()</a>, <a class="el" href="cu-compressed-matrix_8cc_source.html#l00065">CuCompressedMatrix&lt; I &gt;::CopyFromMat()</a>, <a class="el" href="cu-sp-matrix_8cc_source.html#l00039">CuSpMatrix&lt; Real &gt;::CopyFromMat()</a>, <a class="el" href="cu-block-matrix_8cc_source.html#l00296">CuBlockMatrix&lt; Real &gt;::CopyFromMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00207">CuMatrixBase&lt; float &gt;::CopyFromMat()</a>, <a class="el" href="cu-vector_8cc_source.html#l00163">CuVectorBase&lt; float &gt;::CopyRowsFromMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02591">VectorBase&lt; float &gt;::CopyRowsFromMat()</a>, <a class="el" href="cu-sparse-matrix_8cc_source.html#l00622">CuSparseMatrix&lt; Real &gt;::CopyToMat()</a>, <a class="el" href="cu-compressed-matrix_8cc_source.html#l00102">CuCompressedMatrix&lt; I &gt;::CopyToMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00375">CuMatrix&lt; float &gt;::CuMatrix()</a>, <a class="el" href="cu-rand-speed-test_8cc_source.html#l00129">kaldi::CuRandGaussianMatrixBaseSpeedTest()</a>, <a class="el" href="cu-rand-speed-test_8cc_source.html#l00110">kaldi::CuRandGaussianMatrixSpeedTest()</a>, <a class="el" href="cu-rand-speed-test_8cc_source.html#l00091">kaldi::CuRandUniformMatrixBaseSpeedTest()</a>, <a class="el" href="cu-rand-speed-test_8cc_source.html#l00072">kaldi::CuRandUniformMatrixSpeedTest()</a>, <a class="el" href="cu-tp-matrix_8cc_source.html#l00040">CuTpMatrix&lt; Real &gt;::CuTpMatrix()</a>, <a class="el" href="decodable-am-nnet_8h_source.html#l00039">DecodableAmNnet::DecodableAmNnet()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01887">CuMatrixBase&lt; float &gt;::DiffLogSoftmaxPerRow()</a>, <a class="el" href="cu-math_8cc_source.html#l00349">kaldi::cu::DiffNormalizePerRow()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01852">CuMatrixBase&lt; float &gt;::DiffSoftmaxPerRow()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00678">CuMatrixBase&lt; float &gt;::DivElements()</a>, <a class="el" href="cu-math_8cc_source.html#l00209">kaldi::cu::EnsureNonzero()</a>, <a class="el" href="cu-matrix_8cc_source.html#l03395">CuMatrixBase&lt; float &gt;::EqualElementMask()</a>, <a class="el" href="nnet-loss_8cc_source.html#l00062">Xent::Eval()</a>, <a class="el" href="nnet-loss_8cc_source.html#l00228">Mse::Eval()</a>, <a class="el" href="nnet-loss_8cc_source.html#l00365">MultiTaskLoss::Eval()</a>, <a class="el" href="attention_8cc_source.html#l00032">kaldi::nnet3::attention::GetAttentionDotProducts()</a>, <a class="el" href="attention-test_8cc_source.html#l00030">kaldi::nnet3::attention::GetAttentionDotProductsSimple()</a>, <a class="el" href="nnet-tdnn-component_8cc_source.html#l00497">TdnnComponent::GetInputPart()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00457">NnetComputer::GetPointers()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l01512">AffineComponentPreconditioned::GetScalingFactor()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01604">CuMatrixBase&lt; float &gt;::GroupMax()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01563">CuMatrixBase&lt; float &gt;::GroupPnorm()</a>, <a class="el" href="nnet-precondition-online_8cc_source.html#l00123">OnlinePreconditioner::Init()</a>, <a class="el" href="natural-gradient-online_8cc_source.html#l00122">OnlineNaturalGradient::Init()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l01109">AffineComponent::Init()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l01426">AffineComponentPreconditioned::Init()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l01704">AffineComponentPreconditionedOnline::Init()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03245">FixedAffineComponent::Init()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03697">Convolutional1dComponent::Init()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l04033">ConvolutionComponent::Init()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02852">NaturalGradientAffineComponent::InitFromConfig()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l03343">FixedAffineComponent::InitFromConfig()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03175">FixedLinearComponent::InitFromString()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03254">FixedAffineComponent::InitFromString()</a>, <a class="el" href="nnet-precondition-online_8cc_source.html#l00045">OnlinePreconditioner::InitOrthonormalSpecial()</a>, <a class="el" href="natural-gradient-online_8cc_source.html#l00046">OnlineNaturalGradient::InitOrthonormalSpecial()</a>, <a class="el" href="nnet-compute-discriminative_8cc_source.html#l00178">NnetDiscriminativeUpdater::LatticeComputations()</a>, <a class="el" href="nnet2bin_2nnet-compute_8cc_source.html#l00027">main()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00068">NnetComputer::MatrixStddev()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00702">CuMatrixBase&lt; float &gt;::Max()</a>, <a class="el" href="cu-rand-speed-test_8cc_source.html#l00049">kaldi::MeanVariance()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00727">CuMatrixBase&lt; float &gt;::Min()</a>, <a class="el" href="nnet-utils_8h_source.html#l00122">kaldi::nnet1::MomentStatistics()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00654">CuMatrixBase&lt; float &gt;::MulElements()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02838">NaturalGradientAffineComponent::NaturalGradientAffineComponent()</a>, <a class="el" href="nnet2_2nnet-compute_8cc_source.html#l00064">NnetComputer::NnetComputer()</a>, <a class="el" href="cu-math_8cc_source.html#l00280">kaldi::cu::NormalizePerRow()</a>, <a class="el" href="cu-matrix_8cc_source.html#l03430">kaldi::operator&lt;&lt;()</a>, <a class="el" href="cu-matrix_8h_source.html#l00791">CuMatrix&lt; float &gt;::operator=()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01454">CuMatrixBase&lt; float &gt;::ParametricRelu()</a>, <a class="el" href="nnet-precondition_8cc_source.html#l00026">kaldi::nnet2::PreconditionDirections()</a>, <a class="el" href="nnet-precondition-online_8cc_source.html#l00145">OnlinePreconditioner::PreconditionDirections()</a>, <a class="el" href="nnet-precondition_8cc_source.html#l00114">kaldi::nnet2::PreconditionDirectionsAlpha()</a>, <a class="el" href="nnet-precondition_8cc_source.html#l00138">kaldi::nnet2::PreconditionDirectionsAlphaRescaled()</a>, <a class="el" href="nnet-precondition-online_8cc_source.html#l00300">OnlinePreconditioner::PreconditionDirectionsInternal()</a>, <a class="el" href="natural-gradient-online_8cc_source.html#l00323">OnlineNaturalGradient::PreconditionDirectionsInternal()</a>, <a class="el" href="nnet-utils_8cc_source.html#l01913">ModelCollapser::PreMultiplyAffineParameters()</a>, <a class="el" href="nnet-parse_8cc_source.html#l00547">kaldi::nnet3::PrintParameterStats()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00180">DistributeComponent::Propagate()</a>, <a class="el" href="nnet-compute-online_8cc_source.html#l00148">NnetOnlineComputer::Propagate()</a>, <a class="el" href="nnet-normalize-component_8cc_source.html#l00132">NormalizeComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00138">DropoutComponent::Propagate()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00132">RestrictedAttentionComponent::Propagate()</a>, <a class="el" href="nnet-component_8h_source.html#l00314">Component::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00255">ElementwiseProductComponent::Propagate()</a>, <a class="el" href="nnet-normalize-component_8cc_source.html#l00400">BatchNormComponent::Propagate()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00447">StatisticsExtractionComponent::Propagate()</a>, <a class="el" href="nnet-convolutional-component_8cc_source.html#l00282">TimeHeightConvolutionComponent::Propagate()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00771">StatisticsPoolingComponent::Propagate()</a>, <a class="el" href="nnet-tdnn-component_8cc_source.html#l00181">TdnnComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01428">RepeatedAffineComponent::Propagate()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l01412">DropoutMaskComponent::Propagate()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l01545">GeneralDropoutComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l02577">SpliceComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l01974">BlockAffineComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l05967">SumBlockComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03053">DctComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02191">PerElementOffsetComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03619">AdditiveNoiseComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03819">Convolutional1dComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02440">ScaleAndOffsetComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l04204">ConvolutionComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l04721">MaxpoolingComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l05047">CompositeComponent::Propagate()</a>, <a class="el" href="nnet-kl-hmm_8h_source.html#l00050">KlHmm::PropagateFnc()</a>, <a class="el" href="nnet-sentence-averaging-component_8h_source.html#l00124">SimpleSentenceAveragingComponent::PropagateFnc()</a>, <a class="el" href="nnet-recurrent_8h_source.html#l00207">RecurrentComponent::PropagateFnc()</a>, <a class="el" href="nnet-sentence-averaging-component_8h_source.html#l00248">SentenceAveragingComponent::PropagateFnc()</a>, <a class="el" href="nnet-various_8h_source.html#l00256">LengthNormComponent::PropagateFnc()</a>, <a class="el" href="nnet-convolutional-component_8h_source.html#l00258">ConvolutionalComponent::PropagateFnc()</a>, <a class="el" href="nnet-convolutional-2d-component_8h_source.html#l00259">Convolutional2DComponent::PropagateFnc()</a>, <a class="el" href="nnet-activation_8h_source.html#l00329">Dropout::PropagateFnc()</a>, <a class="el" href="nnet-lstm-projected_8h_source.html#l00365">LstmProjected::PropagateFnc()</a>, <a class="el" href="nnet-blstm-projected_8h_source.html#l00532">BlstmProjected::PropagateFnc()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00160">RestrictedAttentionComponent::PropagateOneHead()</a>, <a class="el" href="nnet-utils_8h_source.html#l00164">kaldi::nnet1::RandGauss()</a>, <a class="el" href="cu-rand_8cc_source.html#l00113">CuRand&lt; float &gt;::RandGaussian()</a>, <a class="el" href="cu-math_8cc_source.html#l00080">kaldi::cu::Randomize()</a>, <a class="el" href="cu-rand_8cc_source.html#l00060">CuRand&lt; float &gt;::RandUniform()</a>, <a class="el" href="nnet-utils_8h_source.html#l00188">kaldi::nnet1::RandUniform()</a>, <a class="el" href="nnet-rbm_8h_source.html#l00262">Rbm::RbmUpdate()</a>, <a class="el" href="nnet-rbm_8h_source.html#l00239">Rbm::Reconstruct()</a>, <a class="el" href="cu-math_8cc_source.html#l00037">kaldi::cu::RegularizeL1()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03027">DctComponent::Reorder()</a>, <a class="el" href="nnet-precondition-online_8cc_source.html#l00184">OnlinePreconditioner::ReorthogonalizeXt1()</a>, <a class="el" href="natural-gradient-online_8cc_source.html#l00200">OnlineNaturalGradient::ReorthogonalizeXt1()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00989">RectifiedLinearComponent::RepairGradients()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00738">ClipGradientComponent::RepairGradients()</a>, <a class="el" href="rescale-nnet_8cc_source.html#l00121">NnetRescaler::RescaleComponent()</a>, <a class="el" href="cu-block-matrix_8cc_source.html#l00122">CuBlockMatrix&lt; Real &gt;::SetCudaData()</a>, <a class="el" href="nnet-linear-transform_8h_source.html#l00196">LinearTransform::SetLinearity()</a>, <a class="el" href="nnet-affine-transform_8h_source.html#l00228">AffineTransform::SetLinearity()</a>, <a class="el" href="cu-math_8cc_source.html#l00132">kaldi::cu::Splice()</a>, <a class="el" href="nnet-component-itf_8cc_source.html#l00368">NonlinearComponent::StoreBackpropStats()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00200">RestrictedAttentionComponent::StoreStats()</a>, <a class="el" href="nnet-normalize-component_8cc_source.html#l00549">BatchNormComponent::StoreStats()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00417">SigmoidComponent::StoreStats()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01076">RectifiedLinearComponent::StoreStats()</a>, <a class="el" href="nnet-component-itf_8cc_source.html#l00340">NonlinearComponent::StoreStatsInternal()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02860">CuMatrixBase&lt; float &gt;::SumColumnRanges()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02128">kaldi::TraceMatMat()</a>, <a class="el" href="cu-sparse-matrix_8cc_source.html#l00524">kaldi::TraceMatSmat()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02515">kaldi::UnitTestCheck()</a>, <a class="el" href="cu-math-test_8cc_source.html#l00097">kaldi::UnitTestCuMathCopy()</a>, <a class="el" href="cu-math-test_8cc_source.html#l00046">kaldi::UnitTestCuMathRandomize()</a>, <a class="el" href="cu-math-test_8cc_source.html#l00124">kaldi::UnitTestCuMathSplice()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02570">kaldi::UnitTestCuTanh()</a>, <a class="el" href="nnet-randomizer-test_8cc_source.html#l00081">UnitTestMatrixRandomizer()</a>, <a class="el" href="nnet2_2nnet-compute-test_8cc_source.html#l00029">kaldi::nnet2::UnitTestNnetCompute()</a>, <a class="el" href="nnet-precondition-online-test_8cc_source.html#l00262">kaldi::nnet2::UnitTestPreconditionDirectionsOnline()</a>, <a class="el" href="natural-gradient-online-test_8cc_source.html#l00262">kaldi::nnet3::UnitTestPreconditionDirectionsOnline()</a>, <a class="el" href="nnet-component-test_8cc_source.html#l00073">kaldi::nnet1::UnitTestSimpleSentenceAveragingComponent()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02529">kaldi::UnitTestSwapCu2Cu()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02550">kaldi::UnitTestSwapCu2M()</a>, <a class="el" href="nnet-linear-transform_8h_source.html#l00170">LinearTransform::Update()</a>, <a class="el" href="nnet-affine-transform_8h_source.html#l00179">AffineTransform::Update()</a>, <a class="el" href="nnet-sentence-averaging-component_8h_source.html#l00277">SentenceAveragingComponent::Update()</a>, <a class="el" href="nnet-recurrent_8h_source.html#l00290">RecurrentComponent::Update()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01495">RepeatedAffineComponent::Update()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01594">NaturalGradientRepeatedAffineComponent::Update()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02978">NaturalGradientAffineComponent::Update()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l01544">AffineComponentPreconditioned::Update()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l01869">AffineComponentPreconditionedOnline::Update()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l02253">BlockAffineComponentPreconditioned::Update()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l04162">Convolutional1dComponent::Update()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l04422">ConvolutionComponent::Update()</a>, <a class="el" href="nnet-convolutional-component_8cc_source.html#l00353">TimeHeightConvolutionComponent::UpdateNaturalGradient()</a>, <a class="el" href="nnet-tdnn-component_8cc_source.html#l00284">TdnnComponent::UpdateNaturalGradient()</a>, <a class="el" href="nnet-convolutional-component_8cc_source.html#l00333">TimeHeightConvolutionComponent::UpdateSimple()</a>, <a class="el" href="nnet-tdnn-component_8cc_source.html#l00261">TdnnComponent::UpdateSimple()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l02012">BlockAffineComponent::UpdateSimple()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00329">NonlinearComponent::UpdateStats()</a>, <a class="el" href="cu-vector_8cc_source.html#l00082">kaldi::VecMatVec()</a>, and <a class="el" href="convolution-test_8cc_source.html#l00198">kaldi::nnet3::time_height_convolution::ZeroBlankRows()</a>.</p>
<div class="fragment"><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>;  }</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a65339454ef3aaede4a426fa9848975"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a65339454ef3aaede4a426fa9848975">&#9670;&nbsp;</a></span>operator()() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1CuValue.html">CuValue</a>&lt;Real&gt; operator() </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a>&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a>&#160;</td>
          <td class="paramname"><em>c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00625">625</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                                                                   {</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <a class="code" href="group__error__group.html#ga2c852c1a15c7f195ec8021de2ab119a0">KALDI_PARANOID_ASSERT</a>(static_cast&lt;UnsignedMatrixIndexT&gt;(r) &lt;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                          static_cast&lt;UnsignedMatrixIndexT&gt;(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>) &amp;&amp;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                          static_cast&lt;UnsignedMatrixIndexT&gt;(c) &lt;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                          static_cast&lt;UnsignedMatrixIndexT&gt;(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>));</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="keywordflow">return</span> CuValue&lt;Real&gt;(<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a> + r * <a class="code" href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">stride_</a> + c);</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  }</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a7cb3ee02262893923716e6764439f359"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">kaldi::CuMatrixBase::stride_</a></div><div class="ttdeci">MatrixIndexT stride_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00730">cu-matrix.h:730</a></div></div>
<div class="ttc" id="group__error__group_html_ga2c852c1a15c7f195ec8021de2ab119a0"><div class="ttname"><a href="group__error__group.html#ga2c852c1a15c7f195ec8021de2ab119a0">KALDI_PARANOID_ASSERT</a></div><div class="ttdeci">#define KALDI_PARANOID_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00181">kaldi-error.h:181</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9d7d41d94134d70668760ab75bf7d132"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d7d41d94134d70668760ab75bf7d132">&#9670;&nbsp;</a></span>operator()() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real operator() </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a>&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a>&#160;</td>
          <td class="paramname"><em>c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00633">633</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                                                                {</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <a class="code" href="group__error__group.html#ga2c852c1a15c7f195ec8021de2ab119a0">KALDI_PARANOID_ASSERT</a>(static_cast&lt;UnsignedMatrixIndexT&gt;(r) &lt;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                          static_cast&lt;UnsignedMatrixIndexT&gt;(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>) &amp;&amp;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                          static_cast&lt;UnsignedMatrixIndexT&gt;(c) &lt;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                          static_cast&lt;UnsignedMatrixIndexT&gt;(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>));</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="keywordflow">return</span> CuValue&lt;Real&gt;(<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a> + r * <a class="code" href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">stride_</a> + c);  <span class="comment">// will be casted to Real.</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  }</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a7cb3ee02262893923716e6764439f359"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">kaldi::CuMatrixBase::stride_</a></div><div class="ttdeci">MatrixIndexT stride_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00730">cu-matrix.h:730</a></div></div>
<div class="ttc" id="group__error__group_html_ga2c852c1a15c7f195ec8021de2ab119a0"><div class="ttname"><a href="group__error__group.html#ga2c852c1a15c7f195ec8021de2ab119a0">KALDI_PARANOID_ASSERT</a></div><div class="ttdeci">#define KALDI_PARANOID_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00181">kaldi-error.h:181</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad2eb5b471c0eab9cf8a92482782827d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2eb5b471c0eab9cf8a92482782827d1">&#9670;&nbsp;</a></span>ParametricRelu()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ParametricRelu </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the parametric rectified linear unit function; element by element, *this = src * (src &gt; 0 ? alpha : beta) </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01454">1454</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-parametric-relu_8h_source.html#l00152">ParametricRelu::PropagateFnc()</a>, and <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>.</p>
<div class="fragment"><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                                     {</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(src.NumRows() == this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>());</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(src.NumCols() == this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>());</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(alpha.Dim() == this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>());</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(beta.Dim() == this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>());</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    CuTimer tim;</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    dim3 dimBlock(<a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>, <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>);</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    dim3 dimGrid(n_blocks(src.NumCols(), <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>), n_blocks(src.NumRows(), <a class="code" href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a>));</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    cuda_parametric_relu(dimGrid, dimBlock, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, src.data_, this-&gt;Dim(),</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                         src.Stride(), alpha.data_, beta.data_);</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  {</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <span class="comment">// Do it on CPU,</span></div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> r = 0; r &lt; <a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(); r++) {</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> c = 0; c &lt; <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(); c++) {</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;        Real src_elem = src.Mat()(r,c);</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;        this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>()(r,c) = src_elem * (src_elem &gt;= 0.0 ? alpha.Vec()(c) : beta.Vec()(c));</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;      }</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    }</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  }</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="namespacekaldi_html_aac2c220416519a2b0a7ad822ee2ef972"><div class="ttname"><a href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">kaldi::MatrixIndexT</a></div><div class="ttdeci">int32 MatrixIndexT</div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00098">matrix-common.h:98</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a84acd86e193bca04fb719c476fbcbe5b"><div class="ttname"><a href="cu-matrixdim_8h.html#a84acd86e193bca04fb719c476fbcbe5b">CU2DBLOCK</a></div><div class="ttdeci">#define CU2DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00067">cu-matrixdim.h:67</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7979d7cdf1210cad66fc7ec6861ea9d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7979d7cdf1210cad66fc7ec6861ea9d4">&#9670;&nbsp;</a></span>Range()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1CuSubMatrix.html">CuSubMatrix</a>&lt;Real&gt; Range </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a>&#160;</td>
          <td class="paramname"><em>row_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a>&#160;</td>
          <td class="paramname"><em>num_rows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a>&#160;</td>
          <td class="paramname"><em>col_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a>&#160;</td>
          <td class="paramname"><em>num_cols</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00596">596</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-block-matrix_8cc_source.html#l00211">CuBlockMatrix&lt; Real &gt;::AddMatMat()</a>, <a class="el" href="nnet-various_8h_source.html#l00111">Splice::BackpropagateFnc()</a>, <a class="el" href="nnet-utils_8cc_source.html#l01668">ModelCollapser::CollapseComponentsAffine()</a>, <a class="el" href="nnet-compute-online_8cc_source.html#l00035">NnetOnlineComputer::Compute()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l01109">AffineComponent::Init()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l01426">AffineComponentPreconditioned::Init()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l01704">AffineComponentPreconditionedOnline::Init()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03245">FixedAffineComponent::Init()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03697">Convolutional1dComponent::Init()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l04033">ConvolutionComponent::Init()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02852">NaturalGradientAffineComponent::InitFromConfig()</a>, <a class="el" href="nnet2_2nnet-compute_8cc_source.html#l00064">NnetComputer::NnetComputer()</a>, <a class="el" href="nnet-precondition-online_8cc_source.html#l00145">OnlinePreconditioner::PreconditionDirections()</a>, <a class="el" href="natural-gradient-online_8cc_source.html#l00159">OnlineNaturalGradient::PreconditionDirections()</a>, <a class="el" href="nnet-compute-online_8cc_source.html#l00148">NnetOnlineComputer::Propagate()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01368">kaldi::UnitTestCuMatrixAddMat()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02030">kaldi::UnitTestCuSubMatrix()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02978">NaturalGradientAffineComponent::Update()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l01544">AffineComponentPreconditioned::Update()</a>, and <a class="el" href="_2nnet-component_8cc_source.html#l01869">AffineComponentPreconditionedOnline::Update()</a>.</p>
<div class="fragment"><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                                                                    {</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac85bb7380dfaafef6fc9b91b508756e0">CuSubMatrix&lt;Real&gt;</a>(*<span class="keyword">this</span>, row_offset, num_rows,</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                             col_offset, num_cols);</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  }</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac85bb7380dfaafef6fc9b91b508756e0"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac85bb7380dfaafef6fc9b91b508756e0">kaldi::CuMatrixBase::CuSubMatrix&lt; Real &gt;</a></div><div class="ttdeci">friend class CuSubMatrix&lt; Real &gt;</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00089">cu-matrix.h:89</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2063a15b24ba24887ffaa92f44e1d4bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2063a15b24ba24887ffaa92f44e1d4bf">&#9670;&nbsp;</a></span>Row() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classkaldi_1_1CuSubVector.html">CuSubVector</a>&lt;Real&gt; Row </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a>&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00613">613</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="decodable-simple-looped_8cc_source.html#l00140">DecodableNnetSimpleLooped::AdvanceChunk()</a>, <a class="el" href="nnet-multibasis-component_8h_source.html#l00338">MultiBasisComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-compute-online_8cc_source.html#l00035">NnetOnlineComputer::Compute()</a>, <a class="el" href="nnet-am-decodable-simple_8cc_source.html#l00215">DecodableNnetSimple::DoNnetComputation()</a>, <a class="el" href="nnet-train-multistream-perutt-tgtmat_8cc_source.html#l00034">main()</a>, <a class="el" href="nnet2_2nnet-compute_8cc_source.html#l00064">NnetComputer::NnetComputer()</a>, <a class="el" href="nnet-recurrent_8h_source.html#l00207">RecurrentComponent::PropagateFnc()</a>, <a class="el" href="nnet3-xvector-compute_8cc_source.html#l00033">kaldi::nnet3::RunNnetComputation()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01237">kaldi::UnitTestCuMatrixAddDiagVecMat()</a>, <a class="el" href="_2nnet-component-test_8cc_source.html#l00028">kaldi::nnet2::UnitTestGenericComponentInternal()</a>, <a class="el" href="cu-math-test_8cc_source.html#l00213">kaldi::UnitTestLstmNonlinearity()</a>, <a class="el" href="nnet-component-test_8cc_source.html#l00073">kaldi::nnet1::UnitTestSimpleSentenceAveragingComponent()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01594">NaturalGradientRepeatedAffineComponent::Update()</a>, and <a class="el" href="nnet-convolutional-component_8cc_source.html#l00353">TimeHeightConvolutionComponent::UpdateNaturalGradient()</a>.</p>
<div class="fragment"><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                                                           {</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(static_cast&lt;UnsignedMatrixIndexT&gt;(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                 static_cast&lt;UnsignedMatrixIndexT&gt;(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>));</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html#a4ccc176ff1e8f53ca4ff702f2c6e8064">CuSubVector&lt;Real&gt;</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a> + (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> * <a class="code" href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">stride_</a>), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>());</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  }</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a4ccc176ff1e8f53ca4ff702f2c6e8064"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a4ccc176ff1e8f53ca4ff702f2c6e8064">kaldi::CuMatrixBase::CuSubVector&lt; Real &gt;</a></div><div class="ttdeci">friend class CuSubVector&lt; Real &gt;</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00091">cu-matrix.h:91</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a7cb3ee02262893923716e6764439f359"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">kaldi::CuMatrixBase::stride_</a></div><div class="ttdeci">MatrixIndexT stride_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00730">cu-matrix.h:730</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8758c1ca7743191d82980dc361216654"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8758c1ca7743191d82980dc361216654">&#9670;&nbsp;</a></span>Row() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1CuSubVector.html">CuSubVector</a>&lt;Real&gt; Row </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a>&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00619">619</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                                               {</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(static_cast&lt;UnsignedMatrixIndexT&gt;(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                 static_cast&lt;UnsignedMatrixIndexT&gt;(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>));</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html#a4ccc176ff1e8f53ca4ff702f2c6e8064">CuSubVector&lt;Real&gt;</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a> + (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> * <a class="code" href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">stride_</a>), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>());</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  }</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a4ccc176ff1e8f53ca4ff702f2c6e8064"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a4ccc176ff1e8f53ca4ff702f2c6e8064">kaldi::CuMatrixBase::CuSubVector&lt; Real &gt;</a></div><div class="ttdeci">friend class CuSubVector&lt; Real &gt;</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00091">cu-matrix.h:91</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a7cb3ee02262893923716e6764439f359"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">kaldi::CuMatrixBase::stride_</a></div><div class="ttdeci">MatrixIndexT stride_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00730">cu-matrix.h:730</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aca92364bdcb38c7e30f390340d072bf4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca92364bdcb38c7e30f390340d072bf4">&#9670;&nbsp;</a></span>RowData() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const Real* RowData </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a>&#160;</td>
          <td class="paramname"><em>r</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get raw row pointer (const). </p>
<p>Warning: may return a pointer to GPU memory. Use at your own risk. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00683">683</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-vector_8cc_source.html#l00163">CuVectorBase&lt; float &gt;::CopyRowsFromMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02591">VectorBase&lt; float &gt;::CopyRowsFromMat()</a>, <a class="el" href="cu-vector_8h_source.html#l00335">CuSubVector&lt; Real &gt;::CuSubVector()</a>, <a class="el" href="cu-math_8cc_source.html#l00209">kaldi::cu::EnsureNonzero()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00989">RectifiedLinearComponent::RepairGradients()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00910">kaldi::TestCuMatrixAddRows2()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00934">kaldi::TestCuMatrixAddToRows()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00838">kaldi::TestCuMatrixCopyRows2()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00862">kaldi::TestCuMatrixCopyToRows()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00521">kaldi::UnitTestCuMatrixAddRows()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00451">kaldi::UnitTestCuMatrixCopyRows()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l00562">kaldi::UnitTestCuMatrixMulRows()</a>.</p>
<div class="fragment"><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a> + r * <a class="code" href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">stride_</a>; }</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a7cb3ee02262893923716e6764439f359"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">kaldi::CuMatrixBase::stride_</a></div><div class="ttdeci">MatrixIndexT stride_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00730">cu-matrix.h:730</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a98378a2a16c2d62cc61c89755e4cb78e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98378a2a16c2d62cc61c89755e4cb78e">&#9670;&nbsp;</a></span>RowData() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real* RowData </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a>&#160;</td>
          <td class="paramname"><em>r</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get raw row pointer. </p>
<p>Warning: may return a pointer to GPU memory. Use at your own risk. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00686">686</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a> + r * <a class="code" href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">stride_</a>; }</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a7cb3ee02262893923716e6764439f359"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">kaldi::CuMatrixBase::stride_</a></div><div class="ttdeci">MatrixIndexT stride_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00730">cu-matrix.h:730</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab997ee20e572278dabbfe92987fbed75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab997ee20e572278dabbfe92987fbed75">&#9670;&nbsp;</a></span>RowRange()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1CuSubMatrix.html">CuSubMatrix</a>&lt;Real&gt; RowRange </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a>&#160;</td>
          <td class="paramname"><em>row_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a>&#160;</td>
          <td class="paramname"><em>num_rows</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00603">603</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-various_8h_source.html#l00111">Splice::BackpropagateFnc()</a>, <a class="el" href="nnet-recurrent_8h_source.html#l00243">RecurrentComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-lstm-projected_8h_source.html#l00475">LstmProjected::BackpropagateFnc()</a>, <a class="el" href="nnet-blstm-projected_8h_source.html#l00720">BlstmProjected::BackpropagateFnc()</a>, <a class="el" href="nnet-compute-online_8cc_source.html#l00148">NnetOnlineComputer::Propagate()</a>, <a class="el" href="nnet-recurrent_8h_source.html#l00207">RecurrentComponent::PropagateFnc()</a>, <a class="el" href="nnet-lstm-projected_8h_source.html#l00365">LstmProjected::PropagateFnc()</a>, <a class="el" href="nnet-blstm-projected_8h_source.html#l00532">BlstmProjected::PropagateFnc()</a>, and <a class="el" href="nnet-convolutional-component_8cc_source.html#l00353">TimeHeightConvolutionComponent::UpdateNaturalGradient()</a>.</p>
<div class="fragment"><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                                                                       {</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac85bb7380dfaafef6fc9b91b508756e0">CuSubMatrix&lt;Real&gt;</a>(*<span class="keyword">this</span>, row_offset, num_rows,</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                             0, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>);</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  }</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac85bb7380dfaafef6fc9b91b508756e0"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac85bb7380dfaafef6fc9b91b508756e0">kaldi::CuMatrixBase::CuSubMatrix&lt; Real &gt;</a></div><div class="ttdeci">friend class CuSubMatrix&lt; Real &gt;</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00089">cu-matrix.h:89</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac54802d75d4c9025310b579e3fcea00c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac54802d75d4c9025310b579e3fcea00c">&#9670;&nbsp;</a></span>Scale()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Scale </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00610">610</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="decodable-online-looped_8cc_source.html#l00112">DecodableNnetLoopedOnlineBase::AdvanceChunk()</a>, <a class="el" href="decodable-simple-looped_8cc_source.html#l00140">DecodableNnetSimpleLooped::AdvanceChunk()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l01098">BackpropTruncationComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00664">TanhComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00726">PowerComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00845">ScaleComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00443">NoOpComponent::Backprop()</a>, <a class="el" href="nnet-average-pooling-component_8h_source.html#l00122">AveragePoolingComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-average-pooling-2d-component_8h_source.html#l00151">AveragePooling2DComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-multibasis-component_8h_source.html#l00338">MultiBasisComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-activation_8h_source.html#l00342">Dropout::BackpropagateFnc()</a>, <a class="el" href="online-nnet2-decodable_8cc_source.html#l00081">DecodableNnet2Online::ComputeForFrame()</a>, <a class="el" href="cu-compressed-matrix-test_8cc_source.html#l00054">kaldi::CuCompressedMatrixTestNonnegative()</a>, <a class="el" href="cu-compressed-matrix-test_8cc_source.html#l00107">kaldi::CuCompressedMatrixTestSymmetric()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01887">CuMatrixBase&lt; float &gt;::DiffLogSoftmaxPerRow()</a>, <a class="el" href="nnet-am-decodable-simple_8cc_source.html#l00215">DecodableNnetSimple::DoNnetComputation()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00210">NnetComputer::ExecuteCommand()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l01682">GeneralDropoutComponent::GetMemo()</a>, <a class="el" href="nnet-train-mpe-sequential_8cc_source.html#l00085">main()</a>, <a class="el" href="nnet-precondition_8cc_source.html#l00138">kaldi::nnet2::PreconditionDirectionsAlphaRescaled()</a>, <a class="el" href="nnet-chain-training_8cc_source.html#l00283">NnetChainTrainer::ProcessOutputs()</a>, <a class="el" href="nnet-discriminative-training_8cc_source.html#l00109">NnetDiscriminativeTrainer::ProcessOutputs()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l01087">BackpropTruncationComponent::Propagate()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l01412">DropoutMaskComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00837">ScaleComponent::Propagate()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l03531">DropoutComponent::Propagate()</a>, <a class="el" href="nnet-kl-hmm_8h_source.html#l00050">KlHmm::PropagateFnc()</a>, <a class="el" href="nnet-activation_8h_source.html#l00329">Dropout::PropagateFnc()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00738">ClipGradientComponent::RepairGradients()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00255">RestrictedAttentionComponent::Scale()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00941">TanhComponent::StoreStats()</a>, <a class="el" href="attention-test_8cc_source.html#l00120">kaldi::nnet3::attention::TestAttentionForwardBackward()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01274">kaldi::UnitTestCuMatrixAddMatDiagVec()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01302">kaldi::UnitTestCuMatrixAddMatMatElements()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00243">kaldi::UnitTestCuMatrixScale()</a>, and <a class="el" href="cu-math-test_8cc_source.html#l00213">kaldi::UnitTestLstmNonlinearity()</a>.</p>
<div class="fragment"><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                                         {</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    CuTimer tim;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    cuda_scale(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, value, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  {</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().Scale(value);</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  }</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac6869c723f58973838a83d4b60d4b433"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6869c723f58973838a83d4b60d4b433">&#9670;&nbsp;</a></span>Set()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Set </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00497">497</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-general-component_8cc_source.html#l01098">BackpropTruncationComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00622">SigmoidComponent::Backprop()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00210">NnetComputer::ExecuteCommand()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l04295">MaxpoolingComponent::Propagate()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l01412">DropoutMaskComponent::Propagate()</a>, <a class="el" href="nnet-max-pooling-component_8h_source.html#l00103">MaxPoolingComponent::PropagateFnc()</a>, <a class="el" href="nnet-max-pooling-2d-component_8h_source.html#l00127">MaxPooling2DComponent::PropagateFnc()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00417">SigmoidComponent::StoreStats()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02774">kaldi::UnitTestCuMatrixObjfDeriv()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00338">kaldi::UnitTestCuMatrixSet()</a>, <a class="el" href="nnet-component-test_8cc_source.html#l00393">kaldi::nnet1::UnitTestDropoutComponent()</a>, and <a class="el" href="nnet-component-test_8cc_source.html#l00179">kaldi::nnet1::UnitTestMaxPoolingComponent()</a>.</p>
<div class="fragment"><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                                       {</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="preprocessor">  #if HAVE_CUDA == 1</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    CuTimer tim;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    cuda_set_const(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, value, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="preprocessor">  #endif</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  {</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().Set(value);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  }</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a77216f592a9fd9eb20bcc750c71cc87a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77216f592a9fd9eb20bcc750c71cc87a">&#9670;&nbsp;</a></span>SetMatMatDivMat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetMatMatDivMat </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>C</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>*this = a * b / c (by element; when c = 0, *this = a) *this can be an alias of a, b or c safely and get expected result. </p>
<p>dst = a * b / c (by element; when c = 0, dst = a) dst can be an alias of a, b or c safely and get expected result.</p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01193">1193</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="_2nnet-component_8cc_source.html#l03566">DropoutComponent::Backprop()</a>, and <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>.</p>
<div class="fragment"><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                                                                              {</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    CuTimer tim;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == A.num_rows_ &amp;&amp; <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a> == A.num_cols_);</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == B.num_rows_ &amp;&amp; <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a> == B.num_cols_);</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == C.num_rows_ &amp;&amp; <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a> == C.num_cols_);</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    cuda_set_mat_mat_div_mat(dimGrid, dimBlock, A.data_, B.data_, C.data_,</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                             <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), A.Stride(), B.Stride(), C.Stride());</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;  {</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().SetMatMatDivMat(A.Mat(), B.Mat(), C.Mat());</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;  }</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a40c5a82d6d015bdcc0079b535b1e9a23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40c5a82d6d015bdcc0079b535b1e9a23">&#9670;&nbsp;</a></span>SetRandn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetRandn </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l03099">3099</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-compressed-matrix-test_8cc_source.html#l00034">kaldi::CuCompressedMatrixTestSign()</a>, <a class="el" href="cu-vector-test_8cc_source.html#l00264">kaldi::CuVectorUnitTestAddColSumMat()</a>, <a class="el" href="cu-vector-test_8cc_source.html#l00668">kaldi::CuVectorUnitTestAddDiagMat2()</a>, <a class="el" href="cu-vector-test_8cc_source.html#l00692">kaldi::CuVectorUnitTestAddDiagMatMat()</a>, <a class="el" href="cu-vector-test_8cc_source.html#l00725">kaldi::CuVectorUnitTestAddMatVec()</a>, <a class="el" href="cu-vector-test_8cc_source.html#l00249">kaldi::CuVectorUnitTestAddRowSumMat()</a>, <a class="el" href="cu-vector-test_8cc_source.html#l00207">kaldi::CuVectorUnitTestCopyElements()</a>, <a class="el" href="cu-vector-test_8cc_source.html#l00375">kaldi::CuVectorUnitTestCopyFromMat()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l03343">FixedAffineComponent::InitFromConfig()</a>, <a class="el" href="cu-matrix_8h_source.html#l00633">CuMatrixBase&lt; float &gt;::operator()()</a>, <a class="el" href="nnet-convolutional-component_8cc_source.html#l00599">TimeHeightConvolutionComponent::PerturbParams()</a>, <a class="el" href="nnet-tdnn-component_8cc_source.html#l00617">TdnnComponent::PerturbParams()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01355">RepeatedAffineComponent::PerturbParams()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l01053">AffineComponent::PerturbParams()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l03294">LinearComponent::PerturbParams()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l01933">BlockAffineComponent::PerturbParams()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l04140">Convolutional1dComponent::PerturbParams()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l04570">ConvolutionComponent::PerturbParams()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l05724">LstmNonlinearityComponent::PerturbParams()</a>, <a class="el" href="attention-test_8cc_source.html#l00120">kaldi::nnet3::attention::TestAttentionForwardBackward()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00169">kaldi::TestCuMatrixAddMat()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00192">kaldi::TestCuMatrixAddMatBlocks()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00958">kaldi::TestCuMatrixAddRowRanges()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00886">kaldi::TestCuMatrixAddRows1()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00910">kaldi::TestCuMatrixAddRows2()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00934">kaldi::TestCuMatrixAddToRows()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00308">kaldi::TestCuMatrixCompObjfAndDeriv()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00670">kaldi::TestCuMatrixCopyLowerToUpper()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00814">kaldi::TestCuMatrixCopyRows1()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00838">kaldi::TestCuMatrixCopyRows2()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00862">kaldi::TestCuMatrixCopyToRows()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00736">kaldi::TestCuMatrixCopyUpperToLower()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00553">kaldi::TestCuMatrixDiffGroupPnorm()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00482">kaldi::TestCuMatrixDiffLogSoftmax()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00464">kaldi::TestCuMatrixDiffSoftmax()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00097">kaldi::TestCuMatrixDivRowsVec()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00589">kaldi::TestCuMatrixGroupMaxAllGroupSizes()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00427">kaldi::TestCuMatrixHeaviside()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00518">kaldi::TestCuMatrixLogSoftmax()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00782">kaldi::TestCuMatrixLookup()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00229">kaldi::TestCuMatrixMatMatBatched()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00063">kaldi::TestCuMatrixMax()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00080">kaldi::TestCuMatrixMin()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00445">kaldi::TestCuMatrixMulRowsGroupMat()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00767">kaldi::TestCuMatrixSetZeroAboveDiag()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00410">kaldi::TestCuMatrixSigmoid()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00500">kaldi::TestCuMatrixSoftmax()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00046">kaldi::TestCuMatrixSum()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00630">kaldi::TestCuMatrixTraceMatMat()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00116">kaldi::TestCuMatrixTransposeNS()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00132">kaldi::TestCuMatrixTransposeS()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00983">kaldi::TestCuSparseMatrixTraceMatSmat()</a>, <a class="el" href="cu-vector-speed-test_8cc_source.html#l00266">kaldi::TestCuVectorAddColSumMat()</a>, <a class="el" href="cu-vector-speed-test_8cc_source.html#l00222">kaldi::TestCuVectorAddDiagMat2()</a>, <a class="el" href="cu-vector-speed-test_8cc_source.html#l00196">kaldi::TestCuVectorAddDiagMat2OnVariousShapes()</a>, <a class="el" href="cu-vector-speed-test_8cc_source.html#l00170">kaldi::TestCuVectorAddDiagMatMat()</a>, <a class="el" href="cu-vector-speed-test_8cc_source.html#l00372">kaldi::TestCuVectorAddDiagMatMatShape()</a>, <a class="el" href="cu-vector-speed-test_8cc_source.html#l00244">kaldi::TestCuVectorAddRowSumMat()</a>, <a class="el" href="convolution-test_8cc_source.html#l00308">kaldi::nnet3::time_height_convolution::TestDataBackprop()</a>, <a class="el" href="convolution-test_8cc_source.html#l00350">kaldi::nnet3::time_height_convolution::TestParamsBackprop()</a>, <a class="el" href="convolution-test_8cc_source.html#l00280">kaldi::nnet3::time_height_convolution::TestRunningComputation()</a>, <a class="el" href="_2nnet-component-test_8cc_source.html#l00309">kaldi::nnet3::TestSimpleComponentDataDerivative()</a>, <a class="el" href="_2nnet-component-test_8cc_source.html#l00390">kaldi::nnet3::TestSimpleComponentModelDerivative()</a>, <a class="el" href="_2nnet-component-test_8cc_source.html#l00210">kaldi::nnet3::TestSimpleComponentPropagateProperties()</a>, <a class="el" href="attention-test_8cc_source.html#l00091">kaldi::nnet3::attention::UnitTestAttentionDotProductAndAddScales()</a>, <a class="el" href="cu-math-test_8cc_source.html#l00321">kaldi::UnitTestBackpropLstmNonlinearity()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02158">kaldi::UnitTestCuApproxEqual()</a>, <a class="el" href="cu-block-matrix-test_8cc_source.html#l00076">kaldi::UnitTestCuBlockMatrixAddMatBlock()</a>, <a class="el" href="cu-block-matrix-test_8cc_source.html#l00116">kaldi::UnitTestCuBlockMatrixAddMatMat()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00112">kaldi::UnitTestCuCholesky()</a>, <a class="el" href="cu-math-test_8cc_source.html#l00549">kaldi::UnitTestCuDiffNormalizePerRow()</a>, <a class="el" href="cu-math-test_8cc_source.html#l00166">kaldi::UnitTestCuMathComputeLstmNonlinearity()</a>, <a class="el" href="cu-math-test_8cc_source.html#l00097">kaldi::UnitTestCuMathCopy()</a>, <a class="el" href="cu-math-test_8cc_source.html#l00479">kaldi::UnitTestCuMathNormalizePerRow()</a>, <a class="el" href="cu-math-test_8cc_source.html#l00046">kaldi::UnitTestCuMathRandomize()</a>, <a class="el" href="cu-math-test_8cc_source.html#l00124">kaldi::UnitTestCuMathSplice()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00890">kaldi::UnitTestCuMatrixAddCols()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01237">kaldi::UnitTestCuMatrixAddDiagVecMat()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02815">kaldi::UnitTestCuMatrixAddElements()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01426">kaldi::UnitTestCuMatrixAddMatBlocks1()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01453">kaldi::UnitTestCuMatrixAddMatBlocks1Trans()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01483">kaldi::UnitTestCuMatrixAddMatBlocks2()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00521">kaldi::UnitTestCuMatrixAddRows()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02852">kaldi::UnitTestCuMatrixAddToElements()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00598">kaldi::UnitTestCuMatrixAddToRows()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00757">kaldi::UnitTestCuMatrixCopyCols()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00640">kaldi::UnitTestCuMatrixCopyCross()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00662">kaldi::UnitTestCuMatrixCopyCross2()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02711">kaldi::UnitTestCuMatrixCopyLowerToUpper()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00451">kaldi::UnitTestCuMatrixCopyRows()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00487">kaldi::UnitTestCuMatrixCopyToRows()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02752">kaldi::UnitTestCuMatrixCopyUpperToLower()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02112">kaldi::UnitTestCuMatrixIO()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02874">kaldi::UnitTestCuMatrixLookup()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00562">kaldi::UnitTestCuMatrixMulRows()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02774">kaldi::UnitTestCuMatrixObjfDeriv()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01521">kaldi::UnitTestCuMatrixReduceMax()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01530">kaldi::UnitTestCuMatrixReduceMin()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01512">kaldi::UnitTestCuMatrixReduceSum()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01320">kaldi::UnitTestCuMatrixSetMatMatDivMat()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02623">kaldi::UnitTestCuMatrixSetRandn()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02731">kaldi::UnitTestCuMatrixSetZeroAboveDiag()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01584">kaldi::UnitTestCuMatrixSymAddMat2()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01614">kaldi::UnitTestCuMatrixSymInvertPosDef()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00076">kaldi::UnitTestCuMatrixTraceMatMat()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01874">kaldi::UnitTestCuMatrixTranspose()</a>, <a class="el" href="cu-sparse-matrix-test_8cc_source.html#l00181">kaldi::UnitTestCuSparseMatrixFrobeniusNorm()</a>, <a class="el" href="cu-sparse-matrix-test_8cc_source.html#l00160">kaldi::UnitTestCuSparseMatrixSum()</a>, <a class="el" href="cu-sparse-matrix-test_8cc_source.html#l00126">kaldi::UnitTestCuSparseMatrixTraceMatSmat()</a>, <a class="el" href="cu-sp-matrix-test_8cc_source.html#l00132">kaldi::UnitTestCuSpMatrixCopyFromMat()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02030">kaldi::UnitTestCuSubMatrix()</a>, <a class="el" href="cu-tp-matrix-test_8cc_source.html#l00112">kaldi::UnitTestCuTpMatrixCopyFromMat()</a>, <a class="el" href="cu-math-test_8cc_source.html#l00073">kaldi::UnitTestEnsureNonzero()</a>, <a class="el" href="_2nnet-component-test_8cc_source.html#l00661">kaldi::nnet2::UnitTestFixedAffineComponent()</a>, <a class="el" href="_2nnet-component-test_8cc_source.html#l00649">kaldi::nnet2::UnitTestFixedLinearComponent()</a>, <a class="el" href="_2nnet-component-test_8cc_source.html#l00028">kaldi::nnet2::UnitTestGenericComponentInternal()</a>, <a class="el" href="cu-test_8cc_source.html#l00338">kaldi::UnitTestMatrix()</a>, <a class="el" href="nnet2_2nnet-compute-test_8cc_source.html#l00029">kaldi::nnet2::UnitTestNnetCompute()</a>, <a class="el" href="nnet3_2nnet-compute-test_8cc_source.html#l00147">kaldi::nnet3::UnitTestNnetCompute()</a>, <a class="el" href="nnet2_2nnet-compute-test_8cc_source.html#l00084">kaldi::nnet2::UnitTestNnetComputeChunked()</a>, <a class="el" href="nnet-derivative-test_8cc_source.html#l00246">kaldi::nnet3::UnitTestNnetInputDerivatives()</a>, <a class="el" href="nnet-derivative-test_8cc_source.html#l00091">kaldi::nnet3::UnitTestNnetModelDerivatives()</a>, <a class="el" href="nnet-optimize-test_8cc_source.html#l00033">kaldi::nnet3::UnitTestNnetOptimizeWithOptions()</a>, <a class="el" href="nnet-precondition-test_8cc_source.html#l00026">kaldi::nnet2::UnitTestPreconditionDirections()</a>, and <a class="el" href="cu-vector-test_8cc_source.html#l00234">kaldi::UnitTestVecMatVec()</a>.</p>
<div class="fragment"><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;                                  {</div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#acf5339e82134d0ac259966e0f0f67ab9">CuRand&lt;Real&gt;</a> tmp;</div><div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;    tmp.RandGaussian(<span class="keyword">this</span>);</div><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;  {</div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().SetRandn();</div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;  }</div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acf5339e82134d0ac259966e0f0f67ab9"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acf5339e82134d0ac259966e0f0f67ab9">kaldi::CuMatrixBase::CuRand&lt; Real &gt;</a></div><div class="ttdeci">friend class CuRand&lt; Real &gt;</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00090">cu-matrix.h:90</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8b416db95082dda652bb230f89cdbfbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b416db95082dda652bb230f89cdbfbf">&#9670;&nbsp;</a></span>SetRandUniform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetRandUniform </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l03113">3113</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-compressed-matrix-test_8cc_source.html#l00054">kaldi::CuCompressedMatrixTestNonnegative()</a>, <a class="el" href="cu-compressed-matrix-test_8cc_source.html#l00107">kaldi::CuCompressedMatrixTestSymmetric()</a>, <a class="el" href="cu-matrix_8h_source.html#l00633">CuMatrixBase&lt; float &gt;::operator()()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02905">kaldi::UnitTestCuMatrixEqualElementMask()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l02670">kaldi::UnitTestCuMatrixSetRandUniform()</a>.</p>
<div class="fragment"><div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;                                        {</div><div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#acf5339e82134d0ac259966e0f0f67ab9">CuRand&lt;Real&gt;</a> tmp;</div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;    tmp.RandUniform(<span class="keyword">this</span>);</div><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;  {</div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().SetRandUniform();</div><div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;  }</div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acf5339e82134d0ac259966e0f0f67ab9"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acf5339e82134d0ac259966e0f0f67ab9">kaldi::CuMatrixBase::CuRand&lt; Real &gt;</a></div><div class="ttdeci">friend class CuRand&lt; Real &gt;</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00090">cu-matrix.h:90</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae57e5aca5db002545e4b9335c8d9dbfa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae57e5aca5db002545e4b9335c8d9dbfa">&#9670;&nbsp;</a></span>SetZero()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetZero </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Math operations, some calling kernels. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00476">476</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-general-component_8cc_source.html#l00194">DistributeComponent::Backprop()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00476">StatisticsExtractionComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00675">ClipGradientComponent::Backprop()</a>, <a class="el" href="nnet-max-pooling-component_8h_source.html#l00121">MaxPoolingComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-average-pooling-component_8h_source.html#l00122">AveragePoolingComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-average-pooling-2d-component_8h_source.html#l00151">AveragePooling2DComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-max-pooling-2d-component_8h_source.html#l00153">MaxPooling2DComponent::BackpropagateFnc()</a>, <a class="el" href="nnet-various_8h_source.html#l00221">CopyComponent::BackpropagateFnc()</a>, <a class="el" href="cu-sparse-matrix_8cc_source.html#l00622">CuSparseMatrix&lt; Real &gt;::CopyToMat()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00210">NnetComputer::ExecuteCommand()</a>, <a class="el" href="nnet-precondition-online_8cc_source.html#l00045">OnlinePreconditioner::InitOrthonormalSpecial()</a>, <a class="el" href="natural-gradient-online_8cc_source.html#l00046">OnlineNaturalGradient::InitOrthonormalSpecial()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00447">StatisticsExtractionComponent::Propagate()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00771">StatisticsPoolingComponent::Propagate()</a>, <a class="el" href="nnet-average-pooling-component_8h_source.html#l00103">AveragePoolingComponent::PropagateFnc()</a>, <a class="el" href="nnet-average-pooling-2d-component_8h_source.html#l00126">AveragePooling2DComponent::PropagateFnc()</a>, <a class="el" href="nnet-frame-pooling-component_8h_source.html#l00216">FramePoolingComponent::PropagateFnc()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="attention-test_8cc_source.html#l00120">kaldi::nnet3::attention::TestAttentionForwardBackward()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00308">kaldi::TestCuMatrixCompObjfAndDeriv()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01320">kaldi::UnitTestCuMatrixSetMatMatDivMat()</a>, and <a class="el" href="nnet-attention-component_8cc_source.html#l00249">RestrictedAttentionComponent::ZeroStats()</a>.</p>
<div class="fragment"><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                                 {</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    CuTimer tim;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    CU_SAFE_CALL(cudaMemset2D(<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">stride_</a> * <span class="keyword">sizeof</span>(Real), 0,</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                              <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a> * <span class="keyword">sizeof</span>(Real), <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> ));</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    CuDevice::Instantiate().AccuProfile(<span class="stringliteral">&quot;CuMatrix::SetZero&quot;</span>, tim);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  {</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().SetZero();</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  }</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a7cb3ee02262893923716e6764439f359"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">kaldi::CuMatrixBase::stride_</a></div><div class="ttdeci">MatrixIndexT stride_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00730">cu-matrix.h:730</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a73be15df483d1ef6c08cea5adc15bc3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73be15df483d1ef6c08cea5adc15bc3f">&#9670;&nbsp;</a></span>SetZeroAboveDiag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetZeroAboveDiag </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Zeroes all elements for which col &gt; row. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00520">520</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00767">kaldi::TestCuMatrixSetZeroAboveDiag()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02731">kaldi::UnitTestCuMatrixSetZeroAboveDiag()</a>, and <a class="el" href="cu-test_8cc_source.html#l00060">kaldi::UnitTestSetZeroAboveDiag()</a>.</p>
<div class="fragment"><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                                          {</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    CuTimer tim;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    cuda_set_zero_above_diag(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  {</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    MatrixBase&lt;Real&gt; &amp;mat = <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>();</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    int32 num_rows = mat.NumRows(), num_cols = mat.NumCols();</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordflow">for</span> (int32 r = 0; r + 1 &lt; num_rows; r++) {</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      SubVector&lt;Real&gt; vec(mat, r),</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;          vec_part(vec, r + 1, num_cols - (r + 1));</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      vec_part.SetZero();</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    }</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  }</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aae5806cc9e96c577cec331f3a915017d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae5806cc9e96c577cec331f3a915017d">&#9670;&nbsp;</a></span>Sigmoid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Sigmoid </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>src</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set each element to the sigmoid of the corresponding element of "src": element by element, x = 1 / (1 + exp(-x)) </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01521">1521</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="_2nnet-component_8cc_source.html#l00810">SoftHingeComponent::Backprop()</a>, <a class="el" href="_2nnet-component_8cc_source.html#l00611">SigmoidComponent::Propagate()</a>, <a class="el" href="nnet-activation_8h_source.html#l00223">Sigmoid::PropagateFnc()</a>, <a class="el" href="nnet-rbm_8h_source.html#l00226">Rbm::PropagateFnc()</a>, <a class="el" href="nnet-rbm_8h_source.html#l00239">Rbm::Reconstruct()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00410">kaldi::TestCuMatrixSigmoid()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00223">kaldi::UnitTestCuMatrixSigmoid()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l02225">kaldi::UnitTestCuSigmoid()</a>.</p>
<div class="fragment"><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                                                              {</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">SameDim</a>(*<span class="keyword">this</span>, src));</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    CuTimer tim;</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    cuda_sigmoid(dimGrid, dimBlock, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, src.data_, this-&gt;Dim(),</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                 src.Stride());</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="preprocessor">  #endif</span></div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  {</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().Sigmoid(src.Mat());</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  }</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="group__matrix__funcs__io_html_ga07b147212efb08775c252cd4cc7453fe"><div class="ttname"><a href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">kaldi::SameDim</a></div><div class="ttdeci">bool SameDim(const MatrixBase&lt; Real &gt; &amp;M, const MatrixBase&lt; Real &gt; &amp;N)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l01065">kaldi-matrix.h:1065</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2444c253ce3e836b558d3817edd3fc42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2444c253ce3e836b558d3817edd3fc42">&#9670;&nbsp;</a></span>SizeInBytes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> SizeInBytes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get size of matrix in bytes. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00233">233</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>*<a class="code" href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">stride_</a>*<span class="keyword">sizeof</span>(Real); }</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a7cb3ee02262893923716e6764439f359"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">kaldi::CuMatrixBase::stride_</a></div><div class="ttdeci">MatrixIndexT stride_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00730">cu-matrix.h:730</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af19362cd0ed9de3b0a74bc9616e68dd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af19362cd0ed9de3b0a74bc9616e68dd1">&#9670;&nbsp;</a></span>SoftHinge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SoftHinge </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>src</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply the function y = log(1 + exp(x)), to each element. </p>
<p>Note: the derivative of this function is the sigmoid function. This is like a soft ReLU. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01542">1542</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="_2nnet-component_8cc_source.html#l00799">SoftHingeComponent::Propagate()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l00274">kaldi::UnitTestCuMatrixSoftHinge()</a>.</p>
<div class="fragment"><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                                                                {</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">SameDim</a>(*<span class="keyword">this</span>, src));</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    CuTimer tim;</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    cuda_soft_hinge(dimGrid, dimBlock, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, src.data_, this-&gt;Dim(),</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;                    src.Stride());</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;<span class="preprocessor">  #endif</span></div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;  {</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().SoftHinge(src.Mat());</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  }</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="group__matrix__funcs__io_html_ga07b147212efb08775c252cd4cc7453fe"><div class="ttname"><a href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">kaldi::SameDim</a></div><div class="ttdeci">bool SameDim(const MatrixBase&lt; Real &gt; &amp;M, const MatrixBase&lt; Real &gt; &amp;N)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l01065">kaldi-matrix.h:1065</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a180e10f97fa838f9c1ae125ba164dd77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a180e10f97fa838f9c1ae125ba164dd77">&#9670;&nbsp;</a></span>Stride()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> Stride </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00216">216</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00542">NnetComputer::AcceptInput()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02668">CuMatrixBase&lt; float &gt;::AddCols()</a>, <a class="el" href="cu-vector_8cc_source.html#l00583">CuVectorBase&lt; float &gt;::AddDiagMatMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01369">CuMatrixBase&lt; float &gt;::AddDiagVecMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00941">CuMatrixBase&lt; float &gt;::AddMat()</a>, <a class="el" href="cu-sp-matrix_8cc_source.html#l00130">CuSpMatrix&lt; Real &gt;::AddMat2()</a>, <a class="el" href="cu-matrix_8cc_source.html#l03172">CuMatrixBase&lt; float &gt;::AddMatBlock()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01106">CuMatrixBase&lt; float &gt;::AddMatBlocks()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01402">CuMatrixBase&lt; float &gt;::AddMatDiagVec()</a>, <a class="el" href="cu-block-matrix_8cc_source.html#l00211">CuBlockMatrix&lt; Real &gt;::AddMatMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01278">CuMatrixBase&lt; float &gt;::AddMatMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01434">CuMatrixBase&lt; float &gt;::AddMatMatElements()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01067">CuMatrixBase&lt; float &gt;::AddMatSmat()</a>, <a class="el" href="cu-vector_8cc_source.html#l00478">CuVectorBase&lt; float &gt;::AddMatVec()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02733">CuMatrixBase&lt; float &gt;::AddRows()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01011">CuMatrixBase&lt; float &gt;::AddSmatMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02836">CuMatrixBase&lt; float &gt;::AddToRows()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01724">CuMatrixBase&lt; float &gt;::ApplyLogSoftMaxPerRow()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01701">CuMatrixBase&lt; float &gt;::ApplySoftMaxPerRow()</a>, <a class="el" href="nnet-normalize-component_8cc_source.html#l00177">NormalizeComponent::Backprop()</a>, <a class="el" href="nnet-normalize-component_8cc_source.html#l00466">BatchNormComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01454">RepeatedAffineComponent::Backprop()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l01578">GeneralDropoutComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02210">PerElementOffsetComponent::Backprop()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02474">ScaleAndOffsetComponent::Backprop()</a>, <a class="el" href="cu-math_8cc_source.html#l00768">kaldi::cu::BackpropLstmNonlinearity()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00134">DistributeComponent::ComputeInputPointers()</a>, <a class="el" href="cu-math_8cc_source.html#l00489">kaldi::cu::ComputeLstmNonlinearity()</a>, <a class="el" href="convolution_8cc_source.html#l00682">kaldi::nnet3::time_height_convolution::ConvolveBackwardData()</a>, <a class="el" href="convolution_8cc_source.html#l00603">kaldi::nnet3::time_height_convolution::ConvolveBackwardDataInternal()</a>, <a class="el" href="convolution_8cc_source.html#l00840">kaldi::nnet3::time_height_convolution::ConvolveBackwardParams()</a>, <a class="el" href="convolution_8cc_source.html#l00763">kaldi::nnet3::time_height_convolution::ConvolveBackwardParamsInternal()</a>, <a class="el" href="convolution_8cc_source.html#l00524">kaldi::nnet3::time_height_convolution::ConvolveForward()</a>, <a class="el" href="convolution_8cc_source.html#l00448">kaldi::nnet3::time_height_convolution::ConvolveForwardInternal()</a>, <a class="el" href="cu-vector_8cc_source.html#l00102">CuVectorBase&lt; float &gt;::CopyColFromMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02623">CuMatrixBase&lt; float &gt;::CopyCols()</a>, <a class="el" href="cu-vector_8cc_source.html#l01163">CuVectorBase&lt; float &gt;::CopyDiagFromMat()</a>, <a class="el" href="cu-vector_8cc_source.html#l01296">CuVectorBase&lt; float &gt;::CopyElements()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00207">CuMatrixBase&lt; float &gt;::CopyFromMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02645">CuMatrixBase&lt; float &gt;::CopyRows()</a>, <a class="el" href="cu-vector_8cc_source.html#l00163">CuVectorBase&lt; float &gt;::CopyRowsFromMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02591">VectorBase&lt; float &gt;::CopyRowsFromMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00828">CuMatrixBase&lt; float &gt;::DiffGroupPnorm()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01887">CuMatrixBase&lt; float &gt;::DiffLogSoftmaxPerRow()</a>, <a class="el" href="cu-math_8cc_source.html#l00349">kaldi::cu::DiffNormalizePerRow()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01488">CuMatrixBase&lt; float &gt;::DiffParametricRelu()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01748">CuMatrixBase&lt; float &gt;::DiffSigmoid()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01852">CuMatrixBase&lt; float &gt;::DiffSoftmaxPerRow()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01793">CuMatrixBase&lt; float &gt;::DiffTanh()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00678">CuMatrixBase&lt; float &gt;::DivElements()</a>, <a class="el" href="cu-math_8cc_source.html#l00209">kaldi::cu::EnsureNonzero()</a>, <a class="el" href="cu-matrix_8cc_source.html#l03395">CuMatrixBase&lt; float &gt;::EqualElementMask()</a>, <a class="el" href="nnet-tdnn-component_8cc_source.html#l00497">TdnnComponent::GetInputPart()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00457">NnetComputer::GetPointers()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01604">CuMatrixBase&lt; float &gt;::GroupMax()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00861">CuMatrixBase&lt; float &gt;::GroupMaxDeriv()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01563">CuMatrixBase&lt; float &gt;::GroupPnorm()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02463">CuMatrixBase&lt; float &gt;::Heaviside()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00702">CuMatrixBase&lt; float &gt;::Max()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00727">CuMatrixBase&lt; float &gt;::Min()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00654">CuMatrixBase&lt; float &gt;::MulElements()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02757">CuMatrixBase&lt; float &gt;::MulRows()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00803">CuMatrixBase&lt; float &gt;::MulRowsGroupMat()</a>, <a class="el" href="cu-math_8cc_source.html#l00280">kaldi::cu::NormalizePerRow()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01454">CuMatrixBase&lt; float &gt;::ParametricRelu()</a>, <a class="el" href="nnet-normalize-component_8cc_source.html#l00132">NormalizeComponent::Propagate()</a>, <a class="el" href="nnet-normalize-component_8cc_source.html#l00400">BatchNormComponent::Propagate()</a>, <a class="el" href="nnet-convolutional-component_8cc_source.html#l00282">TimeHeightConvolutionComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01428">RepeatedAffineComponent::Propagate()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l01545">GeneralDropoutComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02191">PerElementOffsetComponent::Propagate()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02440">ScaleAndOffsetComponent::Propagate()</a>, <a class="el" href="cu-rand_8cc_source.html#l00139">CuRand&lt; float &gt;::RandGaussian()</a>, <a class="el" href="cu-rand_8cc_source.html#l00083">CuRand&lt; float &gt;::RandUniform()</a>, <a class="el" href="cu-math_8cc_source.html#l00037">kaldi::cu::RegularizeL1()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00989">RectifiedLinearComponent::RepairGradients()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01193">CuMatrixBase&lt; float &gt;::SetMatMatDivMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01521">CuMatrixBase&lt; float &gt;::Sigmoid()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01542">CuMatrixBase&lt; float &gt;::SoftHinge()</a>, <a class="el" href="nnet-normalize-component_8cc_source.html#l00549">BatchNormComponent::StoreStats()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01340">CuMatrixBase&lt; float &gt;::SymAddMat2()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01770">CuMatrixBase&lt; float &gt;::Tanh()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02128">kaldi::TraceMatMat()</a>, <a class="el" href="cu-test_8cc_source.html#l00242">kaldi::UnitTestCopySp()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01495">RepeatedAffineComponent::Update()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01594">NaturalGradientRepeatedAffineComponent::Update()</a>, <a class="el" href="nnet-convolutional-component_8cc_source.html#l00353">TimeHeightConvolutionComponent::UpdateNaturalGradient()</a>, and <a class="el" href="nnet-convolutional-component_8cc_source.html#l00333">TimeHeightConvolutionComponent::UpdateSimple()</a>.</p>
<div class="fragment"><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">stride_</a>; }</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a7cb3ee02262893923716e6764439f359"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">kaldi::CuMatrixBase::stride_</a></div><div class="ttdeci">MatrixIndexT stride_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00730">cu-matrix.h:730</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae7089fd656218302336300dc42ae55c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7089fd656218302336300dc42ae55c1">&#9670;&nbsp;</a></span>Sum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Real Sum </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02979">2979</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-general-component_8cc_source.html#l01098">BackpropTruncationComponent::Backprop()</a>, <a class="el" href="nnet-utils_8h_source.html#l00132">kaldi::nnet1::CheckNanInf()</a>, <a class="el" href="nnet-training_8cc_source.html#l00370">kaldi::nnet3::ComputeObjectiveFunction()</a>, <a class="el" href="nnet-utils_8h_source.html#l00142">kaldi::nnet1::ComputeStdDev()</a>, <a class="el" href="nnet-loss_8cc_source.html#l00062">Xent::Eval()</a>, <a class="el" href="nnet-loss_8cc_source.html#l00228">Mse::Eval()</a>, <a class="el" href="nnet-forward_8cc_source.html#l00030">main()</a>, <a class="el" href="cu-rand-speed-test_8cc_source.html#l00049">kaldi::MeanVariance()</a>, <a class="el" href="cu-matrix_8h_source.html#l00633">CuMatrixBase&lt; float &gt;::operator()()</a>, <a class="el" href="nnet-parse_8cc_source.html#l00547">kaldi::nnet3::PrintParameterStats()</a>, <a class="el" href="rescale-nnet_8cc_source.html#l00121">NnetRescaler::RescaleComponent()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00046">kaldi::TestCuMatrixSum()</a>, <a class="el" href="cu-block-matrix-test_8cc_source.html#l00116">kaldi::UnitTestCuBlockMatrixAddMatMat()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01237">kaldi::UnitTestCuMatrixAddDiagVecMat()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02905">kaldi::UnitTestCuMatrixEqualElementMask()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01512">kaldi::UnitTestCuMatrixReduceSum()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02623">kaldi::UnitTestCuMatrixSetRandn()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02670">kaldi::UnitTestCuMatrixSetRandUniform()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00076">kaldi::UnitTestCuMatrixTraceMatMat()</a>, <a class="el" href="cu-sparse-matrix-test_8cc_source.html#l00160">kaldi::UnitTestCuSparseMatrixSum()</a>, <a class="el" href="nnet-component-test_8cc_source.html#l00393">kaldi::nnet1::UnitTestDropoutComponent()</a>, <a class="el" href="nnet3_2nnet-compute-test_8cc_source.html#l00147">kaldi::nnet3::UnitTestNnetCompute()</a>, <a class="el" href="nnet-optimize-test_8cc_source.html#l00033">kaldi::nnet3::UnitTestNnetOptimizeWithOptions()</a>, <a class="el" href="nnet-frame-pooling-component_8h_source.html#l00241">FramePoolingComponent::Update()</a>, and <a class="el" href="nnet-simple-component_8cc_source.html#l01594">NaturalGradientRepeatedAffineComponent::Update()</a>.</p>
<div class="fragment"><div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;                                   {</div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> &gt; 0 &amp;&amp; <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a> &gt; 0);</div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;</div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;    CuVector&lt;Real&gt; col_sum(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, <a class="code" href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kUndefined</a>);</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;    cuda_sum_mat_cols(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, <a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a>, col_sum.Data(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>());</div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;    Real ans = col_sum.Sum();</div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;</div><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;    <span class="keywordflow">return</span> ans;</div><div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;  {</div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().Sum();</div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;  }</div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126"><div class="ttname"><a href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kaldi::kUndefined</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00039">matrix-common.h:39</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a6dbdf9d0385c92d6d915b96eaf9ce99e"><div class="ttname"><a href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a></div><div class="ttdeci">#define CU1DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00063">cu-matrixdim.h:63</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a98157a233bc5fd222414eeeeaa5f19a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98157a233bc5fd222414eeeeaa5f19a4">&#9670;&nbsp;</a></span>SumColumnRanges()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SumColumnRanges </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuArrayBase.html">CuArrayBase</a>&lt; <a class="el" href="structInt32Pair.html">Int32Pair</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>indexes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For each row r of this and for each column c, sets (*this)(r, c) to the sum  src(r, j), where j ranges from indexes[c].first through indexes[c].second - 1. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02860">2860</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="_2nnet-component_8cc_source.html#l02440">SumGroupComponent::Propagate()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l00677">kaldi::UnitTestCuMatrixSumColumnRanges()</a>.</p>
<div class="fragment"><div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;                                                                                {</div><div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(static_cast&lt;MatrixIndexT&gt;(indices.Dim()) == <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>());</div><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == src.NumRows());</div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;    cuda_sum_column_ranges(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">Dim</a>(), src.Data(),</div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;                           src.Dim(), indices.Data());</div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;  {</div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;    int32 num_rows = this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, num_cols = this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>,</div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;       this_stride = this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">stride_</a>, src_stride = src.stride_;</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;    Real *data = this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>;</div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;    <span class="keyword">const</span> Real *src_data = src.data_;</div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;    <span class="keyword">const</span> <a class="code" href="structInt32Pair.html">Int32Pair</a> *indices_data = indices.Data();</div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;    <span class="keywordflow">for</span> (int32 row = 0; row &lt; num_rows; row++) {</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;      <span class="keywordflow">for</span> (int32 col = 0; col &lt; num_cols; col++) {</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;        int32 start_col = indices_data[col].<a class="code" href="structInt32Pair.html#a9b288b26b67b6a87162a9e1ab5b35dbf">first</a>,</div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;                end_col = indices_data[col].<a class="code" href="structInt32Pair.html#a03a67f151bb1afcfcafab8870b75acff">second</a>;</div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;        Real sum = 0.0;</div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;        <span class="keywordflow">for</span> (int32 src_col = start_col; src_col &lt; end_col; src_col++)</div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;          sum += src_data[row * src_stride + src_col];</div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;        data[row * this_stride + col] = sum;</div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;      }</div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;    }</div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;  }</div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a7cb3ee02262893923716e6764439f359"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">kaldi::CuMatrixBase::stride_</a></div><div class="ttdeci">MatrixIndexT stride_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00730">cu-matrix.h:730</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a05174128bcd0c73d49c8ebdb7735aa94"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a05174128bcd0c73d49c8ebdb7735aa94">kaldi::CuMatrixBase::Dim</a></div><div class="ttdeci">::MatrixDim Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00220">cu-matrix.h:220</a></div></div>
<div class="ttc" id="structInt32Pair_html"><div class="ttname"><a href="structInt32Pair.html">Int32Pair</a></div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00084">cu-matrixdim.h:84</a></div></div>
<div class="ttc" id="structInt32Pair_html_a03a67f151bb1afcfcafab8870b75acff"><div class="ttname"><a href="structInt32Pair.html#a03a67f151bb1afcfcafab8870b75acff">Int32Pair::second</a></div><div class="ttdeci">int32_cuda second</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00086">cu-matrixdim.h:86</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="structInt32Pair_html_a9b288b26b67b6a87162a9e1ab5b35dbf"><div class="ttname"><a href="structInt32Pair.html#a9b288b26b67b6a87162a9e1ab5b35dbf">Int32Pair::first</a></div><div class="ttdeci">int32_cuda first</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00085">cu-matrixdim.h:85</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9b29a25c5f85d5a970594c2fcbb3c044"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b29a25c5f85d5a970594c2fcbb3c044">&#9670;&nbsp;</a></span>SymAddMat2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SymAddMat2 </td>
          <td>(</td>
          <td class="paramtype">const Real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>transA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>*this = beta * *this + alpha * M M^T, for symmetric matrices. </p>
<p>It only updates the lower triangle of *this. It will leave the matrix asymmetric; if you need it symmetric as a regular matrix, do <a class="el" href="classkaldi_1_1CuMatrixBase.html#ae71f2e6355f884d16edf9539e24adbb5">CopyLowerToUpper()</a>. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01340">1340</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8cc_source.html#l01971">CuMatrixBase&lt; float &gt;::Cholesky()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00896">kaldi::nnet3::ConstrainOrthonormalInternal()</a>, <a class="el" href="nnet-precondition_8cc_source.html#l00026">kaldi::nnet2::PreconditionDirections()</a>, <a class="el" href="nnet-precondition-online_8cc_source.html#l00184">OnlinePreconditioner::ReorthogonalizeXt1()</a>, <a class="el" href="natural-gradient-online_8cc_source.html#l00200">OnlineNaturalGradient::ReorthogonalizeXt1()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00286">kaldi::TestSymInvertPosDef()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l00112">kaldi::UnitTestCuCholesky()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01584">kaldi::UnitTestCuMatrixSymAddMat2()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l01614">kaldi::UnitTestCuMatrixSymInvertPosDef()</a>.</p>
<div class="fragment"><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;               {</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a> &amp;&amp;</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;               ((transA == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a> &amp;&amp; A.num_rows_ == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>) ||</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                (transA == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a> &amp;&amp; A.num_cols_ == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>)));</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(A.data_ != <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>);</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    CuTimer tim;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    cublasOperation_t trans = (transA == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a> ? CUBLAS_OP_N : CUBLAS_OP_T);</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> A_other_dim = (transA == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a> ? A.num_cols_ : A.num_rows_);</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    CUBLAS_SAFE_CALL(cublas_syrk(GetCublasHandle(), CUBLAS_FILL_MODE_UPPER,</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                                 trans, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, A_other_dim,</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                                 alpha, A.Data(), A.Stride(),</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                                 beta, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">stride_</a>));</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;  {</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().SymAddMat2(alpha, A.Mat(), transA, beta);</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;  }</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a7cb3ee02262893923716e6764439f359"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a7cb3ee02262893923716e6764439f359">kaldi::CuMatrixBase::stride_</a></div><div class="ttdeci">MatrixIndexT stride_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00730">cu-matrix.h:730</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00033">matrix-common.h:33</a></div></div>
<div class="ttc" id="namespacekaldi_html_aac2c220416519a2b0a7ad822ee2ef972"><div class="ttname"><a href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">kaldi::MatrixIndexT</a></div><div class="ttdeci">int32 MatrixIndexT</div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00098">matrix-common.h:98</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00034">matrix-common.h:34</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab7590e6a76e5d8757d361703ff47bbb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7590e6a76e5d8757d361703ff47bbb0">&#9670;&nbsp;</a></span>SymInvertPosDef()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SymInvertPosDef </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inversion for positive definite symmetric matrices. </p>
<p>Treats the input as symmetric but only reads the lower triangle. The output is symmetric. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02094">2094</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-sp-matrix_8cc_source.html#l00093">CuSpMatrix&lt; Real &gt;::Invert()</a>, <a class="el" href="nnet-precondition_8cc_source.html#l00026">kaldi::nnet2::PreconditionDirections()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="cu-matrix-speed-test_8cc_source.html#l00286">kaldi::TestSymInvertPosDef()</a>, <a class="el" href="cu-test_8cc_source.html#l00151">kaldi::UnitInvert()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l01614">kaldi::UnitTestCuMatrixSymInvertPosDef()</a>, and <a class="el" href="cu-test_8cc_source.html#l00185">kaldi::UnitTestInvert()</a>.</p>
<div class="fragment"><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;                                         {</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == <a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>);</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    CuMatrix&lt;Real&gt; inv_cholesky(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>);</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a22d93ed1d61d46b5b6f5eb27d3a748f5">Cholesky</a>(&amp;inv_cholesky);</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;    <span class="comment">// note: SymAddMat2 only updates lower part of *this.</span></div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;    this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a9b29a25c5f85d5a970594c2fcbb3c044">SymAddMat2</a>(1.0, inv_cholesky, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>, 0.0);</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;    this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#ae71f2e6355f884d16edf9539e24adbb5">CopyLowerToUpper</a>();</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;  {</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;    SpMatrix&lt;Real&gt; temp_sp(this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>(), <a class="code" href="namespacekaldi.html#a1e7deac168cc2b1002cc25ab544d0f90ab23bc41c203345e3a080b4f011f7aa40">kTakeLower</a>);</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;    TpMatrix&lt;Real&gt; C(temp_sp.NumRows(), <a class="code" href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kUndefined</a>);</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;    C.Cholesky(temp_sp);</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    C.Invert();</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;    temp_sp.AddTp2(1.0, C, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>, 0.0);</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().CopyFromSp(temp_sp);</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;    <span class="comment">// was previously just: CuSpMatrix::Invert().</span></div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;  }</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126"><div class="ttname"><a href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kaldi::kUndefined</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00039">matrix-common.h:39</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00033">matrix-common.h:33</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a9b29a25c5f85d5a970594c2fcbb3c044"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a9b29a25c5f85d5a970594c2fcbb3c044">kaldi::CuMatrixBase::SymAddMat2</a></div><div class="ttdeci">void SymAddMat2(const Real alpha, const CuMatrixBase&lt; Real &gt; &amp;M, MatrixTransposeType transA, Real beta)</div><div class="ttdoc">*this = beta * *this + alpha * M M^T, for symmetric matrices. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l01340">cu-matrix.cc:1340</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a22d93ed1d61d46b5b6f5eb27d3a748f5"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a22d93ed1d61d46b5b6f5eb27d3a748f5">kaldi::CuMatrixBase::Cholesky</a></div><div class="ttdeci">void Cholesky(CuMatrixBase&lt; Real &gt; *inv_cholesky=NULL)</div><div class="ttdoc">This function does sets *this to the Cholesky factor of *this (i.e. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l01971">cu-matrix.cc:1971</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ae71f2e6355f884d16edf9539e24adbb5"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ae71f2e6355f884d16edf9539e24adbb5">kaldi::CuMatrixBase::CopyLowerToUpper</a></div><div class="ttdeci">void CopyLowerToUpper()</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l02936">cu-matrix.cc:2936</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="namespacekaldi_html_a1e7deac168cc2b1002cc25ab544d0f90ab23bc41c203345e3a080b4f011f7aa40"><div class="ttname"><a href="namespacekaldi.html#a1e7deac168cc2b1002cc25ab544d0f90ab23bc41c203345e3a080b4f011f7aa40">kaldi::kTakeLower</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00050">matrix-common.h:50</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac21c2992057adbce518977e8131d3e3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac21c2992057adbce518977e8131d3e3f">&#9670;&nbsp;</a></span>Tanh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Tanh </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>src</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the hyperbolic tangent (tanh) function; element by element, *this = tanh(src). </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l01770">1770</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="_2nnet-component_8cc_source.html#l00650">TanhComponent::Propagate()</a>, <a class="el" href="nnet-activation_8h_source.html#l00252">Tanh::PropagateFnc()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, and <a class="el" href="cu-matrix-test_8cc_source.html#l02570">kaldi::UnitTestCuTanh()</a>.</p>
<div class="fragment"><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;                                                           {</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">SameDim</a>(*<span class="keyword">this</span>, src));</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    CuTimer tim;</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    dim3 dimGrid, dimBlock;</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    GetBlockSizesForSimpleMatrixOperation(<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>(), <a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(),</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;                                          &amp;dimGrid, &amp;dimBlock);</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    cuda_tanh(dimGrid, dimBlock, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, src.data_, this-&gt;Dim(), src.Stride());</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;  {</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().Tanh(src.Mat());</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;  }</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="group__matrix__funcs__io_html_ga07b147212efb08775c252cd4cc7453fe"><div class="ttname"><a href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">kaldi::SameDim</a></div><div class="ttdeci">bool SameDim(const MatrixBase&lt; Real &gt; &amp;M, const MatrixBase&lt; Real &gt; &amp;N)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l01065">kaldi-matrix.h:1065</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4c7007b65327e6c20f96b576c3725881"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c7007b65327e6c20f96b576c3725881">&#9670;&nbsp;</a></span>Trace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Real Trace </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>check_square</em> = <code>true</code></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the trace. If check_square = true, will crash if matrix is not square. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l03042">3042</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-utils_8cc_source.html#l00896">kaldi::nnet3::ConstrainOrthonormalInternal()</a>, <a class="el" href="cu-vector-test_8cc_source.html#l00452">kaldi::CuVectorUnitTestCopyDiagFromMat()</a>, and <a class="el" href="cu-matrix_8h_source.html#l00633">CuMatrixBase&lt; float &gt;::operator()()</a>.</p>
<div class="fragment"><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;                                                      {</div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;    CuTimer tim;</div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;    <span class="keywordflow">if</span> (check_square) <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a> == this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>);</div><div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;    <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> dim = std::min(this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>);</div><div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;    CuVector&lt;Real&gt; tmp(1, <a class="code" href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kUndefined</a>); <span class="comment">// for result.</span></div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;    <span class="keywordtype">int</span> dimBlock(<a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a>);</div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;    <span class="keywordtype">int</span> dimGrid = 1;<span class="comment">// only 1 block here. we have loops in each thread  //(n_blocks(dim_, CU1DBLOCK));</span></div><div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;    cuda_vec_sum(dimGrid, dimBlock, <a class="code" href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">data_</a>, tmp.Data(), dim, <a class="code" href="classkaldi_1_1CuMatrixBase.html#a180e10f97fa838f9c1ae125ba164dd77">Stride</a>() + 1);</div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;    CuDevice::Instantiate().AccuProfile(<span class="stringliteral">&quot;CuVectorBase::Sum&quot;</span>, tim);</div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;    <span class="keywordflow">return</span> tmp(0);</div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;  {</div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>().Trace(check_square);</div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;  }</div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a180e10f97fa838f9c1ae125ba164dd77"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a180e10f97fa838f9c1ae125ba164dd77">kaldi::CuMatrixBase::Stride</a></div><div class="ttdeci">MatrixIndexT Stride() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00216">cu-matrix.h:216</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126"><div class="ttname"><a href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kaldi::kUndefined</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00039">matrix-common.h:39</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac2f903c4d28be2d76febeb70c49bbd0b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac2f903c4d28be2d76febeb70c49bbd0b">kaldi::CuMatrixBase::data_</a></div><div class="ttdeci">Real * data_</div><div class="ttdoc">GPU data pointer (or regular matrix data pointer,. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00720">cu-matrix.h:720</a></div></div>
<div class="ttc" id="namespacekaldi_html_aac2c220416519a2b0a7ad822ee2ef972"><div class="ttname"><a href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">kaldi::MatrixIndexT</a></div><div class="ttdeci">int32 MatrixIndexT</div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00098">matrix-common.h:98</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a6dbdf9d0385c92d6d915b96eaf9ce99e"><div class="ttname"><a href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a></div><div class="ttdeci">#define CU1DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00063">cu-matrixdim.h:63</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a68f354fd5f096134162f01719096e6fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68f354fd5f096134162f01719096e6fc">&#9670;&nbsp;</a></span>Write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Write </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>binary</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l00469">469</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8h_source.html#l00633">CuMatrixBase&lt; float &gt;::operator()()</a>, <a class="el" href="cu-matrix-test_8cc_source.html#l02112">kaldi::UnitTestCuMatrixIO()</a>, and <a class="el" href="nnet-attention-component_8cc_source.html#l00441">RestrictedAttentionComponent::Write()</a>.</p>
<div class="fragment"><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                                                                {</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  Matrix&lt;Real&gt; temp(this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">num_rows_</a>, this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">num_cols_</a>, <a class="code" href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kUndefined</a>);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  this-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#ae67f2eab6adb41c8851873ac493d7f37">CopyToMat</a>(&amp;temp);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  temp.Write(os, binary);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;}</div><div class="ttc" id="namespacekaldi_html_ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126"><div class="ttname"><a href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kaldi::kUndefined</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00039">matrix-common.h:39</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ae67f2eab6adb41c8851873ac493d7f37"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ae67f2eab6adb41c8851873ac493d7f37">kaldi::CuMatrixBase::CopyToMat</a></div><div class="ttdeci">void CopyToMat(MatrixBase&lt; OtherReal &gt; *dst, MatrixTransposeType trans=kNoTrans) const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l00415">cu-matrix.cc:415</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a450082748d9b4882d1ce074d1af59a17"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a450082748d9b4882d1ce074d1af59a17">kaldi::CuMatrixBase::num_cols_</a></div><div class="ttdeci">MatrixIndexT num_cols_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00728">cu-matrix.h:728</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a67d96c77dd3e450528faf1755002e42b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a67d96c77dd3e450528faf1755002e42b">kaldi::CuMatrixBase::num_rows_</a></div><div class="ttdeci">MatrixIndexT num_rows_</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00729">cu-matrix.h:729</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a id="aa02376f1de9d497e87b756fe5af8a315"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa02376f1de9d497e87b756fe5af8a315">&#9670;&nbsp;</a></span>AddMatMatBatched</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void AddMatMatBatched </td>
          <td>(</td>
          <td class="paramtype">const Real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classkaldi_1_1CuSubMatrix.html">CuSubMatrix</a>&lt; Real &gt; * &gt; &amp;&#160;</td>
          <td class="paramname"><em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classkaldi_1_1CuSubMatrix.html">CuSubMatrix</a>&lt; Real &gt; * &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>transA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classkaldi_1_1CuSubMatrix.html">CuSubMatrix</a>&lt; Real &gt; * &gt; &amp;&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>transB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Real&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Does multiple matrix multiplications, executing them in parallel using cuBLAS's gemmBatched if we are using a GPU. </p>
<p>Vectors A, B and C must have the same length; for each i, this function executes the matrix operation C[i] = alpha * A[i](^T)*B[i](^T) + beta * C[i]. </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02190">2190</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;                                                                   {</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(A.size() == B.size() &amp;&amp; B.size() == C.size());</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;  int32 size = A.size();</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;  <span class="keywordflow">if</span> (size == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;  <span class="comment">// all elements must have the same num-rows, num-cols and stride</span></div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;  <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1 &lt; size; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(A[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == A[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>+1]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>());</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(A[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>() == A[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>+1]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>());</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(A[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a180e10f97fa838f9c1ae125ba164dd77">Stride</a>() == A[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>+1]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a180e10f97fa838f9c1ae125ba164dd77">Stride</a>());</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(B[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == B[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>+1]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>());</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(B[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>() == B[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>+1]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>());</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(B[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a180e10f97fa838f9c1ae125ba164dd77">Stride</a>() == B[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>+1]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a180e10f97fa838f9c1ae125ba164dd77">Stride</a>());</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(C[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == C[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>+1]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>());</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(C[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>() == C[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>+1]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>());</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(C[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a180e10f97fa838f9c1ae125ba164dd77">Stride</a>() == C[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>+1]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a180e10f97fa838f9c1ae125ba164dd77">Stride</a>());</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;  }</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;  <span class="comment">// CUBLAS is col-major, cudamatrix is row-major, how to do the mapping?</span></div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;  <span class="comment">// keep trans..., just swap A&amp;B matrices: A-&gt;B B-&gt;A</span></div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;  <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> m = ((transB==<a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>)? B[0]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() : B[0]-&gt;NumCols());</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;  <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> <a class="code" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">n</a> = ((transA==<a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>)? A[0]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>() : A[0]-&gt;NumRows());</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;  <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> k = ((transB==<a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>)? B[0]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>() : B[0]-&gt;NumRows());</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;  <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> k1 = ((transA==<a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>)? A[0]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() : A[0]-&gt;NumCols());</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(m == C[0]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>());</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(n == C[0]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>());</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(k == k1);</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;  <span class="keywordflow">if</span> (m == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;    Real **device_abc_array =</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;        <span class="keyword">static_cast&lt;</span>Real**<span class="keyword">&gt;</span>(CuDevice::Instantiate().Malloc(3 * size * <span class="keyword">sizeof</span>(Real*)));</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;    <span class="keyword">const</span> Real **device_a_array = <span class="keyword">const_cast&lt;</span><span class="keyword">const </span>Real**<span class="keyword">&gt;</span>(device_abc_array);</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;    <span class="keyword">const</span> Real **device_b_array = <span class="keyword">const_cast&lt;</span><span class="keyword">const </span>Real**<span class="keyword">&gt;</span>(device_abc_array) + size;</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;    Real **device_c_array = device_abc_array + 2 * size;</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;    <span class="keyword">const</span> Real **host_abc_array = <span class="keyword">new</span> <span class="keyword">const</span> Real*[3*size];</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;    <span class="keyword">const</span> Real **host_a_array = host_abc_array;</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;    <span class="keyword">const</span> Real **host_b_array = host_abc_array + size;</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;    <span class="keyword">const</span> Real **host_c_array = host_abc_array + 2 * size;</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;    <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; size; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;      host_a_array[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] = A[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;data_;</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;      host_b_array[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] = B[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;data_;</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;      host_c_array[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] = C[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;data_;</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;    }</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;    CU_SAFE_CALL(cudaMemcpy(device_abc_array, host_abc_array, 3*size*<span class="keyword">sizeof</span>(Real*), cudaMemcpyHostToDevice));</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    CUBLAS_SAFE_CALL(cublas_gemmBatched(GetCublasHandle(),</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;                                        (transB==<a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>? CUBLAS_OP_T:CUBLAS_OP_N),</div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;                                        (transA==<a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>? CUBLAS_OP_T:CUBLAS_OP_N),</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;                                        m, n, k, alpha, device_b_array,</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;                                        B[0]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a180e10f97fa838f9c1ae125ba164dd77">Stride</a>(), device_a_array,</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;                                        A[0]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a180e10f97fa838f9c1ae125ba164dd77">Stride</a>(), beta, device_c_array,</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;                                        C[0]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a180e10f97fa838f9c1ae125ba164dd77">Stride</a>(), size));</div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;</div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    CuDevice::Instantiate().Free(device_abc_array);</div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    <span class="keyword">delete</span>[] host_abc_array;</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;  {</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;    <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; size; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;      C[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;Mat().AddMatMat(alpha, A[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>(), transA, B[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">Mat</a>(), transB, beta);</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;    }</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;  }</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a1ae27d8d38f2a7651c76b4f102867dee"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a1ae27d8d38f2a7651c76b4f102867dee">kaldi::CuMatrixBase::Mat</a></div><div class="ttdeci">const MatrixBase&lt; Real &gt; &amp; Mat() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00698">cu-matrix.h:698</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a180e10f97fa838f9c1ae125ba164dd77"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a180e10f97fa838f9c1ae125ba164dd77">kaldi::CuMatrixBase::Stride</a></div><div class="ttdeci">MatrixIndexT Stride() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00216">cu-matrix.h:216</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00033">matrix-common.h:33</a></div></div>
<div class="ttc" id="namespacekaldi_html_aac2c220416519a2b0a7ad822ee2ef972"><div class="ttname"><a href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">kaldi::MatrixIndexT</a></div><div class="ttdeci">int32 MatrixIndexT</div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00098">matrix-common.h:98</a></div></div>
<div class="ttc" id="namespacernnlm_html_ab4871778d570f724a07823e0a2fb9884"><div class="ttname"><a href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@11::@12 n</div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a55ada0f1e6790e16880aa0058c5b0145"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55ada0f1e6790e16880aa0058c5b0145">&#9670;&nbsp;</a></span>CuBlockMatrix< Real ></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classkaldi_1_1CuBlockMatrix.html">CuBlockMatrix</a>&lt; Real &gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00092">92</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

</div>
</div>
<a id="ae917fa9b12583d4279496c32782ad8a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae917fa9b12583d4279496c32782ad8a6">&#9670;&nbsp;</a></span>CuMatrixBase< double ></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; double &gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00081">81</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

</div>
</div>
<a id="a1bf318054a935deec9c192109580dd58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bf318054a935deec9c192109580dd58">&#9670;&nbsp;</a></span>CuMatrixBase< float ></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="classfloat.html">float</a> &gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00080">80</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

</div>
</div>
<a id="acf5339e82134d0ac259966e0f0f67ab9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf5339e82134d0ac259966e0f0f67ab9">&#9670;&nbsp;</a></span>CuRand< Real ></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classkaldi_1_1CuRand.html">CuRand</a>&lt; Real &gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00090">90</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

</div>
</div>
<a id="aa3a3bfb0bbb0a225871e391ee3ec8ac3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3a3bfb0bbb0a225871e391ee3ec8ac3">&#9670;&nbsp;</a></span>CuSparseMatrix< double ></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classkaldi_1_1CuSparseMatrix.html">CuSparseMatrix</a>&lt; double &gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00094">94</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

</div>
</div>
<a id="ab554e7a1d4f5edfc8a0132ed5dbe7903"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab554e7a1d4f5edfc8a0132ed5dbe7903">&#9670;&nbsp;</a></span>CuSparseMatrix< float ></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classkaldi_1_1CuSparseMatrix.html">CuSparseMatrix</a>&lt; <a class="el" href="classfloat.html">float</a> &gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00093">93</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

</div>
</div>
<a id="aafe563db9faef3e8ee4d7a830e8b32b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafe563db9faef3e8ee4d7a830e8b32b4">&#9670;&nbsp;</a></span>CuSparseMatrix< Real ></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classkaldi_1_1CuSparseMatrix.html">CuSparseMatrix</a>&lt; Real &gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00095">95</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

</div>
</div>
<a id="a5bacd18e4e259c776cc1bc2b6a94e21e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5bacd18e4e259c776cc1bc2b6a94e21e">&#9670;&nbsp;</a></span>CuSpMatrix< Real ></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classkaldi_1_1CuSpMatrix.html">CuSpMatrix</a>&lt; Real &gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00085">85</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

</div>
</div>
<a id="ac85bb7380dfaafef6fc9b91b508756e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac85bb7380dfaafef6fc9b91b508756e0">&#9670;&nbsp;</a></span>CuSubMatrix< Real ></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classkaldi_1_1CuSubMatrix.html">CuSubMatrix</a>&lt; Real &gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00089">89</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

</div>
</div>
<a id="a4ccc176ff1e8f53ca4ff702f2c6e8064"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ccc176ff1e8f53ca4ff702f2c6e8064">&#9670;&nbsp;</a></span>CuSubVector< Real ></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classkaldi_1_1CuSubVector.html">CuSubVector</a>&lt; Real &gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00091">91</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

</div>
</div>
<a id="aa090cca3755862c6cc08f338f49bb7d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa090cca3755862c6cc08f338f49bb7d0">&#9670;&nbsp;</a></span>CuTpMatrix< double ></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classkaldi_1_1CuTpMatrix.html">CuTpMatrix</a>&lt; double &gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00087">87</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

</div>
</div>
<a id="a9f44971f4ba5f51965bd7f7365571699"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f44971f4ba5f51965bd7f7365571699">&#9670;&nbsp;</a></span>CuTpMatrix< float ></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classkaldi_1_1CuTpMatrix.html">CuTpMatrix</a>&lt; <a class="el" href="classfloat.html">float</a> &gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00086">86</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

</div>
</div>
<a id="a79628e1864f029ca5e7bff6f90c51ac2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79628e1864f029ca5e7bff6f90c51ac2">&#9670;&nbsp;</a></span>CuVectorBase< double ></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; double &gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00083">83</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

</div>
</div>
<a id="ac2a7950adac175fe23c5e9212dc0897d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2a7950adac175fe23c5e9212dc0897d">&#9670;&nbsp;</a></span>CuVectorBase< float ></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; <a class="el" href="classfloat.html">float</a> &gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00082">82</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

</div>
</div>
<a id="abea3cd763f21985be450c62ad5877540"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abea3cd763f21985be450c62ad5877540">&#9670;&nbsp;</a></span>CuVectorBase< Real ></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classkaldi_1_1CuVectorBase.html">CuVectorBase</a>&lt; Real &gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00088">88</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

</div>
</div>
<a id="a66bed104430bbbde5005c244cf0387f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66bed104430bbbde5005c244cf0387f7">&#9670;&nbsp;</a></span>TraceMatMat</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real TraceMatMat </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>trans</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8cc_source.html#l02128">2128</a> of file <a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8h_source.html#l00225">CuMatrixBase&lt; float &gt;::FrobeniusNorm()</a>.</p>
<div class="fragment"><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;                                            {</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;  <span class="keywordflow">if</span> (A.num_rows_ == 0) {</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(B.num_rows_ == 0);</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;    <span class="keywordflow">return</span> 0.0;</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;  }</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;  Real result = 0;</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    <span class="keywordflow">if</span> (trans == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>) {</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(A.NumRows() == B.NumCols() &amp;&amp; A.NumCols() == B.NumRows());</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(A.NumRows() == B.NumRows() &amp;&amp; A.NumCols() == B.NumCols());</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;    }</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;    CuTimer tim;</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;    <span class="comment">// 2D blocks: each (8x32) block sums up (32x32) elements.</span></div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;    <span class="comment">// 2D grid: try to cover all the matrix A unless it is too big.</span></div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;    <span class="comment">// Kernel will reduce to ~256 elements with good performance,</span></div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    <span class="comment">// if the matrix is not in a very bad shape.</span></div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    <span class="comment">// (wider or taller than 32x8192)</span></div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    <span class="comment">// CPU will then reduce to 1 element.</span></div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> kWarpSize = 32;</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;    dim3 dimBlock(kWarpSize, <a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a> / kWarpSize);</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;    dim3 dimGrid(n_blocks(A.NumCols(), kWarpSize),</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;        n_blocks(A.NumRows(), kWarpSize));</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    <span class="keywordflow">if</span> (dimGrid.x * dimGrid.y &gt; 256) {</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;      dimGrid.y = 256 / dimGrid.x;</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;      <span class="keywordflow">if</span> (dimGrid.y == 0) {</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;        dimGrid.y = 1;</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;      }</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    }</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    CuVector&lt;Real&gt; result_vec(dimGrid.x * dimGrid.y, <a class="code" href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kUndefined</a>);</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    <span class="keywordflow">if</span> (trans == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>) {</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;      cuda_trace_mat_mat(dimGrid, dimBlock, A.Data(), B.Data(), A.Dim(),</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;          B.Stride(), result_vec.Data());</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;      cuda_trace_mat_mat_trans(dimGrid, dimBlock, A.Data(), B.Data(), A.Dim(),</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;          B.Stride(), result_vec.Data());</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    }</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    CU_SAFE_CALL(cudaGetLastError());</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    Vector&lt;Real&gt; result_cpu(result_vec); <span class="comment">// copying from CUDA faster than summing in CUDA.</span></div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;    result = result_cpu.Sum();</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;  {</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    result = <a class="code" href="classkaldi_1_1CuMatrixBase.html#a66bed104430bbbde5005c244cf0387f7">TraceMatMat</a>(A.Mat(), B.Mat(), trans);</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;  }</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;  <span class="keywordflow">return</span> result;</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;}</div><div class="ttc" id="namespacekaldi_html_ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126"><div class="ttname"><a href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kaldi::kUndefined</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00039">matrix-common.h:39</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a6dbdf9d0385c92d6d915b96eaf9ce99e"><div class="ttname"><a href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a></div><div class="ttdeci">#define CU1DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00063">cu-matrixdim.h:63</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00034">matrix-common.h:34</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a66bed104430bbbde5005c244cf0387f7"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a66bed104430bbbde5005c244cf0387f7">kaldi::CuMatrixBase::TraceMatMat</a></div><div class="ttdeci">friend Real TraceMatMat(const CuMatrixBase&lt; Real &gt; &amp;A, const CuMatrixBase&lt; Real &gt; &amp;B, MatrixTransposeType trans)</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l02128">cu-matrix.cc:2128</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0cb54da2ae21c43f23b18486b608e73e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cb54da2ae21c43f23b18486b608e73e">&#9670;&nbsp;</a></span>TraceMatSmat</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real TraceMatSmat </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuSparseMatrix.html">CuSparseMatrix</a>&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724f">MatrixTransposeType</a>&#160;</td>
          <td class="paramname"><em>trans</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-sparse-matrix_8cc_source.html#l00524">524</a> of file <a class="el" href="cu-sparse-matrix_8cc_source.html">cu-sparse-matrix.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                                             {</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="keywordflow">if</span> (A.NumCols() == 0) {</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(B.NumCols() == 0);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">return</span> 0.0;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  }</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="keywordflow">if</span> (B.NumElements() == 0) {</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">return</span> 0.0;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  }</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  Real result = 0;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="preprocessor">#if HAVE_CUDA == 1</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="keywordflow">if</span> (CuDevice::Instantiate().Enabled()) {</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordflow">if</span> (trans == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>) {</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(A.NumRows() == B.NumRows() &amp;&amp; A.NumCols() == B.NumCols());</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(A.NumCols() == B.NumRows() &amp;&amp; A.NumRows() == B.NumCols());</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    }</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="comment">// The Sum() method in CuVector handles a bunch of logic, we use that to</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="comment">// comptue the trace.</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    CuVector&lt;Real&gt; sum_vec(B.NumElements());</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    CuTimer tim;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="comment">// We use warpSize threads per row to access only the nnz elements.</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="comment">// Every CU1DBLOCK/warpSize rows share one thread block.</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="comment">// 1D grid to cover all rows of B.</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> warpSize = 32;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    dim3 dimBlock(warpSize, <a class="code" href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a> / warpSize);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    dim3 dimGrid(n_blocks(B.NumRows(), dimBlock.y));</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordflow">if</span> (trans == <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>) {</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      cuda_trace_mat_smat(dimGrid, dimBlock, A.Data(), A.Dim(), B.CsrRowPtr(),</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                          B.CsrColIdx(), B.CsrVal(), sum_vec.Data());</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      cuda_trace_mat_smat_trans(dimGrid, dimBlock, A.Data(), A.Dim(),</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                                B.CsrRowPtr(), B.CsrColIdx(), B.CsrVal(),</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                                sum_vec.Data());</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    }</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    result = sum_vec.Sum();</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    CuDevice::Instantiate().AccuProfile(__func__, tim);</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  {</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    result = <a class="code" href="classkaldi_1_1CuMatrixBase.html#a0cb54da2ae21c43f23b18486b608e73e">TraceMatSmat</a>(A.Mat(), B.Smat(), trans);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  }</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;}</div><div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00033">matrix-common.h:33</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a0cb54da2ae21c43f23b18486b608e73e"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a0cb54da2ae21c43f23b18486b608e73e">kaldi::CuMatrixBase::TraceMatSmat</a></div><div class="ttdeci">friend Real TraceMatSmat(const CuMatrixBase&lt; Real &gt; &amp;A, const CuSparseMatrix&lt; Real &gt; &amp;B, MatrixTransposeType trans)</div><div class="ttdef"><b>Definition:</b> <a href="cu-sparse-matrix_8cc_source.html#l00524">cu-sparse-matrix.cc:524</a></div></div>
<div class="ttc" id="cu-matrixdim_8h_html_a6dbdf9d0385c92d6d915b96eaf9ce99e"><div class="ttname"><a href="cu-matrixdim_8h.html#a6dbdf9d0385c92d6d915b96eaf9ce99e">CU1DBLOCK</a></div><div class="ttdeci">#define CU1DBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrixdim_8h_source.html#l00063">cu-matrixdim.h:63</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00034">matrix-common.h:34</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a81e2ad38d9196b98a379223e4383572d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81e2ad38d9196b98a379223e4383572d">&#9670;&nbsp;</a></span>VectorBase< Real ></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a>&lt; Real &gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00084">84</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ac2f903c4d28be2d76febeb70c49bbd0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2f903c4d28be2d76febeb70c49bbd0b">&#9670;&nbsp;</a></span>data_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real* data_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>GPU data pointer (or regular matrix data pointer,. </p>
<p>if either CUDA was not compiled in or we could not acquire the device). </p>

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00720">720</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8cc_source.html#l00941">CuMatrixBase&lt; float &gt;::AddMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01106">CuMatrixBase&lt; float &gt;::AddMatBlocks()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01278">CuMatrixBase&lt; float &gt;::AddMatMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02190">kaldi::AddMatMatBatched()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02898">CuMatrixBase&lt; float &gt;::AddRowRanges()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01724">CuMatrixBase&lt; float &gt;::ApplyLogSoftMaxPerRow()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01701">CuMatrixBase&lt; float &gt;::ApplySoftMaxPerRow()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00207">CuMatrixBase&lt; float &gt;::CopyFromMat()</a>, <a class="el" href="cu-matrix-inl_8h_source.html#l00028">CuSubMatrix&lt; Real &gt;::CuSubMatrix()</a>, <a class="el" href="cu-matrix_8h_source.html#l00689">CuMatrixBase&lt; float &gt;::Data()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01488">CuMatrixBase&lt; float &gt;::DiffParametricRelu()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01748">CuMatrixBase&lt; float &gt;::DiffSigmoid()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01793">CuMatrixBase&lt; float &gt;::DiffTanh()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00678">CuMatrixBase&lt; float &gt;::DivElements()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01604">CuMatrixBase&lt; float &gt;::GroupMax()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01563">CuMatrixBase&lt; float &gt;::GroupPnorm()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02463">CuMatrixBase&lt; float &gt;::Heaviside()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00702">CuMatrixBase&lt; float &gt;::Max()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00727">CuMatrixBase&lt; float &gt;::Min()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00654">CuMatrixBase&lt; float &gt;::MulElements()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00803">CuMatrixBase&lt; float &gt;::MulRowsGroupMat()</a>, <a class="el" href="cu-matrix_8h_source.html#l00625">CuMatrixBase&lt; float &gt;::operator()()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01454">CuMatrixBase&lt; float &gt;::ParametricRelu()</a>, <a class="el" href="cu-matrix_8h_source.html#l00613">CuMatrixBase&lt; float &gt;::Row()</a>, <a class="el" href="cu-matrix_8h_source.html#l00683">CuMatrixBase&lt; float &gt;::RowData()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01193">CuMatrixBase&lt; float &gt;::SetMatMatDivMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01521">CuMatrixBase&lt; float &gt;::Sigmoid()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01542">CuMatrixBase&lt; float &gt;::SoftHinge()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02860">CuMatrixBase&lt; float &gt;::SumColumnRanges()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00113">CuMatrix&lt; float &gt;::Swap()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01340">CuMatrixBase&lt; float &gt;::SymAddMat2()</a>, and <a class="el" href="cu-matrix_8cc_source.html#l01770">CuMatrixBase&lt; float &gt;::Tanh()</a>.</p>

</div>
</div>
<a id="a450082748d9b4882d1ce074d1af59a17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a450082748d9b4882d1ce074d1af59a17">&#9670;&nbsp;</a></span>num_cols_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> num_cols_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00728">728</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix-inl_8h_source.html#l00028">CuSubMatrix&lt; Real &gt;::CuSubMatrix()</a>, <a class="el" href="cu-matrix_8h_source.html#l00220">CuMatrixBase&lt; float &gt;::Dim()</a>, <a class="el" href="cu-matrix_8h_source.html#l00215">CuMatrixBase&lt; float &gt;::NumCols()</a>, <a class="el" href="cu-matrix_8h_source.html#l00625">CuMatrixBase&lt; float &gt;::operator()()</a>, <a class="el" href="cu-matrix_8h_source.html#l00603">CuMatrixBase&lt; float &gt;::RowRange()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01193">CuMatrixBase&lt; float &gt;::SetMatMatDivMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00113">CuMatrix&lt; float &gt;::Swap()</a>, and <a class="el" href="cu-matrix_8cc_source.html#l01340">CuMatrixBase&lt; float &gt;::SymAddMat2()</a>.</p>

</div>
</div>
<a id="a67d96c77dd3e450528faf1755002e42b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67d96c77dd3e450528faf1755002e42b">&#9670;&nbsp;</a></span>num_rows_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> num_rows_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00729">729</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8cc_source.html#l01724">CuMatrixBase&lt; float &gt;::ApplyLogSoftMaxPerRow()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01701">CuMatrixBase&lt; float &gt;::ApplySoftMaxPerRow()</a>, <a class="el" href="cu-matrix_8h_source.html#l00608">CuMatrixBase&lt; float &gt;::ColRange()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00207">CuMatrixBase&lt; float &gt;::CopyFromMat()</a>, <a class="el" href="cu-matrix-inl_8h_source.html#l00028">CuSubMatrix&lt; Real &gt;::CuSubMatrix()</a>, <a class="el" href="cu-matrix_8h_source.html#l00220">CuMatrixBase&lt; float &gt;::Dim()</a>, <a class="el" href="cu-matrix_8h_source.html#l00214">CuMatrixBase&lt; float &gt;::NumRows()</a>, <a class="el" href="cu-matrix_8h_source.html#l00625">CuMatrixBase&lt; float &gt;::operator()()</a>, <a class="el" href="cu-matrix_8h_source.html#l00613">CuMatrixBase&lt; float &gt;::Row()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01193">CuMatrixBase&lt; float &gt;::SetMatMatDivMat()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00113">CuMatrix&lt; float &gt;::Swap()</a>, <a class="el" href="cu-matrix_8cc_source.html#l01340">CuMatrixBase&lt; float &gt;::SymAddMat2()</a>, and <a class="el" href="cu-matrix_8cc_source.html#l02128">kaldi::TraceMatMat()</a>.</p>

</div>
</div>
<a id="a7cb3ee02262893923716e6764439f359"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cb3ee02262893923716e6764439f359">&#9670;&nbsp;</a></span>stride_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> stride_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cu-matrix_8h_source.html#l00730">730</a> of file <a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="cu-matrix_8cc_source.html#l02898">CuMatrixBase&lt; float &gt;::AddRowRanges()</a>, <a class="el" href="cu-matrix-inl_8h_source.html#l00028">CuSubMatrix&lt; Real &gt;::CuSubMatrix()</a>, <a class="el" href="cu-matrix_8h_source.html#l00220">CuMatrixBase&lt; float &gt;::Dim()</a>, <a class="el" href="cu-matrix_8h_source.html#l00625">CuMatrixBase&lt; float &gt;::operator()()</a>, <a class="el" href="cu-matrix_8h_source.html#l00613">CuMatrixBase&lt; float &gt;::Row()</a>, <a class="el" href="cu-matrix_8h_source.html#l00683">CuMatrixBase&lt; float &gt;::RowData()</a>, <a class="el" href="cu-matrix_8h_source.html#l00233">CuMatrixBase&lt; float &gt;::SizeInBytes()</a>, <a class="el" href="cu-matrix_8h_source.html#l00216">CuMatrixBase&lt; float &gt;::Stride()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02860">CuMatrixBase&lt; float &gt;::SumColumnRanges()</a>, and <a class="el" href="cu-matrix_8cc_source.html#l00113">CuMatrix&lt; float &gt;::Swap()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>matrix/<a class="el" href="matrix-common_8h_source.html">matrix-common.h</a></li>
<li>cudamatrix/<a class="el" href="cu-matrix_8h_source.html">cu-matrix.h</a></li>
<li>cudamatrix/<a class="el" href="cu-matrix_8cc_source.html">cu-matrix.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacekaldi.html">kaldi</a></li><li class="navelem"><a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
