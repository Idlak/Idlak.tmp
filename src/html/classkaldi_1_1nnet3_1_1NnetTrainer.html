<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Kaldi: NnetTrainer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" /> 
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
 <td id="projectlogo"><a href="http://kaldi-asr.org/"><img alt="Logo" src="KaldiTextAndLogoSmall.png"/ style="padding: 3px 5px 1px 5px"></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname" style="display:none">Kaldi
   </div>
  </td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief" style="display:none"></div>
    </td>
   <!--END PROJECT_BRIEF-->
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classkaldi_1_1nnet3_1_1NnetTrainer.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classkaldi_1_1nnet3_1_1NnetTrainer-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">NnetTrainer Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This class is for single-threaded training of neural nets using standard objective functions such as cross-entropy (implemented with logsoftmax nonlinearity and a linear objective function) and quadratic loss.  
 <a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="nnet-training_8h_source.html">nnet-training.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for NnetTrainer:</div>
<div class="dyncontent">
<div class="center"><img src="classkaldi_1_1nnet3_1_1NnetTrainer__coll__graph.png" border="0" usemap="#NnetTrainer_coll__map" alt="Collaboration graph"/></div>
<map name="NnetTrainer_coll__map" id="NnetTrainer_coll__map">
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1d0f95070c4d8a7a24351463507b5dc2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a1d0f95070c4d8a7a24351463507b5dc2">NnetTrainer</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html">NnetTrainerOptions</a> &amp;config, <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> *nnet)</td></tr>
<tr class="separator:a1d0f95070c4d8a7a24351463507b5dc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a987bc9ce40e66b7efc8b4321eedc8ded"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a987bc9ce40e66b7efc8b4321eedc8ded">Train</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &amp;eg)</td></tr>
<tr class="separator:a987bc9ce40e66b7efc8b4321eedc8ded"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad57a45f61541b7b94999b984a3c43439"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ad57a45f61541b7b94999b984a3c43439">PrintTotalStats</a> () const</td></tr>
<tr class="separator:ad57a45f61541b7b94999b984a3c43439"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eb417b84053d9c0352207e9a5206efe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a7eb417b84053d9c0352207e9a5206efe">PrintMaxChangeStats</a> () const</td></tr>
<tr class="separator:a7eb417b84053d9c0352207e9a5206efe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5c0d9a92b9c3873022401a5fb69013e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#af5c0d9a92b9c3873022401a5fb69013e">~NnetTrainer</a> ()</td></tr>
<tr class="separator:af5c0d9a92b9c3873022401a5fb69013e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a2dd3350275a8d44250b93d6e1f06c186"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a2dd3350275a8d44250b93d6e1f06c186">TrainInternal</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &amp;eg, const <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> &amp;computation)</td></tr>
<tr class="separator:a2dd3350275a8d44250b93d6e1f06c186"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5672aa8ecefb855b96d43521adfe23f9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a5672aa8ecefb855b96d43521adfe23f9">TrainInternalBackstitch</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &amp;eg, const <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> &amp;computation, <a class="el" href="classbool.html">bool</a> is_backstitch_step1)</td></tr>
<tr class="separator:a5672aa8ecefb855b96d43521adfe23f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a150ac242bbed448bc9a90d6df485023e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a150ac242bbed448bc9a90d6df485023e">ProcessOutputs</a> (<a class="el" href="classbool.html">bool</a> is_backstitch_step2, const <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &amp;eg, <a class="el" href="classkaldi_1_1nnet3_1_1NnetComputer.html">NnetComputer</a> *computer)</td></tr>
<tr class="separator:a150ac242bbed448bc9a90d6df485023e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a70dbc9bfde10a7aa389b8a8114e41e74"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html">NnetTrainerOptions</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a></td></tr>
<tr class="separator:a70dbc9bfde10a7aa389b8a8114e41e74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6b2732bea7ce47719f18ad2b06d81d2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a></td></tr>
<tr class="separator:ae6b2732bea7ce47719f18ad2b06d81d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a066d19bab97676c8c6910e9c98d8008b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a066d19bab97676c8c6910e9c98d8008b">delta_nnet_</a></td></tr>
<tr class="separator:a066d19bab97676c8c6910e9c98d8008b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc1c4c518295918abed6546cfd7f065f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1nnet3_1_1CachingOptimizingCompiler.html">CachingOptimizingCompiler</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#acc1c4c518295918abed6546cfd7f065f">compiler_</a></td></tr>
<tr class="separator:acc1c4c518295918abed6546cfd7f065f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af676d295ba780873405747474e9f28aa"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#af676d295ba780873405747474e9f28aa">num_minibatches_processed_</a></td></tr>
<tr class="separator:af676d295ba780873405747474e9f28aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad23f9ac031cfabb9f57e14ab2f410a70"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int32 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ad23f9ac031cfabb9f57e14ab2f410a70">num_max_change_per_component_applied_</a></td></tr>
<tr class="separator:ad23f9ac031cfabb9f57e14ab2f410a70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae354c2b143a8dad295c45027860765b"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#aae354c2b143a8dad295c45027860765b">num_max_change_global_applied_</a></td></tr>
<tr class="separator:aae354c2b143a8dad295c45027860765b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a855a05d0c2cac564dba34eb4ed0b6c75"><td class="memItemLeft" align="right" valign="top">unordered_map&lt; std::string, <a class="el" href="structkaldi_1_1nnet3_1_1ObjectiveFunctionInfo.html">ObjectiveFunctionInfo</a>, <a class="el" href="structkaldi_1_1StringHasher.html">StringHasher</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a855a05d0c2cac564dba34eb4ed0b6c75">objf_info_</a></td></tr>
<tr class="separator:a855a05d0c2cac564dba34eb4ed0b6c75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15f099307d268e10568df4612a52c8c5"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a15f099307d268e10568df4612a52c8c5">srand_seed_</a></td></tr>
<tr class="separator:a15f099307d268e10568df4612a52c8c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class is for single-threaded training of neural nets using standard objective functions such as cross-entropy (implemented with logsoftmax nonlinearity and a linear objective function) and quadratic loss. </p>
<p>Something that we should do in the future is to make it possible to have two different threads, one for the compilation, and one for the computation. This would only improve efficiency in the cases where the structure of the input example was different each time, which isn't what we expect to see in speech-recognition training. (If the structure is the same each time, the <a class="el" href="classkaldi_1_1nnet3_1_1CachingOptimizingCompiler.html" title="This class enables you to do the compilation and optimization in one call, and also ensures that if t...">CachingOptimizingCompiler</a> notices this and uses the computation from last time). </p>

<p class="definition">Definition at line <a class="el" href="nnet-training_8h_source.html#l00179">179</a> of file <a class="el" href="nnet-training_8h_source.html">nnet-training.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a1d0f95070c4d8a7a24351463507b5dc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d0f95070c4d8a7a24351463507b5dc2">&#9670;&nbsp;</a></span>NnetTrainer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1nnet3_1_1NnetTrainer.html">NnetTrainer</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html">NnetTrainerOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> *&#160;</td>
          <td class="paramname"><em>nnet</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-training_8cc_source.html#l00027">27</a> of file <a class="el" href="nnet-training_8cc_source.html">nnet-training.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-training_8h_source.html#l00041">NnetTrainerOptions::backstitch_training_interval</a>, <a class="el" href="nnet-training_8h_source.html#l00215">NnetTrainer::compiler_</a>, <a class="el" href="nnet-training_8h_source.html#l00210">NnetTrainer::config_</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00246">Nnet::Copy()</a>, <a class="el" href="nnet-training_8h_source.html#l00212">NnetTrainer::delta_nnet_</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00132">KALDI_LOG</a>, <a class="el" href="kaldi-error_8h_source.html#l00129">KALDI_WARN</a>, <a class="el" href="nnet-training_8h_source.html#l00046">NnetTrainerOptions::max_param_change</a>, <a class="el" href="nnet-training_8h_source.html#l00038">NnetTrainerOptions::momentum</a>, <a class="el" href="nnet-training_8h_source.html#l00211">NnetTrainer::nnet_</a>, <a class="el" href="nnet-training_8h_source.html#l00224">NnetTrainer::num_max_change_global_applied_</a>, <a class="el" href="nnet-training_8h_source.html#l00223">NnetTrainer::num_max_change_per_component_applied_</a>, <a class="el" href="nnet-utils_8cc_source.html#l00413">kaldi::nnet3::NumUpdatableComponents()</a>, <a class="el" href="kaldi-io-inl_8h_source.html#l00026">Input::Open()</a>, <a class="el" href="nnet-training_8h_source.html#l00043">NnetTrainerOptions::read_cache</a>, <a class="el" href="nnet-optimize_8cc_source.html#l00666">CachingOptimizingCompiler::ReadCache()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00303">kaldi::nnet3::ScaleNnet()</a>, <a class="el" href="kaldi-io_8cc_source.html#l00826">Input::Stream()</a>, <a class="el" href="nnet-training_8h_source.html#l00034">NnetTrainerOptions::zero_component_stats</a>, and <a class="el" href="nnet-utils_8cc_source.html#l00269">kaldi::nnet3::ZeroComponentStats()</a>.</p>
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;                                    :</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>(config),</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>(nnet),</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#acc1c4c518295918abed6546cfd7f065f">compiler_</a>(*nnet, <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#af7eb9009a775319c96e30d19bb9f329f">optimize_config</a>, <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a92592ade35ce8201f316a1390632b82a">compiler_config</a>),</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#af676d295ba780873405747474e9f28aa">num_minibatches_processed_</a>(0),</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a15f099307d268e10568df4612a52c8c5">srand_seed_</a>(<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 100000)) {</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordflow">if</span> (config.zero_component_stats)</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#aca9d819d3ed85b506db090905d4c1cea">ZeroComponentStats</a>(nnet);</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(config.momentum &gt;= 0.0 &amp;&amp;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;               config.max_param_change &gt;= 0.0 &amp;&amp;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;               config.backstitch_training_interval &gt; 0);</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a066d19bab97676c8c6910e9c98d8008b">delta_nnet_</a> = <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a2e3135dae3bdab2ada7530236722142b">Copy</a>();</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a62b3a3e7be6ebc2a2af34bdb347ec76a">ScaleNnet</a>(0.0, <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a066d19bab97676c8c6910e9c98d8008b">delta_nnet_</a>);</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keyword">const</span> int32 num_updatable = <a class="code" href="namespacekaldi_1_1nnet3.html#a25df665b8f7a712a34469e53fc875851">NumUpdatableComponents</a>(*<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a066d19bab97676c8c6910e9c98d8008b">delta_nnet_</a>);</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ad23f9ac031cfabb9f57e14ab2f410a70">num_max_change_per_component_applied_</a>.resize(num_updatable, 0);</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#aae354c2b143a8dad295c45027860765b">num_max_change_global_applied_</a> = 0;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#ab4758f80f53eb8b2f9d1c9ba22406141">read_cache</a> != <span class="stringliteral">&quot;&quot;</span>) {</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordtype">bool</span> binary;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    Input ki;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">if</span> (ki.Open(<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#ab4758f80f53eb8b2f9d1c9ba22406141">read_cache</a>, &amp;binary)) {</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#acc1c4c518295918abed6546cfd7f065f">compiler_</a>.<a class="code" href="classkaldi_1_1nnet3_1_1CachingOptimizingCompiler.html#a86f956e344b819d8094cf0eb70721bd0">ReadCache</a>(ki.Stream(), binary);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Read computation cache from &quot;</span> &lt;&lt; <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#ab4758f80f53eb8b2f9d1c9ba22406141">read_cache</a>;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Could not open cached computation. &quot;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                    <span class="stringliteral">&quot;Probably this is the first training iteration.&quot;</span>;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    }</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  }</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;}</div><div class="ttc" id="namespacekaldi_1_1nnet3_html_a62b3a3e7be6ebc2a2af34bdb347ec76a"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a62b3a3e7be6ebc2a2af34bdb347ec76a">kaldi::nnet3::ScaleNnet</a></div><div class="ttdeci">void ScaleNnet(BaseFloat scale, Nnet *nnet)</div><div class="ttdoc">Scales the nnet parameters and stats by this scale. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00303">nnet-utils.cc:303</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_ad23f9ac031cfabb9f57e14ab2f410a70"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ad23f9ac031cfabb9f57e14ab2f410a70">kaldi::nnet3::NnetTrainer::num_max_change_per_component_applied_</a></div><div class="ttdeci">std::vector&lt; int32 &gt; num_max_change_per_component_applied_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00223">nnet-training.h:223</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_ae6b2732bea7ce47719f18ad2b06d81d2"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ae6b2732bea7ce47719f18ad2b06d81d2">kaldi::nnet3::NnetTrainer::nnet_</a></div><div class="ttdeci">Nnet * nnet_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00211">nnet-training.h:211</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_a066d19bab97676c8c6910e9c98d8008b"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a066d19bab97676c8c6910e9c98d8008b">kaldi::nnet3::NnetTrainer::delta_nnet_</a></div><div class="ttdeci">Nnet * delta_nnet_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00212">nnet-training.h:212</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetTrainerOptions_html_af7eb9009a775319c96e30d19bb9f329f"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#af7eb9009a775319c96e30d19bb9f329f">kaldi::nnet3::NnetTrainerOptions::optimize_config</a></div><div class="ttdeci">NnetOptimizeOptions optimize_config</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00047">nnet-training.h:47</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetTrainerOptions_html_a92592ade35ce8201f316a1390632b82a"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a92592ade35ce8201f316a1390632b82a">kaldi::nnet3::NnetTrainerOptions::compiler_config</a></div><div class="ttdeci">CachingOptimizingCompilerOptions compiler_config</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00049">nnet-training.h:49</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a2e3135dae3bdab2ada7530236722142b"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a2e3135dae3bdab2ada7530236722142b">kaldi::nnet3::Nnet::Copy</a></div><div class="ttdeci">Nnet * Copy() const</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00246">nnet-nnet.h:246</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_acc1c4c518295918abed6546cfd7f065f"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#acc1c4c518295918abed6546cfd7f065f">kaldi::nnet3::NnetTrainer::compiler_</a></div><div class="ttdeci">CachingOptimizingCompiler compiler_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00215">nnet-training.h:215</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_aca9d819d3ed85b506db090905d4c1cea"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#aca9d819d3ed85b506db090905d4c1cea">kaldi::nnet3::ZeroComponentStats</a></div><div class="ttdeci">void ZeroComponentStats(Nnet *nnet)</div><div class="ttdoc">Zeroes the component stats in all nonlinear components in the nnet. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00269">nnet-utils.cc:269</a></div></div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00129">kaldi-error.h:129</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_a70dbc9bfde10a7aa389b8a8114e41e74"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">kaldi::nnet3::NnetTrainer::config_</a></div><div class="ttdeci">const NnetTrainerOptions config_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00210">nnet-training.h:210</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_a15f099307d268e10568df4612a52c8c5"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a15f099307d268e10568df4612a52c8c5">kaldi::nnet3::NnetTrainer::srand_seed_</a></div><div class="ttdeci">int32 srand_seed_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00231">nnet-training.h:231</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1CachingOptimizingCompiler_html_a86f956e344b819d8094cf0eb70721bd0"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1CachingOptimizingCompiler.html#a86f956e344b819d8094cf0eb70721bd0">kaldi::nnet3::CachingOptimizingCompiler::ReadCache</a></div><div class="ttdeci">void ReadCache(std::istream &amp;is, bool binary)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize_8cc_source.html#l00666">nnet-optimize.cc:666</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetTrainerOptions_html_ab4758f80f53eb8b2f9d1c9ba22406141"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#ab4758f80f53eb8b2f9d1c9ba22406141">kaldi::nnet3::NnetTrainerOptions::read_cache</a></div><div class="ttdeci">std::string read_cache</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00043">nnet-training.h:43</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_af676d295ba780873405747474e9f28aa"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#af676d295ba780873405747474e9f28aa">kaldi::nnet3::NnetTrainer::num_minibatches_processed_</a></div><div class="ttdeci">int32 num_minibatches_processed_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00220">nnet-training.h:220</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00132">kaldi-error.h:132</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_aae354c2b143a8dad295c45027860765b"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#aae354c2b143a8dad295c45027860765b">kaldi::nnet3::NnetTrainer::num_max_change_global_applied_</a></div><div class="ttdeci">int32 num_max_change_global_applied_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00224">nnet-training.h:224</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a25df665b8f7a712a34469e53fc875851"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a25df665b8f7a712a34469e53fc875851">kaldi::nnet3::NumUpdatableComponents</a></div><div class="ttdeci">int32 NumUpdatableComponents(const Nnet &amp;dest)</div><div class="ttdoc">Returns the number of updatable components in the nnet. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00413">nnet-utils.cc:413</a></div></div>
<div class="ttc" id="namespacekaldi_html_a0361eab3c5ebb78e6be060e6fa78e1a1"><div class="ttname"><a href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">kaldi::RandInt</a></div><div class="ttdeci">int32 RandInt(int32 min_val, int32 max_val, struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00094">kaldi-math.cc:94</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af5c0d9a92b9c3873022401a5fb69013e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5c0d9a92b9c3873022401a5fb69013e">&#9670;&nbsp;</a></span>~NnetTrainer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">~<a class="el" href="classkaldi_1_1nnet3_1_1NnetTrainer.html">NnetTrainer</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-training_8cc_source.html#l00361">361</a> of file <a class="el" href="nnet-training_8cc_source.html">nnet-training.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-training_8h_source.html#l00045">NnetTrainerOptions::binary_write_cache</a>, <a class="el" href="nnet-training_8h_source.html#l00215">NnetTrainer::compiler_</a>, <a class="el" href="nnet-training_8h_source.html#l00210">NnetTrainer::config_</a>, <a class="el" href="nnet-training_8h_source.html#l00212">NnetTrainer::delta_nnet_</a>, <a class="el" href="kaldi-error_8h_source.html#l00132">KALDI_LOG</a>, <a class="el" href="kaldi-io_8cc_source.html#l00701">Output::Stream()</a>, <a class="el" href="nnet-training_8h_source.html#l00044">NnetTrainerOptions::write_cache</a>, and <a class="el" href="nnet-optimize_8cc_source.html#l00688">CachingOptimizingCompiler::WriteCache()</a>.</p>
<div class="fragment"><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                          {</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#aa868ac38e0137c4a6839b39c20a0738d">write_cache</a> != <span class="stringliteral">&quot;&quot;</span>) {</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    Output ko(<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#aa868ac38e0137c4a6839b39c20a0738d">write_cache</a>, <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a7ac69688ba1d051fafdd99aebe57dea6">binary_write_cache</a>);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#acc1c4c518295918abed6546cfd7f065f">compiler_</a>.<a class="code" href="classkaldi_1_1nnet3_1_1CachingOptimizingCompiler.html#ab795efcd7320a0556ac3080659e5d704">WriteCache</a>(ko.Stream(), <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a7ac69688ba1d051fafdd99aebe57dea6">binary_write_cache</a>);</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Wrote computation cache to &quot;</span> &lt;&lt; <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#aa868ac38e0137c4a6839b39c20a0738d">write_cache</a>;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  }</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keyword">delete</span> <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a066d19bab97676c8c6910e9c98d8008b">delta_nnet_</a>;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_a066d19bab97676c8c6910e9c98d8008b"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a066d19bab97676c8c6910e9c98d8008b">kaldi::nnet3::NnetTrainer::delta_nnet_</a></div><div class="ttdeci">Nnet * delta_nnet_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00212">nnet-training.h:212</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_acc1c4c518295918abed6546cfd7f065f"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#acc1c4c518295918abed6546cfd7f065f">kaldi::nnet3::NnetTrainer::compiler_</a></div><div class="ttdeci">CachingOptimizingCompiler compiler_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00215">nnet-training.h:215</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_a70dbc9bfde10a7aa389b8a8114e41e74"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">kaldi::nnet3::NnetTrainer::config_</a></div><div class="ttdeci">const NnetTrainerOptions config_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00210">nnet-training.h:210</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetTrainerOptions_html_aa868ac38e0137c4a6839b39c20a0738d"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#aa868ac38e0137c4a6839b39c20a0738d">kaldi::nnet3::NnetTrainerOptions::write_cache</a></div><div class="ttdeci">std::string write_cache</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00044">nnet-training.h:44</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1CachingOptimizingCompiler_html_ab795efcd7320a0556ac3080659e5d704"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1CachingOptimizingCompiler.html#ab795efcd7320a0556ac3080659e5d704">kaldi::nnet3::CachingOptimizingCompiler::WriteCache</a></div><div class="ttdeci">void WriteCache(std::ostream &amp;os, bool binary)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize_8cc_source.html#l00688">nnet-optimize.cc:688</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetTrainerOptions_html_a7ac69688ba1d051fafdd99aebe57dea6"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a7ac69688ba1d051fafdd99aebe57dea6">kaldi::nnet3::NnetTrainerOptions::binary_write_cache</a></div><div class="ttdeci">bool binary_write_cache</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00045">nnet-training.h:45</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00132">kaldi-error.h:132</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a7eb417b84053d9c0352207e9a5206efe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7eb417b84053d9c0352207e9a5206efe">&#9670;&nbsp;</a></span>PrintMaxChangeStats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PrintMaxChangeStats </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-training_8cc_source.html#l00243">243</a> of file <a class="el" href="nnet-training_8cc_source.html">nnet-training.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-training_8h_source.html#l00041">NnetTrainerOptions::backstitch_training_interval</a>, <a class="el" href="nnet-training_8h_source.html#l00040">NnetTrainerOptions::backstitch_training_scale</a>, <a class="el" href="nnet-training_8h_source.html#l00210">NnetTrainer::config_</a>, <a class="el" href="nnet-training_8h_source.html#l00212">NnetTrainer::delta_nnet_</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00150">Nnet::GetComponent()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00689">Nnet::GetComponentName()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00126">KALDI_ERR</a>, <a class="el" href="kaldi-error_8h_source.html#l00132">KALDI_LOG</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00042">kaldi::nnet3::kUpdatableComponent</a>, <a class="el" href="nnet-training_8h_source.html#l00224">NnetTrainer::num_max_change_global_applied_</a>, <a class="el" href="nnet-training_8h_source.html#l00223">NnetTrainer::num_max_change_per_component_applied_</a>, <a class="el" href="nnet-training_8h_source.html#l00220">NnetTrainer::num_minibatches_processed_</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00124">Nnet::NumComponents()</a>, and <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">Component::Properties()</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-training_8cc_source.html#l00221">NnetTrainer::PrintTotalStats()</a>.</p>
<div class="fragment"><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                                            {</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a066d19bab97676c8c6910e9c98d8008b">delta_nnet_</a> != NULL);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  int32 <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keywordflow">for</span> (int32 c = 0; c &lt; <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a066d19bab97676c8c6910e9c98d8008b">delta_nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a15b5336b4413124b1fd4531f57781182">NumComponents</a>(); c++) {</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    Component *comp = <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a066d19bab97676c8c6910e9c98d8008b">delta_nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#aec8d6dfed3e4ab080d3ff4cf6a1126e3">GetComponent</a>(c);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">if</span> (comp-&gt;Properties() &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kUpdatableComponent</a>) {</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      UpdatableComponent *uc = <span class="keyword">dynamic_cast&lt;</span>UpdatableComponent*<span class="keyword">&gt;</span>(comp);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="keywordflow">if</span> (uc == NULL)</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Updatable component does not inherit from class &quot;</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;UpdatableComponent; change this code.&quot;</span>;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ad23f9ac031cfabb9f57e14ab2f410a70">num_max_change_per_component_applied_</a>[i] &gt; 0)</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;For &quot;</span> &lt;&lt; <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a066d19bab97676c8c6910e9c98d8008b">delta_nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a20a30bf0a11b6b83ba8837af06cf7d70">GetComponentName</a>(c)</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;, per-component max-change was enforced &quot;</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                  &lt;&lt; (100.0 * <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ad23f9ac031cfabb9f57e14ab2f410a70">num_max_change_per_component_applied_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]) /</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                     (<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#af676d295ba780873405747474e9f28aa">num_minibatches_processed_</a> *</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                     (<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a5041066d06d6652098df5bc8a4ff3d77">backstitch_training_scale</a> == 0.0 ? 1.0 :</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                     1.0 + 1.0 / <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a7257951f546c86d429ba6b839a1dc18d">backstitch_training_interval</a>))</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot; \% of the time.&quot;</span>;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      i++;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    }</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  }</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#aae354c2b143a8dad295c45027860765b">num_max_change_global_applied_</a> &gt; 0)</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;The global max-change was enforced &quot;</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;              &lt;&lt; (100.0 * <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#aae354c2b143a8dad295c45027860765b">num_max_change_global_applied_</a>) /</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                 (<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#af676d295ba780873405747474e9f28aa">num_minibatches_processed_</a> *</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                 (<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a5041066d06d6652098df5bc8a4ff3d77">backstitch_training_scale</a> == 0.0 ? 1.0 :</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                 1.0 + 1.0 / <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a7257951f546c86d429ba6b839a1dc18d">backstitch_training_interval</a>))</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; \% of the time.&quot;</span>;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_ad23f9ac031cfabb9f57e14ab2f410a70"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ad23f9ac031cfabb9f57e14ab2f410a70">kaldi::nnet3::NnetTrainer::num_max_change_per_component_applied_</a></div><div class="ttdeci">std::vector&lt; int32 &gt; num_max_change_per_component_applied_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00223">nnet-training.h:223</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_a066d19bab97676c8c6910e9c98d8008b"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a066d19bab97676c8c6910e9c98d8008b">kaldi::nnet3::NnetTrainer::delta_nnet_</a></div><div class="ttdeci">Nnet * delta_nnet_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00212">nnet-training.h:212</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kaldi::nnet3::kUpdatableComponent</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00042">nnet-component-itf.h:42</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetTrainerOptions_html_a7257951f546c86d429ba6b839a1dc18d"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a7257951f546c86d429ba6b839a1dc18d">kaldi::nnet3::NnetTrainerOptions::backstitch_training_interval</a></div><div class="ttdeci">int32 backstitch_training_interval</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00041">nnet-training.h:41</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00126">kaldi-error.h:126</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a20a30bf0a11b6b83ba8837af06cf7d70"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a20a30bf0a11b6b83ba8837af06cf7d70">kaldi::nnet3::Nnet::GetComponentName</a></div><div class="ttdeci">const std::string &amp; GetComponentName(int32 component_index) const</div><div class="ttdoc">returns individual component name. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00689">nnet-nnet.cc:689</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_a70dbc9bfde10a7aa389b8a8114e41e74"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">kaldi::nnet3::NnetTrainer::config_</a></div><div class="ttdeci">const NnetTrainerOptions config_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00210">nnet-training.h:210</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_aec8d6dfed3e4ab080d3ff4cf6a1126e3"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#aec8d6dfed3e4ab080d3ff4cf6a1126e3">kaldi::nnet3::Nnet::GetComponent</a></div><div class="ttdeci">Component * GetComponent(int32 c)</div><div class="ttdoc">Return component indexed c. Not a copy; not owned by caller. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00150">nnet-nnet.cc:150</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a15b5336b4413124b1fd4531f57781182"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a15b5336b4413124b1fd4531f57781182">kaldi::nnet3::Nnet::NumComponents</a></div><div class="ttdeci">int32 NumComponents() const</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00124">nnet-nnet.h:124</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_af676d295ba780873405747474e9f28aa"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#af676d295ba780873405747474e9f28aa">kaldi::nnet3::NnetTrainer::num_minibatches_processed_</a></div><div class="ttdeci">int32 num_minibatches_processed_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00220">nnet-training.h:220</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetTrainerOptions_html_a5041066d06d6652098df5bc8a4ff3d77"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a5041066d06d6652098df5bc8a4ff3d77">kaldi::nnet3::NnetTrainerOptions::backstitch_training_scale</a></div><div class="ttdeci">BaseFloat backstitch_training_scale</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00040">nnet-training.h:40</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00132">kaldi-error.h:132</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_aae354c2b143a8dad295c45027860765b"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#aae354c2b143a8dad295c45027860765b">kaldi::nnet3::NnetTrainer::num_max_change_global_applied_</a></div><div class="ttdeci">int32 num_max_change_global_applied_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00224">nnet-training.h:224</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad57a45f61541b7b94999b984a3c43439"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad57a45f61541b7b94999b984a3c43439">&#9670;&nbsp;</a></span>PrintTotalStats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> PrintTotalStats </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-training_8cc_source.html#l00221">221</a> of file <a class="el" href="nnet-training_8cc_source.html">nnet-training.cc</a>.</p>

<p class="reference">References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-training_8h_source.html#l00226">NnetTrainer::objf_info_</a>, <a class="el" href="nnet-training_8cc_source.html#l00243">NnetTrainer::PrintMaxChangeStats()</a>, and <a class="el" href="nnet-training_8cc_source.html#l00343">ObjectiveFunctionInfo::PrintTotalStats()</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet3-train_8cc_source.html#l00025">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                        {</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  unordered_map&lt;std::string, ObjectiveFunctionInfo, StringHasher&gt;::const_iterator</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      iter = <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a855a05d0c2cac564dba34eb4ed0b6c75">objf_info_</a>.begin(),</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      end = <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a855a05d0c2cac564dba34eb4ed0b6c75">objf_info_</a>.end();</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  std::vector&lt;std::pair&lt;std::string, const ObjectiveFunctionInfo*&gt; &gt; all_pairs;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="keywordflow">for</span> (; iter != end; ++iter)</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    all_pairs.push_back(std::pair&lt;std::string, const ObjectiveFunctionInfo*&gt;(</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        iter-&gt;first, &amp;(iter-&gt;second)));</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="comment">// ensure deterministic order of these names (this will matter in situations</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="comment">// where a script greps for the objective from the log).</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  std::sort(all_pairs.begin(), all_pairs.end());</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordtype">bool</span> ans = <span class="keyword">false</span>;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; all_pairs.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keyword">const</span> std::string &amp;name = all_pairs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].first;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keyword">const</span> ObjectiveFunctionInfo &amp;info = *(all_pairs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].second);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordtype">bool</span> ok = info.PrintTotalStats(name);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    ans = ans || ok;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  }</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a7eb417b84053d9c0352207e9a5206efe">PrintMaxChangeStats</a>();</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordflow">return</span> ans;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_a7eb417b84053d9c0352207e9a5206efe"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a7eb417b84053d9c0352207e9a5206efe">kaldi::nnet3::NnetTrainer::PrintMaxChangeStats</a></div><div class="ttdeci">void PrintMaxChangeStats() const</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8cc_source.html#l00243">nnet-training.cc:243</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_a855a05d0c2cac564dba34eb4ed0b6c75"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a855a05d0c2cac564dba34eb4ed0b6c75">kaldi::nnet3::NnetTrainer::objf_info_</a></div><div class="ttdeci">unordered_map&lt; std::string, ObjectiveFunctionInfo, StringHasher &gt; objf_info_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00226">nnet-training.h:226</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a150ac242bbed448bc9a90d6df485023e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a150ac242bbed448bc9a90d6df485023e">&#9670;&nbsp;</a></span>ProcessOutputs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProcessOutputs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>is_backstitch_step2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &amp;&#160;</td>
          <td class="paramname"><em>eg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1nnet3_1_1NnetComputer.html">NnetComputer</a> *&#160;</td>
          <td class="paramname"><em>computer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-training_8cc_source.html#l00192">192</a> of file <a class="el" href="nnet-training_8cc_source.html">nnet-training.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-training_8cc_source.html#l00370">kaldi::nnet3::ComputeObjectiveFunction()</a>, <a class="el" href="nnet-training_8h_source.html#l00210">NnetTrainer::config_</a>, <a class="el" href="nnet3_2nnet-example_8h_source.html#l00046">NnetIo::features</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00146">Nnet::GetNode()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00466">Nnet::GetNodeIndex()</a>, <a class="el" href="nnet3_2nnet-example_8h_source.html#l00116">NnetExample::io</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00112">Nnet::IsOutputNode()</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="nnet3_2nnet-example_8h_source.html#l00036">NnetIo::name</a>, <a class="el" href="nnet-training_8h_source.html#l00211">NnetTrainer::nnet_</a>, <a class="el" href="nnet-training_8h_source.html#l00220">NnetTrainer::num_minibatches_processed_</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00097">NetworkNode::objective_type</a>, <a class="el" href="nnet-training_8h_source.html#l00226">NnetTrainer::objf_info_</a>, <a class="el" href="nnet-training_8h_source.html#l00036">NnetTrainerOptions::print_interval</a>, and <a class="el" href="structkaldi_1_1nnet3_1_1NetworkNode.html#a1350345f237cf9f9ce2f2e2b39800dd7">NetworkNode::u</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-training_8cc_source.html#l00093">NnetTrainer::TrainInternal()</a>, and <a class="el" href="nnet-training_8cc_source.html#l00133">NnetTrainer::TrainInternalBackstitch()</a>.</p>
<div class="fragment"><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                                                         {</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="comment">// normally the eg will have just one output named &#39;output&#39;, but</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="comment">// we don&#39;t assume this.</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="comment">// In backstitch training, the output-name with the &quot;_backstitch&quot; suffix is</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">// the one computed after the first, backward step of backstitch.</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keyword">const</span> std::string suffix = (is_backstitch_step2 ? <span class="stringliteral">&quot;_backstitch&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  std::vector&lt;NnetIo&gt;::const_iterator iter = eg.io.begin(),</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      end = eg.io.end();</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordflow">for</span> (; iter != end; ++iter) {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keyword">const</span> NnetIo &amp;io = *iter;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    int32 node_index = <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a801beed78b9ad611d753940538c15252">GetNodeIndex</a>(io.name);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(node_index &gt;= 0);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a6c50812e1be80ab06573493276ec2ca5">IsOutputNode</a>(node_index)) {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a45660f9909187129a953fa05e664576e">ObjectiveType</a> obj_type = <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a7c9670858b79ae4a8e1c054b5d5231b8">GetNode</a>(node_index).<a class="code" href="structkaldi_1_1nnet3_1_1NetworkNode.html#a1350345f237cf9f9ce2f2e2b39800dd7">u</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NetworkNode.html#ae3e6a612d02a63dd4e56b23d35463a44">objective_type</a>;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> tot_weight, tot_objf;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keywordtype">bool</span> supply_deriv = <span class="keyword">true</span>;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a2f2fefdb7c8c1cc2fd30b5e102e8e979">ComputeObjectiveFunction</a>(io.features, obj_type, io.name,</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                               supply_deriv, computer,</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                               &amp;tot_weight, &amp;tot_objf);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a855a05d0c2cac564dba34eb4ed0b6c75">objf_info_</a>[io.name + suffix].UpdateStats(io.name + suffix,</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                                      <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#ab4d457269a5f2b6987167cfeebea78e4">print_interval</a>,</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                                      <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#af676d295ba780873405747474e9f28aa">num_minibatches_processed_</a>,</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                                      tot_weight, tot_objf);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  }</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_ae6b2732bea7ce47719f18ad2b06d81d2"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ae6b2732bea7ce47719f18ad2b06d81d2">kaldi::nnet3::NnetTrainer::nnet_</a></div><div class="ttdeci">Nnet * nnet_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00211">nnet-training.h:211</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a2f2fefdb7c8c1cc2fd30b5e102e8e979"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a2f2fefdb7c8c1cc2fd30b5e102e8e979">kaldi::nnet3::ComputeObjectiveFunction</a></div><div class="ttdeci">void ComputeObjectiveFunction(const GeneralMatrix &amp;supervision, ObjectiveType objective_type, const std::string &amp;output_name, bool supply_deriv, NnetComputer *computer, BaseFloat *tot_weight, BaseFloat *tot_objf)</div><div class="ttdoc">This function computes the objective function, and if supply_deriv = true, supplies its derivative to...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8cc_source.html#l00370">nnet-training.cc:370</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NetworkNode_html_ae3e6a612d02a63dd4e56b23d35463a44"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NetworkNode.html#ae3e6a612d02a63dd4e56b23d35463a44">kaldi::nnet3::NetworkNode::objective_type</a></div><div class="ttdeci">ObjectiveType objective_type</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00097">nnet-nnet.h:97</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetTrainerOptions_html_ab4d457269a5f2b6987167cfeebea78e4"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#ab4d457269a5f2b6987167cfeebea78e4">kaldi::nnet3::NnetTrainerOptions::print_interval</a></div><div class="ttdeci">int32 print_interval</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00036">nnet-training.h:36</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a7c9670858b79ae4a8e1c054b5d5231b8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a7c9670858b79ae4a8e1c054b5d5231b8">kaldi::nnet3::Nnet::GetNode</a></div><div class="ttdeci">const NetworkNode &amp; GetNode(int32 node) const</div><div class="ttdoc">returns const reference to a particular numbered network node. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00146">nnet-nnet.h:146</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a6c50812e1be80ab06573493276ec2ca5"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a6c50812e1be80ab06573493276ec2ca5">kaldi::nnet3::Nnet::IsOutputNode</a></div><div class="ttdeci">bool IsOutputNode(int32 node) const</div><div class="ttdoc">Returns true if this is an output node, meaning that it is of type kDescriptor and is not directly fo...</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00112">nnet-nnet.cc:112</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_a855a05d0c2cac564dba34eb4ed0b6c75"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a855a05d0c2cac564dba34eb4ed0b6c75">kaldi::nnet3::NnetTrainer::objf_info_</a></div><div class="ttdeci">unordered_map&lt; std::string, ObjectiveFunctionInfo, StringHasher &gt; objf_info_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00226">nnet-training.h:226</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_a70dbc9bfde10a7aa389b8a8114e41e74"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">kaldi::nnet3::NnetTrainer::config_</a></div><div class="ttdeci">const NnetTrainerOptions config_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00210">nnet-training.h:210</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a45660f9909187129a953fa05e664576e"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a45660f9909187129a953fa05e664576e">kaldi::nnet3::ObjectiveType</a></div><div class="ttdeci">ObjectiveType</div><div class="ttdoc">This enum is for a kind of annotation we associate with output nodes of the network; it&amp;#39;s for the con...</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00052">nnet-nnet.h:52</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a801beed78b9ad611d753940538c15252"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a801beed78b9ad611d753940538c15252">kaldi::nnet3::Nnet::GetNodeIndex</a></div><div class="ttdeci">int32 GetNodeIndex(const std::string &amp;node_name) const</div><div class="ttdoc">returns index associated with this node name, or -1 if no such index. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00466">nnet-nnet.cc:466</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_af676d295ba780873405747474e9f28aa"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#af676d295ba780873405747474e9f28aa">kaldi::nnet3::NnetTrainer::num_minibatches_processed_</a></div><div class="ttdeci">int32 num_minibatches_processed_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00220">nnet-training.h:220</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NetworkNode_html_a1350345f237cf9f9ce2f2e2b39800dd7"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NetworkNode.html#a1350345f237cf9f9ce2f2e2b39800dd7">kaldi::nnet3::NetworkNode::u</a></div><div class="ttdeci">union kaldi::nnet3::NetworkNode::@14 u</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a987bc9ce40e66b7efc8b4321eedc8ded"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a987bc9ce40e66b7efc8b4321eedc8ded">&#9670;&nbsp;</a></span>Train()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Train </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &amp;&#160;</td>
          <td class="paramname"><em>eg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-training_8cc_source.html#l00059">59</a> of file <a class="el" href="nnet-training_8cc_source.html">nnet-training.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-training_8h_source.html#l00041">NnetTrainerOptions::backstitch_training_interval</a>, <a class="el" href="nnet-training_8h_source.html#l00040">NnetTrainerOptions::backstitch_training_scale</a>, <a class="el" href="nnet-optimize_8cc_source.html#l00716">CachingOptimizingCompiler::Compile()</a>, <a class="el" href="nnet-training_8h_source.html#l00215">NnetTrainer::compiler_</a>, <a class="el" href="nnet-training_8h_source.html#l00210">NnetTrainer::config_</a>, <a class="el" href="nnet-utils_8cc_source.html#l01061">kaldi::nnet3::ConsolidateMemory()</a>, <a class="el" href="nnet-training_8h_source.html#l00212">NnetTrainer::delta_nnet_</a>, <a class="el" href="nnet-utils_8cc_source.html#l00423">kaldi::nnet3::FreezeNaturalGradient()</a>, <a class="el" href="nnet-example-utils_8cc_source.html#l00202">kaldi::nnet3::GetComputationRequest()</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="nnet-training_8h_source.html#l00038">NnetTrainerOptions::momentum</a>, <a class="el" href="nnet-training_8h_source.html#l00211">NnetTrainer::nnet_</a>, <a class="el" href="nnet-training_8h_source.html#l00220">NnetTrainer::num_minibatches_processed_</a>, <a class="el" href="nnet-utils_8cc_source.html#l00573">kaldi::nnet3::ResetGenerators()</a>, <a class="el" href="nnet-training_8h_source.html#l00231">NnetTrainer::srand_seed_</a>, <a class="el" href="nnet-training_8h_source.html#l00035">NnetTrainerOptions::store_component_stats</a>, <a class="el" href="nnet-training_8cc_source.html#l00093">NnetTrainer::TrainInternal()</a>, and <a class="el" href="nnet-training_8cc_source.html#l00133">NnetTrainer::TrainInternalBackstitch()</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet3-train_8cc_source.html#l00025">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                                             {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordtype">bool</span> need_model_derivative = <span class="keyword">true</span>;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  ComputationRequest request;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a66f879097cf9cba7482bad03a4030f72">GetComputationRequest</a>(*<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>, eg, need_model_derivative,</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                        <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a5c5011f4cb4b2fc21775a3308c9cecda">store_component_stats</a>,</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                        &amp;request);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  std::shared_ptr&lt;const NnetComputation&gt; computation = <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#acc1c4c518295918abed6546cfd7f065f">compiler_</a>.<a class="code" href="classkaldi_1_1nnet3_1_1CachingOptimizingCompiler.html#aff351a0fdf96a308aac59a70993d58ff">Compile</a>(request);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a5041066d06d6652098df5bc8a4ff3d77">backstitch_training_scale</a> &gt; 0.0 &amp;&amp;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#af676d295ba780873405747474e9f28aa">num_minibatches_processed_</a> % <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a7257951f546c86d429ba6b839a1dc18d">backstitch_training_interval</a> ==</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a15f099307d268e10568df4612a52c8c5">srand_seed_</a> % <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a7257951f546c86d429ba6b839a1dc18d">backstitch_training_interval</a>) {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">// backstitch training is incompatible with momentum &gt; 0</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#aefc49bfa70545c9f199ef57bad5ef3c9">momentum</a> == 0.0);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#aa665cb6bf2afd82ee21658d7d5d9c410">FreezeNaturalGradient</a>(<span class="keyword">true</span>, <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a066d19bab97676c8c6910e9c98d8008b">delta_nnet_</a>);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordtype">bool</span> is_backstitch_step1 = <span class="keyword">true</span>;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    srand(<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a15f099307d268e10568df4612a52c8c5">srand_seed_</a> + <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#af676d295ba780873405747474e9f28aa">num_minibatches_processed_</a>);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a3c2029913de309432ceda98856ca5819">ResetGenerators</a>(<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a5672aa8ecefb855b96d43521adfe23f9">TrainInternalBackstitch</a>(eg, *computation, is_backstitch_step1);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#aa665cb6bf2afd82ee21658d7d5d9c410">FreezeNaturalGradient</a>(<span class="keyword">false</span>, <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a066d19bab97676c8c6910e9c98d8008b">delta_nnet_</a>); <span class="comment">// un-freeze natural gradient</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    is_backstitch_step1 = <span class="keyword">false</span>;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    srand(<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a15f099307d268e10568df4612a52c8c5">srand_seed_</a> + <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#af676d295ba780873405747474e9f28aa">num_minibatches_processed_</a>);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a3c2029913de309432ceda98856ca5819">ResetGenerators</a>(<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a5672aa8ecefb855b96d43521adfe23f9">TrainInternalBackstitch</a>(eg, *computation, is_backstitch_step1);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  } <span class="keywordflow">else</span> { <span class="comment">// conventional training</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a2dd3350275a8d44250b93d6e1f06c186">TrainInternal</a>(eg, *computation);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  }</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#af676d295ba780873405747474e9f28aa">num_minibatches_processed_</a> == 0) {</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a322efc02a286b646c40b65235c432893">ConsolidateMemory</a>(<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a322efc02a286b646c40b65235c432893">ConsolidateMemory</a>(<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a066d19bab97676c8c6910e9c98d8008b">delta_nnet_</a>);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#af676d295ba780873405747474e9f28aa">num_minibatches_processed_</a>++;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_ae6b2732bea7ce47719f18ad2b06d81d2"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ae6b2732bea7ce47719f18ad2b06d81d2">kaldi::nnet3::NnetTrainer::nnet_</a></div><div class="ttdeci">Nnet * nnet_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00211">nnet-training.h:211</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_a066d19bab97676c8c6910e9c98d8008b"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a066d19bab97676c8c6910e9c98d8008b">kaldi::nnet3::NnetTrainer::delta_nnet_</a></div><div class="ttdeci">Nnet * delta_nnet_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00212">nnet-training.h:212</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_a5672aa8ecefb855b96d43521adfe23f9"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a5672aa8ecefb855b96d43521adfe23f9">kaldi::nnet3::NnetTrainer::TrainInternalBackstitch</a></div><div class="ttdeci">void TrainInternalBackstitch(const NnetExample &amp;eg, const NnetComputation &amp;computation, bool is_backstitch_step1)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8cc_source.html#l00133">nnet-training.cc:133</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetTrainerOptions_html_aefc49bfa70545c9f199ef57bad5ef3c9"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#aefc49bfa70545c9f199ef57bad5ef3c9">kaldi::nnet3::NnetTrainerOptions::momentum</a></div><div class="ttdeci">BaseFloat momentum</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00038">nnet-training.h:38</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetTrainerOptions_html_a7257951f546c86d429ba6b839a1dc18d"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a7257951f546c86d429ba6b839a1dc18d">kaldi::nnet3::NnetTrainerOptions::backstitch_training_interval</a></div><div class="ttdeci">int32 backstitch_training_interval</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00041">nnet-training.h:41</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_aa665cb6bf2afd82ee21658d7d5d9c410"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#aa665cb6bf2afd82ee21658d7d5d9c410">kaldi::nnet3::FreezeNaturalGradient</a></div><div class="ttdeci">void FreezeNaturalGradient(bool freeze, Nnet *nnet)</div><div class="ttdoc">Controls if natural gradient will be updated. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00423">nnet-utils.cc:423</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a3c2029913de309432ceda98856ca5819"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a3c2029913de309432ceda98856ca5819">kaldi::nnet3::ResetGenerators</a></div><div class="ttdeci">void ResetGenerators(Nnet *nnet)</div><div class="ttdoc">This function calls &amp;#39;ResetGenerator()&amp;#39; on all components in &amp;#39;nnet&amp;#39; that inherit from class RandomComp...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00573">nnet-utils.cc:573</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetTrainerOptions_html_a5c5011f4cb4b2fc21775a3308c9cecda"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a5c5011f4cb4b2fc21775a3308c9cecda">kaldi::nnet3::NnetTrainerOptions::store_component_stats</a></div><div class="ttdeci">bool store_component_stats</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00035">nnet-training.h:35</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_acc1c4c518295918abed6546cfd7f065f"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#acc1c4c518295918abed6546cfd7f065f">kaldi::nnet3::NnetTrainer::compiler_</a></div><div class="ttdeci">CachingOptimizingCompiler compiler_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00215">nnet-training.h:215</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_a70dbc9bfde10a7aa389b8a8114e41e74"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">kaldi::nnet3::NnetTrainer::config_</a></div><div class="ttdeci">const NnetTrainerOptions config_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00210">nnet-training.h:210</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_a15f099307d268e10568df4612a52c8c5"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a15f099307d268e10568df4612a52c8c5">kaldi::nnet3::NnetTrainer::srand_seed_</a></div><div class="ttdeci">int32 srand_seed_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00231">nnet-training.h:231</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1CachingOptimizingCompiler_html_aff351a0fdf96a308aac59a70993d58ff"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1CachingOptimizingCompiler.html#aff351a0fdf96a308aac59a70993d58ff">kaldi::nnet3::CachingOptimizingCompiler::Compile</a></div><div class="ttdeci">std::shared_ptr&lt; const NnetComputation &gt; Compile(const ComputationRequest &amp;request)</div><div class="ttdoc">Does the compilation and returns a const pointer to the result, which is owned by this class...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize_8cc_source.html#l00716">nnet-optimize.cc:716</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a322efc02a286b646c40b65235c432893"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a322efc02a286b646c40b65235c432893">kaldi::nnet3::ConsolidateMemory</a></div><div class="ttdeci">void ConsolidateMemory(Nnet *nnet)</div><div class="ttdoc">This just calls ConsolidateMemory() on all the components of the nnet. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l01061">nnet-utils.cc:1061</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_a2dd3350275a8d44250b93d6e1f06c186"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a2dd3350275a8d44250b93d6e1f06c186">kaldi::nnet3::NnetTrainer::TrainInternal</a></div><div class="ttdeci">void TrainInternal(const NnetExample &amp;eg, const NnetComputation &amp;computation)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8cc_source.html#l00093">nnet-training.cc:93</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_af676d295ba780873405747474e9f28aa"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#af676d295ba780873405747474e9f28aa">kaldi::nnet3::NnetTrainer::num_minibatches_processed_</a></div><div class="ttdeci">int32 num_minibatches_processed_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00220">nnet-training.h:220</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetTrainerOptions_html_a5041066d06d6652098df5bc8a4ff3d77"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a5041066d06d6652098df5bc8a4ff3d77">kaldi::nnet3::NnetTrainerOptions::backstitch_training_scale</a></div><div class="ttdeci">BaseFloat backstitch_training_scale</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00040">nnet-training.h:40</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a66f879097cf9cba7482bad03a4030f72"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a66f879097cf9cba7482bad03a4030f72">kaldi::nnet3::GetComputationRequest</a></div><div class="ttdeci">void GetComputationRequest(const Nnet &amp;nnet, const NnetExample &amp;eg, bool need_model_derivative, bool store_component_stats, ComputationRequest *request)</div><div class="ttdoc">This function takes a NnetExample (which should already have been frame-selected, if desired...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-example-utils_8cc_source.html#l00202">nnet-example-utils.cc:202</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2dd3350275a8d44250b93d6e1f06c186"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dd3350275a8d44250b93d6e1f06c186">&#9670;&nbsp;</a></span>TrainInternal()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void TrainInternal </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &amp;&#160;</td>
          <td class="paramname"><em>eg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> &amp;&#160;</td>
          <td class="paramname"><em>computation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-training_8cc_source.html#l00093">93</a> of file <a class="el" href="nnet-training_8cc_source.html">nnet-training.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00658">NnetComputer::AcceptInputs()</a>, <a class="el" href="nnet-utils_8cc_source.html#l02151">kaldi::nnet3::ApplyL2Regularization()</a>, <a class="el" href="nnet-training_8h_source.html#l00042">NnetTrainerOptions::batchnorm_stats_scale</a>, <a class="el" href="nnet-training_8h_source.html#l00048">NnetTrainerOptions::compute_config</a>, <a class="el" href="nnet-training_8h_source.html#l00210">NnetTrainer::config_</a>, <a class="el" href="nnet-utils_8cc_source.html#l01022">kaldi::nnet3::ConstrainOrthonormal()</a>, <a class="el" href="nnet-training_8h_source.html#l00212">NnetTrainer::delta_nnet_</a>, <a class="el" href="nnet-utils_8cc_source.html#l02105">kaldi::nnet3::GetNumNvalues()</a>, <a class="el" href="nnet3_2nnet-example_8h_source.html#l00116">NnetExample::io</a>, <a class="el" href="nnet-training_8h_source.html#l00039">NnetTrainerOptions::l2_regularize_factor</a>, <a class="el" href="nnet-training_8h_source.html#l00046">NnetTrainerOptions::max_param_change</a>, <a class="el" href="nnet-training_8h_source.html#l00038">NnetTrainerOptions::momentum</a>, <a class="el" href="nnet-training_8h_source.html#l00211">NnetTrainer::nnet_</a>, <a class="el" href="nnet-training_8h_source.html#l00224">NnetTrainer::num_max_change_global_applied_</a>, <a class="el" href="nnet-training_8h_source.html#l00223">NnetTrainer::num_max_change_per_component_applied_</a>, <a class="el" href="nnet-training_8cc_source.html#l00192">NnetTrainer::ProcessOutputs()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00508">NnetComputer::Run()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00527">kaldi::nnet3::ScaleBatchnormStats()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00303">kaldi::nnet3::ScaleNnet()</a>, and <a class="el" href="nnet-utils_8cc_source.html#l02013">kaldi::nnet3::UpdateNnetWithMaxChange()</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-training_8cc_source.html#l00059">NnetTrainer::Train()</a>.</p>
<div class="fragment"><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                                                                    {</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="comment">// note: because we give the 1st arg (nnet_) as a pointer to the</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="comment">// constructor of &#39;computer&#39;, it will use that copy of the nnet to</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">// store stats.</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  NnetComputer computer(<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a4493f40ffdbde20bcfbf81716ae74d01">compute_config</a>, computation,</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                        <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>, <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a066d19bab97676c8c6910e9c98d8008b">delta_nnet_</a>);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="comment">// give the inputs to the computer object.</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  computer.AcceptInputs(*<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>, eg.io);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  computer.Run();</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  this-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a150ac242bbed448bc9a90d6df485023e">ProcessOutputs</a>(<span class="keyword">false</span>, eg, &amp;computer);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  computer.Run();</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="comment">// If relevant, add in the part of the gradient that comes from L2</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="comment">// regularization.</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a5240f2d016ad928b0034835c77f5b2cb">ApplyL2Regularization</a>(*<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>,</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                        <a class="code" href="namespacekaldi_1_1nnet3.html#a433fdafbe9ea5093a2742b5451ba674f">GetNumNvalues</a>(eg.io, <span class="keyword">false</span>) * <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#ae609859aca85e8e01335caebf4c2a558">l2_regularize_factor</a>,</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                        <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a066d19bab97676c8c6910e9c98d8008b">delta_nnet_</a>);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="comment">// Update the parameters of nnet</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordtype">bool</span> success = <a class="code" href="namespacekaldi_1_1nnet3.html#a1386d6c6a6d3e9bd00fed536d63cb847">UpdateNnetWithMaxChange</a>(*<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a066d19bab97676c8c6910e9c98d8008b">delta_nnet_</a>, <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#aa308f26d8c7993f163da1c6d4159e86f">max_param_change</a>,</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      1.0, 1.0 - <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#aefc49bfa70545c9f199ef57bad5ef3c9">momentum</a>, <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>,</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      &amp;<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ad23f9ac031cfabb9f57e14ab2f410a70">num_max_change_per_component_applied_</a>, &amp;<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#aae354c2b143a8dad295c45027860765b">num_max_change_global_applied_</a>);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="comment">// Scale down the batchnorm stats (keeps them fresh... this affects what</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="comment">// happens when we use the model with batchnorm test-mode set).</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a40f1b6df80b7997a8958d2672c40b05c">ScaleBatchnormStats</a>(<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a09f7f723ff480286b19e9f75ecd5071b">batchnorm_stats_scale</a>, <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="comment">// The following will only do something if we have a LinearComponent</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="comment">// or AffineComponent with orthonormal-constraint set to a nonzero value.</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a8f170223a0b8d8f515dbc03279e78a4a">ConstrainOrthonormal</a>(<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="comment">// Scale deta_nnet</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordflow">if</span> (success)</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a62b3a3e7be6ebc2a2af34bdb347ec76a">ScaleNnet</a>(<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#aefc49bfa70545c9f199ef57bad5ef3c9">momentum</a>, <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a066d19bab97676c8c6910e9c98d8008b">delta_nnet_</a>);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a62b3a3e7be6ebc2a2af34bdb347ec76a">ScaleNnet</a>(0.0, <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a066d19bab97676c8c6910e9c98d8008b">delta_nnet_</a>);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;}</div><div class="ttc" id="namespacekaldi_1_1nnet3_html_a62b3a3e7be6ebc2a2af34bdb347ec76a"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a62b3a3e7be6ebc2a2af34bdb347ec76a">kaldi::nnet3::ScaleNnet</a></div><div class="ttdeci">void ScaleNnet(BaseFloat scale, Nnet *nnet)</div><div class="ttdoc">Scales the nnet parameters and stats by this scale. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00303">nnet-utils.cc:303</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_ad23f9ac031cfabb9f57e14ab2f410a70"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ad23f9ac031cfabb9f57e14ab2f410a70">kaldi::nnet3::NnetTrainer::num_max_change_per_component_applied_</a></div><div class="ttdeci">std::vector&lt; int32 &gt; num_max_change_per_component_applied_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00223">nnet-training.h:223</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_ae6b2732bea7ce47719f18ad2b06d81d2"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ae6b2732bea7ce47719f18ad2b06d81d2">kaldi::nnet3::NnetTrainer::nnet_</a></div><div class="ttdeci">Nnet * nnet_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00211">nnet-training.h:211</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_a066d19bab97676c8c6910e9c98d8008b"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a066d19bab97676c8c6910e9c98d8008b">kaldi::nnet3::NnetTrainer::delta_nnet_</a></div><div class="ttdeci">Nnet * delta_nnet_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00212">nnet-training.h:212</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a40f1b6df80b7997a8958d2672c40b05c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a40f1b6df80b7997a8958d2672c40b05c">kaldi::nnet3::ScaleBatchnormStats</a></div><div class="ttdeci">void ScaleBatchnormStats(BaseFloat batchnorm_stats_scale, Nnet *nnet)</div><div class="ttdoc">This function scales the batchorm stats of any batchnorm components (components of type BatchNormComp...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00527">nnet-utils.cc:527</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetTrainerOptions_html_ae609859aca85e8e01335caebf4c2a558"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#ae609859aca85e8e01335caebf4c2a558">kaldi::nnet3::NnetTrainerOptions::l2_regularize_factor</a></div><div class="ttdeci">BaseFloat l2_regularize_factor</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00039">nnet-training.h:39</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetTrainerOptions_html_aefc49bfa70545c9f199ef57bad5ef3c9"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#aefc49bfa70545c9f199ef57bad5ef3c9">kaldi::nnet3::NnetTrainerOptions::momentum</a></div><div class="ttdeci">BaseFloat momentum</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00038">nnet-training.h:38</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a8f170223a0b8d8f515dbc03279e78a4a"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a8f170223a0b8d8f515dbc03279e78a4a">kaldi::nnet3::ConstrainOrthonormal</a></div><div class="ttdeci">void ConstrainOrthonormal(Nnet *nnet)</div><div class="ttdoc">This function, to be called after processing every minibatch, is responsible for enforcing the orthog...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l01022">nnet-utils.cc:1022</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a433fdafbe9ea5093a2742b5451ba674f"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a433fdafbe9ea5093a2742b5451ba674f">kaldi::nnet3::GetNumNvalues</a></div><div class="ttdeci">int32 GetNumNvalues(const std::vector&lt; NnetIo &gt; &amp;io_vec, bool exhaustive)</div><div class="ttdoc">This utility function can be used to obtain the number of distinct &amp;#39;n&amp;#39; values in a training example...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l02105">nnet-utils.cc:2105</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a5240f2d016ad928b0034835c77f5b2cb"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a5240f2d016ad928b0034835c77f5b2cb">kaldi::nnet3::ApplyL2Regularization</a></div><div class="ttdeci">void ApplyL2Regularization(const Nnet &amp;nnet, BaseFloat l2_regularize_scale, Nnet *delta_nnet)</div><div class="ttdoc">This function is used as part of the regular training workflow, prior to UpdateNnetWithMaxChange(). </div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l02151">nnet-utils.cc:2151</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_a70dbc9bfde10a7aa389b8a8114e41e74"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">kaldi::nnet3::NnetTrainer::config_</a></div><div class="ttdeci">const NnetTrainerOptions config_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00210">nnet-training.h:210</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetTrainerOptions_html_aa308f26d8c7993f163da1c6d4159e86f"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#aa308f26d8c7993f163da1c6d4159e86f">kaldi::nnet3::NnetTrainerOptions::max_param_change</a></div><div class="ttdeci">BaseFloat max_param_change</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00046">nnet-training.h:46</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetTrainerOptions_html_a4493f40ffdbde20bcfbf81716ae74d01"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a4493f40ffdbde20bcfbf81716ae74d01">kaldi::nnet3::NnetTrainerOptions::compute_config</a></div><div class="ttdeci">NnetComputeOptions compute_config</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00048">nnet-training.h:48</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetTrainerOptions_html_a09f7f723ff480286b19e9f75ecd5071b"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a09f7f723ff480286b19e9f75ecd5071b">kaldi::nnet3::NnetTrainerOptions::batchnorm_stats_scale</a></div><div class="ttdeci">BaseFloat batchnorm_stats_scale</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00042">nnet-training.h:42</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_aae354c2b143a8dad295c45027860765b"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#aae354c2b143a8dad295c45027860765b">kaldi::nnet3::NnetTrainer::num_max_change_global_applied_</a></div><div class="ttdeci">int32 num_max_change_global_applied_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00224">nnet-training.h:224</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a1386d6c6a6d3e9bd00fed536d63cb847"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a1386d6c6a6d3e9bd00fed536d63cb847">kaldi::nnet3::UpdateNnetWithMaxChange</a></div><div class="ttdeci">bool UpdateNnetWithMaxChange(const Nnet &amp;delta_nnet, BaseFloat max_param_change, BaseFloat max_change_scale, BaseFloat scale, Nnet *nnet, std::vector&lt; int32 &gt; *num_max_change_per_component_applied, int32 *num_max_change_global_applied)</div><div class="ttdoc">This function does the operation &amp;#39;*nnet += scale * delta_nnet&amp;#39;, while respecting any max-parameter-ch...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l02013">nnet-utils.cc:2013</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_a150ac242bbed448bc9a90d6df485023e"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a150ac242bbed448bc9a90d6df485023e">kaldi::nnet3::NnetTrainer::ProcessOutputs</a></div><div class="ttdeci">void ProcessOutputs(bool is_backstitch_step2, const NnetExample &amp;eg, NnetComputer *computer)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8cc_source.html#l00192">nnet-training.cc:192</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5672aa8ecefb855b96d43521adfe23f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5672aa8ecefb855b96d43521adfe23f9">&#9670;&nbsp;</a></span>TrainInternalBackstitch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void TrainInternalBackstitch </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &amp;&#160;</td>
          <td class="paramname"><em>eg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> &amp;&#160;</td>
          <td class="paramname"><em>computation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>is_backstitch_step1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-training_8cc_source.html#l00133">133</a> of file <a class="el" href="nnet-training_8cc_source.html">nnet-training.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00658">NnetComputer::AcceptInputs()</a>, <a class="el" href="nnet-utils_8cc_source.html#l02151">kaldi::nnet3::ApplyL2Regularization()</a>, <a class="el" href="nnet-training_8h_source.html#l00040">NnetTrainerOptions::backstitch_training_scale</a>, <a class="el" href="nnet-training_8h_source.html#l00042">NnetTrainerOptions::batchnorm_stats_scale</a>, <a class="el" href="nnet-training_8h_source.html#l00048">NnetTrainerOptions::compute_config</a>, <a class="el" href="nnet-training_8h_source.html#l00210">NnetTrainer::config_</a>, <a class="el" href="nnet-utils_8cc_source.html#l01022">kaldi::nnet3::ConstrainOrthonormal()</a>, <a class="el" href="nnet-training_8h_source.html#l00212">NnetTrainer::delta_nnet_</a>, <a class="el" href="nnet-utils_8cc_source.html#l02105">kaldi::nnet3::GetNumNvalues()</a>, <a class="el" href="nnet3_2nnet-example_8h_source.html#l00116">NnetExample::io</a>, <a class="el" href="nnet-training_8h_source.html#l00039">NnetTrainerOptions::l2_regularize_factor</a>, <a class="el" href="nnet-training_8h_source.html#l00046">NnetTrainerOptions::max_param_change</a>, <a class="el" href="nnet-training_8h_source.html#l00211">NnetTrainer::nnet_</a>, <a class="el" href="nnet-training_8h_source.html#l00224">NnetTrainer::num_max_change_global_applied_</a>, <a class="el" href="nnet-training_8h_source.html#l00223">NnetTrainer::num_max_change_per_component_applied_</a>, <a class="el" href="nnet-training_8cc_source.html#l00192">NnetTrainer::ProcessOutputs()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00508">NnetComputer::Run()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00527">kaldi::nnet3::ScaleBatchnormStats()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00303">kaldi::nnet3::ScaleNnet()</a>, and <a class="el" href="nnet-utils_8cc_source.html#l02013">kaldi::nnet3::UpdateNnetWithMaxChange()</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-training_8cc_source.html#l00059">NnetTrainer::Train()</a>.</p>
<div class="fragment"><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                                                                    {</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="comment">// note: because we give the 1st arg (nnet_) as a pointer to the</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="comment">// constructor of &#39;computer&#39;, it will use that copy of the nnet to</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="comment">// store stats.</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  NnetComputer computer(<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a4493f40ffdbde20bcfbf81716ae74d01">compute_config</a>, computation,</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                        <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>, <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a066d19bab97676c8c6910e9c98d8008b">delta_nnet_</a>);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="comment">// give the inputs to the computer object.</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  computer.AcceptInputs(*<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>, eg.io);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  computer.Run();</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordtype">bool</span> is_backstitch_step2 = !is_backstitch_step1;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  this-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a150ac242bbed448bc9a90d6df485023e">ProcessOutputs</a>(is_backstitch_step2, eg, &amp;computer);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  computer.Run();</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> max_change_scale, scale_adding;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordflow">if</span> (is_backstitch_step1) {</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">// max-change is scaled by backstitch_training_scale;</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">// delta_nnet is scaled by -backstitch_training_scale when added to nnet;</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    max_change_scale = <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a5041066d06d6652098df5bc8a4ff3d77">backstitch_training_scale</a>;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    scale_adding = -<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a5041066d06d6652098df5bc8a4ff3d77">backstitch_training_scale</a>;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">// max-change is scaled by 1 +  backstitch_training_scale;</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// delta_nnet is scaled by 1 + backstitch_training_scale when added to nnet;</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    max_change_scale = 1.0 + <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a5041066d06d6652098df5bc8a4ff3d77">backstitch_training_scale</a>;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    scale_adding = 1.0 + <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a5041066d06d6652098df5bc8a4ff3d77">backstitch_training_scale</a>;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">// If relevant, add in the part of the gradient that comes from L2</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">// regularization.  It may not be optimally inefficient to do it on both</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">// passes of the backstitch, like we do here, but it probably minimizes</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">// any harmful interactions with the max-change.</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a5240f2d016ad928b0034835c77f5b2cb">ApplyL2Regularization</a>(*<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>,</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                          1.0 / scale_adding * <a class="code" href="namespacekaldi_1_1nnet3.html#a433fdafbe9ea5093a2742b5451ba674f">GetNumNvalues</a>(eg.io, <span class="keyword">false</span>) *</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                          <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#ae609859aca85e8e01335caebf4c2a558">l2_regularize_factor</a>, <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a066d19bab97676c8c6910e9c98d8008b">delta_nnet_</a>);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="comment">// Updates the parameters of nnet</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a1386d6c6a6d3e9bd00fed536d63cb847">UpdateNnetWithMaxChange</a>(*<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a066d19bab97676c8c6910e9c98d8008b">delta_nnet_</a>, <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#aa308f26d8c7993f163da1c6d4159e86f">max_param_change</a>,</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      max_change_scale, scale_adding, <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>,</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      &amp;<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ad23f9ac031cfabb9f57e14ab2f410a70">num_max_change_per_component_applied_</a>, &amp;<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#aae354c2b143a8dad295c45027860765b">num_max_change_global_applied_</a>);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordflow">if</span> (is_backstitch_step1) {</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">// The following will only do something if we have a LinearComponent or</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">// AffineComponent with orthonormal-constraint set to a nonzero value. We</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">// choose to do this only on the 1st backstitch step, for efficiency.</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a8f170223a0b8d8f515dbc03279e78a4a">ConstrainOrthonormal</a>(<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  }</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keywordflow">if</span> (!is_backstitch_step1) {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">// Scale down the batchnorm stats (keeps them fresh... this affects what</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">// happens when we use the model with batchnorm test-mode set).  Do this</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">// after backstitch step 2 so that the stats are scaled down before we start</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">// the next minibatch.</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a40f1b6df80b7997a8958d2672c40b05c">ScaleBatchnormStats</a>(<a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">config_</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a09f7f723ff480286b19e9f75ecd5071b">batchnorm_stats_scale</a>, <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ae6b2732bea7ce47719f18ad2b06d81d2">nnet_</a>);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  }</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a62b3a3e7be6ebc2a2af34bdb347ec76a">ScaleNnet</a>(0.0, <a class="code" href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a066d19bab97676c8c6910e9c98d8008b">delta_nnet_</a>);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;}</div><div class="ttc" id="namespacekaldi_1_1nnet3_html_a62b3a3e7be6ebc2a2af34bdb347ec76a"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a62b3a3e7be6ebc2a2af34bdb347ec76a">kaldi::nnet3::ScaleNnet</a></div><div class="ttdeci">void ScaleNnet(BaseFloat scale, Nnet *nnet)</div><div class="ttdoc">Scales the nnet parameters and stats by this scale. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00303">nnet-utils.cc:303</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_ad23f9ac031cfabb9f57e14ab2f410a70"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ad23f9ac031cfabb9f57e14ab2f410a70">kaldi::nnet3::NnetTrainer::num_max_change_per_component_applied_</a></div><div class="ttdeci">std::vector&lt; int32 &gt; num_max_change_per_component_applied_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00223">nnet-training.h:223</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_ae6b2732bea7ce47719f18ad2b06d81d2"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#ae6b2732bea7ce47719f18ad2b06d81d2">kaldi::nnet3::NnetTrainer::nnet_</a></div><div class="ttdeci">Nnet * nnet_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00211">nnet-training.h:211</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_a066d19bab97676c8c6910e9c98d8008b"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a066d19bab97676c8c6910e9c98d8008b">kaldi::nnet3::NnetTrainer::delta_nnet_</a></div><div class="ttdeci">Nnet * delta_nnet_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00212">nnet-training.h:212</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a40f1b6df80b7997a8958d2672c40b05c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a40f1b6df80b7997a8958d2672c40b05c">kaldi::nnet3::ScaleBatchnormStats</a></div><div class="ttdeci">void ScaleBatchnormStats(BaseFloat batchnorm_stats_scale, Nnet *nnet)</div><div class="ttdoc">This function scales the batchorm stats of any batchnorm components (components of type BatchNormComp...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00527">nnet-utils.cc:527</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetTrainerOptions_html_ae609859aca85e8e01335caebf4c2a558"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#ae609859aca85e8e01335caebf4c2a558">kaldi::nnet3::NnetTrainerOptions::l2_regularize_factor</a></div><div class="ttdeci">BaseFloat l2_regularize_factor</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00039">nnet-training.h:39</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a8f170223a0b8d8f515dbc03279e78a4a"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a8f170223a0b8d8f515dbc03279e78a4a">kaldi::nnet3::ConstrainOrthonormal</a></div><div class="ttdeci">void ConstrainOrthonormal(Nnet *nnet)</div><div class="ttdoc">This function, to be called after processing every minibatch, is responsible for enforcing the orthog...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l01022">nnet-utils.cc:1022</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a433fdafbe9ea5093a2742b5451ba674f"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a433fdafbe9ea5093a2742b5451ba674f">kaldi::nnet3::GetNumNvalues</a></div><div class="ttdeci">int32 GetNumNvalues(const std::vector&lt; NnetIo &gt; &amp;io_vec, bool exhaustive)</div><div class="ttdoc">This utility function can be used to obtain the number of distinct &amp;#39;n&amp;#39; values in a training example...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l02105">nnet-utils.cc:2105</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a5240f2d016ad928b0034835c77f5b2cb"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a5240f2d016ad928b0034835c77f5b2cb">kaldi::nnet3::ApplyL2Regularization</a></div><div class="ttdeci">void ApplyL2Regularization(const Nnet &amp;nnet, BaseFloat l2_regularize_scale, Nnet *delta_nnet)</div><div class="ttdoc">This function is used as part of the regular training workflow, prior to UpdateNnetWithMaxChange(). </div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l02151">nnet-utils.cc:2151</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_a70dbc9bfde10a7aa389b8a8114e41e74"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a70dbc9bfde10a7aa389b8a8114e41e74">kaldi::nnet3::NnetTrainer::config_</a></div><div class="ttdeci">const NnetTrainerOptions config_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00210">nnet-training.h:210</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetTrainerOptions_html_aa308f26d8c7993f163da1c6d4159e86f"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#aa308f26d8c7993f163da1c6d4159e86f">kaldi::nnet3::NnetTrainerOptions::max_param_change</a></div><div class="ttdeci">BaseFloat max_param_change</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00046">nnet-training.h:46</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetTrainerOptions_html_a4493f40ffdbde20bcfbf81716ae74d01"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a4493f40ffdbde20bcfbf81716ae74d01">kaldi::nnet3::NnetTrainerOptions::compute_config</a></div><div class="ttdeci">NnetComputeOptions compute_config</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00048">nnet-training.h:48</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetTrainerOptions_html_a5041066d06d6652098df5bc8a4ff3d77"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a5041066d06d6652098df5bc8a4ff3d77">kaldi::nnet3::NnetTrainerOptions::backstitch_training_scale</a></div><div class="ttdeci">BaseFloat backstitch_training_scale</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00040">nnet-training.h:40</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetTrainerOptions_html_a09f7f723ff480286b19e9f75ecd5071b"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html#a09f7f723ff480286b19e9f75ecd5071b">kaldi::nnet3::NnetTrainerOptions::batchnorm_stats_scale</a></div><div class="ttdeci">BaseFloat batchnorm_stats_scale</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00042">nnet-training.h:42</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_aae354c2b143a8dad295c45027860765b"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#aae354c2b143a8dad295c45027860765b">kaldi::nnet3::NnetTrainer::num_max_change_global_applied_</a></div><div class="ttdeci">int32 num_max_change_global_applied_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8h_source.html#l00224">nnet-training.h:224</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a1386d6c6a6d3e9bd00fed536d63cb847"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a1386d6c6a6d3e9bd00fed536d63cb847">kaldi::nnet3::UpdateNnetWithMaxChange</a></div><div class="ttdeci">bool UpdateNnetWithMaxChange(const Nnet &amp;delta_nnet, BaseFloat max_param_change, BaseFloat max_change_scale, BaseFloat scale, Nnet *nnet, std::vector&lt; int32 &gt; *num_max_change_per_component_applied, int32 *num_max_change_global_applied)</div><div class="ttdoc">This function does the operation &amp;#39;*nnet += scale * delta_nnet&amp;#39;, while respecting any max-parameter-ch...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l02013">nnet-utils.cc:2013</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetTrainer_html_a150ac242bbed448bc9a90d6df485023e"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#a150ac242bbed448bc9a90d6df485023e">kaldi::nnet3::NnetTrainer::ProcessOutputs</a></div><div class="ttdeci">void ProcessOutputs(bool is_backstitch_step2, const NnetExample &amp;eg, NnetComputer *computer)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-training_8cc_source.html#l00192">nnet-training.cc:192</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="acc1c4c518295918abed6546cfd7f065f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc1c4c518295918abed6546cfd7f065f">&#9670;&nbsp;</a></span>compiler_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1nnet3_1_1CachingOptimizingCompiler.html">CachingOptimizingCompiler</a> compiler_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-training_8h_source.html#l00215">215</a> of file <a class="el" href="nnet-training_8h_source.html">nnet-training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-training_8cc_source.html#l00027">NnetTrainer::NnetTrainer()</a>, <a class="el" href="nnet-training_8cc_source.html#l00059">NnetTrainer::Train()</a>, and <a class="el" href="nnet-training_8cc_source.html#l00361">NnetTrainer::~NnetTrainer()</a>.</p>

</div>
</div>
<a id="a70dbc9bfde10a7aa389b8a8114e41e74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70dbc9bfde10a7aa389b8a8114e41e74">&#9670;&nbsp;</a></span>config_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html">NnetTrainerOptions</a> config_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-training_8h_source.html#l00210">210</a> of file <a class="el" href="nnet-training_8h_source.html">nnet-training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-training_8cc_source.html#l00027">NnetTrainer::NnetTrainer()</a>, <a class="el" href="nnet-training_8cc_source.html#l00243">NnetTrainer::PrintMaxChangeStats()</a>, <a class="el" href="nnet-training_8cc_source.html#l00192">NnetTrainer::ProcessOutputs()</a>, <a class="el" href="nnet-training_8cc_source.html#l00059">NnetTrainer::Train()</a>, <a class="el" href="nnet-training_8cc_source.html#l00093">NnetTrainer::TrainInternal()</a>, <a class="el" href="nnet-training_8cc_source.html#l00133">NnetTrainer::TrainInternalBackstitch()</a>, and <a class="el" href="nnet-training_8cc_source.html#l00361">NnetTrainer::~NnetTrainer()</a>.</p>

</div>
</div>
<a id="a066d19bab97676c8c6910e9c98d8008b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a066d19bab97676c8c6910e9c98d8008b">&#9670;&nbsp;</a></span>delta_nnet_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a>* delta_nnet_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-training_8h_source.html#l00212">212</a> of file <a class="el" href="nnet-training_8h_source.html">nnet-training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-training_8cc_source.html#l00027">NnetTrainer::NnetTrainer()</a>, <a class="el" href="nnet-training_8cc_source.html#l00243">NnetTrainer::PrintMaxChangeStats()</a>, <a class="el" href="nnet-training_8cc_source.html#l00059">NnetTrainer::Train()</a>, <a class="el" href="nnet-training_8cc_source.html#l00093">NnetTrainer::TrainInternal()</a>, <a class="el" href="nnet-training_8cc_source.html#l00133">NnetTrainer::TrainInternalBackstitch()</a>, and <a class="el" href="nnet-training_8cc_source.html#l00361">NnetTrainer::~NnetTrainer()</a>.</p>

</div>
</div>
<a id="ae6b2732bea7ce47719f18ad2b06d81d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6b2732bea7ce47719f18ad2b06d81d2">&#9670;&nbsp;</a></span>nnet_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a>* nnet_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-training_8h_source.html#l00211">211</a> of file <a class="el" href="nnet-training_8h_source.html">nnet-training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-training_8cc_source.html#l00027">NnetTrainer::NnetTrainer()</a>, <a class="el" href="nnet-training_8cc_source.html#l00192">NnetTrainer::ProcessOutputs()</a>, <a class="el" href="nnet-training_8cc_source.html#l00059">NnetTrainer::Train()</a>, <a class="el" href="nnet-training_8cc_source.html#l00093">NnetTrainer::TrainInternal()</a>, and <a class="el" href="nnet-training_8cc_source.html#l00133">NnetTrainer::TrainInternalBackstitch()</a>.</p>

</div>
</div>
<a id="aae354c2b143a8dad295c45027860765b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae354c2b143a8dad295c45027860765b">&#9670;&nbsp;</a></span>num_max_change_global_applied_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 num_max_change_global_applied_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-training_8h_source.html#l00224">224</a> of file <a class="el" href="nnet-training_8h_source.html">nnet-training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-training_8cc_source.html#l00027">NnetTrainer::NnetTrainer()</a>, <a class="el" href="nnet-training_8cc_source.html#l00243">NnetTrainer::PrintMaxChangeStats()</a>, <a class="el" href="nnet-training_8cc_source.html#l00093">NnetTrainer::TrainInternal()</a>, and <a class="el" href="nnet-training_8cc_source.html#l00133">NnetTrainer::TrainInternalBackstitch()</a>.</p>

</div>
</div>
<a id="ad23f9ac031cfabb9f57e14ab2f410a70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad23f9ac031cfabb9f57e14ab2f410a70">&#9670;&nbsp;</a></span>num_max_change_per_component_applied_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int32&gt; num_max_change_per_component_applied_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-training_8h_source.html#l00223">223</a> of file <a class="el" href="nnet-training_8h_source.html">nnet-training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-training_8cc_source.html#l00027">NnetTrainer::NnetTrainer()</a>, <a class="el" href="nnet-training_8cc_source.html#l00243">NnetTrainer::PrintMaxChangeStats()</a>, <a class="el" href="nnet-training_8cc_source.html#l00093">NnetTrainer::TrainInternal()</a>, and <a class="el" href="nnet-training_8cc_source.html#l00133">NnetTrainer::TrainInternalBackstitch()</a>.</p>

</div>
</div>
<a id="af676d295ba780873405747474e9f28aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af676d295ba780873405747474e9f28aa">&#9670;&nbsp;</a></span>num_minibatches_processed_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 num_minibatches_processed_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-training_8h_source.html#l00220">220</a> of file <a class="el" href="nnet-training_8h_source.html">nnet-training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-training_8cc_source.html#l00243">NnetTrainer::PrintMaxChangeStats()</a>, <a class="el" href="nnet-training_8cc_source.html#l00192">NnetTrainer::ProcessOutputs()</a>, and <a class="el" href="nnet-training_8cc_source.html#l00059">NnetTrainer::Train()</a>.</p>

</div>
</div>
<a id="a855a05d0c2cac564dba34eb4ed0b6c75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a855a05d0c2cac564dba34eb4ed0b6c75">&#9670;&nbsp;</a></span>objf_info_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unordered_map&lt;std::string, <a class="el" href="structkaldi_1_1nnet3_1_1ObjectiveFunctionInfo.html">ObjectiveFunctionInfo</a>, <a class="el" href="structkaldi_1_1StringHasher.html">StringHasher</a>&gt; objf_info_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-training_8h_source.html#l00226">226</a> of file <a class="el" href="nnet-training_8h_source.html">nnet-training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-training_8cc_source.html#l00221">NnetTrainer::PrintTotalStats()</a>, and <a class="el" href="nnet-training_8cc_source.html#l00192">NnetTrainer::ProcessOutputs()</a>.</p>

</div>
</div>
<a id="a15f099307d268e10568df4612a52c8c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15f099307d268e10568df4612a52c8c5">&#9670;&nbsp;</a></span>srand_seed_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 srand_seed_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-training_8h_source.html#l00231">231</a> of file <a class="el" href="nnet-training_8h_source.html">nnet-training.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-training_8cc_source.html#l00059">NnetTrainer::Train()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>nnet3/<a class="el" href="nnet-training_8h_source.html">nnet-training.h</a></li>
<li>nnet3/<a class="el" href="nnet-training_8cc_source.html">nnet-training.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacekaldi.html">kaldi</a></li><li class="navelem"><a class="el" href="namespacekaldi_1_1nnet3.html">nnet3</a></li><li class="navelem"><a class="el" href="classkaldi_1_1nnet3_1_1NnetTrainer.html">NnetTrainer</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
