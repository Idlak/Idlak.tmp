<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Kaldi: GrammarFst Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" /> 
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
 <td id="projectlogo"><a href="http://kaldi-asr.org/"><img alt="Logo" src="KaldiTextAndLogoSmall.png"/ style="padding: 3px 5px 1px 5px"></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname" style="display:none">Kaldi
   </div>
  </td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief" style="display:none"></div>
    </td>
   <!--END PROJECT_BRIEF-->
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classfst_1_1GrammarFst.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classfst_1_1GrammarFst-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">GrammarFst Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classfst_1_1GrammarFst.html" title="GrammarFst is an FST that is &#39;stitched together&#39; from multiple FSTs, that can recursively incorporate...">GrammarFst</a> is an FST that is 'stitched together' from multiple FSTs, that can recursively incorporate each other.  
 <a href="classfst_1_1GrammarFst.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="grammar-fst_8h_source.html">grammar-fst.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for GrammarFst:</div>
<div class="dyncontent">
<div class="center"><img src="classfst_1_1GrammarFst__coll__graph.png" border="0" usemap="#GrammarFst_coll__map" alt="Collaboration graph"/></div>
<map name="GrammarFst_coll__map" id="GrammarFst_coll__map">
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfst_1_1GrammarFst_1_1ExpandedState.html">ExpandedState</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents an expanded state in an <a class="el" href="structfst_1_1GrammarFst_1_1FstInstance.html">FstInstance</a>.  <a href="structfst_1_1GrammarFst_1_1ExpandedState.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfst_1_1GrammarFst_1_1FstInstance.html">FstInstance</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:ac51460b0e5a4b5bc6e67fc6bf0561439"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="structfst_1_1GrammarFstArc.html">GrammarFstArc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#ac51460b0e5a4b5bc6e67fc6bf0561439">Arc</a></td></tr>
<tr class="separator:ac51460b0e5a4b5bc6e67fc6bf0561439"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a302a4d2fc21b3024edccaf18ef1604f1"><td class="memItemLeft" align="right" valign="top">typedef TropicalWeight&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#a302a4d2fc21b3024edccaf18ef1604f1">Weight</a></td></tr>
<tr class="separator:a302a4d2fc21b3024edccaf18ef1604f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ace4c191c83fe28b57d4d080ae967b0"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="structfst_1_1GrammarFstArc.html#a875b746461472785be87ec24826ff874">Arc::StateId</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#a4ace4c191c83fe28b57d4d080ae967b0">StateId</a></td></tr>
<tr class="separator:a4ace4c191c83fe28b57d4d080ae967b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8086078c61f5b3c4959476d0a59c2836"><td class="memItemLeft" align="right" valign="top">typedef StdArc::StateId&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#a8086078c61f5b3c4959476d0a59c2836">BaseStateId</a></td></tr>
<tr class="separator:a8086078c61f5b3c4959476d0a59c2836"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b4305fe971ea965a741395013fd9c49"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="structfst_1_1GrammarFstArc.html#a32e4ee538ce0d6ce57e587fd2179ca1b">Arc::Label</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#a8b4305fe971ea965a741395013fd9c49">Label</a></td></tr>
<tr class="separator:a8b4305fe971ea965a741395013fd9c49"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a4c83ce76130a15c55e87f9b64afdb72e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#a4c83ce76130a15c55e87f9b64afdb72e">GrammarFst</a> (int32 nonterm_phones_offset, const ConstFst&lt; <a class="el" href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">StdArc</a> &gt; &amp;top_fst, const std::vector&lt; std::pair&lt; int32, const ConstFst&lt; <a class="el" href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">StdArc</a> &gt; *&gt; &gt; &amp;ifsts)</td></tr>
<tr class="memdesc:a4c83ce76130a15c55e87f9b64afdb72e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a4c83ce76130a15c55e87f9b64afdb72e">More...</a><br /></td></tr>
<tr class="separator:a4c83ce76130a15c55e87f9b64afdb72e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d2feaf3dcb4c627e7c4c7ae0c1d2a56"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#a0d2feaf3dcb4c627e7c4c7ae0c1d2a56">GrammarFst</a> ()</td></tr>
<tr class="memdesc:a0d2feaf3dcb4c627e7c4c7ae0c1d2a56"><td class="mdescLeft">&#160;</td><td class="mdescRight">This constructor should only be used prior to calling <a class="el" href="classfst_1_1GrammarFst.html#ae2892c501e401b523a3eb774e735d64d">Read()</a>.  <a href="#a0d2feaf3dcb4c627e7c4c7ae0c1d2a56">More...</a><br /></td></tr>
<tr class="separator:a0d2feaf3dcb4c627e7c4c7ae0c1d2a56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68f354fd5f096134162f01719096e6fc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#a68f354fd5f096134162f01719096e6fc">Write</a> (std::ostream &amp;os, <a class="el" href="classbool.html">bool</a> binary) const</td></tr>
<tr class="separator:a68f354fd5f096134162f01719096e6fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2892c501e401b523a3eb774e735d64d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#ae2892c501e401b523a3eb774e735d64d">Read</a> (std::istream &amp;os, <a class="el" href="classbool.html">bool</a> binary)</td></tr>
<tr class="separator:ae2892c501e401b523a3eb774e735d64d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a505ff365f90ab7b3851c6c531ad772c2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfst_1_1GrammarFst.html#a4ace4c191c83fe28b57d4d080ae967b0">StateId</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#a505ff365f90ab7b3851c6c531ad772c2">Start</a> () const</td></tr>
<tr class="separator:a505ff365f90ab7b3851c6c531ad772c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abac0d92668ae11c078d86c557a9217c9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfst_1_1GrammarFst.html#a302a4d2fc21b3024edccaf18ef1604f1">Weight</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#abac0d92668ae11c078d86c557a9217c9">Final</a> (<a class="el" href="classfst_1_1GrammarFst.html#a4ace4c191c83fe28b57d4d080ae967b0">StateId</a> s) const</td></tr>
<tr class="separator:abac0d92668ae11c078d86c557a9217c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa50b206fd7185396de5c158d7f2564cb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classsize__t.html">size_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#aa50b206fd7185396de5c158d7f2564cb">NumInputEpsilons</a> (<a class="el" href="classfst_1_1GrammarFst.html#a4ace4c191c83fe28b57d4d080ae967b0">StateId</a> s) const</td></tr>
<tr class="separator:aa50b206fd7185396de5c158d7f2564cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9261b9326e20a8d1f6a9be72c1ad66db"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#a9261b9326e20a8d1f6a9be72c1ad66db">Type</a> () const</td></tr>
<tr class="separator:a9261b9326e20a8d1f6a9be72c1ad66db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcde49f68292e807c903f4a577a21dfc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#afcde49f68292e807c903f4a577a21dfc">~GrammarFst</a> ()</td></tr>
<tr class="separator:afcde49f68292e807c903f4a577a21dfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a8ad20dddb56f73904c0d427e51f2eb4f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#a8ad20dddb56f73904c0d427e51f2eb4f">InitNonterminalMap</a> ()</td></tr>
<tr class="separator:a8ad20dddb56f73904c0d427e51f2eb4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98a1bd90bcd088e6a889a7e61ce4a99b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#a98a1bd90bcd088e6a889a7e61ce4a99b">InitEntryArcs</a> (int32 i)</td></tr>
<tr class="separator:a98a1bd90bcd088e6a889a7e61ce4a99b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2aa0f8fd6325fdede2bca6d013a2f29"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#af2aa0f8fd6325fdede2bca6d013a2f29">InitInstances</a> ()</td></tr>
<tr class="separator:af2aa0f8fd6325fdede2bca6d013a2f29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e3b6d38df0786ccf7f938d60e386aae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#a1e3b6d38df0786ccf7f938d60e386aae">Init</a> ()</td></tr>
<tr class="separator:a1e3b6d38df0786ccf7f938d60e386aae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac919a991060ede6983343719401686de"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#ac919a991060ede6983343719401686de">Destroy</a> ()</td></tr>
<tr class="separator:ac919a991060ede6983343719401686de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a0814345f5aa1ad5ada7b9a4439124b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#a9a0814345f5aa1ad5ada7b9a4439124b">InitEntryOrReentryArcs</a> (const ConstFst&lt; <a class="el" href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">StdArc</a> &gt; &amp;fst, int32 entry_state, int32 nonterminal_symbol, std::unordered_map&lt; int32, int32 &gt; *phone_to_arc)</td></tr>
<tr class="separator:a9a0814345f5aa1ad5ada7b9a4439124b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbdafb790b8c9a3c39f7880b8d64136d"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#adbdafb790b8c9a3c39f7880b8d64136d">GetPhoneSymbolFor</a> (enum <a class="el" href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2">NonterminalValues</a> n)</td></tr>
<tr class="separator:adbdafb790b8c9a3c39f7880b8d64136d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9956a77f3a82dfddc07f7ee649d07bc4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#a9956a77f3a82dfddc07f7ee649d07bc4">DecodeSymbol</a> (<a class="el" href="classfst_1_1GrammarFst.html#a8b4305fe971ea965a741395013fd9c49">Label</a> label, int32 *nonterminal_symbol, int32 *left_context_phone)</td></tr>
<tr class="memdesc:a9956a77f3a82dfddc07f7ee649d07bc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decodes an ilabel into a pair (nonterminal, left_context_phone).  <a href="#a9956a77f3a82dfddc07f7ee649d07bc4">More...</a><br /></td></tr>
<tr class="separator:a9956a77f3a82dfddc07f7ee649d07bc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a8a892a0794d0cefabeec2a8860d4dc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfst_1_1GrammarFst_1_1ExpandedState.html">ExpandedState</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#a2a8a892a0794d0cefabeec2a8860d4dc">ExpandState</a> (int32 instance_id, <a class="el" href="classfst_1_1GrammarFst.html#a8086078c61f5b3c4959476d0a59c2836">BaseStateId</a> state_id)</td></tr>
<tr class="separator:a2a8a892a0794d0cefabeec2a8860d4dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d2cede02beae2c01ae4ca6cbb6c6086"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfst_1_1GrammarFst_1_1ExpandedState.html">ExpandedState</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#a1d2cede02beae2c01ae4ca6cbb6c6086">ExpandStateEnd</a> (int32 instance_id, <a class="el" href="classfst_1_1GrammarFst.html#a8086078c61f5b3c4959476d0a59c2836">BaseStateId</a> state_id)</td></tr>
<tr class="separator:a1d2cede02beae2c01ae4ca6cbb6c6086"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35bb38a463a02d47426a68faa1584092"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfst_1_1GrammarFst_1_1ExpandedState.html">ExpandedState</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#a35bb38a463a02d47426a68faa1584092">ExpandStateUserDefined</a> (int32 instance_id, <a class="el" href="classfst_1_1GrammarFst.html#a8086078c61f5b3c4959476d0a59c2836">BaseStateId</a> state_id)</td></tr>
<tr class="separator:a35bb38a463a02d47426a68faa1584092"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02544b1df2ed0618053ca21f2188b43f"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#a02544b1df2ed0618053ca21f2188b43f">GetChildInstanceId</a> (int32 instance_id, int32 nonterminal, int32 state)</td></tr>
<tr class="separator:a02544b1df2ed0618053ca21f2188b43f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d457ccb91ac9095428ec77b504bb01c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfst_1_1GrammarFst_1_1ExpandedState.html">ExpandedState</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#a7d457ccb91ac9095428ec77b504bb01c">GetExpandedState</a> (int32 instance_id, <a class="el" href="classfst_1_1GrammarFst.html#a8086078c61f5b3c4959476d0a59c2836">BaseStateId</a> state_id)</td></tr>
<tr class="memdesc:a7d457ccb91ac9095428ec77b504bb01c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called from the ArcIterator constructor when we encounter an FST state with nonzero final-prob, this function first looks up this state_id in 'expanded_states' member of the corresponding <a class="el" href="structfst_1_1GrammarFst_1_1FstInstance.html">FstInstance</a>, and returns it if already present; otherwise it populates the 'expanded_states' map with something for this state_id and returns the value.  <a href="#a7d457ccb91ac9095428ec77b504bb01c">More...</a><br /></td></tr>
<tr class="separator:a7d457ccb91ac9095428ec77b504bb01c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:a799fac4aecf6dc610b3ca2dae19473df"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#a799fac4aecf6dc610b3ca2dae19473df">CombineArcs</a> (const <a class="el" href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">StdArc</a> &amp;leaving_arc, const <a class="el" href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">StdArc</a> &amp;arriving_arc, <a class="el" href="classfloat.html">float</a> cost_correction, <a class="el" href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">StdArc</a> *arc)</td></tr>
<tr class="memdesc:a799fac4aecf6dc610b3ca2dae19473df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called while expanding states, this function combines information from two arcs: one leaving one sub-fst and one arriving in another sub-fst.  <a href="#a799fac4aecf6dc610b3ca2dae19473df">More...</a><br /></td></tr>
<tr class="separator:a799fac4aecf6dc610b3ca2dae19473df"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a56db4c50d7ba7ecdac05db5856374e81"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#a56db4c50d7ba7ecdac05db5856374e81">nonterm_phones_offset_</a></td></tr>
<tr class="separator:a56db4c50d7ba7ecdac05db5856374e81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad68dfecca65ab013329921e1c178b455"><td class="memItemLeft" align="right" valign="top">const ConstFst&lt; <a class="el" href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">StdArc</a> &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#ad68dfecca65ab013329921e1c178b455">top_fst_</a></td></tr>
<tr class="separator:ad68dfecca65ab013329921e1c178b455"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c5eec26f7b7e8d7a4a09f2aeb29ae1f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::pair&lt; int32, const ConstFst&lt; <a class="el" href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">StdArc</a> &gt; * &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#a3c5eec26f7b7e8d7a4a09f2aeb29ae1f">ifsts_</a></td></tr>
<tr class="separator:a3c5eec26f7b7e8d7a4a09f2aeb29ae1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05f1d86c7978348900bb85cc73690a4d"><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; int32, int32 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#a05f1d86c7978348900bb85cc73690a4d">nonterminal_map_</a></td></tr>
<tr class="separator:a05f1d86c7978348900bb85cc73690a4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9de1f012d8b92d4a2d7522abedc9a884"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::unordered_map&lt; int32, int32 &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#a9de1f012d8b92d4a2d7522abedc9a884">entry_arcs_</a></td></tr>
<tr class="separator:a9de1f012d8b92d4a2d7522abedc9a884"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc925c31b57e960b56eb179f9a3cb17b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structfst_1_1GrammarFst_1_1FstInstance.html">FstInstance</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">instances_</a></td></tr>
<tr class="separator:adc925c31b57e960b56eb179f9a3cb17b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad061d7149ef830dd0d7eb4aae390a0fd"><td class="memItemLeft" align="right" valign="top">std::vector&lt; const ConstFst&lt; <a class="el" href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">StdArc</a> &gt; * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#ad061d7149ef830dd0d7eb4aae390a0fd">fsts_to_delete_</a></td></tr>
<tr class="separator:ad061d7149ef830dd0d7eb4aae390a0fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a043d69c81d6e3b54ced0552be5cbc14d"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfst_1_1GrammarFst.html#a043d69c81d6e3b54ced0552be5cbc14d">ArcIterator&lt; GrammarFst &gt;</a></td></tr>
<tr class="separator:a043d69c81d6e3b54ced0552be5cbc14d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classfst_1_1GrammarFst.html" title="GrammarFst is an FST that is &#39;stitched together&#39; from multiple FSTs, that can recursively incorporate...">GrammarFst</a> is an FST that is 'stitched together' from multiple FSTs, that can recursively incorporate each other. </p>
<p>(This is limited to left-biphone phonetic context). This class does not inherit from fst::Fst and does not support its full interface&ndash; only the parts that are necessary for the decoder to work when templated on it.</p>
<p>The basic interface is inspired by OpenFst's 'ReplaceFst' (see its replace.h), except that this handles left-biphone phonetic context, which requires, essentially, having multiple exit-points and entry-points for sub-FSTs that represent nonterminals in the grammar; and multiple return points whenever we invoke a nonterminal. For more information see <a class="el" href="grammar.html">Support for grammars and graphs with on-the-fly parts.</a> (i.e. ../doc/grammar.dox). </p>

<p class="definition">Definition at line <a class="el" href="grammar-fst_8h_source.html#l00091">91</a> of file <a class="el" href="grammar-fst_8h_source.html">grammar-fst.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="ac51460b0e5a4b5bc6e67fc6bf0561439"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac51460b0e5a4b5bc6e67fc6bf0561439">&#9670;&nbsp;</a></span>Arc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="structfst_1_1GrammarFstArc.html">GrammarFstArc</a> <a class="el" href="classfst_1_1GrammarFst.html#ac51460b0e5a4b5bc6e67fc6bf0561439">Arc</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8h_source.html#l00093">93</a> of file <a class="el" href="grammar-fst_8h_source.html">grammar-fst.h</a>.</p>

</div>
</div>
<a id="a8086078c61f5b3c4959476d0a59c2836"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8086078c61f5b3c4959476d0a59c2836">&#9670;&nbsp;</a></span>BaseStateId</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef StdArc::StateId <a class="el" href="classfst_1_1GrammarFst.html#a8086078c61f5b3c4959476d0a59c2836">BaseStateId</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8h_source.html#l00102">102</a> of file <a class="el" href="grammar-fst_8h_source.html">grammar-fst.h</a>.</p>

</div>
</div>
<a id="a8b4305fe971ea965a741395013fd9c49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b4305fe971ea965a741395013fd9c49">&#9670;&nbsp;</a></span>Label</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="structfst_1_1GrammarFstArc.html#a32e4ee538ce0d6ce57e587fd2179ca1b">Arc::Label</a> <a class="el" href="classfst_1_1GrammarFst.html#a8b4305fe971ea965a741395013fd9c49">Label</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8h_source.html#l00104">104</a> of file <a class="el" href="grammar-fst_8h_source.html">grammar-fst.h</a>.</p>

</div>
</div>
<a id="a4ace4c191c83fe28b57d4d080ae967b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ace4c191c83fe28b57d4d080ae967b0">&#9670;&nbsp;</a></span>StateId</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="structfst_1_1GrammarFstArc.html#a875b746461472785be87ec24826ff874">Arc::StateId</a> <a class="el" href="classfst_1_1GrammarFst.html#a4ace4c191c83fe28b57d4d080ae967b0">StateId</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8h_source.html#l00099">99</a> of file <a class="el" href="grammar-fst_8h_source.html">grammar-fst.h</a>.</p>

</div>
</div>
<a id="a302a4d2fc21b3024edccaf18ef1604f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a302a4d2fc21b3024edccaf18ef1604f1">&#9670;&nbsp;</a></span>Weight</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef TropicalWeight <a class="el" href="classfst_1_1GrammarFst.html#a302a4d2fc21b3024edccaf18ef1604f1">Weight</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8h_source.html#l00094">94</a> of file <a class="el" href="grammar-fst_8h_source.html">grammar-fst.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a4c83ce76130a15c55e87f9b64afdb72e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c83ce76130a15c55e87f9b64afdb72e">&#9670;&nbsp;</a></span>GrammarFst() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfst_1_1GrammarFst.html">GrammarFst</a> </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>nonterm_phones_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ConstFst&lt; <a class="el" href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">StdArc</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>top_fst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::pair&lt; int32, const ConstFst&lt; <a class="el" href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">StdArc</a> &gt; *&gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>ifsts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<p>This constructor is very lightweight; the only immediate work it does is to iterate over the arcs in the start states of the provided FSTs in order to set up the appropriate entry points.</p>
<p>For simplicity (to avoid templates), we limit the input FSTs to be of type ConstFst&lt;StdArc&gt;; this limitation could be removed later if needed. You can always construct a ConstFst&lt;StdArc&gt; if you have another StdArc-based FST type. If the FST was read from disk, it may already be of type ConstFst, and dynamic_cast might be sufficient to convert the type.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nonterm_phones_offset</td><td>The integer id of the symbol "#nonterm_bos" in phones.txt. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">top_fst</td><td>The top-level FST of the grammar, which will usually invoke the fsts in 'ifsts'. The fsts in 'ifsts' may also invoke each other recursively. Even left-recursion is allowed, although if it is with zero cost, it may blow up when you decode. When an FST invokes another, the invocation point will have sequences of two special symbols which would be decoded as: (#nonterm:foo,p1) (#nonterm_reenter,p2) where p1 and p2 (which may be real phones or #nonterm_bos) represent the phonetic left-context that we enter, and leave, the sub-graph with respectively. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ifsts</td><td>ifsts is a list of pairs (nonterminal-symbol, the HCLG.fst corresponding to that symbol). The nonterminal symbols must be among the user-specified nonterminals in phones.txt, i.e. the things with names like "#nonterm:foo" and "#nonterm:bar" in phones.txt. Also no nonterminal may appear more than once in 'fsts'. ifsts may be empty, even though that doesn't make much sense. This function does not take ownership of these pointers (i.e. it will not delete them when it is destroyed). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0d2feaf3dcb4c627e7c4c7ae0c1d2a56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d2feaf3dcb4c627e7c4c7ae0c1d2a56">&#9670;&nbsp;</a></span>GrammarFst() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfst_1_1GrammarFst.html">GrammarFst</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This constructor should only be used prior to calling <a class="el" href="classfst_1_1GrammarFst.html#ae2892c501e401b523a3eb774e735d64d">Read()</a>. </p>

<p class="definition">Definition at line <a class="el" href="grammar-fst_8h_source.html#l00145">145</a> of file <a class="el" href="grammar-fst_8h_source.html">grammar-fst.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;: <a class="code" href="classfst_1_1GrammarFst.html#ad68dfecca65ab013329921e1c178b455">top_fst_</a>(NULL) { }</div><div class="ttc" id="classfst_1_1GrammarFst_html_ad68dfecca65ab013329921e1c178b455"><div class="ttname"><a href="classfst_1_1GrammarFst.html#ad68dfecca65ab013329921e1c178b455">fst::GrammarFst::top_fst_</a></div><div class="ttdeci">const ConstFst&lt; StdArc &gt; * top_fst_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00448">grammar-fst.h:448</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afcde49f68292e807c903f4a577a21dfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcde49f68292e807c903f4a577a21dfc">&#9670;&nbsp;</a></span>~GrammarFst()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">~<a class="el" href="classfst_1_1GrammarFst.html">GrammarFst</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8cc_source.html#l00052">52</a> of file <a class="el" href="grammar-fst_8cc_source.html">grammar-fst.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                        {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <a class="code" href="classfst_1_1GrammarFst.html#ac919a991060ede6983343719401686de">Destroy</a>();</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;}</div><div class="ttc" id="classfst_1_1GrammarFst_html_ac919a991060ede6983343719401686de"><div class="ttname"><a href="classfst_1_1GrammarFst.html#ac919a991060ede6983343719401686de">fst::GrammarFst::Destroy</a></div><div class="ttdeci">void Destroy()</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8cc_source.html#l00056">grammar-fst.cc:56</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a799fac4aecf6dc610b3ca2dae19473df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a799fac4aecf6dc610b3ca2dae19473df">&#9670;&nbsp;</a></span>CombineArcs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CombineArcs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">StdArc</a> &amp;&#160;</td>
          <td class="paramname"><em>leaving_arc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">StdArc</a> &amp;&#160;</td>
          <td class="paramname"><em>arriving_arc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfloat.html">float</a>&#160;</td>
          <td class="paramname"><em>cost_correction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">StdArc</a> *&#160;</td>
          <td class="paramname"><em>arc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Called while expanding states, this function combines information from two arcs: one leaving one sub-fst and one arriving in another sub-fst. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">leaving_arc</td><td>The arc leaving the first FST; must have zero olabel. The ilabel will have a nonterminal symbol like #nonterm:foo or #nonterm_end on it, encoded with a phonetic context, but we ignore the ilabel. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">arriving_arc</td><td>The arc arriving in the second FST. It will have an ilabel consisted of either #nonterm_begin or #nonterm_enter combined with a left-context phone, but we ignore the ilabel. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cost_correction</td><td>A correction term that we add to the cost of the arcs. This basically cancels out the "1/num_options" part of the weight that we added in L.fst when we put in all the phonetic-context options. We did that to keep the FST stochastic, so that if we ever pushed the weights, it wouldn't lead to weird effects. This takes out that correction term... things will still sum to one in the appropriate way, because in fact when we cross these FST boundaries we only take one specific phonetic context, rather than all possibilities. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">arc</td><td>The arc that we output. Will have:<ul>
<li>weight equal to the product of the input arcs' weights, times a weight constructed from 'cost_correction'.</li>
<li>olabel equal to arriving_arc.olabel (leaving_arc's olabel will be zero).</li>
<li>ilabel equal to zero (we discard both ilabels, they are not transition-ids but special symbols).</li>
<li>nextstate equal to the nextstate of arriving_arc. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="grammar-fst_8cc_source.html#l00201">201</a> of file <a class="el" href="grammar-fst_8cc_source.html">grammar-fst.cc</a>.</p>

<p class="reference">References <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>.</p>
<div class="fragment"><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                                          {</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="comment">// The following assertion shouldn&#39;t fail; we ensured this in</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="comment">// PrepareForGrammarFst(), search for &#39;olabel_problem&#39;.</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(leaving_arc.olabel == 0);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="comment">// &#39;leaving_arc&#39; leaves one fst, and &#39;arriving_arcs&#39;, conceptually arrives in</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="comment">// another.  This code merges the information of the two arcs to make a</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="comment">// cross-FST arc.  The ilabel information is discarded as it was only intended</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="comment">// for the consumption of the GrammarFST code.</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  arc-&gt;ilabel = 0;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  arc-&gt;olabel = arriving_arc.olabel;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="comment">// conceptually, arc-&gt;weight =</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="comment">//  Times(Times(leaving_arc.weight, arriving_arc.weight), Weight(cost_correction)).</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="comment">// The below might be a bit faster, I hope-- avoiding checking.</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  arc-&gt;weight = <a class="code" href="classfst_1_1GrammarFst.html#a302a4d2fc21b3024edccaf18ef1604f1">Weight</a>(cost_correction + leaving_arc.weight.Value() +</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                       arriving_arc.weight.Value());</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  arc-&gt;nextstate = arriving_arc.nextstate;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;}</div><div class="ttc" id="classfst_1_1GrammarFst_html_a302a4d2fc21b3024edccaf18ef1604f1"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a302a4d2fc21b3024edccaf18ef1604f1">fst::GrammarFst::Weight</a></div><div class="ttdeci">TropicalWeight Weight</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00094">grammar-fst.h:94</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9956a77f3a82dfddc07f7ee649d07bc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9956a77f3a82dfddc07f7ee649d07bc4">&#9670;&nbsp;</a></span>DecodeSymbol()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DecodeSymbol </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfst_1_1GrammarFst.html#a8b4305fe971ea965a741395013fd9c49">Label</a>&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32 *&#160;</td>
          <td class="paramname"><em>nonterminal_symbol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32 *&#160;</td>
          <td class="paramname"><em>left_context_phone</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Decodes an ilabel into a pair (nonterminal, left_context_phone). </p>
<p>Crashes if something went wrong or ilabel did not represent that (e.g. was less than kNontermBigNumber).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">the</td><td>ilabel to be decoded. Note: the type 'Label' will in practice be int. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">The</td><td>nonterminal part of the ilabel after decoding. Will be a value greater than nonterm_phones_offset_. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">The</td><td>left-context-phone part of the ilabel after decoding. Will either be a phone index, or the symbol corresponding to #nonterm_bos (meaning no left-context as we are at the beginning of the sequence). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="grammar-fst_8cc_source.html#l00080">80</a> of file <a class="el" href="grammar-fst_8cc_source.html">grammar-fst.cc</a>.</p>

<p class="reference">References <a class="el" href="grammar-context-fst_8h_source.html#l00090">fst::GetEncodingMultiple()</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00126">KALDI_ERR</a>, <a class="el" href="grammar-context-fst_8h_source.html#l00080">fst::kNontermBigNumber</a>, <a class="el" href="grammar-context-fst_8h_source.html#l00069">fst::kNontermBos</a>, and <a class="el" href="grammar-context-fst_8h_source.html#l00079">fst::kNontermMediumNumber</a>.</p>
<div class="fragment"><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                                                         {</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">// encoding_multiple will normally equal 1000 (but may be a multiple of 1000</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="comment">// if there are a lot of phones); kNontermBigNumber is 10000000.</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  int32 big_number = <span class="keyword">static_cast&lt;</span>int32<span class="keyword">&gt;</span>(<a class="code" href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2aafc1d79474b5b834eae90c6a9c42790f">kNontermBigNumber</a>),</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      nonterm_phones_offset = <a class="code" href="classfst_1_1GrammarFst.html#a56db4c50d7ba7ecdac05db5856374e81">nonterm_phones_offset_</a>,</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      encoding_multiple = <a class="code" href="namespacefst.html#a4828391bb3d612ffffaf704c14c30d6a">GetEncodingMultiple</a>(nonterm_phones_offset);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="comment">// The following assertion should be optimized out as the condition is</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="comment">// statically known.</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(big_number % static_cast&lt;int32&gt;(<a class="code" href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2a912e4937034fa71a1d4dc31c523dc351">kNontermMediumNumber</a>) == 0);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  *nonterminal_symbol = (label - big_number) / encoding_multiple;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  *left_context_phone = label % encoding_multiple;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordflow">if</span> (*nonterminal_symbol &lt;= nonterm_phones_offset ||</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      *left_context_phone == 0 || *left_context_phone &gt;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      nonterm_phones_offset + static_cast&lt;int32&gt;(<a class="code" href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2a8420d849ee0c4302c3e4f963feed7a00">kNontermBos</a>))</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Decoding invalid label &quot;</span> &lt;&lt; label</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;: code error or invalid --nonterm-phones-offset?&quot;</span>;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;}</div><div class="ttc" id="namespacefst_html_a251b709d87fe58fc66599f483fb98bd2aafc1d79474b5b834eae90c6a9c42790f"><div class="ttname"><a href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2aafc1d79474b5b834eae90c6a9c42790f">fst::kNontermBigNumber</a></div><div class="ttdef"><b>Definition:</b> <a href="grammar-context-fst_8h_source.html#l00080">grammar-context-fst.h:80</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00126">kaldi-error.h:126</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="namespacefst_html_a251b709d87fe58fc66599f483fb98bd2a8420d849ee0c4302c3e4f963feed7a00"><div class="ttname"><a href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2a8420d849ee0c4302c3e4f963feed7a00">fst::kNontermBos</a></div><div class="ttdef"><b>Definition:</b> <a href="grammar-context-fst_8h_source.html#l00069">grammar-context-fst.h:69</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a56db4c50d7ba7ecdac05db5856374e81"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a56db4c50d7ba7ecdac05db5856374e81">fst::GrammarFst::nonterm_phones_offset_</a></div><div class="ttdeci">int32 nonterm_phones_offset_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00443">grammar-fst.h:443</a></div></div>
<div class="ttc" id="namespacefst_html_a251b709d87fe58fc66599f483fb98bd2a912e4937034fa71a1d4dc31c523dc351"><div class="ttname"><a href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2a912e4937034fa71a1d4dc31c523dc351">fst::kNontermMediumNumber</a></div><div class="ttdef"><b>Definition:</b> <a href="grammar-context-fst_8h_source.html#l00079">grammar-context-fst.h:79</a></div></div>
<div class="ttc" id="namespacefst_html_a4828391bb3d612ffffaf704c14c30d6a"><div class="ttname"><a href="namespacefst.html#a4828391bb3d612ffffaf704c14c30d6a">fst::GetEncodingMultiple</a></div><div class="ttdeci">int32 GetEncodingMultiple(int32 nonterm_phones_offset)</div><div class="ttdef"><b>Definition:</b> <a href="grammar-context-fst_8h_source.html#l00090">grammar-context-fst.h:90</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac919a991060ede6983343719401686de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac919a991060ede6983343719401686de">&#9670;&nbsp;</a></span>Destroy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Destroy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8cc_source.html#l00056">56</a> of file <a class="el" href="grammar-fst_8cc_source.html">grammar-fst.cc</a>.</p>

<p class="reference">References <a class="el" href="grammar-fst_8h_source.html#l00400">GrammarFst::FstInstance::expanded_states</a>, and <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>.</p>
<div class="fragment"><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                         {</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">instances_</a>.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    FstInstance &amp;instance = <a class="code" href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">instances_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    std::unordered_map&lt;BaseStateId, ExpandedState*&gt;::const_iterator</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        iter = instance.expanded_states.begin(),</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        end = instance.expanded_states.end();</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">for</span> (; iter != end; ++iter) {</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      ExpandedState *e = iter-&gt;second;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keyword">delete</span> e;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  }</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <a class="code" href="classfst_1_1GrammarFst.html#ad68dfecca65ab013329921e1c178b455">top_fst_</a> = NULL;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <a class="code" href="classfst_1_1GrammarFst.html#a3c5eec26f7b7e8d7a4a09f2aeb29ae1f">ifsts_</a>.clear();</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <a class="code" href="classfst_1_1GrammarFst.html#a05f1d86c7978348900bb85cc73690a4d">nonterminal_map_</a>.clear();</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <a class="code" href="classfst_1_1GrammarFst.html#a9de1f012d8b92d4a2d7522abedc9a884">entry_arcs_</a>.clear();</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <a class="code" href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">instances_</a>.clear();</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="comment">// the following will only do something if we read this object from disk using</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">// its Read() function.</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classfst_1_1GrammarFst.html#ad061d7149ef830dd0d7eb4aae390a0fd">fsts_to_delete_</a>.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classfst_1_1GrammarFst.html#ad061d7149ef830dd0d7eb4aae390a0fd">fsts_to_delete_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="code" href="classfst_1_1GrammarFst.html#ad061d7149ef830dd0d7eb4aae390a0fd">fsts_to_delete_</a>.clear();</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;}</div><div class="ttc" id="classfst_1_1GrammarFst_html_a9de1f012d8b92d4a2d7522abedc9a884"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a9de1f012d8b92d4a2d7522abedc9a884">fst::GrammarFst::entry_arcs_</a></div><div class="ttdeci">std::vector&lt; std::unordered_map&lt; int32, int32 &gt; &gt; entry_arcs_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00467">grammar-fst.h:467</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_ad061d7149ef830dd0d7eb4aae390a0fd"><div class="ttname"><a href="classfst_1_1GrammarFst.html#ad061d7149ef830dd0d7eb4aae390a0fd">fst::GrammarFst::fsts_to_delete_</a></div><div class="ttdeci">std::vector&lt; const ConstFst&lt; StdArc &gt; * &gt; fsts_to_delete_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00477">grammar-fst.h:477</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a05f1d86c7978348900bb85cc73690a4d"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a05f1d86c7978348900bb85cc73690a4d">fst::GrammarFst::nonterminal_map_</a></div><div class="ttdeci">std::unordered_map&lt; int32, int32 &gt; nonterminal_map_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00457">grammar-fst.h:457</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_adc925c31b57e960b56eb179f9a3cb17b"><div class="ttname"><a href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">fst::GrammarFst::instances_</a></div><div class="ttdeci">std::vector&lt; FstInstance &gt; instances_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00472">grammar-fst.h:472</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_ad68dfecca65ab013329921e1c178b455"><div class="ttname"><a href="classfst_1_1GrammarFst.html#ad68dfecca65ab013329921e1c178b455">fst::GrammarFst::top_fst_</a></div><div class="ttdeci">const ConstFst&lt; StdArc &gt; * top_fst_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00448">grammar-fst.h:448</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a3c5eec26f7b7e8d7a4a09f2aeb29ae1f"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a3c5eec26f7b7e8d7a4a09f2aeb29ae1f">fst::GrammarFst::ifsts_</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; int32, const ConstFst&lt; StdArc &gt; * &gt; &gt; ifsts_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00453">grammar-fst.h:453</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2a8a892a0794d0cefabeec2a8860d4dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a8a892a0794d0cefabeec2a8860d4dc">&#9670;&nbsp;</a></span>ExpandState()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfst_1_1GrammarFst_1_1ExpandedState.html">GrammarFst::ExpandedState</a> * ExpandState </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>instance_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfst_1_1GrammarFst.html#a8086078c61f5b3c4959476d0a59c2836">BaseStateId</a>&#160;</td>
          <td class="paramname"><em>state_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8cc_source.html#l00173">173</a> of file <a class="el" href="grammar-fst_8cc_source.html">grammar-fst.cc</a>.</p>

<p class="reference">References <a class="el" href="grammar-context-fst_8h_source.html#l00090">fst::GetEncodingMultiple()</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00126">KALDI_ERR</a>, <a class="el" href="grammar-context-fst_8h_source.html#l00070">fst::kNontermBegin</a>, <a class="el" href="grammar-context-fst_8h_source.html#l00080">fst::kNontermBigNumber</a>, <a class="el" href="grammar-context-fst_8h_source.html#l00071">fst::kNontermEnd</a>, <a class="el" href="grammar-context-fst_8h_source.html#l00072">fst::kNontermReenter</a>, and <a class="el" href="grammar-context-fst_8h_source.html#l00073">fst::kNontermUserDefined</a>.</p>
<div class="fragment"><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                                             {</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  int32 big_number = <a class="code" href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2aafc1d79474b5b834eae90c6a9c42790f">kNontermBigNumber</a>;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keyword">const</span> ConstFst&lt;StdArc&gt; &amp;<a class="code" href="namespacefst.html">fst</a> = *(<a class="code" href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">instances_</a>[instance_id].fst);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  ArcIterator&lt;ConstFst&lt;StdArc&gt; &gt; aiter(fst, state_id);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!aiter.Done() &amp;&amp; aiter.Value().ilabel &gt; big_number &amp;&amp;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;               <span class="stringliteral">&quot;Something is not right; did you call PrepareForGrammarFst()?&quot;</span>);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">StdArc</a> &amp;arc = aiter.Value();</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  int32 encoding_multiple = <a class="code" href="namespacefst.html#a4828391bb3d612ffffaf704c14c30d6a">GetEncodingMultiple</a>(<a class="code" href="classfst_1_1GrammarFst.html#a56db4c50d7ba7ecdac05db5856374e81">nonterm_phones_offset_</a>),</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      nonterminal = (arc.ilabel - big_number) / encoding_multiple;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordflow">if</span> (nonterminal == <a class="code" href="classfst_1_1GrammarFst.html#adbdafb790b8c9a3c39f7880b8d64136d">GetPhoneSymbolFor</a>(<a class="code" href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2a853f28d67c5daf316eecc91390831332">kNontermBegin</a>) ||</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      nonterminal == <a class="code" href="classfst_1_1GrammarFst.html#adbdafb790b8c9a3c39f7880b8d64136d">GetPhoneSymbolFor</a>(<a class="code" href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2af2f1f7ed744565c5728529dcce2e2ef5">kNontermReenter</a>)) {</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Encountered unexpected type of nonterminal while &quot;</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="stringliteral">&quot;expanding state.&quot;</span>;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nonterminal == <a class="code" href="classfst_1_1GrammarFst.html#adbdafb790b8c9a3c39f7880b8d64136d">GetPhoneSymbolFor</a>(<a class="code" href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2a534b236508a8d909dd97b3d7475b75db">kNontermEnd</a>)) {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfst_1_1GrammarFst.html#a1d2cede02beae2c01ae4ca6cbb6c6086">ExpandStateEnd</a>(instance_id, state_id);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nonterminal &gt;= <a class="code" href="classfst_1_1GrammarFst.html#adbdafb790b8c9a3c39f7880b8d64136d">GetPhoneSymbolFor</a>(<a class="code" href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2a9407a1ae01a2fea99f092723c3c3cbc0">kNontermUserDefined</a>)) {</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfst_1_1GrammarFst.html#a35bb38a463a02d47426a68faa1584092">ExpandStateUserDefined</a>(instance_id, state_id);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Encountered unexpected type of nonterminal &quot;</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;              &lt;&lt; nonterminal &lt;&lt; <span class="stringliteral">&quot; while expanding state.&quot;</span>;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keywordflow">return</span> NULL;  <span class="comment">// Suppress compiler warning</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;}</div><div class="ttc" id="namespacefst_html_a251b709d87fe58fc66599f483fb98bd2aafc1d79474b5b834eae90c6a9c42790f"><div class="ttname"><a href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2aafc1d79474b5b834eae90c6a9c42790f">fst::kNontermBigNumber</a></div><div class="ttdef"><b>Definition:</b> <a href="grammar-context-fst_8h_source.html#l00080">grammar-context-fst.h:80</a></div></div>
<div class="ttc" id="namespacefst_html"><div class="ttname"><a href="namespacefst.html">fst</a></div><div class="ttdoc">For an extended explanation of the framework of which grammar-fsts are a part, please see Support for...</div><div class="ttdef"><b>Definition:</b> <a href="graph_8dox_source.html#l00021">graph.dox:21</a></div></div>
<div class="ttc" id="namespacefst_html_a251b709d87fe58fc66599f483fb98bd2a853f28d67c5daf316eecc91390831332"><div class="ttname"><a href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2a853f28d67c5daf316eecc91390831332">fst::kNontermBegin</a></div><div class="ttdef"><b>Definition:</b> <a href="grammar-context-fst_8h_source.html#l00070">grammar-context-fst.h:70</a></div></div>
<div class="ttc" id="namespacefst_html_a70478eb2428a9406e4692d19a7a3a97f"><div class="ttname"><a href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">fst::StdArc</a></div><div class="ttdeci">fst::StdArc StdArc</div><div class="ttdef"><b>Definition:</b> <a href="deterministic-fst-test_8cc_source.html#l00053">deterministic-fst-test.cc:53</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_adc925c31b57e960b56eb179f9a3cb17b"><div class="ttname"><a href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">fst::GrammarFst::instances_</a></div><div class="ttdeci">std::vector&lt; FstInstance &gt; instances_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00472">grammar-fst.h:472</a></div></div>
<div class="ttc" id="namespacefst_html_a251b709d87fe58fc66599f483fb98bd2af2f1f7ed744565c5728529dcce2e2ef5"><div class="ttname"><a href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2af2f1f7ed744565c5728529dcce2e2ef5">fst::kNontermReenter</a></div><div class="ttdef"><b>Definition:</b> <a href="grammar-context-fst_8h_source.html#l00072">grammar-context-fst.h:72</a></div></div>
<div class="ttc" id="namespacefst_html_a251b709d87fe58fc66599f483fb98bd2a9407a1ae01a2fea99f092723c3c3cbc0"><div class="ttname"><a href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2a9407a1ae01a2fea99f092723c3c3cbc0">fst::kNontermUserDefined</a></div><div class="ttdef"><b>Definition:</b> <a href="grammar-context-fst_8h_source.html#l00073">grammar-context-fst.h:73</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_adbdafb790b8c9a3c39f7880b8d64136d"><div class="ttname"><a href="classfst_1_1GrammarFst.html#adbdafb790b8c9a3c39f7880b8d64136d">fst::GrammarFst::GetPhoneSymbolFor</a></div><div class="ttdeci">int32 GetPhoneSymbolFor(enum NonterminalValues n)</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00252">grammar-fst.h:252</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00126">kaldi-error.h:126</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a35bb38a463a02d47426a68faa1584092"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a35bb38a463a02d47426a68faa1584092">fst::GrammarFst::ExpandStateUserDefined</a></div><div class="ttdeci">ExpandedState * ExpandStateUserDefined(int32 instance_id, BaseStateId state_id)</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8cc_source.html#l00326">grammar-fst.cc:326</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a56db4c50d7ba7ecdac05db5856374e81"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a56db4c50d7ba7ecdac05db5856374e81">fst::GrammarFst::nonterm_phones_offset_</a></div><div class="ttdeci">int32 nonterm_phones_offset_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00443">grammar-fst.h:443</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a1d2cede02beae2c01ae4ca6cbb6c6086"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a1d2cede02beae2c01ae4ca6cbb6c6086">fst::GrammarFst::ExpandStateEnd</a></div><div class="ttdeci">ExpandedState * ExpandStateEnd(int32 instance_id, BaseStateId state_id)</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8cc_source.html#l00222">grammar-fst.cc:222</a></div></div>
<div class="ttc" id="namespacefst_html_a251b709d87fe58fc66599f483fb98bd2a534b236508a8d909dd97b3d7475b75db"><div class="ttname"><a href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2a534b236508a8d909dd97b3d7475b75db">fst::kNontermEnd</a></div><div class="ttdef"><b>Definition:</b> <a href="grammar-context-fst_8h_source.html#l00071">grammar-context-fst.h:71</a></div></div>
<div class="ttc" id="namespacefst_html_a4828391bb3d612ffffaf704c14c30d6a"><div class="ttname"><a href="namespacefst.html#a4828391bb3d612ffffaf704c14c30d6a">fst::GetEncodingMultiple</a></div><div class="ttdeci">int32 GetEncodingMultiple(int32 nonterm_phones_offset)</div><div class="ttdef"><b>Definition:</b> <a href="grammar-context-fst_8h_source.html#l00090">grammar-context-fst.h:90</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1d2cede02beae2c01ae4ca6cbb6c6086"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d2cede02beae2c01ae4ca6cbb6c6086">&#9670;&nbsp;</a></span>ExpandStateEnd()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfst_1_1GrammarFst_1_1ExpandedState.html">GrammarFst::ExpandedState</a> * ExpandStateEnd </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>instance_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfst_1_1GrammarFst.html#a8086078c61f5b3c4959476d0a59c2836">BaseStateId</a>&#160;</td>
          <td class="paramname"><em>state_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8cc_source.html#l00222">222</a> of file <a class="el" href="grammar-fst_8cc_source.html">grammar-fst.cc</a>.</p>

<p class="reference">References <a class="el" href="grammar-fst_8h_source.html#l00379">GrammarFst::ExpandedState::arcs</a>, <a class="el" href="grammar-fst_8h_source.html#l00370">GrammarFst::ExpandedState::dest_fst_instance</a>, <a class="el" href="grammar-fst_8h_source.html#l00393">GrammarFst::FstInstance::fst</a>, <a class="el" href="grammar-fst_8h_source.html#l00389">GrammarFst::FstInstance::ifst_index</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00126">KALDI_ERR</a>, <a class="el" href="grammar-context-fst_8h_source.html#l00071">fst::kNontermEnd</a>, <a class="el" href="grammar-fst_8h_source.html#l00423">GrammarFst::FstInstance::parent_instance</a>, and <a class="el" href="grammar-fst_8h_source.html#l00428">GrammarFst::FstInstance::parent_state</a>.</p>
<div class="fragment"><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                                             {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordflow">if</span> (instance_id == 0)</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Did not expect #nonterm_end symbol in FST-instance 0.&quot;</span>;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="keyword">const</span> FstInstance &amp;instance = <a class="code" href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">instances_</a>[instance_id];</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  int32 parent_instance_id = instance.parent_instance;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keyword">const</span> ConstFst&lt;StdArc&gt; &amp;<a class="code" href="namespacefst.html">fst</a> = *(instance.fst);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keyword">const</span> FstInstance &amp;parent_instance = <a class="code" href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">instances_</a>[parent_instance_id];</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keyword">const</span> ConstFst&lt;StdArc&gt; &amp;parent_fst = *(parent_instance.fst);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  ExpandedState *ans = <span class="keyword">new</span> ExpandedState;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  ans-&gt;dest_fst_instance = parent_instance_id;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="comment">// parent_aiter is the arc-iterator in the state we return to.  We&#39;ll Seek()</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="comment">// to a different position &#39;parent_aiter&#39; for each arc leaving this state.</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="comment">// (actually we expect just one arc to leave this state).</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  ArcIterator&lt;ConstFst&lt;StdArc&gt; &gt; parent_aiter(parent_fst,</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                                              instance.parent_state);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="comment">// for explanation of cost_correction, see documentation for CombineArcs().</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordtype">float</span> num_reentry_arcs = <a class="code" href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">instances_</a>[instance_id].parent_reentry_arcs.size(),</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      cost_correction = -log(num_reentry_arcs);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  ArcIterator&lt;ConstFst&lt;StdArc&gt; &gt; aiter(fst, state_id);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordflow">for</span> (; !aiter.Done(); aiter.Next()) {</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">StdArc</a> &amp;leaving_arc = aiter.Value();</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    int32 this_nonterminal, left_context_phone;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <a class="code" href="classfst_1_1GrammarFst.html#a9956a77f3a82dfddc07f7ee649d07bc4">DecodeSymbol</a>(leaving_arc.ilabel, &amp;this_nonterminal,</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                 &amp;left_context_phone);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(this_nonterminal == <a class="code" href="classfst_1_1GrammarFst.html#adbdafb790b8c9a3c39f7880b8d64136d">GetPhoneSymbolFor</a>(<a class="code" href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2a534b236508a8d909dd97b3d7475b75db">kNontermEnd</a>) &amp;&amp;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                 <span class="stringliteral">&quot;&gt;1 nonterminals from a state; did you use &quot;</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                 <span class="stringliteral">&quot;PrepareForGrammarFst()?&quot;</span>);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    std::unordered_map&lt;int32, int32&gt;::const_iterator reentry_iter =</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <a class="code" href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">instances_</a>[instance_id].parent_reentry_arcs.find(left_context_phone),</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        reentry_end = <a class="code" href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">instances_</a>[instance_id].parent_reentry_arcs.end();</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">if</span> (reentry_iter == reentry_end) {</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;FST with index &quot;</span> &lt;&lt; instance.ifst_index</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; ends with left-context-phone &quot;</span> &lt;&lt; left_context_phone</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; but parent FST does not support that left-context &quot;</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;          <span class="stringliteral">&quot;at the return point.&quot;</span>;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    }</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordtype">size_t</span> parent_arc_index = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(reentry_iter-&gt;second);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    parent_aiter.Seek(parent_arc_index);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">StdArc</a> &amp;arriving_arc = parent_aiter.Value();</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">// &#39;arc&#39; will combine the information on &#39;leaving_arc&#39; and &#39;arriving_arc&#39;,</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">// except that the ilabel will be set to zero.</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">if</span> (leaving_arc.olabel != 0) {</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="comment">// If the following fails it would maybe indicate you hadn&#39;t called</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <span class="comment">// PrepareForGrammarFst(), or there was an error in that, because</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <span class="comment">// we made sure the leaving arc does not have an olabel.  Search</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="comment">// in that code for &#39;olabel_problem&#39; for more details.</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Leaving arc has zero olabel.&quot;</span>;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">StdArc</a> arc;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="classfst_1_1GrammarFst.html#a799fac4aecf6dc610b3ca2dae19473df">CombineArcs</a>(leaving_arc, arriving_arc, cost_correction, &amp;arc);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    ans-&gt;arcs.push_back(arc);</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="keywordflow">return</span> ans;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;}</div><div class="ttc" id="namespacefst_html"><div class="ttname"><a href="namespacefst.html">fst</a></div><div class="ttdoc">For an extended explanation of the framework of which grammar-fsts are a part, please see Support for...</div><div class="ttdef"><b>Definition:</b> <a href="graph_8dox_source.html#l00021">graph.dox:21</a></div></div>
<div class="ttc" id="namespacefst_html_a70478eb2428a9406e4692d19a7a3a97f"><div class="ttname"><a href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">fst::StdArc</a></div><div class="ttdeci">fst::StdArc StdArc</div><div class="ttdef"><b>Definition:</b> <a href="deterministic-fst-test_8cc_source.html#l00053">deterministic-fst-test.cc:53</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_adc925c31b57e960b56eb179f9a3cb17b"><div class="ttname"><a href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">fst::GrammarFst::instances_</a></div><div class="ttdeci">std::vector&lt; FstInstance &gt; instances_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00472">grammar-fst.h:472</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a799fac4aecf6dc610b3ca2dae19473df"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a799fac4aecf6dc610b3ca2dae19473df">fst::GrammarFst::CombineArcs</a></div><div class="ttdeci">static void CombineArcs(const StdArc &amp;leaving_arc, const StdArc &amp;arriving_arc, float cost_correction, StdArc *arc)</div><div class="ttdoc">Called while expanding states, this function combines information from two arcs: one leaving one sub-...</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8cc_source.html#l00201">grammar-fst.cc:201</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_adbdafb790b8c9a3c39f7880b8d64136d"><div class="ttname"><a href="classfst_1_1GrammarFst.html#adbdafb790b8c9a3c39f7880b8d64136d">fst::GrammarFst::GetPhoneSymbolFor</a></div><div class="ttdeci">int32 GetPhoneSymbolFor(enum NonterminalValues n)</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00252">grammar-fst.h:252</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00126">kaldi-error.h:126</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="namespacefst_html_a251b709d87fe58fc66599f483fb98bd2a534b236508a8d909dd97b3d7475b75db"><div class="ttname"><a href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2a534b236508a8d909dd97b3d7475b75db">fst::kNontermEnd</a></div><div class="ttdef"><b>Definition:</b> <a href="grammar-context-fst_8h_source.html#l00071">grammar-context-fst.h:71</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a9956a77f3a82dfddc07f7ee649d07bc4"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a9956a77f3a82dfddc07f7ee649d07bc4">fst::GrammarFst::DecodeSymbol</a></div><div class="ttdeci">void DecodeSymbol(Label label, int32 *nonterminal_symbol, int32 *left_context_phone)</div><div class="ttdoc">Decodes an ilabel into a pair (nonterminal, left_context_phone). </div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8cc_source.html#l00080">grammar-fst.cc:80</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a35bb38a463a02d47426a68faa1584092"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35bb38a463a02d47426a68faa1584092">&#9670;&nbsp;</a></span>ExpandStateUserDefined()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfst_1_1GrammarFst_1_1ExpandedState.html">GrammarFst::ExpandedState</a> * ExpandStateUserDefined </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>instance_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfst_1_1GrammarFst.html#a8086078c61f5b3c4959476d0a59c2836">BaseStateId</a>&#160;</td>
          <td class="paramname"><em>state_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8cc_source.html#l00326">326</a> of file <a class="el" href="grammar-fst_8cc_source.html">grammar-fst.cc</a>.</p>

<p class="reference">References <a class="el" href="grammar-fst_8h_source.html#l00379">GrammarFst::ExpandedState::arcs</a>, <a class="el" href="grammar-fst_8h_source.html#l00370">GrammarFst::ExpandedState::dest_fst_instance</a>, <a class="el" href="grammar-fst_8h_source.html#l00393">GrammarFst::FstInstance::fst</a>, <a class="el" href="grammar-fst_8h_source.html#l00389">GrammarFst::FstInstance::ifst_index</a>, and <a class="el" href="kaldi-error_8h_source.html#l00126">KALDI_ERR</a>.</p>
<div class="fragment"><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                                             {</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="keyword">const</span> ConstFst&lt;StdArc&gt; &amp;<a class="code" href="namespacefst.html">fst</a> = *(<a class="code" href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">instances_</a>[instance_id].fst);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  ArcIterator&lt;ConstFst&lt;StdArc&gt; &gt; aiter(fst, state_id);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  ExpandedState *ans = <span class="keyword">new</span> ExpandedState;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  int32 dest_fst_instance = -1;  <span class="comment">// We&#39;ll set it in the loop.</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                                 <span class="comment">// and-&gt;dest_fst_instance will be set to this.</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordflow">for</span> (; !aiter.Done(); aiter.Next()) {</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">StdArc</a> &amp;leaving_arc = aiter.Value();</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    int32 nonterminal, left_context_phone;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <a class="code" href="classfst_1_1GrammarFst.html#a9956a77f3a82dfddc07f7ee649d07bc4">DecodeSymbol</a>(leaving_arc.ilabel, &amp;nonterminal,</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                 &amp;left_context_phone);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    int32 child_instance_id = <a class="code" href="classfst_1_1GrammarFst.html#a02544b1df2ed0618053ca21f2188b43f">GetChildInstanceId</a>(instance_id,</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                                                 nonterminal,</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                                                 leaving_arc.nextstate);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">if</span> (dest_fst_instance &lt; 0) {</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      dest_fst_instance = child_instance_id;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dest_fst_instance != child_instance_id) {</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Same state leaves to different FST instances &quot;</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;          <span class="stringliteral">&quot;(Did you use PrepareForGrammarFst()?)&quot;</span>;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    }</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keyword">const</span> FstInstance &amp;child_instance = <a class="code" href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">instances_</a>[child_instance_id];</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keyword">const</span> ConstFst&lt;StdArc&gt; &amp;child_fst = *(child_instance.fst);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    int32 child_ifst_index = child_instance.ifst_index;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    std::unordered_map&lt;int32, int32&gt; &amp;entry_arcs = <a class="code" href="classfst_1_1GrammarFst.html#a9de1f012d8b92d4a2d7522abedc9a884">entry_arcs_</a>[child_ifst_index];</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">if</span> (entry_arcs.empty())</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <a class="code" href="classfst_1_1GrammarFst.html#a98a1bd90bcd088e6a889a7e61ce4a99b">InitEntryArcs</a>(child_ifst_index);</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">// for explanation of cost_correction, see documentation for CombineArcs().</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordtype">float</span> num_entry_arcs = entry_arcs.size(),</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        cost_correction = -log(num_entry_arcs);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">// Get the arc-index for the arc leaving the start-state of child FST that</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">// corresponds to this phonetic context.</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    std::unordered_map&lt;int32, int32&gt;::const_iterator entry_iter =</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        entry_arcs.find(left_context_phone);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">if</span> (entry_iter == entry_arcs.end()) {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;FST for nonterminal &quot;</span> &lt;&lt; nonterminal</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; does not have an entry point for left-context-phone &quot;</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                &lt;&lt; left_context_phone;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    }</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    int32 arc_index = entry_iter-&gt;second;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    ArcIterator&lt;ConstFst&lt;StdArc&gt; &gt; child_aiter(child_fst, child_fst.Start());</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    child_aiter.Seek(arc_index);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">StdArc</a> &amp;arriving_arc = child_aiter.Value();</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <a class="code" href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">StdArc</a> arc;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <a class="code" href="classfst_1_1GrammarFst.html#a799fac4aecf6dc610b3ca2dae19473df">CombineArcs</a>(leaving_arc, arriving_arc, cost_correction, &amp;arc);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    ans-&gt;arcs.push_back(arc);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  }</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  ans-&gt;dest_fst_instance = dest_fst_instance;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keywordflow">return</span> ans;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;}</div><div class="ttc" id="classfst_1_1GrammarFst_html_a9de1f012d8b92d4a2d7522abedc9a884"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a9de1f012d8b92d4a2d7522abedc9a884">fst::GrammarFst::entry_arcs_</a></div><div class="ttdeci">std::vector&lt; std::unordered_map&lt; int32, int32 &gt; &gt; entry_arcs_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00467">grammar-fst.h:467</a></div></div>
<div class="ttc" id="namespacefst_html"><div class="ttname"><a href="namespacefst.html">fst</a></div><div class="ttdoc">For an extended explanation of the framework of which grammar-fsts are a part, please see Support for...</div><div class="ttdef"><b>Definition:</b> <a href="graph_8dox_source.html#l00021">graph.dox:21</a></div></div>
<div class="ttc" id="namespacefst_html_a70478eb2428a9406e4692d19a7a3a97f"><div class="ttname"><a href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">fst::StdArc</a></div><div class="ttdeci">fst::StdArc StdArc</div><div class="ttdef"><b>Definition:</b> <a href="deterministic-fst-test_8cc_source.html#l00053">deterministic-fst-test.cc:53</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_adc925c31b57e960b56eb179f9a3cb17b"><div class="ttname"><a href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">fst::GrammarFst::instances_</a></div><div class="ttdeci">std::vector&lt; FstInstance &gt; instances_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00472">grammar-fst.h:472</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a02544b1df2ed0618053ca21f2188b43f"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a02544b1df2ed0618053ca21f2188b43f">fst::GrammarFst::GetChildInstanceId</a></div><div class="ttdeci">int32 GetChildInstanceId(int32 instance_id, int32 nonterminal, int32 state)</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8cc_source.html#l00283">grammar-fst.cc:283</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a799fac4aecf6dc610b3ca2dae19473df"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a799fac4aecf6dc610b3ca2dae19473df">fst::GrammarFst::CombineArcs</a></div><div class="ttdeci">static void CombineArcs(const StdArc &amp;leaving_arc, const StdArc &amp;arriving_arc, float cost_correction, StdArc *arc)</div><div class="ttdoc">Called while expanding states, this function combines information from two arcs: one leaving one sub-...</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8cc_source.html#l00201">grammar-fst.cc:201</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00126">kaldi-error.h:126</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a98a1bd90bcd088e6a889a7e61ce4a99b"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a98a1bd90bcd088e6a889a7e61ce4a99b">fst::GrammarFst::InitEntryArcs</a></div><div class="ttdeci">void InitEntryArcs(int32 i)</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8cc_source.html#l00118">grammar-fst.cc:118</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a9956a77f3a82dfddc07f7ee649d07bc4"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a9956a77f3a82dfddc07f7ee649d07bc4">fst::GrammarFst::DecodeSymbol</a></div><div class="ttdeci">void DecodeSymbol(Label label, int32 *nonterminal_symbol, int32 *left_context_phone)</div><div class="ttdoc">Decodes an ilabel into a pair (nonterminal, left_context_phone). </div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8cc_source.html#l00080">grammar-fst.cc:80</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abac0d92668ae11c078d86c557a9217c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abac0d92668ae11c078d86c557a9217c9">&#9670;&nbsp;</a></span>Final()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfst_1_1GrammarFst.html#a302a4d2fc21b3024edccaf18ef1604f1">Weight</a> Final </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfst_1_1GrammarFst.html#a4ace4c191c83fe28b57d4d080ae967b0">StateId</a>&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8h_source.html#l00162">162</a> of file <a class="el" href="grammar-fst_8h_source.html">grammar-fst.h</a>.</p>

<p class="reference">References <a class="el" href="grammar-fst_8h_source.html#l00067">KALDI_GRAMMAR_FST_SPECIAL_WEIGHT</a>.</p>

<p class="reference">Referenced by <a class="el" href="grammar-fst_8cc_source.html#l00867">fst::CopyToVectorFst()</a>.</p>
<div class="fragment"><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                                {</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">// If the fst-id (top 32 bits of s) is nonzero, this state is not final,</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">// because we need to return to the top-level FST before we can be final.</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">if</span> (s != static_cast&lt;StateId&gt;(static_cast&lt;int32&gt;(s))) {</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="keywordflow">return</span> Weight::Zero();</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <a class="code" href="classfst_1_1GrammarFst.html#a8086078c61f5b3c4959476d0a59c2836">BaseStateId</a> base_state = <span class="keyword">static_cast&lt;</span><a class="code" href="classfst_1_1GrammarFst.html#a8086078c61f5b3c4959476d0a59c2836">BaseStateId</a><span class="keyword">&gt;</span>(s);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <a class="code" href="classfst_1_1GrammarFst.html#a302a4d2fc21b3024edccaf18ef1604f1">Weight</a> ans = <a class="code" href="classfst_1_1GrammarFst.html#ad68dfecca65ab013329921e1c178b455">top_fst_</a>-&gt;Final(base_state);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="keywordflow">if</span> (ans.Value() == <a class="code" href="grammar-fst_8h.html#ac5ec65c3c945b6fcf47a7f303304b1a4">KALDI_GRAMMAR_FST_SPECIAL_WEIGHT</a>) {</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keywordflow">return</span> Weight::Zero();</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordflow">return</span> ans;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      }</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  }</div><div class="ttc" id="classfst_1_1GrammarFst_html_a302a4d2fc21b3024edccaf18ef1604f1"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a302a4d2fc21b3024edccaf18ef1604f1">fst::GrammarFst::Weight</a></div><div class="ttdeci">TropicalWeight Weight</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00094">grammar-fst.h:94</a></div></div>
<div class="ttc" id="grammar-fst_8h_html_ac5ec65c3c945b6fcf47a7f303304b1a4"><div class="ttname"><a href="grammar-fst_8h.html#ac5ec65c3c945b6fcf47a7f303304b1a4">KALDI_GRAMMAR_FST_SPECIAL_WEIGHT</a></div><div class="ttdeci">#define KALDI_GRAMMAR_FST_SPECIAL_WEIGHT</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00067">grammar-fst.h:67</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a8086078c61f5b3c4959476d0a59c2836"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a8086078c61f5b3c4959476d0a59c2836">fst::GrammarFst::BaseStateId</a></div><div class="ttdeci">StdArc::StateId BaseStateId</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00102">grammar-fst.h:102</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_ad68dfecca65ab013329921e1c178b455"><div class="ttname"><a href="classfst_1_1GrammarFst.html#ad68dfecca65ab013329921e1c178b455">fst::GrammarFst::top_fst_</a></div><div class="ttdeci">const ConstFst&lt; StdArc &gt; * top_fst_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00448">grammar-fst.h:448</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a02544b1df2ed0618053ca21f2188b43f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02544b1df2ed0618053ca21f2188b43f">&#9670;&nbsp;</a></span>GetChildInstanceId()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 GetChildInstanceId </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>instance_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>nonterminal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8cc_source.html#l00283">283</a> of file <a class="el" href="grammar-fst_8cc_source.html">grammar-fst.cc</a>.</p>

<p class="reference">References <a class="el" href="grammar-fst_8h_source.html#l00393">GrammarFst::FstInstance::fst</a>, <a class="el" href="grammar-fst_8h_source.html#l00389">GrammarFst::FstInstance::ifst_index</a>, <a class="el" href="kaldi-error_8h_source.html#l00126">KALDI_ERR</a>, <a class="el" href="grammar-context-fst_8h_source.html#l00072">fst::kNontermReenter</a>, <a class="el" href="grammar-fst_8h_source.html#l00423">GrammarFst::FstInstance::parent_instance</a>, <a class="el" href="grammar-fst_8h_source.html#l00439">GrammarFst::FstInstance::parent_reentry_arcs</a>, and <a class="el" href="grammar-fst_8h_source.html#l00428">GrammarFst::FstInstance::parent_state</a>.</p>
<div class="fragment"><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                                                  {</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  int64 encoded_pair = (<span class="keyword">static_cast&lt;</span>int64<span class="keyword">&gt;</span>(nonterminal) &lt;&lt; 32) + state;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="comment">// &#39;new_instance_id&#39; is the instance-id we&#39;d assign if we had to create a new one.</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="comment">// We try to add it at once, to avoid having to do an extra map lookup in case</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="comment">// it wasn&#39;t there and we did need to add it.</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  int32 child_instance_id = <a class="code" href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">instances_</a>.size();</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  {</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    std::pair&lt;int64, int32&gt; p(encoded_pair, child_instance_id);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    std::pair&lt;std::unordered_map&lt;int64, int32&gt;::const_iterator, <span class="keywordtype">bool</span>&gt; ans =</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <a class="code" href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">instances_</a>[instance_id].child_instances.insert(p);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">if</span> (!ans.second) {</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="comment">// The pair was not inserted, which means the key &#39;encoded_pair&#39; did exist in the</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="comment">// map.  Return the value in the map.</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      child_instance_id = ans.first-&gt;second;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="keywordflow">return</span> child_instance_id;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    }</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  }</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="comment">// If we reached this point, we did successfully insert &#39;child_instance_id&#39; into</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="comment">// the map, because the key didn&#39;t exist.  That means we have to actually create</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="comment">// the instance.</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <a class="code" href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">instances_</a>.resize(child_instance_id + 1);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="keyword">const</span> FstInstance &amp;parent_instance = <a class="code" href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">instances_</a>[instance_id];</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  FstInstance &amp;child_instance = <a class="code" href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">instances_</a>[child_instance_id];</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="comment">// Work out the ifst_index for this nonterminal.</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  std::unordered_map&lt;int32, int32&gt;::const_iterator iter =</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <a class="code" href="classfst_1_1GrammarFst.html#a05f1d86c7978348900bb85cc73690a4d">nonterminal_map_</a>.find(nonterminal);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keywordflow">if</span> (iter == <a class="code" href="classfst_1_1GrammarFst.html#a05f1d86c7978348900bb85cc73690a4d">nonterminal_map_</a>.end()) {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Nonterminal &quot;</span> &lt;&lt; nonterminal &lt;&lt; <span class="stringliteral">&quot; was requested, but &quot;</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="stringliteral">&quot;there is no FST for it.&quot;</span>;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  int32 ifst_index = iter-&gt;second;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  child_instance.ifst_index = ifst_index;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  child_instance.fst = <a class="code" href="classfst_1_1GrammarFst.html#a3c5eec26f7b7e8d7a4a09f2aeb29ae1f">ifsts_</a>[ifst_index].second;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  child_instance.parent_instance = instance_id;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  child_instance.parent_state = state;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <a class="code" href="classfst_1_1GrammarFst.html#a9a0814345f5aa1ad5ada7b9a4439124b">InitEntryOrReentryArcs</a>(*(parent_instance.fst), state,</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                         <a class="code" href="classfst_1_1GrammarFst.html#adbdafb790b8c9a3c39f7880b8d64136d">GetPhoneSymbolFor</a>(<a class="code" href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2af2f1f7ed744565c5728529dcce2e2ef5">kNontermReenter</a>),</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                         &amp;(child_instance.parent_reentry_arcs));</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keywordflow">return</span> child_instance_id;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;}</div><div class="ttc" id="classfst_1_1GrammarFst_html_a05f1d86c7978348900bb85cc73690a4d"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a05f1d86c7978348900bb85cc73690a4d">fst::GrammarFst::nonterminal_map_</a></div><div class="ttdeci">std::unordered_map&lt; int32, int32 &gt; nonterminal_map_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00457">grammar-fst.h:457</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a9a0814345f5aa1ad5ada7b9a4439124b"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a9a0814345f5aa1ad5ada7b9a4439124b">fst::GrammarFst::InitEntryOrReentryArcs</a></div><div class="ttdeci">void InitEntryOrReentryArcs(const ConstFst&lt; StdArc &gt; &amp;fst, int32 entry_state, int32 nonterminal_symbol, std::unordered_map&lt; int32, int32 &gt; *phone_to_arc)</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8cc_source.html#l00135">grammar-fst.cc:135</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_adc925c31b57e960b56eb179f9a3cb17b"><div class="ttname"><a href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">fst::GrammarFst::instances_</a></div><div class="ttdeci">std::vector&lt; FstInstance &gt; instances_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00472">grammar-fst.h:472</a></div></div>
<div class="ttc" id="namespacefst_html_a251b709d87fe58fc66599f483fb98bd2af2f1f7ed744565c5728529dcce2e2ef5"><div class="ttname"><a href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2af2f1f7ed744565c5728529dcce2e2ef5">fst::kNontermReenter</a></div><div class="ttdef"><b>Definition:</b> <a href="grammar-context-fst_8h_source.html#l00072">grammar-context-fst.h:72</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_adbdafb790b8c9a3c39f7880b8d64136d"><div class="ttname"><a href="classfst_1_1GrammarFst.html#adbdafb790b8c9a3c39f7880b8d64136d">fst::GrammarFst::GetPhoneSymbolFor</a></div><div class="ttdeci">int32 GetPhoneSymbolFor(enum NonterminalValues n)</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00252">grammar-fst.h:252</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00126">kaldi-error.h:126</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a3c5eec26f7b7e8d7a4a09f2aeb29ae1f"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a3c5eec26f7b7e8d7a4a09f2aeb29ae1f">fst::GrammarFst::ifsts_</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; int32, const ConstFst&lt; StdArc &gt; * &gt; &gt; ifsts_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00453">grammar-fst.h:453</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7d457ccb91ac9095428ec77b504bb01c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d457ccb91ac9095428ec77b504bb01c">&#9670;&nbsp;</a></span>GetExpandedState()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfst_1_1GrammarFst_1_1ExpandedState.html">ExpandedState</a>* GetExpandedState </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>instance_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfst_1_1GrammarFst.html#a8086078c61f5b3c4959476d0a59c2836">BaseStateId</a>&#160;</td>
          <td class="paramname"><em>state_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Called from the ArcIterator constructor when we encounter an FST state with nonzero final-prob, this function first looks up this state_id in 'expanded_states' member of the corresponding <a class="el" href="structfst_1_1GrammarFst_1_1FstInstance.html">FstInstance</a>, and returns it if already present; otherwise it populates the 'expanded_states' map with something for this state_id and returns the value. </p>

<p class="definition">Definition at line <a class="el" href="grammar-fst_8h_source.html#l00339">339</a> of file <a class="el" href="grammar-fst_8h_source.html">grammar-fst.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="grammar-fst_8h_source.html#l00498">ArcIterator&lt; GrammarFst &gt;::ArcIterator()</a>.</p>
<div class="fragment"><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                                                               {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    std::unordered_map&lt;BaseStateId, ExpandedState*&gt; &amp;expanded_states =</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <a class="code" href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">instances_</a>[instance_id].expanded_states;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    std::unordered_map&lt;BaseStateId, ExpandedState*&gt;::iterator iter =</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        expanded_states.find(state_id);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">if</span> (iter != expanded_states.end()) {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <span class="keywordflow">return</span> iter-&gt;second;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      ExpandedState *ans = <a class="code" href="classfst_1_1GrammarFst.html#a2a8a892a0794d0cefabeec2a8860d4dc">ExpandState</a>(instance_id, state_id);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="comment">// Don&#39;t use the reference &#39;expanded_states&#39;; it could have been</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <span class="comment">// invalidated.</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <a class="code" href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">instances_</a>[instance_id].expanded_states[state_id] = ans;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      <span class="keywordflow">return</span> ans;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    }</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  }</div><div class="ttc" id="classfst_1_1GrammarFst_html_a2a8a892a0794d0cefabeec2a8860d4dc"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a2a8a892a0794d0cefabeec2a8860d4dc">fst::GrammarFst::ExpandState</a></div><div class="ttdeci">ExpandedState * ExpandState(int32 instance_id, BaseStateId state_id)</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8cc_source.html#l00173">grammar-fst.cc:173</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_adc925c31b57e960b56eb179f9a3cb17b"><div class="ttname"><a href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">fst::GrammarFst::instances_</a></div><div class="ttdeci">std::vector&lt; FstInstance &gt; instances_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00472">grammar-fst.h:472</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adbdafb790b8c9a3c39f7880b8d64136d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbdafb790b8c9a3c39f7880b8d64136d">&#9670;&nbsp;</a></span>GetPhoneSymbolFor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 GetPhoneSymbolFor </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2">NonterminalValues</a>&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8h_source.html#l00252">252</a> of file <a class="el" href="grammar-fst_8h_source.html">grammar-fst.h</a>.</p>

<p class="reference">References <a class="el" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">rnnlm::n</a>.</p>
<div class="fragment"><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                                                           {</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classfst_1_1GrammarFst.html#a56db4c50d7ba7ecdac05db5856374e81">nonterm_phones_offset_</a> + <span class="keyword">static_cast&lt;</span>int32<span class="keyword">&gt;</span>(<a class="code" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">n</a>);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  }</div><div class="ttc" id="namespacernnlm_html_ab4871778d570f724a07823e0a2fb9884"><div class="ttname"><a href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@11::@12 n</div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a56db4c50d7ba7ecdac05db5856374e81"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a56db4c50d7ba7ecdac05db5856374e81">fst::GrammarFst::nonterm_phones_offset_</a></div><div class="ttdeci">int32 nonterm_phones_offset_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00443">grammar-fst.h:443</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1e3b6d38df0786ccf7f938d60e386aae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e3b6d38df0786ccf7f938d60e386aae">&#9670;&nbsp;</a></span>Init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8cc_source.html#l00036">36</a> of file <a class="el" href="grammar-fst_8cc_source.html">grammar-fst.cc</a>.</p>

<p class="reference">References <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>.</p>
<div class="fragment"><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                      {</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classfst_1_1GrammarFst.html#a56db4c50d7ba7ecdac05db5856374e81">nonterm_phones_offset_</a> &gt; 1);</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <a class="code" href="classfst_1_1GrammarFst.html#a8ad20dddb56f73904c0d427e51f2eb4f">InitNonterminalMap</a>();</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="classfst_1_1GrammarFst.html#a9de1f012d8b92d4a2d7522abedc9a884">entry_arcs_</a>.resize(<a class="code" href="classfst_1_1GrammarFst.html#a3c5eec26f7b7e8d7a4a09f2aeb29ae1f">ifsts_</a>.size());</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classfst_1_1GrammarFst.html#a3c5eec26f7b7e8d7a4a09f2aeb29ae1f">ifsts_</a>.empty()) {</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">// We call this mostly so that if something is wrong with the input FSTs, the</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">// problem will be detected sooner rather than later.</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// There would be no problem if we were to call InitEntryArcs(i)</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">// for all 0 &lt;= i &lt; ifsts_size(), but we choose to call it</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">// lazily on demand, to save startup time if the number of nonterminals</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">// is large.</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="classfst_1_1GrammarFst.html#a98a1bd90bcd088e6a889a7e61ce4a99b">InitEntryArcs</a>(0);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  }</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <a class="code" href="classfst_1_1GrammarFst.html#af2aa0f8fd6325fdede2bca6d013a2f29">InitInstances</a>();</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;}</div><div class="ttc" id="classfst_1_1GrammarFst_html_a9de1f012d8b92d4a2d7522abedc9a884"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a9de1f012d8b92d4a2d7522abedc9a884">fst::GrammarFst::entry_arcs_</a></div><div class="ttdeci">std::vector&lt; std::unordered_map&lt; int32, int32 &gt; &gt; entry_arcs_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00467">grammar-fst.h:467</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a8ad20dddb56f73904c0d427e51f2eb4f"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a8ad20dddb56f73904c0d427e51f2eb4f">fst::GrammarFst::InitNonterminalMap</a></div><div class="ttdeci">void InitNonterminalMap()</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8cc_source.html#l00102">grammar-fst.cc:102</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_af2aa0f8fd6325fdede2bca6d013a2f29"><div class="ttname"><a href="classfst_1_1GrammarFst.html#af2aa0f8fd6325fdede2bca6d013a2f29">fst::GrammarFst::InitInstances</a></div><div class="ttdeci">void InitInstances()</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8cc_source.html#l00126">grammar-fst.cc:126</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a98a1bd90bcd088e6a889a7e61ce4a99b"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a98a1bd90bcd088e6a889a7e61ce4a99b">fst::GrammarFst::InitEntryArcs</a></div><div class="ttdeci">void InitEntryArcs(int32 i)</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8cc_source.html#l00118">grammar-fst.cc:118</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a3c5eec26f7b7e8d7a4a09f2aeb29ae1f"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a3c5eec26f7b7e8d7a4a09f2aeb29ae1f">fst::GrammarFst::ifsts_</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; int32, const ConstFst&lt; StdArc &gt; * &gt; &gt; ifsts_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00453">grammar-fst.h:453</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a56db4c50d7ba7ecdac05db5856374e81"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a56db4c50d7ba7ecdac05db5856374e81">fst::GrammarFst::nonterm_phones_offset_</a></div><div class="ttdeci">int32 nonterm_phones_offset_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00443">grammar-fst.h:443</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a98a1bd90bcd088e6a889a7e61ce4a99b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98a1bd90bcd088e6a889a7e61ce4a99b">&#9670;&nbsp;</a></span>InitEntryArcs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void InitEntryArcs </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8cc_source.html#l00118">118</a> of file <a class="el" href="grammar-fst_8cc_source.html">grammar-fst.cc</a>.</p>

<p class="reference">References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, and <a class="el" href="grammar-context-fst_8h_source.html#l00070">fst::kNontermBegin</a>.</p>
<div class="fragment"><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                                      {</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(static_cast&lt;size_t&gt;(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt; <a class="code" href="classfst_1_1GrammarFst.html#a3c5eec26f7b7e8d7a4a09f2aeb29ae1f">ifsts_</a>.size());</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keyword">const</span> ConstFst&lt;StdArc&gt; &amp;<a class="code" href="namespacefst.html">fst</a> = *(<a class="code" href="classfst_1_1GrammarFst.html#a3c5eec26f7b7e8d7a4a09f2aeb29ae1f">ifsts_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].second);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <a class="code" href="classfst_1_1GrammarFst.html#a9a0814345f5aa1ad5ada7b9a4439124b">InitEntryOrReentryArcs</a>(fst, fst.Start(),</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                         <a class="code" href="classfst_1_1GrammarFst.html#adbdafb790b8c9a3c39f7880b8d64136d">GetPhoneSymbolFor</a>(<a class="code" href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2a853f28d67c5daf316eecc91390831332">kNontermBegin</a>),</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                         &amp;(<a class="code" href="classfst_1_1GrammarFst.html#a9de1f012d8b92d4a2d7522abedc9a884">entry_arcs_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]));</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;}</div><div class="ttc" id="classfst_1_1GrammarFst_html_a9de1f012d8b92d4a2d7522abedc9a884"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a9de1f012d8b92d4a2d7522abedc9a884">fst::GrammarFst::entry_arcs_</a></div><div class="ttdeci">std::vector&lt; std::unordered_map&lt; int32, int32 &gt; &gt; entry_arcs_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00467">grammar-fst.h:467</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a9a0814345f5aa1ad5ada7b9a4439124b"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a9a0814345f5aa1ad5ada7b9a4439124b">fst::GrammarFst::InitEntryOrReentryArcs</a></div><div class="ttdeci">void InitEntryOrReentryArcs(const ConstFst&lt; StdArc &gt; &amp;fst, int32 entry_state, int32 nonterminal_symbol, std::unordered_map&lt; int32, int32 &gt; *phone_to_arc)</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8cc_source.html#l00135">grammar-fst.cc:135</a></div></div>
<div class="ttc" id="namespacefst_html"><div class="ttname"><a href="namespacefst.html">fst</a></div><div class="ttdoc">For an extended explanation of the framework of which grammar-fsts are a part, please see Support for...</div><div class="ttdef"><b>Definition:</b> <a href="graph_8dox_source.html#l00021">graph.dox:21</a></div></div>
<div class="ttc" id="namespacefst_html_a251b709d87fe58fc66599f483fb98bd2a853f28d67c5daf316eecc91390831332"><div class="ttname"><a href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2a853f28d67c5daf316eecc91390831332">fst::kNontermBegin</a></div><div class="ttdef"><b>Definition:</b> <a href="grammar-context-fst_8h_source.html#l00070">grammar-context-fst.h:70</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_adbdafb790b8c9a3c39f7880b8d64136d"><div class="ttname"><a href="classfst_1_1GrammarFst.html#adbdafb790b8c9a3c39f7880b8d64136d">fst::GrammarFst::GetPhoneSymbolFor</a></div><div class="ttdeci">int32 GetPhoneSymbolFor(enum NonterminalValues n)</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00252">grammar-fst.h:252</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a3c5eec26f7b7e8d7a4a09f2aeb29ae1f"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a3c5eec26f7b7e8d7a4a09f2aeb29ae1f">fst::GrammarFst::ifsts_</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; int32, const ConstFst&lt; StdArc &gt; * &gt; &gt; ifsts_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00453">grammar-fst.h:453</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9a0814345f5aa1ad5ada7b9a4439124b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a0814345f5aa1ad5ada7b9a4439124b">&#9670;&nbsp;</a></span>InitEntryOrReentryArcs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void InitEntryOrReentryArcs </td>
          <td>(</td>
          <td class="paramtype">const ConstFst&lt; <a class="el" href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">StdArc</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>fst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>entry_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>nonterminal_symbol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unordered_map&lt; int32, int32 &gt; *&#160;</td>
          <td class="paramname"><em>phone_to_arc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8cc_source.html#l00135">135</a> of file <a class="el" href="grammar-fst_8cc_source.html">grammar-fst.cc</a>.</p>

<p class="reference">References <a class="el" href="kaldi-error_8h_source.html#l00126">KALDI_ERR</a>, and <a class="el" href="grammar-context-fst_8h_source.html#l00080">fst::kNontermBigNumber</a>.</p>
<div class="fragment"><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                                                  {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  phone_to_arc-&gt;clear();</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  ArcIterator&lt;ConstFst&lt;StdArc&gt; &gt; aiter(<a class="code" href="namespacefst.html">fst</a>, entry_state);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  int32 arc_index = 0;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keywordflow">for</span> (; !aiter.Done(); aiter.Next(), ++arc_index) {</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">StdArc</a> &amp;arc = aiter.Value();</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    int32 nonterminal, left_context_phone;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">if</span> (arc.ilabel &lt;= (int32)<a class="code" href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2aafc1d79474b5b834eae90c6a9c42790f">kNontermBigNumber</a>) {</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="keywordflow">if</span> (entry_state == <a class="code" href="namespacefst.html">fst</a>.Start()) {</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;There is something wrong with the graph; did you forget to &quot;</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            <span class="stringliteral">&quot;add #nonterm_begin and #nonterm_end to the non-top-level FSTs &quot;</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <span class="stringliteral">&quot;before compiling?&quot;</span>;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;There is something wrong with the graph; re-entry state is &quot;</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <span class="stringliteral">&quot;not as anticipated.&quot;</span>;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    }</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="classfst_1_1GrammarFst.html#a9956a77f3a82dfddc07f7ee649d07bc4">DecodeSymbol</a>(arc.ilabel, &amp;nonterminal, &amp;left_context_phone);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordflow">if</span> (nonterminal != expected_nonterminal_symbol) {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Expected arcs from this state to have nonterminal-symbol &quot;</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                &lt;&lt; expected_nonterminal_symbol &lt;&lt; <span class="stringliteral">&quot;, but got &quot;</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                &lt;&lt; nonterminal;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    }</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    std::pair&lt;int32, int32&gt; p(left_context_phone, arc_index);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">if</span> (!phone_to_arc-&gt;insert(p).second) {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="comment">// If it was not successfully inserted in the phone_to_arc map, it means</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="comment">// there were two arcs with the same left-context phone, which does not</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="comment">// make sense; that&#39;s an error, likely a code error (or an error when the</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="comment">// input FSTs were generated).</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Two arcs had the same left-context phone.&quot;</span>;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    }</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  }</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;}</div><div class="ttc" id="namespacefst_html_a251b709d87fe58fc66599f483fb98bd2aafc1d79474b5b834eae90c6a9c42790f"><div class="ttname"><a href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2aafc1d79474b5b834eae90c6a9c42790f">fst::kNontermBigNumber</a></div><div class="ttdef"><b>Definition:</b> <a href="grammar-context-fst_8h_source.html#l00080">grammar-context-fst.h:80</a></div></div>
<div class="ttc" id="namespacefst_html"><div class="ttname"><a href="namespacefst.html">fst</a></div><div class="ttdoc">For an extended explanation of the framework of which grammar-fsts are a part, please see Support for...</div><div class="ttdef"><b>Definition:</b> <a href="graph_8dox_source.html#l00021">graph.dox:21</a></div></div>
<div class="ttc" id="namespacefst_html_a70478eb2428a9406e4692d19a7a3a97f"><div class="ttname"><a href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">fst::StdArc</a></div><div class="ttdeci">fst::StdArc StdArc</div><div class="ttdef"><b>Definition:</b> <a href="deterministic-fst-test_8cc_source.html#l00053">deterministic-fst-test.cc:53</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00126">kaldi-error.h:126</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a9956a77f3a82dfddc07f7ee649d07bc4"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a9956a77f3a82dfddc07f7ee649d07bc4">fst::GrammarFst::DecodeSymbol</a></div><div class="ttdeci">void DecodeSymbol(Label label, int32 *nonterminal_symbol, int32 *left_context_phone)</div><div class="ttdoc">Decodes an ilabel into a pair (nonterminal, left_context_phone). </div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8cc_source.html#l00080">grammar-fst.cc:80</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af2aa0f8fd6325fdede2bca6d013a2f29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2aa0f8fd6325fdede2bca6d013a2f29">&#9670;&nbsp;</a></span>InitInstances()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void InitInstances </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8cc_source.html#l00126">126</a> of file <a class="el" href="grammar-fst_8cc_source.html">grammar-fst.cc</a>.</p>

<p class="reference">References <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>.</p>
<div class="fragment"><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                               {</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">instances_</a>.empty());</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <a class="code" href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">instances_</a>.resize(1);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <a class="code" href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">instances_</a>[0].ifst_index = -1;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <a class="code" href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">instances_</a>[0].fst = <a class="code" href="classfst_1_1GrammarFst.html#ad68dfecca65ab013329921e1c178b455">top_fst_</a>;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <a class="code" href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">instances_</a>[0].parent_instance = -1;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <a class="code" href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">instances_</a>[0].parent_state = -1;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;}</div><div class="ttc" id="classfst_1_1GrammarFst_html_adc925c31b57e960b56eb179f9a3cb17b"><div class="ttname"><a href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">fst::GrammarFst::instances_</a></div><div class="ttdeci">std::vector&lt; FstInstance &gt; instances_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00472">grammar-fst.h:472</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_ad68dfecca65ab013329921e1c178b455"><div class="ttname"><a href="classfst_1_1GrammarFst.html#ad68dfecca65ab013329921e1c178b455">fst::GrammarFst::top_fst_</a></div><div class="ttdeci">const ConstFst&lt; StdArc &gt; * top_fst_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00448">grammar-fst.h:448</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8ad20dddb56f73904c0d427e51f2eb4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ad20dddb56f73904c0d427e51f2eb4f">&#9670;&nbsp;</a></span>InitNonterminalMap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void InitNonterminalMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8cc_source.html#l00102">102</a> of file <a class="el" href="grammar-fst_8cc_source.html">grammar-fst.cc</a>.</p>

<p class="reference">References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00126">KALDI_ERR</a>, and <a class="el" href="grammar-context-fst_8h_source.html#l00073">fst::kNontermUserDefined</a>.</p>
<div class="fragment"><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                                    {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="classfst_1_1GrammarFst.html#a05f1d86c7978348900bb85cc73690a4d">nonterminal_map_</a>.clear();</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classfst_1_1GrammarFst.html#a3c5eec26f7b7e8d7a4a09f2aeb29ae1f">ifsts_</a>.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    int32 nonterminal = <a class="code" href="classfst_1_1GrammarFst.html#a3c5eec26f7b7e8d7a4a09f2aeb29ae1f">ifsts_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].first;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classfst_1_1GrammarFst.html#a05f1d86c7978348900bb85cc73690a4d">nonterminal_map_</a>.count(nonterminal))</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Nonterminal symbol &quot;</span> &lt;&lt; nonterminal</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; is paired with two FSTs.&quot;</span>;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">if</span> (nonterminal &lt; <a class="code" href="classfst_1_1GrammarFst.html#adbdafb790b8c9a3c39f7880b8d64136d">GetPhoneSymbolFor</a>(<a class="code" href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2a9407a1ae01a2fea99f092723c3c3cbc0">kNontermUserDefined</a>))</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Nonterminal symbol &quot;</span> &lt;&lt; nonterminal</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; in input pairs, was expected to be &gt;= &quot;</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                &lt;&lt; <a class="code" href="classfst_1_1GrammarFst.html#adbdafb790b8c9a3c39f7880b8d64136d">GetPhoneSymbolFor</a>(<a class="code" href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2a9407a1ae01a2fea99f092723c3c3cbc0">kNontermUserDefined</a>);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="classfst_1_1GrammarFst.html#a05f1d86c7978348900bb85cc73690a4d">nonterminal_map_</a>[nonterminal] = <span class="keyword">static_cast&lt;</span>int32<span class="keyword">&gt;</span>(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  }</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;}</div><div class="ttc" id="classfst_1_1GrammarFst_html_a05f1d86c7978348900bb85cc73690a4d"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a05f1d86c7978348900bb85cc73690a4d">fst::GrammarFst::nonterminal_map_</a></div><div class="ttdeci">std::unordered_map&lt; int32, int32 &gt; nonterminal_map_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00457">grammar-fst.h:457</a></div></div>
<div class="ttc" id="namespacefst_html_a251b709d87fe58fc66599f483fb98bd2a9407a1ae01a2fea99f092723c3c3cbc0"><div class="ttname"><a href="namespacefst.html#a251b709d87fe58fc66599f483fb98bd2a9407a1ae01a2fea99f092723c3c3cbc0">fst::kNontermUserDefined</a></div><div class="ttdef"><b>Definition:</b> <a href="grammar-context-fst_8h_source.html#l00073">grammar-context-fst.h:73</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_adbdafb790b8c9a3c39f7880b8d64136d"><div class="ttname"><a href="classfst_1_1GrammarFst.html#adbdafb790b8c9a3c39f7880b8d64136d">fst::GrammarFst::GetPhoneSymbolFor</a></div><div class="ttdeci">int32 GetPhoneSymbolFor(enum NonterminalValues n)</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00252">grammar-fst.h:252</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00126">kaldi-error.h:126</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a3c5eec26f7b7e8d7a4a09f2aeb29ae1f"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a3c5eec26f7b7e8d7a4a09f2aeb29ae1f">fst::GrammarFst::ifsts_</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; int32, const ConstFst&lt; StdArc &gt; * &gt; &gt; ifsts_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00453">grammar-fst.h:453</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa50b206fd7185396de5c158d7f2564cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa50b206fd7185396de5c158d7f2564cb">&#9670;&nbsp;</a></span>NumInputEpsilons()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classsize__t.html">size_t</a> NumInputEpsilons </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfst_1_1GrammarFst.html#a4ace4c191c83fe28b57d4d080ae967b0">StateId</a>&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8h_source.html#l00181">181</a> of file <a class="el" href="grammar-fst_8h_source.html">grammar-fst.h</a>.</p>

<p class="reference">References <a class="el" href="grammar-fst_8h_source.html#l00393">GrammarFst::FstInstance::fst</a>, and <a class="el" href="grammar-fst_8h_source.html#l00067">KALDI_GRAMMAR_FST_SPECIAL_WEIGHT</a>.</p>
<div class="fragment"><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                                                  {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">// Compare with the constructor of ArcIterator.</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    int32 instance_id = s &gt;&gt; 32;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="classfst_1_1GrammarFst.html#a8086078c61f5b3c4959476d0a59c2836">BaseStateId</a> base_state = <span class="keyword">static_cast&lt;</span>int32<span class="keyword">&gt;</span>(s);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keyword">const</span> GrammarFst::FstInstance &amp;instance = <a class="code" href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">instances_</a>[instance_id];</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keyword">const</span> ConstFst&lt;StdArc&gt; *base_fst = instance.fst;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">if</span> (base_fst-&gt;Final(base_state).Value() != <a class="code" href="grammar-fst_8h.html#ac5ec65c3c945b6fcf47a7f303304b1a4">KALDI_GRAMMAR_FST_SPECIAL_WEIGHT</a>) {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordflow">return</span> base_fst-&gt;NumInputEpsilons(base_state);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    }</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  }</div><div class="ttc" id="classfst_1_1GrammarFst_html_adc925c31b57e960b56eb179f9a3cb17b"><div class="ttname"><a href="classfst_1_1GrammarFst.html#adc925c31b57e960b56eb179f9a3cb17b">fst::GrammarFst::instances_</a></div><div class="ttdeci">std::vector&lt; FstInstance &gt; instances_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00472">grammar-fst.h:472</a></div></div>
<div class="ttc" id="grammar-fst_8h_html_ac5ec65c3c945b6fcf47a7f303304b1a4"><div class="ttname"><a href="grammar-fst_8h.html#ac5ec65c3c945b6fcf47a7f303304b1a4">KALDI_GRAMMAR_FST_SPECIAL_WEIGHT</a></div><div class="ttdeci">#define KALDI_GRAMMAR_FST_SPECIAL_WEIGHT</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00067">grammar-fst.h:67</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a8086078c61f5b3c4959476d0a59c2836"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a8086078c61f5b3c4959476d0a59c2836">fst::GrammarFst::BaseStateId</a></div><div class="ttdeci">StdArc::StateId BaseStateId</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00102">grammar-fst.h:102</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae2892c501e401b523a3eb774e735d64d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2892c501e401b523a3eb774e735d64d">&#9670;&nbsp;</a></span>Read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Read </td>
          <td>(</td>
          <td class="paramtype">std::istream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>binary</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8cc_source.html#l00418">418</a> of file <a class="el" href="grammar-fst_8cc_source.html">grammar-fst.cc</a>.</p>

<p class="reference">References <a class="el" href="io-funcs_8cc_source.html#l00194">kaldi::ExpectToken()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00126">KALDI_ERR</a>, <a class="el" href="io-funcs-inl_8h_source.html#l00055">kaldi::ReadBasicType()</a>, and <a class="el" href="grammar-fst_8cc_source.html#l00404">fst::ReadConstFstFromStream()</a>.</p>
<div class="fragment"><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                                                 {</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="keyword">using namespace </span><a class="code" href="namespacekaldi.html">kaldi</a>;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keywordflow">if</span> (!binary)</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;GrammarFst::Read only supports binary mode.&quot;</span>;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classfst_1_1GrammarFst.html#ad68dfecca65ab013329921e1c178b455">top_fst_</a> != NULL)</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <a class="code" href="classfst_1_1GrammarFst.html#ac919a991060ede6983343719401686de">Destroy</a>();</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  int32 format = 1, num_ifsts;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga4c7a80f758e878578e78b667f62463a5">ExpectToken</a>(is, binary, <span class="stringliteral">&quot;&lt;GrammarFst&gt;&quot;</span>);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, binary, &amp;format);</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="keywordflow">if</span> (format != 1)</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;This version of the code cannot read this GrammarFst, &quot;</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="stringliteral">&quot;update your code.&quot;</span>;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, binary, &amp;num_ifsts);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, binary, &amp;<a class="code" href="classfst_1_1GrammarFst.html#a56db4c50d7ba7ecdac05db5856374e81">nonterm_phones_offset_</a>);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <a class="code" href="classfst_1_1GrammarFst.html#ad68dfecca65ab013329921e1c178b455">top_fst_</a> = <a class="code" href="namespacefst.html#a279c469277315d755bd9ed37d718c377">ReadConstFstFromStream</a>(is);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <a class="code" href="classfst_1_1GrammarFst.html#ad061d7149ef830dd0d7eb4aae390a0fd">fsts_to_delete_</a>.push_back(<a class="code" href="classfst_1_1GrammarFst.html#ad68dfecca65ab013329921e1c178b455">top_fst_</a>);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; num_ifsts; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    int32 nonterminal;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, binary, &amp;nonterminal);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    ConstFst&lt;StdArc&gt; *this_fst =  <a class="code" href="namespacefst.html#a279c469277315d755bd9ed37d718c377">ReadConstFstFromStream</a>(is);</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <a class="code" href="classfst_1_1GrammarFst.html#ad061d7149ef830dd0d7eb4aae390a0fd">fsts_to_delete_</a>.push_back(this_fst);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <a class="code" href="classfst_1_1GrammarFst.html#a3c5eec26f7b7e8d7a4a09f2aeb29ae1f">ifsts_</a>.push_back(std::pair&lt;int32, <span class="keyword">const</span> ConstFst&lt;StdArc&gt;* &gt;(nonterminal,</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                                                                this_fst));</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  }</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <a class="code" href="classfst_1_1GrammarFst.html#a1e3b6d38df0786ccf7f938d60e386aae">Init</a>();</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;}</div><div class="ttc" id="namespacekaldi_html"><div class="ttname"><a href="namespacekaldi.html">kaldi</a></div><div class="ttdoc">Relabels neural network egs with the read pdf-id alignments. </div><div class="ttdef"><b>Definition:</b> <a href="chain_8dox_source.html#l00020">chain.dox:20</a></div></div>
<div class="ttc" id="namespacefst_html_a279c469277315d755bd9ed37d718c377"><div class="ttname"><a href="namespacefst.html#a279c469277315d755bd9ed37d718c377">fst::ReadConstFstFromStream</a></div><div class="ttdeci">static ConstFst&lt; StdArc &gt; * ReadConstFstFromStream(std::istream &amp;is)</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8cc_source.html#l00404">grammar-fst.cc:404</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_ad061d7149ef830dd0d7eb4aae390a0fd"><div class="ttname"><a href="classfst_1_1GrammarFst.html#ad061d7149ef830dd0d7eb4aae390a0fd">fst::GrammarFst::fsts_to_delete_</a></div><div class="ttdeci">std::vector&lt; const ConstFst&lt; StdArc &gt; * &gt; fsts_to_delete_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00477">grammar-fst.h:477</a></div></div>
<div class="ttc" id="group__io__funcs__basic_html_ga1bd1af0ef712b76f2332febcec8d095a"><div class="ttname"><a href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">kaldi::ReadBasicType</a></div><div class="ttdeci">void ReadBasicType(std::istream &amp;is, bool binary, T *t)</div><div class="ttdoc">ReadBasicType is the name of the read function for bool, integer types, and floating-point types...</div><div class="ttdef"><b>Definition:</b> <a href="io-funcs-inl_8h_source.html#l00055">io-funcs-inl.h:55</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_ac919a991060ede6983343719401686de"><div class="ttname"><a href="classfst_1_1GrammarFst.html#ac919a991060ede6983343719401686de">fst::GrammarFst::Destroy</a></div><div class="ttdeci">void Destroy()</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8cc_source.html#l00056">grammar-fst.cc:56</a></div></div>
<div class="ttc" id="group__io__funcs__basic_html_ga4c7a80f758e878578e78b667f62463a5"><div class="ttname"><a href="group__io__funcs__basic.html#ga4c7a80f758e878578e78b667f62463a5">kaldi::ExpectToken</a></div><div class="ttdeci">void ExpectToken(std::istream &amp;is, bool binary, const char *token)</div><div class="ttdoc">ExpectToken tries to read in the given token, and throws an exception on failure. ...</div><div class="ttdef"><b>Definition:</b> <a href="io-funcs_8cc_source.html#l00194">io-funcs.cc:194</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_ad68dfecca65ab013329921e1c178b455"><div class="ttname"><a href="classfst_1_1GrammarFst.html#ad68dfecca65ab013329921e1c178b455">fst::GrammarFst::top_fst_</a></div><div class="ttdeci">const ConstFst&lt; StdArc &gt; * top_fst_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00448">grammar-fst.h:448</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a1e3b6d38df0786ccf7f938d60e386aae"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a1e3b6d38df0786ccf7f938d60e386aae">fst::GrammarFst::Init</a></div><div class="ttdeci">void Init()</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8cc_source.html#l00036">grammar-fst.cc:36</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00126">kaldi-error.h:126</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a3c5eec26f7b7e8d7a4a09f2aeb29ae1f"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a3c5eec26f7b7e8d7a4a09f2aeb29ae1f">fst::GrammarFst::ifsts_</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; int32, const ConstFst&lt; StdArc &gt; * &gt; &gt; ifsts_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00453">grammar-fst.h:453</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a56db4c50d7ba7ecdac05db5856374e81"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a56db4c50d7ba7ecdac05db5856374e81">fst::GrammarFst::nonterm_phones_offset_</a></div><div class="ttdeci">int32 nonterm_phones_offset_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00443">grammar-fst.h:443</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a505ff365f90ab7b3851c6c531ad772c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a505ff365f90ab7b3851c6c531ad772c2">&#9670;&nbsp;</a></span>Start()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfst_1_1GrammarFst.html#a4ace4c191c83fe28b57d4d080ae967b0">StateId</a> Start </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8h_source.html#l00156">156</a> of file <a class="el" href="grammar-fst_8h_source.html">grammar-fst.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="grammar-fst_8cc_source.html#l00867">fst::CopyToVectorFst()</a>.</p>
<div class="fragment"><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                        {</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// the top 32 bits of the 64-bit state-id will be zero, because the</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">// top FST instance has instance-id = 0.</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code" href="classfst_1_1GrammarFst.html#a4ace4c191c83fe28b57d4d080ae967b0">StateId</a><span class="keyword">&gt;</span>(<a class="code" href="classfst_1_1GrammarFst.html#ad68dfecca65ab013329921e1c178b455">top_fst_</a>-&gt;Start());</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  }</div><div class="ttc" id="classfst_1_1GrammarFst_html_ad68dfecca65ab013329921e1c178b455"><div class="ttname"><a href="classfst_1_1GrammarFst.html#ad68dfecca65ab013329921e1c178b455">fst::GrammarFst::top_fst_</a></div><div class="ttdeci">const ConstFst&lt; StdArc &gt; * top_fst_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00448">grammar-fst.h:448</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a4ace4c191c83fe28b57d4d080ae967b0"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a4ace4c191c83fe28b57d4d080ae967b0">fst::GrammarFst::StateId</a></div><div class="ttdeci">Arc::StateId StateId</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00099">grammar-fst.h:99</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9261b9326e20a8d1f6a9be72c1ad66db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9261b9326e20a8d1f6a9be72c1ad66db">&#9670;&nbsp;</a></span>Type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string Type </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8h_source.html#l00194">194</a> of file <a class="el" href="grammar-fst_8h_source.html">grammar-fst.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;{ <span class="keywordflow">return</span> <span class="stringliteral">&quot;grammar&quot;</span>; }</div></div><!-- fragment -->
</div>
</div>
<a id="a68f354fd5f096134162f01719096e6fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68f354fd5f096134162f01719096e6fc">&#9670;&nbsp;</a></span>Write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Write </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>binary</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8cc_source.html#l00381">381</a> of file <a class="el" href="grammar-fst_8cc_source.html">grammar-fst.cc</a>.</p>

<p class="reference">References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00126">KALDI_ERR</a>, <a class="el" href="io-funcs-inl_8h_source.html#l00034">kaldi::WriteBasicType()</a>, and <a class="el" href="io-funcs_8cc_source.html#l00134">kaldi::WriteToken()</a>.</p>
<div class="fragment"><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                                                        {</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="keyword">using namespace </span><a class="code" href="namespacekaldi.html">kaldi</a>;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="keywordflow">if</span> (!binary)</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;GrammarFst::Write only supports binary mode.&quot;</span>;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  int32 format = 1,</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      num_ifsts = <a class="code" href="classfst_1_1GrammarFst.html#a3c5eec26f7b7e8d7a4a09f2aeb29ae1f">ifsts_</a>.size();</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;GrammarFst&gt;&quot;</span>);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, format);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, num_ifsts);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, <a class="code" href="classfst_1_1GrammarFst.html#a56db4c50d7ba7ecdac05db5856374e81">nonterm_phones_offset_</a>);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  std::string stream_name(<span class="stringliteral">&quot;unknown&quot;</span>);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  FstWriteOptions wopts(stream_name);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <a class="code" href="classfst_1_1GrammarFst.html#ad68dfecca65ab013329921e1c178b455">top_fst_</a>-&gt;Write(os, wopts);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; num_ifsts; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    int32 nonterminal = <a class="code" href="classfst_1_1GrammarFst.html#a3c5eec26f7b7e8d7a4a09f2aeb29ae1f">ifsts_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].first;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, nonterminal);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <a class="code" href="classfst_1_1GrammarFst.html#a3c5eec26f7b7e8d7a4a09f2aeb29ae1f">ifsts_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].second-&gt;Write(os, wopts);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  }</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;/GrammarFst&gt;&quot;</span>);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;}</div><div class="ttc" id="namespacekaldi_html"><div class="ttname"><a href="namespacekaldi.html">kaldi</a></div><div class="ttdoc">Relabels neural network egs with the read pdf-id alignments. </div><div class="ttdef"><b>Definition:</b> <a href="chain_8dox_source.html#l00020">chain.dox:20</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_ad68dfecca65ab013329921e1c178b455"><div class="ttname"><a href="classfst_1_1GrammarFst.html#ad68dfecca65ab013329921e1c178b455">fst::GrammarFst::top_fst_</a></div><div class="ttdeci">const ConstFst&lt; StdArc &gt; * top_fst_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00448">grammar-fst.h:448</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00126">kaldi-error.h:126</a></div></div>
<div class="ttc" id="group__io__funcs__basic_html_ga87f1638ef3c0a3ee117178b202c2d02a"><div class="ttname"><a href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">kaldi::WriteToken</a></div><div class="ttdeci">void WriteToken(std::ostream &amp;os, bool binary, const char *token)</div><div class="ttdoc">The WriteToken functions are for writing nonempty sequences of non-space characters. </div><div class="ttdef"><b>Definition:</b> <a href="io-funcs_8cc_source.html#l00134">io-funcs.cc:134</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a3c5eec26f7b7e8d7a4a09f2aeb29ae1f"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a3c5eec26f7b7e8d7a4a09f2aeb29ae1f">fst::GrammarFst::ifsts_</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; int32, const ConstFst&lt; StdArc &gt; * &gt; &gt; ifsts_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00453">grammar-fst.h:453</a></div></div>
<div class="ttc" id="classfst_1_1GrammarFst_html_a56db4c50d7ba7ecdac05db5856374e81"><div class="ttname"><a href="classfst_1_1GrammarFst.html#a56db4c50d7ba7ecdac05db5856374e81">fst::GrammarFst::nonterm_phones_offset_</a></div><div class="ttdeci">int32 nonterm_phones_offset_</div><div class="ttdef"><b>Definition:</b> <a href="grammar-fst_8h_source.html#l00443">grammar-fst.h:443</a></div></div>
<div class="ttc" id="group__io__funcs__basic_html_ga108506a9aabafd9006926aa1b47617da"><div class="ttname"><a href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">kaldi::WriteBasicType</a></div><div class="ttdeci">void WriteBasicType(std::ostream &amp;os, bool binary, T t)</div><div class="ttdoc">WriteBasicType is the name of the write function for bool, integer types, and floating-point types...</div><div class="ttdef"><b>Definition:</b> <a href="io-funcs-inl_8h_source.html#l00034">io-funcs-inl.h:34</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a id="a043d69c81d6e3b54ced0552be5cbc14d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a043d69c81d6e3b54ced0552be5cbc14d">&#9670;&nbsp;</a></span>ArcIterator< GrammarFst ></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class ArcIterator&lt; <a class="el" href="classfst_1_1GrammarFst.html">GrammarFst</a> &gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8h_source.html#l00199">199</a> of file <a class="el" href="grammar-fst_8h_source.html">grammar-fst.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a9de1f012d8b92d4a2d7522abedc9a884"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9de1f012d8b92d4a2d7522abedc9a884">&#9670;&nbsp;</a></span>entry_arcs_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::unordered_map&lt;int32, int32&gt; &gt; entry_arcs_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8h_source.html#l00467">467</a> of file <a class="el" href="grammar-fst_8h_source.html">grammar-fst.h</a>.</p>

</div>
</div>
<a id="ad061d7149ef830dd0d7eb4aae390a0fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad061d7149ef830dd0d7eb4aae390a0fd">&#9670;&nbsp;</a></span>fsts_to_delete_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;const ConstFst&lt;<a class="el" href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">StdArc</a>&gt; *&gt; fsts_to_delete_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8h_source.html#l00477">477</a> of file <a class="el" href="grammar-fst_8h_source.html">grammar-fst.h</a>.</p>

</div>
</div>
<a id="a3c5eec26f7b7e8d7a4a09f2aeb29ae1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c5eec26f7b7e8d7a4a09f2aeb29ae1f">&#9670;&nbsp;</a></span>ifsts_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::pair&lt;int32, const ConstFst&lt;<a class="el" href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">StdArc</a>&gt; *&gt; &gt; ifsts_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8h_source.html#l00453">453</a> of file <a class="el" href="grammar-fst_8h_source.html">grammar-fst.h</a>.</p>

</div>
</div>
<a id="adc925c31b57e960b56eb179f9a3cb17b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc925c31b57e960b56eb179f9a3cb17b">&#9670;&nbsp;</a></span>instances_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structfst_1_1GrammarFst_1_1FstInstance.html">FstInstance</a>&gt; instances_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8h_source.html#l00472">472</a> of file <a class="el" href="grammar-fst_8h_source.html">grammar-fst.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="grammar-fst_8h_source.html#l00498">ArcIterator&lt; GrammarFst &gt;::ArcIterator()</a>.</p>

</div>
</div>
<a id="a56db4c50d7ba7ecdac05db5856374e81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56db4c50d7ba7ecdac05db5856374e81">&#9670;&nbsp;</a></span>nonterm_phones_offset_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 nonterm_phones_offset_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8h_source.html#l00443">443</a> of file <a class="el" href="grammar-fst_8h_source.html">grammar-fst.h</a>.</p>

</div>
</div>
<a id="a05f1d86c7978348900bb85cc73690a4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05f1d86c7978348900bb85cc73690a4d">&#9670;&nbsp;</a></span>nonterminal_map_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt;int32, int32&gt; nonterminal_map_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8h_source.html#l00457">457</a> of file <a class="el" href="grammar-fst_8h_source.html">grammar-fst.h</a>.</p>

</div>
</div>
<a id="ad68dfecca65ab013329921e1c178b455"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad68dfecca65ab013329921e1c178b455">&#9670;&nbsp;</a></span>top_fst_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const ConstFst&lt;<a class="el" href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">StdArc</a>&gt;* top_fst_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="grammar-fst_8h_source.html#l00448">448</a> of file <a class="el" href="grammar-fst_8h_source.html">grammar-fst.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>decoder/<a class="el" href="grammar-fst_8h_source.html">grammar-fst.h</a></li>
<li>decoder/<a class="el" href="grammar-fst_8cc_source.html">grammar-fst.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefst.html">fst</a></li><li class="navelem"><a class="el" href="classfst_1_1GrammarFst.html">GrammarFst</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
