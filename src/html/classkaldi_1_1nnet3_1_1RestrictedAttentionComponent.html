<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Kaldi: RestrictedAttentionComponent Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" /> 
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
 <td id="projectlogo"><a href="http://kaldi-asr.org/"><img alt="Logo" src="KaldiTextAndLogoSmall.png"/ style="padding: 3px 5px 1px 5px"></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname" style="display:none">Kaldi
   </div>
  </td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief" style="display:none"></div>
    </td>
   <!--END PROJECT_BRIEF-->
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">RestrictedAttentionComponent Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html" title="RestrictedAttentionComponent implements an attention model with restricted temporal context...">RestrictedAttentionComponent</a> implements an attention model with restricted temporal context.  
 <a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="nnet-attention-component_8h_source.html">nnet-attention-component.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for RestrictedAttentionComponent:</div>
<div class="dyncontent">
<div class="center"><img src="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent__inherit__graph.png" border="0" usemap="#RestrictedAttentionComponent_inherit__map" alt="Inheritance graph"/></div>
<map name="RestrictedAttentionComponent_inherit__map" id="RestrictedAttentionComponent_inherit__map">
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for RestrictedAttentionComponent:</div>
<div class="dyncontent">
<div class="center"><img src="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent__coll__graph.png" border="0" usemap="#RestrictedAttentionComponent_coll__map" alt="Collaboration graph"/></div>
<map name="RestrictedAttentionComponent_coll__map" id="RestrictedAttentionComponent_coll__map">
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1Memo.html">Memo</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_1_1PrecomputedIndexes.html">PrecomputedIndexes</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa6b67c244ea18c836e74eed945b46657"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#aa6b67c244ea18c836e74eed945b46657">RestrictedAttentionComponent</a> ()</td></tr>
<tr class="separator:aa6b67c244ea18c836e74eed945b46657"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad510e5c5517d482ca0a0dd1e12a302eb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ad510e5c5517d482ca0a0dd1e12a302eb">RestrictedAttentionComponent</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html">RestrictedAttentionComponent</a> &amp;other)</td></tr>
<tr class="separator:ad510e5c5517d482ca0a0dd1e12a302eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4cb6aed1f1980c2c36f34e09ceea0e0"><td class="memItemLeft" align="right" valign="top">virtual int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ad4cb6aed1f1980c2c36f34e09ceea0e0">InputDim</a> () const</td></tr>
<tr class="memdesc:ad4cb6aed1f1980c2c36f34e09ceea0e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns input-dimension of this component.  <a href="#ad4cb6aed1f1980c2c36f34e09ceea0e0">More...</a><br /></td></tr>
<tr class="separator:ad4cb6aed1f1980c2c36f34e09ceea0e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a323155ad8034c0b14762dd78ae4415b5"><td class="memItemLeft" align="right" valign="top">virtual int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a323155ad8034c0b14762dd78ae4415b5">OutputDim</a> () const</td></tr>
<tr class="memdesc:a323155ad8034c0b14762dd78ae4415b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns output-dimension of this component.  <a href="#a323155ad8034c0b14762dd78ae4415b5">More...</a><br /></td></tr>
<tr class="separator:a323155ad8034c0b14762dd78ae4415b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a245d65d566725422b859c99bff7623f8"><td class="memItemLeft" align="right" valign="top">virtual std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a245d65d566725422b859c99bff7623f8">Info</a> () const</td></tr>
<tr class="memdesc:a245d65d566725422b859c99bff7623f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns some text-form information about this component, for diagnostics.  <a href="#a245d65d566725422b859c99bff7623f8">More...</a><br /></td></tr>
<tr class="separator:a245d65d566725422b859c99bff7623f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4f5c35427c2657c50173313e99e3f01"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac4f5c35427c2657c50173313e99e3f01">InitFromConfig</a> (<a class="el" href="classkaldi_1_1nnet3_1_1ConfigLine.html">ConfigLine</a> *cfl)</td></tr>
<tr class="memdesc:ac4f5c35427c2657c50173313e99e3f01"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize, from a <a class="el" href="classkaldi_1_1nnet3_1_1ConfigLine.html" title="This class is responsible for parsing input like hi-there xx=yyy a=b c empty= f-oo=Append(bar, sss) ba_z=123 bing=&#39;a b c&#39; baz=&quot;a b c d=&#39;a b&#39; e&quot; and giving you access to the fields, in this case. ">ConfigLine</a> object.  <a href="#ac4f5c35427c2657c50173313e99e3f01">More...</a><br /></td></tr>
<tr class="separator:ac4f5c35427c2657c50173313e99e3f01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2d951f58073f362411ee482aa469975"><td class="memItemLeft" align="right" valign="top">virtual std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#af2d951f58073f362411ee482aa469975">Type</a> () const</td></tr>
<tr class="memdesc:af2d951f58073f362411ee482aa469975"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a string such as "SigmoidComponent", describing the type of the object.  <a href="#af2d951f58073f362411ee482aa469975">More...</a><br /></td></tr>
<tr class="separator:af2d951f58073f362411ee482aa469975"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a16a6da3a5108ec53e759722a51fd47"><td class="memItemLeft" align="right" valign="top">virtual int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a16a6da3a5108ec53e759722a51fd47">Properties</a> () const</td></tr>
<tr class="memdesc:a4a16a6da3a5108ec53e759722a51fd47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return bitmask of the component's properties.  <a href="#a4a16a6da3a5108ec53e759722a51fd47">More...</a><br /></td></tr>
<tr class="separator:a4a16a6da3a5108ec53e759722a51fd47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f1f1b05a170bd81a544caefe1acb040"><td class="memItemLeft" align="right" valign="top">virtual void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f1f1b05a170bd81a544caefe1acb040">Propagate</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1ComponentPrecomputedIndexes.html">ComponentPrecomputedIndexes</a> *indexes, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;in, <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; *out) const</td></tr>
<tr class="memdesc:a8f1f1b05a170bd81a544caefe1acb040"><td class="mdescLeft">&#160;</td><td class="mdescRight">Propagate function.  <a href="#a8f1f1b05a170bd81a544caefe1acb040">More...</a><br /></td></tr>
<tr class="separator:a8f1f1b05a170bd81a544caefe1acb040"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd6c79cbaf8c63ca2e31105dd55bb4ab"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acd6c79cbaf8c63ca2e31105dd55bb4ab">StoreStats</a> (const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;in_value, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;out_value, void *memo)</td></tr>
<tr class="memdesc:acd6c79cbaf8c63ca2e31105dd55bb4ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function may store stats on average activation values, and for some component types, the average value of the derivative of the nonlinearity.  <a href="#acd6c79cbaf8c63ca2e31105dd55bb4ab">More...</a><br /></td></tr>
<tr class="separator:acd6c79cbaf8c63ca2e31105dd55bb4ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a4fc4a0524ae8957baf45b8cb168843"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a5a4fc4a0524ae8957baf45b8cb168843">Scale</a> (<a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> scale)</td></tr>
<tr class="memdesc:a5a4fc4a0524ae8957baf45b8cb168843"><td class="mdescLeft">&#160;</td><td class="mdescRight">This virtual function when called on &ndash; an <a class="el" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html" title="Class UpdatableComponent is a Component which has trainable parameters; it extends the interface of C...">UpdatableComponent</a> scales the parameters by "scale" when called by an <a class="el" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html" title="Class UpdatableComponent is a Component which has trainable parameters; it extends the interface of C...">UpdatableComponent</a>.  <a href="#a5a4fc4a0524ae8957baf45b8cb168843">More...</a><br /></td></tr>
<tr class="separator:a5a4fc4a0524ae8957baf45b8cb168843"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdb3e97b46276e3c9f4f696c2bef3943"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acdb3e97b46276e3c9f4f696c2bef3943">Add</a> (<a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> alpha, const <a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> &amp;other)</td></tr>
<tr class="memdesc:acdb3e97b46276e3c9f4f696c2bef3943"><td class="mdescLeft">&#160;</td><td class="mdescRight">This virtual function when called by &ndash; an <a class="el" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html" title="Class UpdatableComponent is a Component which has trainable parameters; it extends the interface of C...">UpdatableComponent</a> adds the parameters of another updatable component, times some constant, to the current parameters.  <a href="#acdb3e97b46276e3c9f4f696c2bef3943">More...</a><br /></td></tr>
<tr class="separator:acdb3e97b46276e3c9f4f696c2bef3943"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfee972431c5488d69a56fc1114c7cdc"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#abfee972431c5488d69a56fc1114c7cdc">ZeroStats</a> ()</td></tr>
<tr class="memdesc:abfee972431c5488d69a56fc1114c7cdc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Components that provide an implementation of StoreStats should also provide an implementation of <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#abfee972431c5488d69a56fc1114c7cdc" title="Components that provide an implementation of StoreStats should also provide an implementation of Zero...">ZeroStats()</a>, to set those stats to zero.  <a href="#abfee972431c5488d69a56fc1114c7cdc">More...</a><br /></td></tr>
<tr class="separator:abfee972431c5488d69a56fc1114c7cdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0f9bb1c29228fa0a498a19b83ac5190"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac0f9bb1c29228fa0a498a19b83ac5190">Backprop</a> (const std::string &amp;debug_info, const <a class="el" href="classkaldi_1_1nnet3_1_1ComponentPrecomputedIndexes.html">ComponentPrecomputedIndexes</a> *indexes, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;in_value, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;out_value, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;out_deriv, void *memo, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> *to_update, <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; *in_deriv) const</td></tr>
<tr class="memdesc:ac0f9bb1c29228fa0a498a19b83ac5190"><td class="mdescLeft">&#160;</td><td class="mdescRight">Backprop function; depending on which of the arguments 'to_update' and 'in_deriv' are non-NULL, this can compute input-data derivatives and/or perform model update.  <a href="#ac0f9bb1c29228fa0a498a19b83ac5190">More...</a><br /></td></tr>
<tr class="separator:ac0f9bb1c29228fa0a498a19b83ac5190"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e7d2790fc7e94fe9780ccc937de1270"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8e7d2790fc7e94fe9780ccc937de1270">Read</a> (std::istream &amp;is, <a class="el" href="classbool.html">bool</a> binary)</td></tr>
<tr class="memdesc:a8e7d2790fc7e94fe9780ccc937de1270"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read function (used after we know the type of the <a class="el" href="classkaldi_1_1nnet3_1_1Component.html" title="Abstract base-class for neural-net components. ">Component</a>); accepts input that is missing the token that describes the component type, in case it has already been consumed.  <a href="#a8e7d2790fc7e94fe9780ccc937de1270">More...</a><br /></td></tr>
<tr class="separator:a8e7d2790fc7e94fe9780ccc937de1270"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68f354fd5f096134162f01719096e6fc"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a68f354fd5f096134162f01719096e6fc">Write</a> (std::ostream &amp;os, <a class="el" href="classbool.html">bool</a> binary) const</td></tr>
<tr class="memdesc:a68f354fd5f096134162f01719096e6fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write component to stream.  <a href="#a68f354fd5f096134162f01719096e6fc">More...</a><br /></td></tr>
<tr class="separator:a68f354fd5f096134162f01719096e6fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1de31388e6c4839d855713baedc4f44b"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1de31388e6c4839d855713baedc4f44b">Copy</a> () const</td></tr>
<tr class="memdesc:a1de31388e6c4839d855713baedc4f44b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies component (deep copy).  <a href="#a1de31388e6c4839d855713baedc4f44b">More...</a><br /></td></tr>
<tr class="separator:a1de31388e6c4839d855713baedc4f44b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8eacf8174f9fa190732c320ee3cf1d62"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8eacf8174f9fa190732c320ee3cf1d62">DeleteMemo</a> (void *memo) const</td></tr>
<tr class="memdesc:a8eacf8174f9fa190732c320ee3cf1d62"><td class="mdescLeft">&#160;</td><td class="mdescRight">This virtual function only needs to be overwritten by Components that return a non-NULL memo from their <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f1f1b05a170bd81a544caefe1acb040" title="Propagate function. ">Propagate()</a> function.  <a href="#a8eacf8174f9fa190732c320ee3cf1d62">More...</a><br /></td></tr>
<tr class="separator:a8eacf8174f9fa190732c320ee3cf1d62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2133bab2e5e5e64e8136a341971f2012"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2133bab2e5e5e64e8136a341971f2012">ReorderIndexes</a> (std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; *input_indexes, std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; *output_indexes) const</td></tr>
<tr class="memdesc:a2133bab2e5e5e64e8136a341971f2012"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function only does something interesting for non-simple Components.  <a href="#a2133bab2e5e5e64e8136a341971f2012">More...</a><br /></td></tr>
<tr class="separator:a2133bab2e5e5e64e8136a341971f2012"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d7b185ac981780bcfaed7dfdd8908d8"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a9d7b185ac981780bcfaed7dfdd8908d8">GetInputIndexes</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1MiscComputationInfo.html">MiscComputationInfo</a> &amp;misc_info, const <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &amp;output_index, std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; *desired_indexes) const</td></tr>
<tr class="memdesc:a9d7b185ac981780bcfaed7dfdd8908d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function only does something interesting for non-simple Components.  <a href="#a9d7b185ac981780bcfaed7dfdd8908d8">More...</a><br /></td></tr>
<tr class="separator:a9d7b185ac981780bcfaed7dfdd8908d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a529c07610dd915a30e452f80b8bb5fc0"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a529c07610dd915a30e452f80b8bb5fc0">IsComputable</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1MiscComputationInfo.html">MiscComputationInfo</a> &amp;misc_info, const <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &amp;output_index, const <a class="el" href="classkaldi_1_1nnet3_1_1IndexSet.html">IndexSet</a> &amp;input_index_set, std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; *used_inputs) const</td></tr>
<tr class="memdesc:a529c07610dd915a30e452f80b8bb5fc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function only does something interesting for non-simple Components, and it exists to make it possible to manage optionally-required inputs.  <a href="#a529c07610dd915a30e452f80b8bb5fc0">More...</a><br /></td></tr>
<tr class="separator:a529c07610dd915a30e452f80b8bb5fc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b2919d1c6cfa5f73581f407150374b6"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classkaldi_1_1nnet3_1_1ComponentPrecomputedIndexes.html">ComponentPrecomputedIndexes</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8b2919d1c6cfa5f73581f407150374b6">PrecomputeIndexes</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1MiscComputationInfo.html">MiscComputationInfo</a> &amp;misc_info, const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; &amp;input_indexes, const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; &amp;output_indexes, <a class="el" href="classbool.html">bool</a> need_backprop) const</td></tr>
<tr class="memdesc:a8b2919d1c6cfa5f73581f407150374b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function must return NULL for simple Components.  <a href="#a8b2919d1c6cfa5f73581f407150374b6">More...</a><br /></td></tr>
<tr class="separator:a8b2919d1c6cfa5f73581f407150374b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classkaldi_1_1nnet3_1_1Component"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classkaldi_1_1nnet3_1_1Component')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a></td></tr>
<tr class="memitem:a44818f697d4e7fb11120645a16bd0e39 inherit pub_methods_classkaldi_1_1nnet3_1_1Component"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a44818f697d4e7fb11120645a16bd0e39">ConsolidateMemory</a> ()</td></tr>
<tr class="memdesc:a44818f697d4e7fb11120645a16bd0e39 inherit pub_methods_classkaldi_1_1nnet3_1_1Component"><td class="mdescLeft">&#160;</td><td class="mdescRight">This virtual function relates to memory management, and avoiding fragmentation.  <a href="classkaldi_1_1nnet3_1_1Component.html#a44818f697d4e7fb11120645a16bd0e39">More...</a><br /></td></tr>
<tr class="separator:a44818f697d4e7fb11120645a16bd0e39 inherit pub_methods_classkaldi_1_1nnet3_1_1Component"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0171e1571f18dc6a27c8b041de55feec inherit pub_methods_classkaldi_1_1nnet3_1_1Component"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a0171e1571f18dc6a27c8b041de55feec">Component</a> ()</td></tr>
<tr class="separator:a0171e1571f18dc6a27c8b041de55feec inherit pub_methods_classkaldi_1_1nnet3_1_1Component"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0df822d4b95a18b1df2529896638daeb inherit pub_methods_classkaldi_1_1nnet3_1_1Component"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a0df822d4b95a18b1df2529896638daeb">~Component</a> ()</td></tr>
<tr class="separator:a0df822d4b95a18b1df2529896638daeb inherit pub_methods_classkaldi_1_1nnet3_1_1Component"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a7493d5942eae2b80fceab01dd8bbff16"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a7493d5942eae2b80fceab01dd8bbff16">PropagateOneHead</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1time__height__convolution_1_1ConvolutionComputationIo.html">time_height_convolution::ConvolutionComputationIo</a> &amp;io, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;in, <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; *c, <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; *out) const</td></tr>
<tr class="separator:a7493d5942eae2b80fceab01dd8bbff16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37fc34ec7c7ab80d54c88e84a12d38e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a37fc34ec7c7ab80d54c88e84a12d38e0">BackpropOneHead</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1time__height__convolution_1_1ConvolutionComputationIo.html">time_height_convolution::ConvolutionComputationIo</a> &amp;io, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;in_value, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;c, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;out_deriv, <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; *in_deriv) const</td></tr>
<tr class="separator:a37fc34ec7c7ab80d54c88e84a12d38e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38367562a48aa99e77d5d2f6eded46c1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a38367562a48aa99e77d5d2f6eded46c1">GetComputationStructure</a> (const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; &amp;input_indexes, const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; &amp;output_indexes, <a class="el" href="structkaldi_1_1nnet3_1_1time__height__convolution_1_1ConvolutionComputationIo.html">time_height_convolution::ConvolutionComputationIo</a> *io) const</td></tr>
<tr class="separator:a38367562a48aa99e77d5d2f6eded46c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc71d7740bea7e0050f7ece2f3d575eb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#afc71d7740bea7e0050f7ece2f3d575eb">GetIndexes</a> (const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; &amp;input_indexes, const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; &amp;output_indexes, <a class="el" href="structkaldi_1_1nnet3_1_1time__height__convolution_1_1ConvolutionComputationIo.html">time_height_convolution::ConvolutionComputationIo</a> &amp;io, std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; *new_input_indexes, std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; *new_output_indexes) const</td></tr>
<tr class="separator:afc71d7740bea7e0050f7ece2f3d575eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c47fd4f163011eb1939870d25aa656a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4c47fd4f163011eb1939870d25aa656a">Check</a> () const</td></tr>
<tr class="separator:a4c47fd4f163011eb1939870d25aa656a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:a91eb639e00c2eafa02815a750be70f8a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a91eb639e00c2eafa02815a750be70f8a">CreateIndexesVector</a> (const std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &amp;n_x_pairs, int32 t_start, int32 t_step, int32 num_t_values, const std::unordered_set&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a>, <a class="el" href="structkaldi_1_1nnet3_1_1IndexHasher.html">IndexHasher</a> &gt; &amp;index_set, std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; *output_indexes)</td></tr>
<tr class="memdesc:a91eb639e00c2eafa02815a750be70f8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility function used in <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#afc71d7740bea7e0050f7ece2f3d575eb">GetIndexes()</a>.  <a href="#a91eb639e00c2eafa02815a750be70f8a">More...</a><br /></td></tr>
<tr class="separator:a91eb639e00c2eafa02815a750be70f8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ae53cc4977f9fbe6523374aaf5ba10c80"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">num_heads_</a></td></tr>
<tr class="separator:ae53cc4977f9fbe6523374aaf5ba10c80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a638e2d2a390900749819b63b06cba8"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a></td></tr>
<tr class="separator:a4a638e2d2a390900749819b63b06cba8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fb0e7f13f5d151b88cf0af7a28e6817"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a></td></tr>
<tr class="separator:a8fb0e7f13f5d151b88cf0af7a28e6817"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d7e5406fed09929350deb26767f25aa"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">num_left_inputs_</a></td></tr>
<tr class="separator:a4d7e5406fed09929350deb26767f25aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40571f26e91bce91b89f63840291c8ce"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">num_right_inputs_</a></td></tr>
<tr class="separator:a40571f26e91bce91b89f63840291c8ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43d674ac6ba436481c1c4672fd1bea77"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">time_stride_</a></td></tr>
<tr class="separator:a43d674ac6ba436481c1c4672fd1bea77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f2ba24a43264b8812e3e1e83878a59c"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a></td></tr>
<tr class="separator:a8f2ba24a43264b8812e3e1e83878a59c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e898f815954c8234cc4c17527168eb9"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a0e898f815954c8234cc4c17527168eb9">num_left_inputs_required_</a></td></tr>
<tr class="separator:a0e898f815954c8234cc4c17527168eb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d9705afdedc78fc1e64957f976085d0"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2d9705afdedc78fc1e64957f976085d0">num_right_inputs_required_</a></td></tr>
<tr class="separator:a2d9705afdedc78fc1e64957f976085d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac81e565312ceebb6467353ca015ea7d6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac81e565312ceebb6467353ca015ea7d6">output_context_</a></td></tr>
<tr class="separator:ac81e565312ceebb6467353ca015ea7d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acee63c613b77d9037649008e094ad585"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acee63c613b77d9037649008e094ad585">key_scale_</a></td></tr>
<tr class="separator:acee63c613b77d9037649008e094ad585"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17d0f37c99e964fc99274cf984f383e8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">stats_count_</a></td></tr>
<tr class="separator:a17d0f37c99e964fc99274cf984f383e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40a34aecd5f5f9754cf84d41be5375c0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1Vector.html">Vector</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40a34aecd5f5f9754cf84d41be5375c0">entropy_stats_</a></td></tr>
<tr class="separator:a40a34aecd5f5f9754cf84d41be5375c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cfb68dbd140132e24fa5ede76562e45"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1CuMatrix.html">CuMatrix</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1cfb68dbd140132e24fa5ede76562e45">posterior_stats_</a></td></tr>
<tr class="separator:a1cfb68dbd140132e24fa5ede76562e45"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_static_methods_classkaldi_1_1nnet3_1_1Component"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_classkaldi_1_1nnet3_1_1Component')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a></td></tr>
<tr class="memitem:a4ddbc3371d68afbe87908b87b8c0a6ae inherit pub_static_methods_classkaldi_1_1nnet3_1_1Component"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a4ddbc3371d68afbe87908b87b8c0a6ae">ReadNew</a> (std::istream &amp;is, <a class="el" href="classbool.html">bool</a> binary)</td></tr>
<tr class="memdesc:a4ddbc3371d68afbe87908b87b8c0a6ae inherit pub_static_methods_classkaldi_1_1nnet3_1_1Component"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read component from stream (works out its type). Dies on error.  <a href="classkaldi_1_1nnet3_1_1Component.html#a4ddbc3371d68afbe87908b87b8c0a6ae">More...</a><br /></td></tr>
<tr class="separator:a4ddbc3371d68afbe87908b87b8c0a6ae inherit pub_static_methods_classkaldi_1_1nnet3_1_1Component"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52564bb899e61119bac38d57147cd223 inherit pub_static_methods_classkaldi_1_1nnet3_1_1Component"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a52564bb899e61119bac38d57147cd223">NewComponentOfType</a> (const std::string &amp;type)</td></tr>
<tr class="memdesc:a52564bb899e61119bac38d57147cd223 inherit pub_static_methods_classkaldi_1_1nnet3_1_1Component"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a new <a class="el" href="classkaldi_1_1nnet3_1_1Component.html" title="Abstract base-class for neural-net components. ">Component</a> of the given type e.g.  <a href="classkaldi_1_1nnet3_1_1Component.html#a52564bb899e61119bac38d57147cd223">More...</a><br /></td></tr>
<tr class="separator:a52564bb899e61119bac38d57147cd223 inherit pub_static_methods_classkaldi_1_1nnet3_1_1Component"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html" title="RestrictedAttentionComponent implements an attention model with restricted temporal context...">RestrictedAttentionComponent</a> implements an attention model with restricted temporal context. </p>
<p>What is implemented here is a case of self-attention, meaning that the set of indexes on the input is the same set as the indexes on the output (like an N-&gt;N mapping, ignoring edge effects, as opposed to an N-&gt;M mapping that you might see in a translation model). "Restricted" means that the source indexes are constrained to be close to the destination indexes, i.e. when outputting something for time 't' we attend to a narrow range of source time indexes close to 't'.</p>
<p>This component is just a fixed nonlinearity (albeit of a type that "knows about" time, i.e. the output at time 't' depends on inputs at a range of time values). This component is not updatable; all the parameters are expected to live in the previous component which is most likely going to be of type <a class="el" href="classkaldi_1_1nnet3_1_1NaturalGradientAffineComponent.html">NaturalGradientAffineComponent</a>. For a more in-depth explanation, please see comments in the source of the file <a class="el" href="attention_8h.html" title="This file contains the lower-level interface for self-attention. ">attention.h</a>. Also, look at the comments for <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ad4cb6aed1f1980c2c36f34e09ceea0e0" title="Returns input-dimension of this component. ">InputDim()</a> and <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a323155ad8034c0b14762dd78ae4415b5" title="Returns output-dimension of this component. ">OutputDim()</a> which help to clarify the input and output formats.</p>
<p>The following are the parameters accepted on the config line, with examples of their values.</p>
<p>num-heads E.g. num-heads=10. Defaults to 1. Having multiple heads just means the same nonlinearity is repeated many times. <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ad4cb6aed1f1980c2c36f34e09ceea0e0" title="Returns input-dimension of this component. ">InputDim()</a> and <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a323155ad8034c0b14762dd78ae4415b5" title="Returns output-dimension of this component. ">OutputDim()</a> are multiples of num-heads. key-dim E.g. key-dim=60. Must be specified. Dimension of input keys. value-dim E.g. value-dim=60. Must be specified. Dimension of input values (these are the things over which the component forms a weighted sum, although if output-context=true we append to the output the weights of the weighted sum, as they might also carry useful information. time-stride Stride for 't' value, e.g. 1 or 3. For example, if time-stride=3, to compute the output for t=10 we'd use the input for time values like ... t=7, t=10, t=13, ... (the ends of this range depend on num-left-inputs and num-right-inputs). num-left-inputs Number of frames to the left of the current frame, that we use as input, e.g. 5. (The 't' values used will be separated by 'time-stride'). num-left-inputs must be &gt;= 0. Must be specified. num-right-inputs Number of frames to the right of the current frame, that we use as input, e.g. 2. Must be &gt;= 0 and must be specified. You are not allowed to set both num-left-inputs and num-right-inputs to zero. num-left-inputs-required The number of frames to the left, that are required in order to produce an output. Defaults to the same as num-left-inputs, but you can set it to a smaller value if you want. We'll use zero-padding for non-required inputs that are not present in the input. Be careful with this because it interacts with decoding settings; for non-online decoding and for dumping of egs it would be advisable to increase the extra-left-context parameter by the sum of the difference between num-left-inputs-required and num-left-inputs, although you could leave extra-left-context-initial at zero. num-right-inputs-required See num-left-inputs-required for explanation; it's the mirror image. Defaults to num-right-inputs. However, be even more careful with the right-hand version; if you set this, online (looped) decoding will not work correctly. It might be wiser just to reduce num-right-inputs if you care about real-time decoding. key-scale Scale on the keys (but not the added context). Defaults to 1.0 / sqrt(key-dim), like the 1/sqrt(d_k) value in the "Attention is all you need" paper. This helps prevent saturation of the softmax. output-context (Default: true). If true, output the softmax that encodes which positions we chose, in addition to the input values. </p>

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8h_source.html#l00106">106</a> of file <a class="el" href="nnet-attention-component_8h_source.html">nnet-attention-component.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aa6b67c244ea18c836e74eed945b46657"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6b67c244ea18c836e74eed945b46657">&#9670;&nbsp;</a></span>RestrictedAttentionComponent() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html">RestrictedAttentionComponent</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8h_source.html#l00110">110</a> of file <a class="el" href="nnet-attention-component_8h_source.html">nnet-attention-component.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8h_source.html#l00155">RestrictedAttentionComponent::Copy()</a>.</p>
<div class="fragment"><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;{ }</div></div><!-- fragment -->
</div>
</div>
<a id="ad510e5c5517d482ca0a0dd1e12a302eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad510e5c5517d482ca0a0dd1e12a302eb">&#9670;&nbsp;</a></span>RestrictedAttentionComponent() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html">RestrictedAttentionComponent</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html">RestrictedAttentionComponent</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8cc_source.html#l00061">61</a> of file <a class="el" href="nnet-attention-component_8cc_source.html">nnet-attention-component.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                                              :</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">num_heads_</a>(other.num_heads_),</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a>(other.key_dim_),</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a>(other.value_dim_),</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">num_left_inputs_</a>(other.num_left_inputs_),</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">num_right_inputs_</a>(other.num_right_inputs_),</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">time_stride_</a>(other.time_stride_),</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a>(other.context_dim_),</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a0e898f815954c8234cc4c17527168eb9">num_left_inputs_required_</a>(other.num_left_inputs_required_),</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2d9705afdedc78fc1e64957f976085d0">num_right_inputs_required_</a>(other.num_right_inputs_required_),</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac81e565312ceebb6467353ca015ea7d6">output_context_</a>(other.output_context_),</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acee63c613b77d9037649008e094ad585">key_scale_</a>(other.key_scale_),</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">stats_count_</a>(other.stats_count_),</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40a34aecd5f5f9754cf84d41be5375c0">entropy_stats_</a>(other.entropy_stats_),</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1cfb68dbd140132e24fa5ede76562e45">posterior_stats_</a>(other.posterior_stats_) { }</div><div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_acee63c613b77d9037649008e094ad585"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acee63c613b77d9037649008e094ad585">kaldi::nnet3::RestrictedAttentionComponent::key_scale_</a></div><div class="ttdeci">BaseFloat key_scale_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00292">nnet-attention-component.h:292</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a43d674ac6ba436481c1c4672fd1bea77"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">kaldi::nnet3::RestrictedAttentionComponent::time_stride_</a></div><div class="ttdeci">int32 time_stride_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00286">nnet-attention-component.h:286</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a0e898f815954c8234cc4c17527168eb9"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a0e898f815954c8234cc4c17527168eb9">kaldi::nnet3::RestrictedAttentionComponent::num_left_inputs_required_</a></div><div class="ttdeci">int32 num_left_inputs_required_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00289">nnet-attention-component.h:289</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_ac81e565312ceebb6467353ca015ea7d6"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac81e565312ceebb6467353ca015ea7d6">kaldi::nnet3::RestrictedAttentionComponent::output_context_</a></div><div class="ttdeci">bool output_context_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00291">nnet-attention-component.h:291</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a2d9705afdedc78fc1e64957f976085d0"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2d9705afdedc78fc1e64957f976085d0">kaldi::nnet3::RestrictedAttentionComponent::num_right_inputs_required_</a></div><div class="ttdeci">int32 num_right_inputs_required_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00290">nnet-attention-component.h:290</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a1cfb68dbd140132e24fa5ede76562e45"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1cfb68dbd140132e24fa5ede76562e45">kaldi::nnet3::RestrictedAttentionComponent::posterior_stats_</a></div><div class="ttdeci">CuMatrix&lt; double &gt; posterior_stats_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00298">nnet-attention-component.h:298</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a40571f26e91bce91b89f63840291c8ce"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">kaldi::nnet3::RestrictedAttentionComponent::num_right_inputs_</a></div><div class="ttdeci">int32 num_right_inputs_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00285">nnet-attention-component.h:285</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a40a34aecd5f5f9754cf84d41be5375c0"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40a34aecd5f5f9754cf84d41be5375c0">kaldi::nnet3::RestrictedAttentionComponent::entropy_stats_</a></div><div class="ttdeci">Vector&lt; double &gt; entropy_stats_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00295">nnet-attention-component.h:295</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a4a638e2d2a390900749819b63b06cba8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">kaldi::nnet3::RestrictedAttentionComponent::key_dim_</a></div><div class="ttdeci">int32 key_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00282">nnet-attention-component.h:282</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a17d0f37c99e964fc99274cf984f383e8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">kaldi::nnet3::RestrictedAttentionComponent::stats_count_</a></div><div class="ttdeci">double stats_count_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00294">nnet-attention-component.h:294</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8fb0e7f13f5d151b88cf0af7a28e6817"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">kaldi::nnet3::RestrictedAttentionComponent::value_dim_</a></div><div class="ttdeci">int32 value_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00283">nnet-attention-component.h:283</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8f2ba24a43264b8812e3e1e83878a59c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">kaldi::nnet3::RestrictedAttentionComponent::context_dim_</a></div><div class="ttdeci">int32 context_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00287">nnet-attention-component.h:287</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_ae53cc4977f9fbe6523374aaf5ba10c80"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">kaldi::nnet3::RestrictedAttentionComponent::num_heads_</a></div><div class="ttdeci">int32 num_heads_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00281">nnet-attention-component.h:281</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a4d7e5406fed09929350deb26767f25aa"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">kaldi::nnet3::RestrictedAttentionComponent::num_left_inputs_</a></div><div class="ttdeci">int32 num_left_inputs_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00284">nnet-attention-component.h:284</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="acdb3e97b46276e3c9f4f696c2bef3943"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdb3e97b46276e3c9f4f696c2bef3943">&#9670;&nbsp;</a></span>Add()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Add </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a>&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This virtual function when called by &ndash; an <a class="el" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html" title="Class UpdatableComponent is a Component which has trainable parameters; it extends the interface of C...">UpdatableComponent</a> adds the parameters of another updatable component, times some constant, to the current parameters. </p>
<p>&ndash; a <a class="el" href="classkaldi_1_1nnet3_1_1NonlinearComponent.html">NonlinearComponent</a> (or another component that stores stats, like <a class="el" href="classkaldi_1_1nnet3_1_1BatchNormComponent.html">BatchNormComponent</a>)&ndash; it relates to adding stats. Otherwise it will normally do nothing. </p>

<p>Reimplemented from <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#aab16938236bd0978bad5de6d56fcf47f">Component</a>.</p>

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8cc_source.html#l00261">261</a> of file <a class="el" href="nnet-attention-component_8cc_source.html">nnet-attention-component.cc</a>.</p>

<p class="reference">References <a class="el" href="cu-matrix_8cc_source.html#l00941">CuMatrixBase&lt; Real &gt;::AddMat()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l01043">VectorBase&lt; Real &gt;::AddVec()</a>, <a class="el" href="kaldi-vector_8h_source.html#l00063">VectorBase&lt; Real &gt;::Dim()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00295">RestrictedAttentionComponent::entropy_stats_</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="cu-matrix_8h_source.html#l00215">CuMatrixBase&lt; Real &gt;::NumCols()</a>, <a class="el" href="cu-matrix_8h_source.html#l00214">CuMatrixBase&lt; Real &gt;::NumRows()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00298">RestrictedAttentionComponent::posterior_stats_</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00190">Vector&lt; Real &gt;::Resize()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00049">CuMatrix&lt; Real &gt;::Resize()</a>, and <a class="el" href="nnet-attention-component_8h_source.html#l00294">RestrictedAttentionComponent::stats_count_</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8h_source.html#l00131">RestrictedAttentionComponent::Properties()</a>.</p>
<div class="fragment"><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                                                                                 {</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keyword">const</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#aa6b67c244ea18c836e74eed945b46657">RestrictedAttentionComponent</a> *other =</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#aa6b67c244ea18c836e74eed945b46657">RestrictedAttentionComponent</a>*<span class="keyword">&gt;</span>(&amp;other_in);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(other != NULL);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40a34aecd5f5f9754cf84d41be5375c0">entropy_stats_</a>.<a class="code" href="classkaldi_1_1VectorBase.html#af3d58f15749a15d89b0ec5819dd7b7f2">Dim</a>() == 0 &amp;&amp; other-&gt;entropy_stats_.Dim() != 0)</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40a34aecd5f5f9754cf84d41be5375c0">entropy_stats_</a>.<a class="code" href="classkaldi_1_1Vector.html#ae98e624cca1982e866ff195131ed4427">Resize</a>(other-&gt;entropy_stats_.Dim());</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1cfb68dbd140132e24fa5ede76562e45">posterior_stats_</a>.<a class="code" href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() == 0 &amp;&amp; other-&gt;posterior_stats_.NumRows() != 0)</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1cfb68dbd140132e24fa5ede76562e45">posterior_stats_</a>.<a class="code" href="classkaldi_1_1CuMatrix.html#af7e3e65772a6eb29e22069822a0fb441">Resize</a>(other-&gt;posterior_stats_.NumRows(), other-&gt;posterior_stats_.NumCols());</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keywordflow">if</span> (other-&gt;entropy_stats_.Dim() != 0)</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40a34aecd5f5f9754cf84d41be5375c0">entropy_stats_</a>.<a class="code" href="classkaldi_1_1VectorBase.html#ab109eed73378866c0e8747379378ca44">AddVec</a>(alpha, other-&gt;entropy_stats_);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordflow">if</span> (other-&gt;posterior_stats_.NumRows() != 0)</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1cfb68dbd140132e24fa5ede76562e45">posterior_stats_</a>.<a class="code" href="classkaldi_1_1CuMatrixBase.html#a4bce9eaec860cf9d9a8aee7e440b976b">AddMat</a>(alpha, other-&gt;posterior_stats_);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">stats_count_</a> += alpha * other-&gt;stats_count_;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a4bce9eaec860cf9d9a8aee7e440b976b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a4bce9eaec860cf9d9a8aee7e440b976b">kaldi::CuMatrixBase::AddMat</a></div><div class="ttdeci">void AddMat(Real alpha, const CuMatrixBase&lt; Real &gt; &amp;A, MatrixTransposeType trans=kNoTrans)</div><div class="ttdoc">*this += alpha * A </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l00941">cu-matrix.cc:941</a></div></div>
<div class="ttc" id="classkaldi_1_1Vector_html_ae98e624cca1982e866ff195131ed4427"><div class="ttname"><a href="classkaldi_1_1Vector.html#ae98e624cca1982e866ff195131ed4427">kaldi::Vector::Resize</a></div><div class="ttdeci">void Resize(MatrixIndexT length, MatrixResizeType resize_type=kSetZero)</div><div class="ttdoc">Set vector to a specified size (can be zero). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l00190">kaldi-vector.cc:190</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_aa6b67c244ea18c836e74eed945b46657"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#aa6b67c244ea18c836e74eed945b46657">kaldi::nnet3::RestrictedAttentionComponent::RestrictedAttentionComponent</a></div><div class="ttdeci">RestrictedAttentionComponent()</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00110">nnet-attention-component.h:110</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a1cfb68dbd140132e24fa5ede76562e45"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1cfb68dbd140132e24fa5ede76562e45">kaldi::nnet3::RestrictedAttentionComponent::posterior_stats_</a></div><div class="ttdeci">CuMatrix&lt; double &gt; posterior_stats_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00298">nnet-attention-component.h:298</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a40a34aecd5f5f9754cf84d41be5375c0"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40a34aecd5f5f9754cf84d41be5375c0">kaldi::nnet3::RestrictedAttentionComponent::entropy_stats_</a></div><div class="ttdeci">Vector&lt; double &gt; entropy_stats_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00295">nnet-attention-component.h:295</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a17d0f37c99e964fc99274cf984f383e8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">kaldi::nnet3::RestrictedAttentionComponent::stats_count_</a></div><div class="ttdeci">double stats_count_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00294">nnet-attention-component.h:294</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_af3d58f15749a15d89b0ec5819dd7b7f2"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#af3d58f15749a15d89b0ec5819dd7b7f2">kaldi::VectorBase::Dim</a></div><div class="ttdeci">MatrixIndexT Dim() const</div><div class="ttdoc">Returns the dimension of the vector. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8h_source.html#l00063">kaldi-vector.h:63</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00214">cu-matrix.h:214</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_ab109eed73378866c0e8747379378ca44"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#ab109eed73378866c0e8747379378ca44">kaldi::VectorBase::AddVec</a></div><div class="ttdeci">void AddVec(const Real alpha, const VectorBase&lt; OtherReal &gt; &amp;v)</div><div class="ttdoc">Add vector : *this = *this + alpha * rv (with casting between floats and doubles) ...</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l01043">kaldi-vector.cc:1043</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrix_html_af7e3e65772a6eb29e22069822a0fb441"><div class="ttname"><a href="classkaldi_1_1CuMatrix.html#af7e3e65772a6eb29e22069822a0fb441">kaldi::CuMatrix::Resize</a></div><div class="ttdeci">void Resize(MatrixIndexT rows, MatrixIndexT cols, MatrixResizeType resize_type=kSetZero, MatrixStrideType stride_type=kDefaultStride)</div><div class="ttdoc">Allocate the memory. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l00049">cu-matrix.cc:49</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0f9bb1c29228fa0a498a19b83ac5190"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0f9bb1c29228fa0a498a19b83ac5190">&#9670;&nbsp;</a></span>Backprop()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Backprop </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>debug_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1nnet3_1_1ComponentPrecomputedIndexes.html">ComponentPrecomputedIndexes</a> *&#160;</td>
          <td class="paramname"><em>indexes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>in_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>out_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>out_deriv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>memo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> *&#160;</td>
          <td class="paramname"><em>to_update</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; *&#160;</td>
          <td class="paramname"><em>in_deriv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Backprop function; depending on which of the arguments 'to_update' and 'in_deriv' are non-NULL, this can compute input-data derivatives and/or perform model update. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">debug_info</td><td>The component name, to be printed out in any warning messages. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">indexes</td><td>A pointer to some information output by this class's PrecomputeIndexes function (will be NULL for simple components, i.e. those that don't do things like splicing). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">in_value</td><td>The matrix that was given as input to the Propagate function. Will be ignored (and may be empty) if <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a16a6da3a5108ec53e759722a51fd47" title="Return bitmask of the component&#39;s properties. ">Properties()</a>&amp;kBackpropNeedsInput == 0. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">out_value</td><td>The matrix that was output from the Propagate function. Will be ignored (and may be empty) if <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a16a6da3a5108ec53e759722a51fd47" title="Return bitmask of the component&#39;s properties. ">Properties()</a>&amp;kBackpropNeedsOutput == 0 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">out_deriv</td><td>The derivative at the output of this component. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">memo</td><td>This will normally be NULL, but for component types that set the flag kUsesMemo, this will be the return value of the <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f1f1b05a170bd81a544caefe1acb040" title="Propagate function. ">Propagate()</a> function that corresponds to this <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac0f9bb1c29228fa0a498a19b83ac5190" title="Backprop function; depending on which of the arguments &#39;to_update&#39; and &#39;in_deriv&#39; are non-NULL...">Backprop()</a> function. Ownership of any pointers is not transferred to the Backprop function; <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8eacf8174f9fa190732c320ee3cf1d62" title="This virtual function only needs to be overwritten by Components that return a non-NULL memo from the...">DeleteMemo()</a> will be called to delete it. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">to_update</td><td>If model update is desired, the <a class="el" href="classkaldi_1_1nnet3_1_1Component.html" title="Abstract base-class for neural-net components. ">Component</a> to be updated, else NULL. Does not have to be identical to this. If supplied, you can assume that to_update-&gt;<a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a16a6da3a5108ec53e759722a51fd47" title="Return bitmask of the component&#39;s properties. ">Properties()</a> &amp; kUpdatableComponent is nonzero. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">in_deriv</td><td>The derivative at the input of this component, if needed (else NULL). If <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a16a6da3a5108ec53e759722a51fd47" title="Return bitmask of the component&#39;s properties. ">Properties()</a>&amp;kBackpropInPlace, may be the same matrix as out_deriv. If <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a16a6da3a5108ec53e759722a51fd47" title="Return bitmask of the component&#39;s properties. ">Properties()</a>&amp;kBackpropAdds, this is added to by the Backprop routine, else it is set. The component code chooses which mode to work in, based on convenience. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#ada8f5f2c358622ef522a7f2b9d2833ca">Component</a>.</p>

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8cc_source.html#l00292">292</a> of file <a class="el" href="nnet-attention-component_8cc_source.html">nnet-attention-component.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-attention-component_8cc_source.html#l00334">RestrictedAttentionComponent::BackpropOneHead()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00208">RestrictedAttentionComponent::Memo::c</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00287">RestrictedAttentionComponent::context_dim_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00198">RestrictedAttentionComponent::PrecomputedIndexes::io</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00282">RestrictedAttentionComponent::key_dim_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00281">RestrictedAttentionComponent::num_heads_</a>, <a class="el" href="convolution_8h_source.html#l00381">ConvolutionComputationIo::num_images</a>, <a class="el" href="convolution_8h_source.html#l00393">ConvolutionComputationIo::num_t_in</a>, <a class="el" href="convolution_8h_source.html#l00394">ConvolutionComputationIo::num_t_out</a>, <a class="el" href="cu-matrix_8h_source.html#l00214">CuMatrixBase&lt; Real &gt;::NumRows()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00291">RestrictedAttentionComponent::output_context_</a>, <a class="el" href="kaldi-matrix_8h_source.html#l01065">kaldi::SameDim()</a>, and <a class="el" href="nnet-attention-component_8h_source.html#l00283">RestrictedAttentionComponent::value_dim_</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8h_source.html#l00131">RestrictedAttentionComponent::Properties()</a>.</p>
<div class="fragment"><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                                             {</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="keyword">const</span> PrecomputedIndexes *indexes =</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>PrecomputedIndexes*<span class="keyword">&gt;</span>(indexes_in);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(indexes != NULL);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  Memo *memo = <span class="keyword">static_cast&lt;</span>Memo*<span class="keyword">&gt;</span>(memo_in);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(memo != NULL);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keyword">const</span> time_height_convolution::ConvolutionComputationIo &amp;io = indexes-&gt;io;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(indexes != NULL &amp;&amp;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;               in_value.NumRows() == io.num_t_in * io.num_images &amp;&amp;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;               out_deriv.NumRows() == io.num_t_out * io.num_images &amp;&amp;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;               in_deriv != NULL &amp;&amp; <a class="code" href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">SameDim</a>(in_value, *in_deriv));</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keyword">const</span> CuMatrix&lt;BaseFloat&gt; &amp;c = memo-&gt;c;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  int32 query_dim = <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a> + <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a>,</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      input_dim_per_head = <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a> + <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a> + query_dim,</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      output_dim_per_head = <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a> + (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac81e565312ceebb6467353ca015ea7d6">output_context_</a> ? <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a> : 0);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordflow">for</span> (int32 h = 0; h &lt; <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">num_heads_</a>; h++) {</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    CuSubMatrix&lt;BaseFloat&gt;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        in_value_part(in_value, 0, in_value.NumRows(),</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                      h * input_dim_per_head, input_dim_per_head),</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        c_part(c, 0, out_deriv.NumRows(),</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;               h * <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a>, <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a>),</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        out_deriv_part(out_deriv, 0, out_deriv.NumRows(),</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                       h * output_dim_per_head, output_dim_per_head),</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        in_deriv_part(*in_deriv, 0, in_value.NumRows(),</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                      h * input_dim_per_head, input_dim_per_head);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a37fc34ec7c7ab80d54c88e84a12d38e0">BackpropOneHead</a>(io, in_value_part, c_part, out_deriv_part,</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                    &amp;in_deriv_part);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  }</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a37fc34ec7c7ab80d54c88e84a12d38e0"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a37fc34ec7c7ab80d54c88e84a12d38e0">kaldi::nnet3::RestrictedAttentionComponent::BackpropOneHead</a></div><div class="ttdeci">void BackpropOneHead(const time_height_convolution::ConvolutionComputationIo &amp;io, const CuMatrixBase&lt; BaseFloat &gt; &amp;in_value, const CuMatrixBase&lt; BaseFloat &gt; &amp;c, const CuMatrixBase&lt; BaseFloat &gt; &amp;out_deriv, CuMatrixBase&lt; BaseFloat &gt; *in_deriv) const</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00334">nnet-attention-component.cc:334</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_ac81e565312ceebb6467353ca015ea7d6"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac81e565312ceebb6467353ca015ea7d6">kaldi::nnet3::RestrictedAttentionComponent::output_context_</a></div><div class="ttdeci">bool output_context_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00291">nnet-attention-component.h:291</a></div></div>
<div class="ttc" id="group__matrix__funcs__io_html_ga07b147212efb08775c252cd4cc7453fe"><div class="ttname"><a href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">kaldi::SameDim</a></div><div class="ttdeci">bool SameDim(const MatrixBase&lt; Real &gt; &amp;M, const MatrixBase&lt; Real &gt; &amp;N)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l01065">kaldi-matrix.h:1065</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a4a638e2d2a390900749819b63b06cba8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">kaldi::nnet3::RestrictedAttentionComponent::key_dim_</a></div><div class="ttdeci">int32 key_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00282">nnet-attention-component.h:282</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8fb0e7f13f5d151b88cf0af7a28e6817"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">kaldi::nnet3::RestrictedAttentionComponent::value_dim_</a></div><div class="ttdeci">int32 value_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00283">nnet-attention-component.h:283</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8f2ba24a43264b8812e3e1e83878a59c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">kaldi::nnet3::RestrictedAttentionComponent::context_dim_</a></div><div class="ttdeci">int32 context_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00287">nnet-attention-component.h:287</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_ae53cc4977f9fbe6523374aaf5ba10c80"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">kaldi::nnet3::RestrictedAttentionComponent::num_heads_</a></div><div class="ttdeci">int32 num_heads_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00281">nnet-attention-component.h:281</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a37fc34ec7c7ab80d54c88e84a12d38e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37fc34ec7c7ab80d54c88e84a12d38e0">&#9670;&nbsp;</a></span>BackpropOneHead()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void BackpropOneHead </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1time__height__convolution_1_1ConvolutionComputationIo.html">time_height_convolution::ConvolutionComputationIo</a> &amp;&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>in_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>out_deriv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; *&#160;</td>
          <td class="paramname"><em>in_deriv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8cc_source.html#l00334">334</a> of file <a class="el" href="nnet-attention-component_8cc_source.html">nnet-attention-component.cc</a>.</p>

<p class="reference">References <a class="el" href="attention_8cc_source.html#l00154">kaldi::nnet3::attention::AttentionBackward()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00287">RestrictedAttentionComponent::context_dim_</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00282">RestrictedAttentionComponent::key_dim_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00292">RestrictedAttentionComponent::key_scale_</a>, <a class="el" href="convolution_8h_source.html#l00381">ConvolutionComputationIo::num_images</a>, <a class="el" href="convolution_8h_source.html#l00393">ConvolutionComputationIo::num_t_in</a>, <a class="el" href="convolution_8h_source.html#l00394">ConvolutionComputationIo::num_t_out</a>, <a class="el" href="cu-matrix_8h_source.html#l00215">CuMatrixBase&lt; Real &gt;::NumCols()</a>, <a class="el" href="cu-matrix_8h_source.html#l00214">CuMatrixBase&lt; Real &gt;::NumRows()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00291">RestrictedAttentionComponent::output_context_</a>, <a class="el" href="kaldi-matrix_8h_source.html#l01065">kaldi::SameDim()</a>, <a class="el" href="convolution_8h_source.html#l00393">ConvolutionComputationIo::start_t_in</a>, <a class="el" href="convolution_8h_source.html#l00394">ConvolutionComputationIo::start_t_out</a>, <a class="el" href="convolution_8h_source.html#l00393">ConvolutionComputationIo::t_step_in</a>, <a class="el" href="convolution_8h_source.html#l00394">ConvolutionComputationIo::t_step_out</a>, and <a class="el" href="nnet-attention-component_8h_source.html#l00283">RestrictedAttentionComponent::value_dim_</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8cc_source.html#l00292">RestrictedAttentionComponent::Backprop()</a>.</p>
<div class="fragment"><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                                             {</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="comment">// the easiest way to understand this is to compare it with PropagateOneHead().</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  int32 query_dim = <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a> + <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a>,</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      full_value_dim = <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a> + (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac81e565312ceebb6467353ca015ea7d6">output_context_</a> ? <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a> : 0);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(in_value.NumRows() == io.num_images * io.num_t_in &amp;&amp;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;               out_deriv.NumRows() == io.num_images * io.num_t_out &amp;&amp;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;               out_deriv.NumCols() == full_value_dim &amp;&amp;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;               in_value.NumCols() == (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a> + <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a> + query_dim) &amp;&amp;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;               io.t_step_in == io.t_step_out &amp;&amp;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;               (io.start_t_out - io.start_t_in) % io.t_step_in == 0 &amp;&amp;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;               <a class="code" href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">SameDim</a>(in_value, *in_deriv) &amp;&amp;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;               c.NumRows() == out_deriv.NumRows() &amp;&amp;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;               c.NumCols() == <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a>);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="comment">// &#39;steps_left_context&#39; is the number of time-steps the input has on the left</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="comment">// that don&#39;t appear in the output.</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  int32 steps_left_context = (io.start_t_out - io.start_t_in) / io.t_step_in,</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      rows_left_context = steps_left_context * io.num_images;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(rows_left_context &gt;= 0);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  CuSubMatrix&lt;BaseFloat&gt; queries(in_value, rows_left_context, out_deriv.NumRows(),</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                                 <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a> + <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a>, query_dim),</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      queries_deriv(*in_deriv, rows_left_context, out_deriv.NumRows(),</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a> + <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a>, query_dim),</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      keys(in_value, 0, in_value.NumRows(), 0, <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a>),</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      keys_deriv(*in_deriv,  0, in_value.NumRows(), 0, <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a>),</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      values(in_value, 0, in_value.NumRows(), <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a>, <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a>),</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      values_deriv(*in_deriv, 0, in_value.NumRows(), <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a>, <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a>);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3_1_1attention.html#a714ba1d18b57b12b94ae67f551cbe522">attention::AttentionBackward</a>(<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acee63c613b77d9037649008e094ad585">key_scale_</a>, keys, queries, values, c, out_deriv,</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                               &amp;keys_deriv, &amp;queries_deriv, &amp;values_deriv);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;}</div><div class="ttc" id="namespacekaldi_1_1nnet3_1_1attention_html_a714ba1d18b57b12b94ae67f551cbe522"><div class="ttname"><a href="namespacekaldi_1_1nnet3_1_1attention.html#a714ba1d18b57b12b94ae67f551cbe522">kaldi::nnet3::attention::AttentionBackward</a></div><div class="ttdeci">void AttentionBackward(BaseFloat key_scale, const CuMatrixBase&lt; BaseFloat &gt; &amp;keys, const CuMatrixBase&lt; BaseFloat &gt; &amp;queries, const CuMatrixBase&lt; BaseFloat &gt; &amp;values, const CuMatrixBase&lt; BaseFloat &gt; &amp;c, const CuMatrixBase&lt; BaseFloat &gt; &amp;output_deriv, CuMatrixBase&lt; BaseFloat &gt; *keys_deriv, CuMatrixBase&lt; BaseFloat &gt; *queries_deriv, CuMatrixBase&lt; BaseFloat &gt; *values_deriv)</div><div class="ttdoc">Performs the backward pass corresponding to &amp;#39;AttentionForward&amp;#39;, propagating the derivative back to th...</div><div class="ttdef"><b>Definition:</b> <a href="attention_8cc_source.html#l00154">attention.cc:154</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_acee63c613b77d9037649008e094ad585"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acee63c613b77d9037649008e094ad585">kaldi::nnet3::RestrictedAttentionComponent::key_scale_</a></div><div class="ttdeci">BaseFloat key_scale_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00292">nnet-attention-component.h:292</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_ac81e565312ceebb6467353ca015ea7d6"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac81e565312ceebb6467353ca015ea7d6">kaldi::nnet3::RestrictedAttentionComponent::output_context_</a></div><div class="ttdeci">bool output_context_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00291">nnet-attention-component.h:291</a></div></div>
<div class="ttc" id="group__matrix__funcs__io_html_ga07b147212efb08775c252cd4cc7453fe"><div class="ttname"><a href="group__matrix__funcs__io.html#ga07b147212efb08775c252cd4cc7453fe">kaldi::SameDim</a></div><div class="ttdeci">bool SameDim(const MatrixBase&lt; Real &gt; &amp;M, const MatrixBase&lt; Real &gt; &amp;N)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l01065">kaldi-matrix.h:1065</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a4a638e2d2a390900749819b63b06cba8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">kaldi::nnet3::RestrictedAttentionComponent::key_dim_</a></div><div class="ttdeci">int32 key_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00282">nnet-attention-component.h:282</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8fb0e7f13f5d151b88cf0af7a28e6817"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">kaldi::nnet3::RestrictedAttentionComponent::value_dim_</a></div><div class="ttdeci">int32 value_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00283">nnet-attention-component.h:283</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8f2ba24a43264b8812e3e1e83878a59c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">kaldi::nnet3::RestrictedAttentionComponent::context_dim_</a></div><div class="ttdeci">int32 context_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00287">nnet-attention-component.h:287</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4c47fd4f163011eb1939870d25aa656a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c47fd4f163011eb1939870d25aa656a">&#9670;&nbsp;</a></span>Check()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Check </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8cc_source.html#l00277">277</a> of file <a class="el" href="nnet-attention-component_8cc_source.html">nnet-attention-component.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-attention-component_8h_source.html#l00287">RestrictedAttentionComponent::context_dim_</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00282">RestrictedAttentionComponent::key_dim_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00292">RestrictedAttentionComponent::key_scale_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00281">RestrictedAttentionComponent::num_heads_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00284">RestrictedAttentionComponent::num_left_inputs_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00289">RestrictedAttentionComponent::num_left_inputs_required_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00285">RestrictedAttentionComponent::num_right_inputs_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00290">RestrictedAttentionComponent::num_right_inputs_required_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00294">RestrictedAttentionComponent::stats_count_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00286">RestrictedAttentionComponent::time_stride_</a>, and <a class="el" href="nnet-attention-component_8h_source.html#l00283">RestrictedAttentionComponent::value_dim_</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8cc_source.html#l00080">RestrictedAttentionComponent::InitFromConfig()</a>.</p>
<div class="fragment"><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                                               {</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">num_heads_</a> &gt; 0 &amp;&amp; <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a> &gt; 0 &amp;&amp; <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a> &gt; 0 &amp;&amp;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;               <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">num_left_inputs_</a> &gt;= 0 &amp;&amp; <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">num_right_inputs_</a> &gt;= 0 &amp;&amp;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;               (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">num_left_inputs_</a> + <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">num_right_inputs_</a>) &gt; 0 &amp;&amp;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;               <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">time_stride_</a> &gt; 0 &amp;&amp;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;               <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a> == (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">num_left_inputs_</a> + 1 + <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">num_right_inputs_</a>) &amp;&amp;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;               <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a0e898f815954c8234cc4c17527168eb9">num_left_inputs_required_</a> &gt;= 0 &amp;&amp;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;               <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a0e898f815954c8234cc4c17527168eb9">num_left_inputs_required_</a> &lt;= <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">num_left_inputs_</a> &amp;&amp;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;               <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2d9705afdedc78fc1e64957f976085d0">num_right_inputs_required_</a> &gt;= 0 &amp;&amp;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;               <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2d9705afdedc78fc1e64957f976085d0">num_right_inputs_required_</a> &lt;= <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">num_right_inputs_</a> &amp;&amp;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;               <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acee63c613b77d9037649008e094ad585">key_scale_</a> &gt; 0.0 &amp;&amp; <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acee63c613b77d9037649008e094ad585">key_scale_</a> &lt;= 1.0 &amp;&amp;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;               <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">stats_count_</a> &gt;= 0.0);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_acee63c613b77d9037649008e094ad585"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acee63c613b77d9037649008e094ad585">kaldi::nnet3::RestrictedAttentionComponent::key_scale_</a></div><div class="ttdeci">BaseFloat key_scale_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00292">nnet-attention-component.h:292</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a43d674ac6ba436481c1c4672fd1bea77"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">kaldi::nnet3::RestrictedAttentionComponent::time_stride_</a></div><div class="ttdeci">int32 time_stride_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00286">nnet-attention-component.h:286</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a0e898f815954c8234cc4c17527168eb9"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a0e898f815954c8234cc4c17527168eb9">kaldi::nnet3::RestrictedAttentionComponent::num_left_inputs_required_</a></div><div class="ttdeci">int32 num_left_inputs_required_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00289">nnet-attention-component.h:289</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a2d9705afdedc78fc1e64957f976085d0"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2d9705afdedc78fc1e64957f976085d0">kaldi::nnet3::RestrictedAttentionComponent::num_right_inputs_required_</a></div><div class="ttdeci">int32 num_right_inputs_required_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00290">nnet-attention-component.h:290</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a40571f26e91bce91b89f63840291c8ce"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">kaldi::nnet3::RestrictedAttentionComponent::num_right_inputs_</a></div><div class="ttdeci">int32 num_right_inputs_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00285">nnet-attention-component.h:285</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a4a638e2d2a390900749819b63b06cba8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">kaldi::nnet3::RestrictedAttentionComponent::key_dim_</a></div><div class="ttdeci">int32 key_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00282">nnet-attention-component.h:282</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a17d0f37c99e964fc99274cf984f383e8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">kaldi::nnet3::RestrictedAttentionComponent::stats_count_</a></div><div class="ttdeci">double stats_count_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00294">nnet-attention-component.h:294</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8fb0e7f13f5d151b88cf0af7a28e6817"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">kaldi::nnet3::RestrictedAttentionComponent::value_dim_</a></div><div class="ttdeci">int32 value_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00283">nnet-attention-component.h:283</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8f2ba24a43264b8812e3e1e83878a59c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">kaldi::nnet3::RestrictedAttentionComponent::context_dim_</a></div><div class="ttdeci">int32 context_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00287">nnet-attention-component.h:287</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_ae53cc4977f9fbe6523374aaf5ba10c80"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">kaldi::nnet3::RestrictedAttentionComponent::num_heads_</a></div><div class="ttdeci">int32 num_heads_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00281">nnet-attention-component.h:281</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a4d7e5406fed09929350deb26767f25aa"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">kaldi::nnet3::RestrictedAttentionComponent::num_left_inputs_</a></div><div class="ttdeci">int32 num_left_inputs_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00284">nnet-attention-component.h:284</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1de31388e6c4839d855713baedc4f44b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1de31388e6c4839d855713baedc4f44b">&#9670;&nbsp;</a></span>Copy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a>* Copy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copies component (deep copy). </p>

<p>Implements <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">Component</a>.</p>

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8h_source.html#l00155">155</a> of file <a class="el" href="nnet-attention-component_8h_source.html">nnet-attention-component.h</a>.</p>

<p class="reference">References <a class="el" href="nnet-attention-component_8h_source.html#l00110">RestrictedAttentionComponent::RestrictedAttentionComponent()</a>.</p>
<div class="fragment"><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                                  {</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#aa6b67c244ea18c836e74eed945b46657">RestrictedAttentionComponent</a>(*<span class="keyword">this</span>);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  }</div><div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_aa6b67c244ea18c836e74eed945b46657"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#aa6b67c244ea18c836e74eed945b46657">kaldi::nnet3::RestrictedAttentionComponent::RestrictedAttentionComponent</a></div><div class="ttdeci">RestrictedAttentionComponent()</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00110">nnet-attention-component.h:110</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a91eb639e00c2eafa02815a750be70f8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91eb639e00c2eafa02815a750be70f8a">&#9670;&nbsp;</a></span>CreateIndexesVector()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CreateIndexesVector </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>n_x_pairs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>t_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>t_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>num_t_values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::unordered_set&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a>, <a class="el" href="structkaldi_1_1nnet3_1_1IndexHasher.html">IndexHasher</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>index_set</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; *&#160;</td>
          <td class="paramname"><em>output_indexes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility function used in <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#afc71d7740bea7e0050f7ece2f3d575eb">GetIndexes()</a>. </p>
<p>Creates a grid of Indexes, where 't' has the larger stride, and within each block of Indexes for a given 't', we have the given list of (n, x) pairs. For Indexes that we create where the 't' value was not present in 'index_set', we set the 't' value to kNoTime (indicating that it's only for padding, not a real input or an output that's ever used). </p>

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8cc_source.html#l00574">574</a> of file <a class="el" href="nnet-attention-component_8cc_source.html">nnet-attention-component.cc</a>.</p>

<p class="reference">References <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, and <a class="el" href="nnet-common_8cc_source.html#l00573">kaldi::nnet3::kNoTime</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8cc_source.html#l00596">RestrictedAttentionComponent::GetIndexes()</a>.</p>
<div class="fragment"><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                                      {</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  output_indexes-&gt;resize(static_cast&lt;size_t&gt;(num_t_values) * n_x_pairs.size());</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  std::vector&lt;Index&gt;::iterator out_iter = output_indexes-&gt;begin();</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <span class="keywordflow">for</span> (int32 t = t_start; t &lt; t_start + (t_step * num_t_values); t += t_step) {</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    std::vector&lt;std::pair&lt;int32, int32&gt; &gt;::const_iterator</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        iter = n_x_pairs.begin(), end = n_x_pairs.end();</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keywordflow">for</span> (; iter != end; ++iter) {</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      out_iter-&gt;n = iter-&gt;first;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      out_iter-&gt;t = t;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      out_iter-&gt;x = iter-&gt;second;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <span class="keywordflow">if</span> (index_set.count(*out_iter) == 0)</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        out_iter-&gt;t = <a class="code" href="namespacekaldi_1_1nnet3.html#ac952f0840a7950dff80c1a89e69656d7">kNoTime</a>;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      ++out_iter;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    }</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  }</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(out_iter == output_indexes-&gt;end());</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;}</div><div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ac952f0840a7950dff80c1a89e69656d7"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ac952f0840a7950dff80c1a89e69656d7">kaldi::nnet3::kNoTime</a></div><div class="ttdeci">const int kNoTime</div><div class="ttdef"><b>Definition:</b> <a href="nnet-common_8cc_source.html#l00573">nnet-common.cc:573</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8eacf8174f9fa190732c320ee3cf1d62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8eacf8174f9fa190732c320ee3cf1d62">&#9670;&nbsp;</a></span>DeleteMemo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void DeleteMemo </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>memo</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This virtual function only needs to be overwritten by Components that return a non-NULL memo from their <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f1f1b05a170bd81a544caefe1acb040" title="Propagate function. ">Propagate()</a> function. </p>
<p>It's called by <a class="el" href="classkaldi_1_1nnet3_1_1NnetComputer.html" title="class NnetComputer is responsible for executing the computation described in the &quot;computation&quot; object...">NnetComputer</a> in cases where Propagate returns a memo but there will be no backprop to consume it. </p>

<p>Reimplemented from <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a8eacf8174f9fa190732c320ee3cf1d62">Component</a>.</p>

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8h_source.html#l00158">158</a> of file <a class="el" href="nnet-attention-component_8h_source.html">nnet-attention-component.h</a>.</p>

<p class="reference">References <a class="el" href="nnet-attention-component_8cc_source.html#l00506">RestrictedAttentionComponent::GetInputIndexes()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00526">RestrictedAttentionComponent::IsComputable()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00621">RestrictedAttentionComponent::PrecomputeIndexes()</a>, and <a class="el" href="nnet-attention-component_8cc_source.html#l00375">RestrictedAttentionComponent::ReorderIndexes()</a>.</p>
<div class="fragment"><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;{ <span class="keyword">delete</span> <span class="keyword">static_cast&lt;</span>Memo*<span class="keyword">&gt;</span>(memo); }</div></div><!-- fragment -->
</div>
</div>
<a id="a38367562a48aa99e77d5d2f6eded46c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38367562a48aa99e77d5d2f6eded46c1">&#9670;&nbsp;</a></span>GetComputationStructure()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void GetComputationStructure </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>input_indexes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>output_indexes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structkaldi_1_1nnet3_1_1time__height__convolution_1_1ConvolutionComputationIo.html">time_height_convolution::ConvolutionComputationIo</a> *&#160;</td>
          <td class="paramname"><em>io</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8cc_source.html#l00388">388</a> of file <a class="el" href="nnet-attention-component_8cc_source.html">nnet-attention-component.cc</a>.</p>

<p class="reference">References <a class="el" href="kaldi-math_8h_source.html#l00296">kaldi::Gcd()</a>, <a class="el" href="convolution_8cc_source.html#l01519">kaldi::nnet3::time_height_convolution::GetComputationIo()</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00284">RestrictedAttentionComponent::num_left_inputs_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00289">RestrictedAttentionComponent::num_left_inputs_required_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00285">RestrictedAttentionComponent::num_right_inputs_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00290">RestrictedAttentionComponent::num_right_inputs_required_</a>, <a class="el" href="convolution_8h_source.html#l00393">ConvolutionComputationIo::num_t_in</a>, <a class="el" href="convolution_8h_source.html#l00394">ConvolutionComputationIo::num_t_out</a>, <a class="el" href="convolution_8h_source.html#l00393">ConvolutionComputationIo::start_t_in</a>, <a class="el" href="convolution_8h_source.html#l00394">ConvolutionComputationIo::start_t_out</a>, <a class="el" href="convolution_8h_source.html#l00393">ConvolutionComputationIo::t_step_in</a>, <a class="el" href="convolution_8h_source.html#l00394">ConvolutionComputationIo::t_step_out</a>, and <a class="el" href="nnet-attention-component_8h_source.html#l00286">RestrictedAttentionComponent::time_stride_</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8cc_source.html#l00621">RestrictedAttentionComponent::PrecomputeIndexes()</a>, and <a class="el" href="nnet-attention-component_8cc_source.html#l00375">RestrictedAttentionComponent::ReorderIndexes()</a>.</p>
<div class="fragment"><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                                                                 {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3_1_1time__height__convolution.html#ae62a1a6a9f5852ccbac183045ab6815e">GetComputationIo</a>(input_indexes, output_indexes, io);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="comment">// if there was only one output and/or input index (unlikely),</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="comment">// just let the grid periodicity be t_stride_.</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="keywordflow">if</span> (io-&gt;t_step_out == 0) io-&gt;t_step_out = <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">time_stride_</a>;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="keywordflow">if</span> (io-&gt;t_step_in == 0) io-&gt;t_step_in = <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">time_stride_</a>;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="comment">// We need the grid size on the input and output to be the same, and to divide</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="comment">// t_stride_.  If someone is requesting the output more frequently than</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="comment">// t_stride_, then after this change we may end up computing more outputs than</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="comment">// we need, but this is not a configuration that I think is very likely.  We</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="comment">// let the grid step be the gcd of the input and output steps, and of</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="comment">// t_stride_.</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="comment">// The next few statements may have the effect of making the grid finer at the</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="comment">// input and output, while having the same start and end point.</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  int32 t_step = <a class="code" href="namespacekaldi.html#a75dfcbc8c8e6254466874ee4b2e69d31">Gcd</a>(<a class="code" href="namespacekaldi.html#a75dfcbc8c8e6254466874ee4b2e69d31">Gcd</a>(io-&gt;t_step_out, io-&gt;t_step_in), <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">time_stride_</a>);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  int32 multiple_out = io-&gt;t_step_out / t_step,</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      multiple_in = io-&gt;t_step_in / t_step;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  io-&gt;t_step_in = t_step;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  io-&gt;t_step_out = t_step;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  io-&gt;num_t_out = 1 + multiple_out * (io-&gt;num_t_out - 1);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  io-&gt;num_t_in = 1 + multiple_in * (io-&gt;num_t_in - 1);</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="comment">// Now ensure that the extent of the input has at least</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="comment">// the requested left-context and right context; if</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="comment">// this increases the amount of input, we&#39;ll do zero-padding.</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  int32 first_requested_input =</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;          io-&gt;start_t_out - (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">time_stride_</a> * <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">num_left_inputs_</a>),</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      first_required_input =</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;         io-&gt;start_t_out - (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">time_stride_</a> * <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a0e898f815954c8234cc4c17527168eb9">num_left_inputs_required_</a>),</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      last_t_out = io-&gt;start_t_out + (io-&gt;num_t_out - 1) * t_step,</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      last_t_in = io-&gt;start_t_in + (io-&gt;num_t_in - 1) * t_step,</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      last_requested_input = last_t_out + (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">time_stride_</a> * <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">num_right_inputs_</a>),</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      last_required_input =</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;           last_t_out + (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">time_stride_</a> * <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2d9705afdedc78fc1e64957f976085d0">num_right_inputs_required_</a>);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="comment">// check that we don&#39;t have *more* than the requested context,</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="comment">// but that we have at least the required context.</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(io-&gt;start_t_in &gt;= first_requested_input &amp;&amp;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;               last_t_in &lt;= last_requested_input &amp;&amp;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;               io-&gt;start_t_in &lt;= first_required_input &amp;&amp;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;               last_t_in &gt;= last_required_input);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="comment">// For the inputs that were requested, but not required,</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="comment">// we pad with zeros.  We pad the &#39;io&#39; object, adding these</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="comment">// extra inputs structurally; in runtime they&#39;ll be set to zero.</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  io-&gt;start_t_in = first_requested_input;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  io-&gt;num_t_in = 1 + (last_requested_input - first_requested_input) / t_step;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a43d674ac6ba436481c1c4672fd1bea77"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">kaldi::nnet3::RestrictedAttentionComponent::time_stride_</a></div><div class="ttdeci">int32 time_stride_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00286">nnet-attention-component.h:286</a></div></div>
<div class="ttc" id="namespacekaldi_html_a75dfcbc8c8e6254466874ee4b2e69d31"><div class="ttname"><a href="namespacekaldi.html#a75dfcbc8c8e6254466874ee4b2e69d31">kaldi::Gcd</a></div><div class="ttdeci">I Gcd(I m, I n)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8h_source.html#l00296">kaldi-math.h:296</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a0e898f815954c8234cc4c17527168eb9"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a0e898f815954c8234cc4c17527168eb9">kaldi::nnet3::RestrictedAttentionComponent::num_left_inputs_required_</a></div><div class="ttdeci">int32 num_left_inputs_required_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00289">nnet-attention-component.h:289</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a2d9705afdedc78fc1e64957f976085d0"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2d9705afdedc78fc1e64957f976085d0">kaldi::nnet3::RestrictedAttentionComponent::num_right_inputs_required_</a></div><div class="ttdeci">int32 num_right_inputs_required_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00290">nnet-attention-component.h:290</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a40571f26e91bce91b89f63840291c8ce"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">kaldi::nnet3::RestrictedAttentionComponent::num_right_inputs_</a></div><div class="ttdeci">int32 num_right_inputs_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00285">nnet-attention-component.h:285</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_1_1time__height__convolution_html_ae62a1a6a9f5852ccbac183045ab6815e"><div class="ttname"><a href="namespacekaldi_1_1nnet3_1_1time__height__convolution.html#ae62a1a6a9f5852ccbac183045ab6815e">kaldi::nnet3::time_height_convolution::GetComputationIo</a></div><div class="ttdeci">void GetComputationIo(const std::vector&lt; Index &gt; &amp;input_indexes, const std::vector&lt; Index &gt; &amp;output_indexes, ConvolutionComputationIo *io)</div><div class="ttdoc">This function takes lists of input and output indexes to a computation (e.g. </div><div class="ttdef"><b>Definition:</b> <a href="convolution_8cc_source.html#l01519">convolution.cc:1519</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a4d7e5406fed09929350deb26767f25aa"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">kaldi::nnet3::RestrictedAttentionComponent::num_left_inputs_</a></div><div class="ttdeci">int32 num_left_inputs_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00284">nnet-attention-component.h:284</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afc71d7740bea7e0050f7ece2f3d575eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc71d7740bea7e0050f7ece2f3d575eb">&#9670;&nbsp;</a></span>GetIndexes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void GetIndexes </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>input_indexes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>output_indexes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structkaldi_1_1nnet3_1_1time__height__convolution_1_1ConvolutionComputationIo.html">time_height_convolution::ConvolutionComputationIo</a> &amp;&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; *&#160;</td>
          <td class="paramname"><em>new_input_indexes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; *&#160;</td>
          <td class="paramname"><em>new_output_indexes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8cc_source.html#l00596">596</a> of file <a class="el" href="nnet-attention-component_8cc_source.html">nnet-attention-component.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-attention-component_8cc_source.html#l00574">RestrictedAttentionComponent::CreateIndexesVector()</a>, <a class="el" href="nnet-compile-utils_8cc_source.html#l00603">kaldi::nnet3::GetNxList()</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="convolution_8h_source.html#l00381">ConvolutionComputationIo::num_images</a>, <a class="el" href="convolution_8h_source.html#l00393">ConvolutionComputationIo::num_t_in</a>, <a class="el" href="convolution_8h_source.html#l00394">ConvolutionComputationIo::num_t_out</a>, <a class="el" href="convolution_8h_source.html#l00393">ConvolutionComputationIo::start_t_in</a>, <a class="el" href="convolution_8h_source.html#l00394">ConvolutionComputationIo::start_t_out</a>, <a class="el" href="convolution_8h_source.html#l00393">ConvolutionComputationIo::t_step_in</a>, and <a class="el" href="convolution_8h_source.html#l00394">ConvolutionComputationIo::t_step_out</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8cc_source.html#l00621">RestrictedAttentionComponent::PrecomputeIndexes()</a>, and <a class="el" href="nnet-attention-component_8cc_source.html#l00375">RestrictedAttentionComponent::ReorderIndexes()</a>.</p>
<div class="fragment"><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                                                  {</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  std::unordered_set&lt;Index, IndexHasher&gt; input_set, output_set;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="keywordflow">for</span> (std::vector&lt;Index&gt;::const_iterator iter = input_indexes.begin();</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;       iter != input_indexes.end(); ++iter)</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    input_set.insert(*iter);</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="keywordflow">for</span> (std::vector&lt;Index&gt;::const_iterator iter = output_indexes.begin();</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;       iter != output_indexes.end(); ++iter)</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    output_set.insert(*iter);</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  std::vector&lt;std::pair&lt;int32, int32&gt; &gt; n_x_pairs;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a88f25f27da8a794033590e7e322d7673">GetNxList</a>(input_indexes, &amp;n_x_pairs);  <span class="comment">// the n,x pairs at the output will be</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                                         <span class="comment">// identical.</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(n_x_pairs.size() == io.num_images);</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a91eb639e00c2eafa02815a750be70f8a">CreateIndexesVector</a>(n_x_pairs, io.start_t_in, io.t_step_in, io.num_t_in,</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                      input_set, new_input_indexes);</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a91eb639e00c2eafa02815a750be70f8a">CreateIndexesVector</a>(n_x_pairs, io.start_t_out, io.t_step_out, io.num_t_out,</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                      output_set, new_output_indexes);</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a91eb639e00c2eafa02815a750be70f8a"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a91eb639e00c2eafa02815a750be70f8a">kaldi::nnet3::RestrictedAttentionComponent::CreateIndexesVector</a></div><div class="ttdeci">static void CreateIndexesVector(const std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &amp;n_x_pairs, int32 t_start, int32 t_step, int32 num_t_values, const std::unordered_set&lt; Index, IndexHasher &gt; &amp;index_set, std::vector&lt; Index &gt; *output_indexes)</div><div class="ttdoc">Utility function used in GetIndexes(). </div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00574">nnet-attention-component.cc:574</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a88f25f27da8a794033590e7e322d7673"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a88f25f27da8a794033590e7e322d7673">kaldi::nnet3::GetNxList</a></div><div class="ttdeci">void GetNxList(const std::vector&lt; Index &gt; &amp;indexes, std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; *pairs)</div><div class="ttdoc">This function outputs a unique, lexicographically sorted list of the pairs of (n, x) values that are ...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile-utils_8cc_source.html#l00603">nnet-compile-utils.cc:603</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9d7b185ac981780bcfaed7dfdd8908d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d7b185ac981780bcfaed7dfdd8908d8">&#9670;&nbsp;</a></span>GetInputIndexes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void GetInputIndexes </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1MiscComputationInfo.html">MiscComputationInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>misc_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>output_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; *&#160;</td>
          <td class="paramname"><em>desired_indexes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function only does something interesting for non-simple Components. </p>
<p>For a given index at the output of the component, tells us what indexes are required at its input (note: "required" encompasses also optionally-required things; it will enumerate all things that we'd like to have). See also <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a529c07610dd915a30e452f80b8bb5fc0" title="This function only does something interesting for non-simple Components, and it exists to make it pos...">IsComputable()</a>. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">misc_info</td><td>This argument is supplied to handle things that the framework can't very easily supply: information like which time indexes are needed for AggregateComponent, which time-indexes are available at the input of a recurrent network, and so on. We will add members to misc_info as needed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">output_index</td><td>The <a class="el" href="structkaldi_1_1nnet3_1_1Index.html" title="struct Index is intended to represent the various indexes by which we number the rows of the matrices...">Index</a> at the output of the component, for which we are requesting the list of indexes at the component's input. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">desired_indexes</td><td>A list of indexes that are desired at the input. are to be written to here. By "desired" we mean required or optionally-required.</td></tr>
  </table>
  </dd>
</dl>
<p>The default implementation of this function is suitable for any SimpleComponent; it just copies the output_index to a single identical element in input_indexes. </p>

<p>Reimplemented from <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a9d7b185ac981780bcfaed7dfdd8908d8">Component</a>.</p>

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8cc_source.html#l00506">506</a> of file <a class="el" href="nnet-attention-component_8cc_source.html">nnet-attention-component.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-attention-component_8h_source.html#l00287">RestrictedAttentionComponent::context_dim_</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="nnet-common_8cc_source.html#l00573">kaldi::nnet3::kNoTime</a>, <a class="el" href="nnet-common_8h_source.html#l00045">Index::n</a>, <a class="el" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">rnnlm::n</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00284">RestrictedAttentionComponent::num_left_inputs_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00285">RestrictedAttentionComponent::num_right_inputs_</a>, <a class="el" href="nnet-common_8h_source.html#l00046">Index::t</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00286">RestrictedAttentionComponent::time_stride_</a>, and <a class="el" href="nnet-common_8h_source.html#l00047">Index::x</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8h_source.html#l00158">RestrictedAttentionComponent::DeleteMemo()</a>.</p>
<div class="fragment"><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                                             {</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(output_index.t != <a class="code" href="namespacekaldi_1_1nnet3.html#ac952f0840a7950dff80c1a89e69656d7">kNoTime</a>);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  int32 first_time = output_index.t - (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">time_stride_</a> * <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">num_left_inputs_</a>),</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      last_time = output_index.t + (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">time_stride_</a> * <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">num_right_inputs_</a>);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  desired_indexes-&gt;clear();</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  desired_indexes-&gt;resize(<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a>);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  int32 <a class="code" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">n</a> = output_index.n, x = output_index.x,</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="keywordflow">for</span> (int32 t = first_time; t &lt;= last_time; t += <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">time_stride_</a>, <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    (*desired_indexes)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].n = <a class="code" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">n</a>;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    (*desired_indexes)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].t = t;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    (*desired_indexes)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].x = x;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  }</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> == <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a>);</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a43d674ac6ba436481c1c4672fd1bea77"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">kaldi::nnet3::RestrictedAttentionComponent::time_stride_</a></div><div class="ttdeci">int32 time_stride_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00286">nnet-attention-component.h:286</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a40571f26e91bce91b89f63840291c8ce"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">kaldi::nnet3::RestrictedAttentionComponent::num_right_inputs_</a></div><div class="ttdeci">int32 num_right_inputs_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00285">nnet-attention-component.h:285</a></div></div>
<div class="ttc" id="namespacernnlm_html_ab4871778d570f724a07823e0a2fb9884"><div class="ttname"><a href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@11::@12 n</div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8f2ba24a43264b8812e3e1e83878a59c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">kaldi::nnet3::RestrictedAttentionComponent::context_dim_</a></div><div class="ttdeci">int32 context_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00287">nnet-attention-component.h:287</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ac952f0840a7950dff80c1a89e69656d7"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ac952f0840a7950dff80c1a89e69656d7">kaldi::nnet3::kNoTime</a></div><div class="ttdeci">const int kNoTime</div><div class="ttdef"><b>Definition:</b> <a href="nnet-common_8cc_source.html#l00573">nnet-common.cc:573</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a4d7e5406fed09929350deb26767f25aa"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">kaldi::nnet3::RestrictedAttentionComponent::num_left_inputs_</a></div><div class="ttdeci">int32 num_left_inputs_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00284">nnet-attention-component.h:284</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a245d65d566725422b859c99bff7623f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a245d65d566725422b859c99bff7623f8">&#9670;&nbsp;</a></span>Info()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string Info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns some text-form information about this component, for diagnostics. </p>
<p>Starts with the type of the component. E.g. "SigmoidComponent dim=900", although most components will have much more info. </p>

<p>Reimplemented from <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a245d65d566725422b859c99bff7623f8">Component</a>.</p>

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8cc_source.html#l00032">32</a> of file <a class="el" href="nnet-attention-component_8cc_source.html">nnet-attention-component.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-attention-component_8h_source.html#l00287">RestrictedAttentionComponent::context_dim_</a>, <a class="el" href="kaldi-vector_8h_source.html#l00063">VectorBase&lt; Real &gt;::Dim()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00295">RestrictedAttentionComponent::entropy_stats_</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00115">RestrictedAttentionComponent::InputDim()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00282">RestrictedAttentionComponent::key_dim_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00292">RestrictedAttentionComponent::key_scale_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00281">RestrictedAttentionComponent::num_heads_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00284">RestrictedAttentionComponent::num_left_inputs_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00289">RestrictedAttentionComponent::num_left_inputs_required_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00285">RestrictedAttentionComponent::num_right_inputs_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00290">RestrictedAttentionComponent::num_right_inputs_required_</a>, <a class="el" href="cu-matrix_8h_source.html#l00215">CuMatrixBase&lt; Real &gt;::NumCols()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00291">RestrictedAttentionComponent::output_context_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00121">RestrictedAttentionComponent::OutputDim()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00298">RestrictedAttentionComponent::posterior_stats_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00294">RestrictedAttentionComponent::stats_count_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00286">RestrictedAttentionComponent::time_stride_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00130">RestrictedAttentionComponent::Type()</a>, and <a class="el" href="nnet-attention-component_8h_source.html#l00283">RestrictedAttentionComponent::value_dim_</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8h_source.html#l00121">RestrictedAttentionComponent::OutputDim()</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                                                   {</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  std::stringstream stream;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  stream &lt;&lt; <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#af2d951f58073f362411ee482aa469975">Type</a>() &lt;&lt; <span class="stringliteral">&quot;, input-dim=&quot;</span> &lt;&lt; <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ad4cb6aed1f1980c2c36f34e09ceea0e0">InputDim</a>()</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;, output-dim=&quot;</span> &lt;&lt; <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a323155ad8034c0b14762dd78ae4415b5">OutputDim</a>()</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;, num-heads=&quot;</span> &lt;&lt; <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">num_heads_</a></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;, time-stride=&quot;</span> &lt;&lt; <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">time_stride_</a></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;, key-dim=&quot;</span> &lt;&lt; <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;, value-dim=&quot;</span> &lt;&lt; <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;, num-left-inputs=&quot;</span> &lt;&lt; <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">num_left_inputs_</a></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;, num-right-inputs=&quot;</span> &lt;&lt; <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">num_right_inputs_</a></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;, context-dim=&quot;</span> &lt;&lt; <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;, num-left-inputs-required=&quot;</span> &lt;&lt; <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a0e898f815954c8234cc4c17527168eb9">num_left_inputs_required_</a></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;, num-right-inputs-required=&quot;</span> &lt;&lt; <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2d9705afdedc78fc1e64957f976085d0">num_right_inputs_required_</a></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;, output-context=&quot;</span> &lt;&lt; (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac81e565312ceebb6467353ca015ea7d6">output_context_</a> ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>)</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;, key-scale=&quot;</span> &lt;&lt; <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acee63c613b77d9037649008e094ad585">key_scale_</a>;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">stats_count_</a> != 0.0) {</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    stream &lt;&lt; <span class="stringliteral">&quot;, entropy=&quot;</span>;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40a34aecd5f5f9754cf84d41be5375c0">entropy_stats_</a>.<a class="code" href="classkaldi_1_1VectorBase.html#af3d58f15749a15d89b0ec5819dd7b7f2">Dim</a>(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      stream &lt;&lt; (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40a34aecd5f5f9754cf84d41be5375c0">entropy_stats_</a>(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) / <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">stats_count_</a>) &lt;&lt; <span class="charliteral">&#39;,&#39;</span>;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">num_heads_</a> &amp;&amp; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 5; i++) {</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      stream &lt;&lt; <span class="stringliteral">&quot; posterior-stats[&quot;</span> &lt;&lt; i &lt;&lt;<span class="stringliteral">&quot;]=&quot;</span>;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1cfb68dbd140132e24fa5ede76562e45">posterior_stats_</a>.<a class="code" href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">NumCols</a>(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++)</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        stream &lt;&lt; (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1cfb68dbd140132e24fa5ede76562e45">posterior_stats_</a>(i,<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>) / <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">stats_count_</a>) &lt;&lt; <span class="charliteral">&#39;,&#39;</span>;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    }</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    stream &lt;&lt; <span class="stringliteral">&quot; stats-count=&quot;</span> &lt;&lt; <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">stats_count_</a>;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  }</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordflow">return</span> stream.str();</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_ad4cb6aed1f1980c2c36f34e09ceea0e0"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ad4cb6aed1f1980c2c36f34e09ceea0e0">kaldi::nnet3::RestrictedAttentionComponent::InputDim</a></div><div class="ttdeci">virtual int32 InputDim() const</div><div class="ttdoc">Returns input-dimension of this component. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00115">nnet-attention-component.h:115</a></div></div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_acee63c613b77d9037649008e094ad585"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acee63c613b77d9037649008e094ad585">kaldi::nnet3::RestrictedAttentionComponent::key_scale_</a></div><div class="ttdeci">BaseFloat key_scale_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00292">nnet-attention-component.h:292</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a43d674ac6ba436481c1c4672fd1bea77"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">kaldi::nnet3::RestrictedAttentionComponent::time_stride_</a></div><div class="ttdeci">int32 time_stride_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00286">nnet-attention-component.h:286</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a0e898f815954c8234cc4c17527168eb9"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a0e898f815954c8234cc4c17527168eb9">kaldi::nnet3::RestrictedAttentionComponent::num_left_inputs_required_</a></div><div class="ttdeci">int32 num_left_inputs_required_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00289">nnet-attention-component.h:289</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_ac81e565312ceebb6467353ca015ea7d6"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac81e565312ceebb6467353ca015ea7d6">kaldi::nnet3::RestrictedAttentionComponent::output_context_</a></div><div class="ttdeci">bool output_context_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00291">nnet-attention-component.h:291</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a2d9705afdedc78fc1e64957f976085d0"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2d9705afdedc78fc1e64957f976085d0">kaldi::nnet3::RestrictedAttentionComponent::num_right_inputs_required_</a></div><div class="ttdeci">int32 num_right_inputs_required_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00290">nnet-attention-component.h:290</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a1cfb68dbd140132e24fa5ede76562e45"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1cfb68dbd140132e24fa5ede76562e45">kaldi::nnet3::RestrictedAttentionComponent::posterior_stats_</a></div><div class="ttdeci">CuMatrix&lt; double &gt; posterior_stats_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00298">nnet-attention-component.h:298</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a323155ad8034c0b14762dd78ae4415b5"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a323155ad8034c0b14762dd78ae4415b5">kaldi::nnet3::RestrictedAttentionComponent::OutputDim</a></div><div class="ttdeci">virtual int32 OutputDim() const</div><div class="ttdoc">Returns output-dimension of this component. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00121">nnet-attention-component.h:121</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a40571f26e91bce91b89f63840291c8ce"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">kaldi::nnet3::RestrictedAttentionComponent::num_right_inputs_</a></div><div class="ttdeci">int32 num_right_inputs_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00285">nnet-attention-component.h:285</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a40a34aecd5f5f9754cf84d41be5375c0"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40a34aecd5f5f9754cf84d41be5375c0">kaldi::nnet3::RestrictedAttentionComponent::entropy_stats_</a></div><div class="ttdeci">Vector&lt; double &gt; entropy_stats_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00295">nnet-attention-component.h:295</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a4a638e2d2a390900749819b63b06cba8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">kaldi::nnet3::RestrictedAttentionComponent::key_dim_</a></div><div class="ttdeci">int32 key_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00282">nnet-attention-component.h:282</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a17d0f37c99e964fc99274cf984f383e8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">kaldi::nnet3::RestrictedAttentionComponent::stats_count_</a></div><div class="ttdeci">double stats_count_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00294">nnet-attention-component.h:294</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_af2d951f58073f362411ee482aa469975"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#af2d951f58073f362411ee482aa469975">kaldi::nnet3::RestrictedAttentionComponent::Type</a></div><div class="ttdeci">virtual std::string Type() const</div><div class="ttdoc">Returns a string such as &quot;SigmoidComponent&quot;, describing the type of the object. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00130">nnet-attention-component.h:130</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8fb0e7f13f5d151b88cf0af7a28e6817"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">kaldi::nnet3::RestrictedAttentionComponent::value_dim_</a></div><div class="ttdeci">int32 value_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00283">nnet-attention-component.h:283</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_af3d58f15749a15d89b0ec5819dd7b7f2"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#af3d58f15749a15d89b0ec5819dd7b7f2">kaldi::VectorBase::Dim</a></div><div class="ttdeci">MatrixIndexT Dim() const</div><div class="ttdoc">Returns the dimension of the vector. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8h_source.html#l00063">kaldi-vector.h:63</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8f2ba24a43264b8812e3e1e83878a59c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">kaldi::nnet3::RestrictedAttentionComponent::context_dim_</a></div><div class="ttdeci">int32 context_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00287">nnet-attention-component.h:287</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_acd4c9f53536602585f5aff9e8005299a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#acd4c9f53536602585f5aff9e8005299a">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00215">cu-matrix.h:215</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_ae53cc4977f9fbe6523374aaf5ba10c80"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">kaldi::nnet3::RestrictedAttentionComponent::num_heads_</a></div><div class="ttdeci">int32 num_heads_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00281">nnet-attention-component.h:281</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a4d7e5406fed09929350deb26767f25aa"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">kaldi::nnet3::RestrictedAttentionComponent::num_left_inputs_</a></div><div class="ttdeci">int32 num_left_inputs_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00284">nnet-attention-component.h:284</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac4f5c35427c2657c50173313e99e3f01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4f5c35427c2657c50173313e99e3f01">&#9670;&nbsp;</a></span>InitFromConfig()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void InitFromConfig </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1nnet3_1_1ConfigLine.html">ConfigLine</a> *&#160;</td>
          <td class="paramname"><em>cfl</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize, from a <a class="el" href="classkaldi_1_1nnet3_1_1ConfigLine.html" title="This class is responsible for parsing input like hi-there xx=yyy a=b c empty= f-oo=Append(bar, sss) ba_z=123 bing=&#39;a b c&#39; baz=&quot;a b c d=&#39;a b&#39; e&quot; and giving you access to the fields, in this case. ">ConfigLine</a> object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cfl</td><td>A <a class="el" href="classkaldi_1_1nnet3_1_1ConfigLine.html" title="This class is responsible for parsing input like hi-there xx=yyy a=b c empty= f-oo=Append(bar, sss) ba_z=123 bing=&#39;a b c&#39; baz=&quot;a b c d=&#39;a b&#39; e&quot; and giving you access to the fields, in this case. ">ConfigLine</a> containing any parameters that are needed for initialization. For example: "dim=100 param-stddev=0.1" </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a1f7dc9cc61293d3c7decb5bd8ea3f4d5">Component</a>.</p>

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8cc_source.html#l00080">80</a> of file <a class="el" href="nnet-attention-component_8cc_source.html">nnet-attention-component.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-attention-component_8cc_source.html#l00277">RestrictedAttentionComponent::Check()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00287">RestrictedAttentionComponent::context_dim_</a>, <a class="el" href="nnet-parse_8cc_source.html#l00115">ConfigLine::GetValue()</a>, <a class="el" href="kaldi-error_8h_source.html#l00126">KALDI_ERR</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00282">RestrictedAttentionComponent::key_dim_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00292">RestrictedAttentionComponent::key_scale_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00281">RestrictedAttentionComponent::num_heads_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00284">RestrictedAttentionComponent::num_left_inputs_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00289">RestrictedAttentionComponent::num_left_inputs_required_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00285">RestrictedAttentionComponent::num_right_inputs_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00290">RestrictedAttentionComponent::num_right_inputs_required_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00291">RestrictedAttentionComponent::output_context_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00294">RestrictedAttentionComponent::stats_count_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00286">RestrictedAttentionComponent::time_stride_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00283">RestrictedAttentionComponent::value_dim_</a>, and <a class="el" href="nnet-parse_8h_source.html#l00073">ConfigLine::WholeLine()</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8h_source.html#l00121">RestrictedAttentionComponent::OutputDim()</a>.</p>
<div class="fragment"><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                                                                 {</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">num_heads_</a> = 1;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a> = -1;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a> = -1;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">num_left_inputs_</a> = -1;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">num_right_inputs_</a> = -1;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">time_stride_</a> = 1;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a0e898f815954c8234cc4c17527168eb9">num_left_inputs_required_</a> = -1;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2d9705afdedc78fc1e64957f976085d0">num_right_inputs_required_</a> = -1;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac81e565312ceebb6467353ca015ea7d6">output_context_</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acee63c613b77d9037649008e094ad585">key_scale_</a> = -1.0;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="comment">// mandatory arguments.</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordtype">bool</span> ok = cfl-&gt;GetValue(<span class="stringliteral">&quot;key-dim&quot;</span>, &amp;<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a>) &amp;&amp;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      cfl-&gt;GetValue(<span class="stringliteral">&quot;value-dim&quot;</span>, &amp;<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a>) &amp;&amp;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      cfl-&gt;GetValue(<span class="stringliteral">&quot;num-left-inputs&quot;</span>, &amp;<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">num_left_inputs_</a>) &amp;&amp;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      cfl-&gt;GetValue(<span class="stringliteral">&quot;num-right-inputs&quot;</span>, &amp;<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">num_right_inputs_</a>);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordflow">if</span> (!ok)</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;All of the values key-dim, value-dim, &quot;</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="stringliteral">&quot;num-left-inputs and num-right-inputs must be defined.&quot;</span>;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="comment">// optional arguments.</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  cfl-&gt;GetValue(<span class="stringliteral">&quot;num-heads&quot;</span>, &amp;<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">num_heads_</a>);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  cfl-&gt;GetValue(<span class="stringliteral">&quot;time-stride&quot;</span>, &amp;<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">time_stride_</a>);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  cfl-&gt;GetValue(<span class="stringliteral">&quot;num-left-inputs-required&quot;</span>, &amp;<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a0e898f815954c8234cc4c17527168eb9">num_left_inputs_required_</a>);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  cfl-&gt;GetValue(<span class="stringliteral">&quot;num-right-inputs-required&quot;</span>, &amp;<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2d9705afdedc78fc1e64957f976085d0">num_right_inputs_required_</a>);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  cfl-&gt;GetValue(<span class="stringliteral">&quot;output-context&quot;</span>, &amp;<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac81e565312ceebb6467353ca015ea7d6">output_context_</a>);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  cfl-&gt;GetValue(<span class="stringliteral">&quot;key-scale&quot;</span>, &amp;<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acee63c613b77d9037649008e094ad585">key_scale_</a>);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acee63c613b77d9037649008e094ad585">key_scale_</a> &lt; 0.0) <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acee63c613b77d9037649008e094ad585">key_scale_</a> = 1.0 / sqrt(<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a>);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a0e898f815954c8234cc4c17527168eb9">num_left_inputs_required_</a> &lt; 0)</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a0e898f815954c8234cc4c17527168eb9">num_left_inputs_required_</a> = <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">num_left_inputs_</a>;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2d9705afdedc78fc1e64957f976085d0">num_right_inputs_required_</a> &lt; 0)</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2d9705afdedc78fc1e64957f976085d0">num_right_inputs_required_</a> = <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">num_right_inputs_</a>;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">num_heads_</a> &lt;= 0 || <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a> &lt;= 0 || <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a> &lt;= 0 ||</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">num_left_inputs_</a> &lt; 0 || <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">num_right_inputs_</a> &lt; 0 ||</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">num_left_inputs_</a> + <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">num_right_inputs_</a>) &lt;= 0 ||</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a0e898f815954c8234cc4c17527168eb9">num_left_inputs_required_</a> &gt; <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">num_left_inputs_</a> ||</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2d9705afdedc78fc1e64957f976085d0">num_right_inputs_required_</a> &gt; <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">num_right_inputs_</a> ||</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">time_stride_</a> &lt;= 0)</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Config line contains invalid values: &quot;</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;              &lt;&lt; cfl-&gt;WholeLine();</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">stats_count_</a> = 0.0;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a> = <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">num_left_inputs_</a> + 1 + <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">num_right_inputs_</a>;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4c47fd4f163011eb1939870d25aa656a">Check</a>();</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_acee63c613b77d9037649008e094ad585"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acee63c613b77d9037649008e094ad585">kaldi::nnet3::RestrictedAttentionComponent::key_scale_</a></div><div class="ttdeci">BaseFloat key_scale_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00292">nnet-attention-component.h:292</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a4c47fd4f163011eb1939870d25aa656a"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4c47fd4f163011eb1939870d25aa656a">kaldi::nnet3::RestrictedAttentionComponent::Check</a></div><div class="ttdeci">void Check() const</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00277">nnet-attention-component.cc:277</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a43d674ac6ba436481c1c4672fd1bea77"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">kaldi::nnet3::RestrictedAttentionComponent::time_stride_</a></div><div class="ttdeci">int32 time_stride_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00286">nnet-attention-component.h:286</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a0e898f815954c8234cc4c17527168eb9"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a0e898f815954c8234cc4c17527168eb9">kaldi::nnet3::RestrictedAttentionComponent::num_left_inputs_required_</a></div><div class="ttdeci">int32 num_left_inputs_required_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00289">nnet-attention-component.h:289</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_ac81e565312ceebb6467353ca015ea7d6"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac81e565312ceebb6467353ca015ea7d6">kaldi::nnet3::RestrictedAttentionComponent::output_context_</a></div><div class="ttdeci">bool output_context_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00291">nnet-attention-component.h:291</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a2d9705afdedc78fc1e64957f976085d0"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2d9705afdedc78fc1e64957f976085d0">kaldi::nnet3::RestrictedAttentionComponent::num_right_inputs_required_</a></div><div class="ttdeci">int32 num_right_inputs_required_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00290">nnet-attention-component.h:290</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a40571f26e91bce91b89f63840291c8ce"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">kaldi::nnet3::RestrictedAttentionComponent::num_right_inputs_</a></div><div class="ttdeci">int32 num_right_inputs_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00285">nnet-attention-component.h:285</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a4a638e2d2a390900749819b63b06cba8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">kaldi::nnet3::RestrictedAttentionComponent::key_dim_</a></div><div class="ttdeci">int32 key_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00282">nnet-attention-component.h:282</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a17d0f37c99e964fc99274cf984f383e8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">kaldi::nnet3::RestrictedAttentionComponent::stats_count_</a></div><div class="ttdeci">double stats_count_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00294">nnet-attention-component.h:294</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00126">kaldi-error.h:126</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8fb0e7f13f5d151b88cf0af7a28e6817"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">kaldi::nnet3::RestrictedAttentionComponent::value_dim_</a></div><div class="ttdeci">int32 value_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00283">nnet-attention-component.h:283</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8f2ba24a43264b8812e3e1e83878a59c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">kaldi::nnet3::RestrictedAttentionComponent::context_dim_</a></div><div class="ttdeci">int32 context_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00287">nnet-attention-component.h:287</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_ae53cc4977f9fbe6523374aaf5ba10c80"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">kaldi::nnet3::RestrictedAttentionComponent::num_heads_</a></div><div class="ttdeci">int32 num_heads_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00281">nnet-attention-component.h:281</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a4d7e5406fed09929350deb26767f25aa"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">kaldi::nnet3::RestrictedAttentionComponent::num_left_inputs_</a></div><div class="ttdeci">int32 num_left_inputs_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00284">nnet-attention-component.h:284</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad4cb6aed1f1980c2c36f34e09ceea0e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4cb6aed1f1980c2c36f34e09ceea0e0">&#9670;&nbsp;</a></span>InputDim()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual int32 InputDim </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns input-dimension of this component. </p>

<p>Implements <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a7f37d871d35c43a03324502cea308635">Component</a>.</p>

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8h_source.html#l00115">115</a> of file <a class="el" href="nnet-attention-component_8h_source.html">nnet-attention-component.h</a>.</p>

<p class="reference">References <a class="el" href="nnet-attention-component_8h_source.html#l00287">RestrictedAttentionComponent::context_dim_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00282">RestrictedAttentionComponent::key_dim_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00281">RestrictedAttentionComponent::num_heads_</a>, and <a class="el" href="nnet-attention-component_8h_source.html#l00283">RestrictedAttentionComponent::value_dim_</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8cc_source.html#l00032">RestrictedAttentionComponent::Info()</a>.</p>
<div class="fragment"><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                                 {</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">// the input is interpreted as being appended blocks one for each head; each</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">// such block is interpreted as (key, value, query).</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    int32 query_dim = <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a> + <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a>;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">num_heads_</a> * (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a> + <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a> + query_dim);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  }</div><div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a4a638e2d2a390900749819b63b06cba8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">kaldi::nnet3::RestrictedAttentionComponent::key_dim_</a></div><div class="ttdeci">int32 key_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00282">nnet-attention-component.h:282</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8fb0e7f13f5d151b88cf0af7a28e6817"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">kaldi::nnet3::RestrictedAttentionComponent::value_dim_</a></div><div class="ttdeci">int32 value_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00283">nnet-attention-component.h:283</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8f2ba24a43264b8812e3e1e83878a59c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">kaldi::nnet3::RestrictedAttentionComponent::context_dim_</a></div><div class="ttdeci">int32 context_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00287">nnet-attention-component.h:287</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_ae53cc4977f9fbe6523374aaf5ba10c80"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">kaldi::nnet3::RestrictedAttentionComponent::num_heads_</a></div><div class="ttdeci">int32 num_heads_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00281">nnet-attention-component.h:281</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a529c07610dd915a30e452f80b8bb5fc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a529c07610dd915a30e452f80b8bb5fc0">&#9670;&nbsp;</a></span>IsComputable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> IsComputable </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1MiscComputationInfo.html">MiscComputationInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>misc_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>output_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1nnet3_1_1IndexSet.html">IndexSet</a> &amp;&#160;</td>
          <td class="paramname"><em>input_index_set</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; *&#160;</td>
          <td class="paramname"><em>used_inputs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function only does something interesting for non-simple Components, and it exists to make it possible to manage optionally-required inputs. </p>
<p>It tells the user whether a given output index is computable from a given set of input indexes, and if so, says which input indexes will be used in the computation.</p>
<p>Implementations of this function are required to have the property that adding an element to "input_index_set" can only ever change IsComputable from false to true, never vice versa.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">misc_info</td><td>Some information specific to the computation, such as minimum and maximum times for certain components to do adaptation on; it's a place to put things that don't easily fit in the framework. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">output_index</td><td>The index that is to be computed at the output of this <a class="el" href="classkaldi_1_1nnet3_1_1Component.html" title="Abstract base-class for neural-net components. ">Component</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">input_index_set</td><td>The set of indexes that is available at the input of this <a class="el" href="classkaldi_1_1nnet3_1_1Component.html" title="Abstract base-class for neural-net components. ">Component</a>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">used_inputs</td><td>If this is non-NULL and the output is computable this will be set to the list of input indexes that will actually be used in the computation. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true iff this output is computable from the provided inputs.</dd></dl>
<p>The default implementation of this function is suitable for any SimpleComponent: it just returns true if output_index is in input_index_set, and if so sets used_inputs to vector containing that one <a class="el" href="structkaldi_1_1nnet3_1_1Index.html" title="struct Index is intended to represent the various indexes by which we number the rows of the matrices...">Index</a>. </p>

<p>Reimplemented from <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a529c07610dd915a30e452f80b8bb5fc0">Component</a>.</p>

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8cc_source.html#l00526">526</a> of file <a class="el" href="nnet-attention-component_8cc_source.html">nnet-attention-component.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-attention-component_8h_source.html#l00287">RestrictedAttentionComponent::context_dim_</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="nnet-common_8cc_source.html#l00573">kaldi::nnet3::kNoTime</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00284">RestrictedAttentionComponent::num_left_inputs_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00289">RestrictedAttentionComponent::num_left_inputs_required_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00285">RestrictedAttentionComponent::num_right_inputs_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00290">RestrictedAttentionComponent::num_right_inputs_required_</a>, <a class="el" href="nnet-common_8h_source.html#l00046">Index::t</a>, and <a class="el" href="nnet-attention-component_8h_source.html#l00286">RestrictedAttentionComponent::time_stride_</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8h_source.html#l00158">RestrictedAttentionComponent::DeleteMemo()</a>.</p>
<div class="fragment"><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                                         {</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(output_index.t != <a class="code" href="namespacekaldi_1_1nnet3.html#ac952f0840a7950dff80c1a89e69656d7">kNoTime</a>);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  Index index(output_index);</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keywordflow">if</span> (used_inputs != NULL) {</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    int32 first_time = output_index.t - (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">time_stride_</a> * <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">num_left_inputs_</a>),</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        last_time = output_index.t + (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">time_stride_</a> * <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">num_right_inputs_</a>);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    used_inputs-&gt;clear();</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    used_inputs-&gt;reserve(<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a>);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keywordflow">for</span> (int32 t = first_time; t &lt;= last_time; t += <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">time_stride_</a>) {</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      index.t = t;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <span class="keywordflow">if</span> (input_index_set(index)) {</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <span class="comment">// This input index is available.</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        used_inputs-&gt;push_back(index);</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="comment">// This input index is not available.</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        int32 offset = (t - output_index.t) / <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">time_stride_</a>;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <span class="keywordflow">if</span> (offset &gt;= <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a0e898f815954c8234cc4c17527168eb9">num_left_inputs_required_</a> &amp;&amp;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            offset &lt;= <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2d9705afdedc78fc1e64957f976085d0">num_right_inputs_required_</a>) {</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;          used_inputs-&gt;clear();</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        }</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      }</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    }</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="comment">// All required time-offsets of the output were computable. -&gt; return true.</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    int32 t = output_index.t,</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        first_time_required = t - (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">time_stride_</a> * <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a0e898f815954c8234cc4c17527168eb9">num_left_inputs_required_</a>),</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        last_time_required = t + (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">time_stride_</a> * <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2d9705afdedc78fc1e64957f976085d0">num_right_inputs_required_</a>);</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordflow">for</span> (int32 t = first_time_required;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;         t &lt;= last_time_required;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;         t += <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">time_stride_</a>) {</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      index.t = t;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      <span class="keywordflow">if</span> (!input_index_set(index))</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    }</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  }</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a43d674ac6ba436481c1c4672fd1bea77"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">kaldi::nnet3::RestrictedAttentionComponent::time_stride_</a></div><div class="ttdeci">int32 time_stride_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00286">nnet-attention-component.h:286</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a0e898f815954c8234cc4c17527168eb9"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a0e898f815954c8234cc4c17527168eb9">kaldi::nnet3::RestrictedAttentionComponent::num_left_inputs_required_</a></div><div class="ttdeci">int32 num_left_inputs_required_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00289">nnet-attention-component.h:289</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a2d9705afdedc78fc1e64957f976085d0"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2d9705afdedc78fc1e64957f976085d0">kaldi::nnet3::RestrictedAttentionComponent::num_right_inputs_required_</a></div><div class="ttdeci">int32 num_right_inputs_required_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00290">nnet-attention-component.h:290</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a40571f26e91bce91b89f63840291c8ce"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">kaldi::nnet3::RestrictedAttentionComponent::num_right_inputs_</a></div><div class="ttdeci">int32 num_right_inputs_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00285">nnet-attention-component.h:285</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8f2ba24a43264b8812e3e1e83878a59c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">kaldi::nnet3::RestrictedAttentionComponent::context_dim_</a></div><div class="ttdeci">int32 context_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00287">nnet-attention-component.h:287</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ac952f0840a7950dff80c1a89e69656d7"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ac952f0840a7950dff80c1a89e69656d7">kaldi::nnet3::kNoTime</a></div><div class="ttdeci">const int kNoTime</div><div class="ttdef"><b>Definition:</b> <a href="nnet-common_8cc_source.html#l00573">nnet-common.cc:573</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a4d7e5406fed09929350deb26767f25aa"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">kaldi::nnet3::RestrictedAttentionComponent::num_left_inputs_</a></div><div class="ttdeci">int32 num_left_inputs_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00284">nnet-attention-component.h:284</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a323155ad8034c0b14762dd78ae4415b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a323155ad8034c0b14762dd78ae4415b5">&#9670;&nbsp;</a></span>OutputDim()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual int32 OutputDim </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns output-dimension of this component. </p>

<p>Implements <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#ac0f2f034a884363d4e0694c62ea8a764">Component</a>.</p>

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8h_source.html#l00121">121</a> of file <a class="el" href="nnet-attention-component_8h_source.html">nnet-attention-component.h</a>.</p>

<p class="reference">References <a class="el" href="nnet-attention-component_8h_source.html#l00287">RestrictedAttentionComponent::context_dim_</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00032">RestrictedAttentionComponent::Info()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00080">RestrictedAttentionComponent::InitFromConfig()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00281">RestrictedAttentionComponent::num_heads_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00291">RestrictedAttentionComponent::output_context_</a>, and <a class="el" href="nnet-attention-component_8h_source.html#l00283">RestrictedAttentionComponent::value_dim_</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8cc_source.html#l00032">RestrictedAttentionComponent::Info()</a>.</p>
<div class="fragment"><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                                  {</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">// the output consists of appended blocks, one for each head; each such</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment">// block is is the attention weighted average of the input values, to which</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">// we append softmax encoding of the positions we chose, if output_context_</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">// == true.</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">num_heads_</a> * (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a> + (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac81e565312ceebb6467353ca015ea7d6">output_context_</a> ? <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a> : 0));</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  }</div><div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_ac81e565312ceebb6467353ca015ea7d6"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac81e565312ceebb6467353ca015ea7d6">kaldi::nnet3::RestrictedAttentionComponent::output_context_</a></div><div class="ttdeci">bool output_context_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00291">nnet-attention-component.h:291</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8fb0e7f13f5d151b88cf0af7a28e6817"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">kaldi::nnet3::RestrictedAttentionComponent::value_dim_</a></div><div class="ttdeci">int32 value_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00283">nnet-attention-component.h:283</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8f2ba24a43264b8812e3e1e83878a59c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">kaldi::nnet3::RestrictedAttentionComponent::context_dim_</a></div><div class="ttdeci">int32 context_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00287">nnet-attention-component.h:287</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_ae53cc4977f9fbe6523374aaf5ba10c80"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">kaldi::nnet3::RestrictedAttentionComponent::num_heads_</a></div><div class="ttdeci">int32 num_heads_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00281">nnet-attention-component.h:281</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8b2919d1c6cfa5f73581f407150374b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b2919d1c6cfa5f73581f407150374b6">&#9670;&nbsp;</a></span>PrecomputeIndexes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1nnet3_1_1ComponentPrecomputedIndexes.html">ComponentPrecomputedIndexes</a> * PrecomputeIndexes </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1MiscComputationInfo.html">MiscComputationInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>misc_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>input_indexes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>output_indexes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>need_backprop</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function must return NULL for simple Components. </p>
<p>Returns a pointer to a class that may contain some precomputed component-specific and computation-specific indexes to be in used in the Propagate and Backprop functions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">misc_info</td><td>This argument is supplied to handle things that the framework can't very easily supply: information like which time indexes are needed for AggregateComponent, which time-indexes are available at the input of a recurrent network, and so on. misc_info may not even ever be used here. We will add members to misc_info as needed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">input_indexes</td><td>A vector of indexes that explains what time-indexes (and other indexes) each row of the in/in_value/in_deriv matrices given to Propagate and Backprop will mean. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">output_indexes</td><td>A vector of indexes that explains what time-indexes (and other indexes) each row of the out/out_value/out_deriv matrices given to Propagate and Backprop will mean. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">need_backprop</td><td>True if we might need to do backprop with this component, so that if any different indexes are needed for backprop then those should be computed too. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a child-class of class <a class="el" href="classkaldi_1_1nnet3_1_1ComponentPrecomputedIndexes.html">ComponentPrecomputedIndexes</a>, or NULL if this component for does not need to precompute any indexes (e.g. if it is a simple component and does not care about indexes). </dd></dl>

<p>Reimplemented from <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#ad3829084b3e064ff320153ff4b6cfd44">Component</a>.</p>

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8cc_source.html#l00621">621</a> of file <a class="el" href="nnet-attention-component_8cc_source.html">nnet-attention-component.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-attention-component_8cc_source.html#l00388">RestrictedAttentionComponent::GetComputationStructure()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00596">RestrictedAttentionComponent::GetIndexes()</a>, <a class="el" href="kaldi-error_8h_source.html#l00057">kaldi::GetVerboseLevel()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00198">RestrictedAttentionComponent::PrecomputedIndexes::io</a>, and <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8h_source.html#l00158">RestrictedAttentionComponent::DeleteMemo()</a>.</p>
<div class="fragment"><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;          {</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  PrecomputedIndexes *ans = <span class="keyword">new</span> PrecomputedIndexes();</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a38367562a48aa99e77d5d2f6eded46c1">GetComputationStructure</a>(input_indexes, output_indexes, &amp;(ans-&gt;io));</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__error__group.html#gae77f5cf98f18f8cbe207690e49da166e">GetVerboseLevel</a>() &gt;= 2) {</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="comment">// what goes next is just a check.</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    std::vector&lt;Index&gt; new_input_indexes, new_output_indexes;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#afc71d7740bea7e0050f7ece2f3d575eb">GetIndexes</a>(input_indexes, output_indexes, ans-&gt;io,</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;               &amp;new_input_indexes, &amp;new_output_indexes);</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="comment">// input_indexes and output_indexes should be the ones that were</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="comment">// output by ReorderIndexes(), so they should already</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="comment">// have gone through the GetComputationStructure()-&gt;GetIndexes()</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="comment">// procedure.  Applying the same procedure twice is supposed to</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="comment">// give an unchanged results.</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(input_indexes == new_input_indexes &amp;&amp;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                 output_indexes == new_output_indexes);</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  }</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="keywordflow">return</span> ans;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_afc71d7740bea7e0050f7ece2f3d575eb"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#afc71d7740bea7e0050f7ece2f3d575eb">kaldi::nnet3::RestrictedAttentionComponent::GetIndexes</a></div><div class="ttdeci">void GetIndexes(const std::vector&lt; Index &gt; &amp;input_indexes, const std::vector&lt; Index &gt; &amp;output_indexes, time_height_convolution::ConvolutionComputationIo &amp;io, std::vector&lt; Index &gt; *new_input_indexes, std::vector&lt; Index &gt; *new_output_indexes) const</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00596">nnet-attention-component.cc:596</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a38367562a48aa99e77d5d2f6eded46c1"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a38367562a48aa99e77d5d2f6eded46c1">kaldi::nnet3::RestrictedAttentionComponent::GetComputationStructure</a></div><div class="ttdeci">void GetComputationStructure(const std::vector&lt; Index &gt; &amp;input_indexes, const std::vector&lt; Index &gt; &amp;output_indexes, time_height_convolution::ConvolutionComputationIo *io) const</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00388">nnet-attention-component.cc:388</a></div></div>
<div class="ttc" id="group__error__group_html_gae77f5cf98f18f8cbe207690e49da166e"><div class="ttname"><a href="group__error__group.html#gae77f5cf98f18f8cbe207690e49da166e">kaldi::GetVerboseLevel</a></div><div class="ttdeci">int32 GetVerboseLevel()</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00057">kaldi-error.h:57</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8f1f1b05a170bd81a544caefe1acb040"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f1f1b05a170bd81a544caefe1acb040">&#9670;&nbsp;</a></span>Propagate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void * Propagate </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1nnet3_1_1ComponentPrecomputedIndexes.html">ComponentPrecomputedIndexes</a> *&#160;</td>
          <td class="paramname"><em>indexes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; *&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Propagate function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">indexes</td><td>A pointer to some information output by this class's PrecomputeIndexes function (will be NULL for simple components, i.e. those that don't do things like splicing). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">in</td><td>The input to this component. Num-columns == <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ad4cb6aed1f1980c2c36f34e09ceea0e0" title="Returns input-dimension of this component. ">InputDim()</a>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>The output of this component. Num-columns == <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a323155ad8034c0b14762dd78ae4415b5" title="Returns output-dimension of this component. ">OutputDim()</a>. Note: output of this component will be added to the initial value of "out" if <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a16a6da3a5108ec53e759722a51fd47" title="Return bitmask of the component&#39;s properties. ">Properties()</a>&amp;kPropagateAdds != 0; otherwise the output will be set and the initial value ignored. Each <a class="el" href="classkaldi_1_1nnet3_1_1Component.html" title="Abstract base-class for neural-net components. ">Component</a> chooses whether it is more convenient implementation-wise to add or set, and the calling code has to deal with it. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Normally returns NULL, but may return a non-NULL value for components which have the flag kUsesMemo set. This value will be passed into the corresponding Backprop routine. </dd></dl>

<p>Implements <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a342467ad10ff8535abe96768bdf27958">Component</a>.</p>

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8cc_source.html#l00132">132</a> of file <a class="el" href="nnet-attention-component_8cc_source.html">nnet-attention-component.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-attention-component_8h_source.html#l00287">RestrictedAttentionComponent::context_dim_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00198">RestrictedAttentionComponent::PrecomputedIndexes::io</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00282">RestrictedAttentionComponent::key_dim_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00281">RestrictedAttentionComponent::num_heads_</a>, <a class="el" href="convolution_8h_source.html#l00381">ConvolutionComputationIo::num_images</a>, <a class="el" href="convolution_8h_source.html#l00393">ConvolutionComputationIo::num_t_in</a>, <a class="el" href="convolution_8h_source.html#l00394">ConvolutionComputationIo::num_t_out</a>, <a class="el" href="cu-matrix_8h_source.html#l00214">CuMatrixBase&lt; Real &gt;::NumRows()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00291">RestrictedAttentionComponent::output_context_</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00160">RestrictedAttentionComponent::PropagateOneHead()</a>, and <a class="el" href="nnet-attention-component_8h_source.html#l00283">RestrictedAttentionComponent::value_dim_</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8h_source.html#l00131">RestrictedAttentionComponent::Properties()</a>.</p>
<div class="fragment"><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                                                                            {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keyword">const</span> PrecomputedIndexes *indexes = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>PrecomputedIndexes*<span class="keyword">&gt;</span>(</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      indexes_in);</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(indexes != NULL &amp;&amp;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;               in.NumRows() == indexes-&gt;io.num_t_in * indexes-&gt;io.num_images &amp;&amp;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;               out-&gt;NumRows() == indexes-&gt;io.num_t_out * indexes-&gt;io.num_images);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  Memo *memo = <span class="keyword">new</span> Memo();</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  memo-&gt;c.Resize(out-&gt;NumRows(), <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a> * <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">num_heads_</a>);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  int32 query_dim = <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a> + <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a>;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  int32 input_dim_per_head = <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a> + <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a> + query_dim,</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      output_dim_per_head = <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a> + (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac81e565312ceebb6467353ca015ea7d6">output_context_</a> ? <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a> : 0);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">for</span> (int32 h = 0; h &lt; <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">num_heads_</a>; h++) {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    CuSubMatrix&lt;BaseFloat&gt; in_part(in, 0, in.NumRows(),</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                                   h * input_dim_per_head, input_dim_per_head),</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        c_part(memo-&gt;c, 0, out-&gt;NumRows(),</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;               h * <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a>, <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a>),</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        out_part(*out, 0, out-&gt;NumRows(),</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                 h * output_dim_per_head, output_dim_per_head);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a7493d5942eae2b80fceab01dd8bbff16">PropagateOneHead</a>(indexes-&gt;io, in_part, &amp;c_part, &amp;out_part);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  }</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(memo);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_ac81e565312ceebb6467353ca015ea7d6"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac81e565312ceebb6467353ca015ea7d6">kaldi::nnet3::RestrictedAttentionComponent::output_context_</a></div><div class="ttdeci">bool output_context_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00291">nnet-attention-component.h:291</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a4a638e2d2a390900749819b63b06cba8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">kaldi::nnet3::RestrictedAttentionComponent::key_dim_</a></div><div class="ttdeci">int32 key_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00282">nnet-attention-component.h:282</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8fb0e7f13f5d151b88cf0af7a28e6817"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">kaldi::nnet3::RestrictedAttentionComponent::value_dim_</a></div><div class="ttdeci">int32 value_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00283">nnet-attention-component.h:283</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8f2ba24a43264b8812e3e1e83878a59c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">kaldi::nnet3::RestrictedAttentionComponent::context_dim_</a></div><div class="ttdeci">int32 context_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00287">nnet-attention-component.h:287</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a7493d5942eae2b80fceab01dd8bbff16"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a7493d5942eae2b80fceab01dd8bbff16">kaldi::nnet3::RestrictedAttentionComponent::PropagateOneHead</a></div><div class="ttdeci">void PropagateOneHead(const time_height_convolution::ConvolutionComputationIo &amp;io, const CuMatrixBase&lt; BaseFloat &gt; &amp;in, CuMatrixBase&lt; BaseFloat &gt; *c, CuMatrixBase&lt; BaseFloat &gt; *out) const</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00160">nnet-attention-component.cc:160</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_ae53cc4977f9fbe6523374aaf5ba10c80"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">kaldi::nnet3::RestrictedAttentionComponent::num_heads_</a></div><div class="ttdeci">int32 num_heads_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00281">nnet-attention-component.h:281</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7493d5942eae2b80fceab01dd8bbff16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7493d5942eae2b80fceab01dd8bbff16">&#9670;&nbsp;</a></span>PropagateOneHead()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PropagateOneHead </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1time__height__convolution_1_1ConvolutionComputationIo.html">time_height_convolution::ConvolutionComputationIo</a> &amp;&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; *&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8cc_source.html#l00160">160</a> of file <a class="el" href="nnet-attention-component_8cc_source.html">nnet-attention-component.cc</a>.</p>

<p class="reference">References <a class="el" href="attention_8cc_source.html#l00097">kaldi::nnet3::attention::AttentionForward()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00287">RestrictedAttentionComponent::context_dim_</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00282">RestrictedAttentionComponent::key_dim_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00292">RestrictedAttentionComponent::key_scale_</a>, <a class="el" href="convolution_8h_source.html#l00381">ConvolutionComputationIo::num_images</a>, <a class="el" href="convolution_8h_source.html#l00393">ConvolutionComputationIo::num_t_in</a>, <a class="el" href="convolution_8h_source.html#l00394">ConvolutionComputationIo::num_t_out</a>, <a class="el" href="cu-matrix_8h_source.html#l00215">CuMatrixBase&lt; Real &gt;::NumCols()</a>, <a class="el" href="cu-matrix_8h_source.html#l00214">CuMatrixBase&lt; Real &gt;::NumRows()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00291">RestrictedAttentionComponent::output_context_</a>, <a class="el" href="convolution_8h_source.html#l00393">ConvolutionComputationIo::start_t_in</a>, <a class="el" href="convolution_8h_source.html#l00394">ConvolutionComputationIo::start_t_out</a>, <a class="el" href="convolution_8h_source.html#l00393">ConvolutionComputationIo::t_step_in</a>, <a class="el" href="convolution_8h_source.html#l00394">ConvolutionComputationIo::t_step_out</a>, and <a class="el" href="nnet-attention-component_8h_source.html#l00283">RestrictedAttentionComponent::value_dim_</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8cc_source.html#l00132">RestrictedAttentionComponent::Propagate()</a>.</p>
<div class="fragment"><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                                        {</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  int32 query_dim = <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a> + <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a>,</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      full_value_dim = <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a> + (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac81e565312ceebb6467353ca015ea7d6">output_context_</a> ? <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a> : 0);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(in.NumRows() == io.num_images * io.num_t_in &amp;&amp;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;               out-&gt;NumRows() == io.num_images * io.num_t_out &amp;&amp;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;               out-&gt;NumCols() == full_value_dim &amp;&amp;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;               in.NumCols() == (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a> + <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a> + query_dim) &amp;&amp;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;               io.t_step_in == io.t_step_out &amp;&amp;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;               (io.start_t_out - io.start_t_in) % io.t_step_in == 0);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="comment">// &#39;steps_left_context&#39; is the number of time-steps the input has on the left</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">// that don&#39;t appear in the output.</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  int32 steps_left_context = (io.start_t_out - io.start_t_in) / io.t_step_in,</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      rows_left_context = steps_left_context * io.num_images;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(rows_left_context &gt;= 0);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="comment">// &#39;queries&#39; contains the queries.  We don&#39;t use all rows of the input</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="comment">// queries; only the rows that correspond to the time-indexes at the</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="comment">// output, i.e. we exclude the left-context and right-context.</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="comment">// &#39;out&#39;; the remaining rows of &#39;in&#39; that we didn&#39;t select correspond to left</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="comment">// and right temporal context.</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  CuSubMatrix&lt;BaseFloat&gt; queries(in, rows_left_context, out-&gt;NumRows(),</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                                 <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a> + <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a>, query_dim);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="comment">// &#39;keys&#39; contains the keys; note, these are not extended with</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="comment">// context information; that happens further in.</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  CuSubMatrix&lt;BaseFloat&gt; keys(in, 0, in.NumRows(), 0, <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a>);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="comment">// &#39;values&#39; contains the values which we will interpolate.</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="comment">// these don&#39;t contain the context information; that will be added</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="comment">// later if output_context_ == true.</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  CuSubMatrix&lt;BaseFloat&gt; values(in, 0, in.NumRows(), <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a>, <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a>);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3_1_1attention.html#a4dba6c0cd0571bfe5b1434b30e7d7bdf">attention::AttentionForward</a>(<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acee63c613b77d9037649008e094ad585">key_scale_</a>, keys, queries, values, c, out);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_acee63c613b77d9037649008e094ad585"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acee63c613b77d9037649008e094ad585">kaldi::nnet3::RestrictedAttentionComponent::key_scale_</a></div><div class="ttdeci">BaseFloat key_scale_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00292">nnet-attention-component.h:292</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_ac81e565312ceebb6467353ca015ea7d6"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac81e565312ceebb6467353ca015ea7d6">kaldi::nnet3::RestrictedAttentionComponent::output_context_</a></div><div class="ttdeci">bool output_context_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00291">nnet-attention-component.h:291</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_1_1attention_html_a4dba6c0cd0571bfe5b1434b30e7d7bdf"><div class="ttname"><a href="namespacekaldi_1_1nnet3_1_1attention.html#a4dba6c0cd0571bfe5b1434b30e7d7bdf">kaldi::nnet3::attention::AttentionForward</a></div><div class="ttdeci">void AttentionForward(BaseFloat key_scale, const CuMatrixBase&lt; BaseFloat &gt; &amp;keys, const CuMatrixBase&lt; BaseFloat &gt; &amp;queries, const CuMatrixBase&lt; BaseFloat &gt; &amp;values, CuMatrixBase&lt; BaseFloat &gt; *c, CuMatrixBase&lt; BaseFloat &gt; *output)</div><div class="ttdoc">This is a higher-level interface to the attention code. </div><div class="ttdef"><b>Definition:</b> <a href="attention_8cc_source.html#l00097">attention.cc:97</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a4a638e2d2a390900749819b63b06cba8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">kaldi::nnet3::RestrictedAttentionComponent::key_dim_</a></div><div class="ttdeci">int32 key_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00282">nnet-attention-component.h:282</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8fb0e7f13f5d151b88cf0af7a28e6817"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">kaldi::nnet3::RestrictedAttentionComponent::value_dim_</a></div><div class="ttdeci">int32 value_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00283">nnet-attention-component.h:283</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8f2ba24a43264b8812e3e1e83878a59c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">kaldi::nnet3::RestrictedAttentionComponent::context_dim_</a></div><div class="ttdeci">int32 context_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00287">nnet-attention-component.h:287</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4a16a6da3a5108ec53e759722a51fd47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a16a6da3a5108ec53e759722a51fd47">&#9670;&nbsp;</a></span>Properties()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual int32 Properties </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return bitmask of the component's properties. </p>
<p>These properties depend only on the component's type. See enum ComponentProperties. </p>

<p>Implements <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">Component</a>.</p>

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8h_source.html#l00131">131</a> of file <a class="el" href="nnet-attention-component_8h_source.html">nnet-attention-component.h</a>.</p>

<p class="reference">References <a class="el" href="nnet-attention-component_8cc_source.html#l00261">RestrictedAttentionComponent::Add()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00292">RestrictedAttentionComponent::Backprop()</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00061">kaldi::nnet3::kBackpropAdds</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00065">kaldi::nnet3::kBackpropNeedsInput</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00053">kaldi::nnet3::kPropagateAdds</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00058">kaldi::nnet3::kReordersIndexes</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00071">kaldi::nnet3::kStoresStats</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00079">kaldi::nnet3::kUsesMemo</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00132">RestrictedAttentionComponent::Propagate()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00472">RestrictedAttentionComponent::Read()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00255">RestrictedAttentionComponent::Scale()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00200">RestrictedAttentionComponent::StoreStats()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00441">RestrictedAttentionComponent::Write()</a>, and <a class="el" href="nnet-attention-component_8cc_source.html#l00249">RestrictedAttentionComponent::ZeroStats()</a>.</p>
<div class="fragment"><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                   {</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a6c12dbc12f9d02024f66b4b0d160ee67">kReordersIndexes</a>|<a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3adac6588b2ef2e8b52936718cf97263e7">kBackpropNeedsInput</a>|<a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a5180ca55eb0162c68740d51295d056c7">kPropagateAdds</a>|<a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3acda3bbc91bd09631b18fdc57376c2b90">kBackpropAdds</a>|</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3affff5abfeafd5643bee15f1daafe6827">kStoresStats</a>|<a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a1713e609229066c956d4c7d544c69658">kUsesMemo</a>;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  }</div><div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a1713e609229066c956d4c7d544c69658"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a1713e609229066c956d4c7d544c69658">kaldi::nnet3::kUsesMemo</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00079">nnet-component-itf.h:79</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3affff5abfeafd5643bee15f1daafe6827"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3affff5abfeafd5643bee15f1daafe6827">kaldi::nnet3::kStoresStats</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00071">nnet-component-itf.h:71</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3adac6588b2ef2e8b52936718cf97263e7"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3adac6588b2ef2e8b52936718cf97263e7">kaldi::nnet3::kBackpropNeedsInput</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00065">nnet-component-itf.h:65</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a5180ca55eb0162c68740d51295d056c7"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a5180ca55eb0162c68740d51295d056c7">kaldi::nnet3::kPropagateAdds</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00053">nnet-component-itf.h:53</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a6c12dbc12f9d02024f66b4b0d160ee67"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a6c12dbc12f9d02024f66b4b0d160ee67">kaldi::nnet3::kReordersIndexes</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00058">nnet-component-itf.h:58</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3acda3bbc91bd09631b18fdc57376c2b90"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3acda3bbc91bd09631b18fdc57376c2b90">kaldi::nnet3::kBackpropAdds</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00061">nnet-component-itf.h:61</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8e7d2790fc7e94fe9780ccc937de1270"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e7d2790fc7e94fe9780ccc937de1270">&#9670;&nbsp;</a></span>Read()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Read </td>
          <td>(</td>
          <td class="paramtype">std::istream &amp;&#160;</td>
          <td class="paramname"><em>is</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>binary</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read function (used after we know the type of the <a class="el" href="classkaldi_1_1nnet3_1_1Component.html" title="Abstract base-class for neural-net components. ">Component</a>); accepts input that is missing the token that describes the component type, in case it has already been consumed. </p>

<p>Implements <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a5d1c1c5364c25160bfef9dda52480cf5">Component</a>.</p>

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8cc_source.html#l00472">472</a> of file <a class="el" href="nnet-attention-component_8cc_source.html">nnet-attention-component.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-attention-component_8h_source.html#l00287">RestrictedAttentionComponent::context_dim_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00295">RestrictedAttentionComponent::entropy_stats_</a>, <a class="el" href="nnet-parse_8cc_source.html#l00224">kaldi::nnet3::ExpectOneOrTwoTokens()</a>, <a class="el" href="nnet-descriptor_8cc_source.html#l00045">kaldi::nnet3::ExpectToken()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00282">RestrictedAttentionComponent::key_dim_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00292">RestrictedAttentionComponent::key_scale_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00281">RestrictedAttentionComponent::num_heads_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00284">RestrictedAttentionComponent::num_left_inputs_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00289">RestrictedAttentionComponent::num_left_inputs_required_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00285">RestrictedAttentionComponent::num_right_inputs_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00290">RestrictedAttentionComponent::num_right_inputs_required_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00291">RestrictedAttentionComponent::output_context_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00298">RestrictedAttentionComponent::posterior_stats_</a>, <a class="el" href="kaldi-vector_8cc_source.html#l01108">Vector&lt; Real &gt;::Read()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00461">CuMatrix&lt; Real &gt;::Read()</a>, <a class="el" href="io-funcs-inl_8h_source.html#l00055">kaldi::ReadBasicType()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00294">RestrictedAttentionComponent::stats_count_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00286">RestrictedAttentionComponent::time_stride_</a>, and <a class="el" href="nnet-attention-component_8h_source.html#l00283">RestrictedAttentionComponent::value_dim_</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8h_source.html#l00131">RestrictedAttentionComponent::Properties()</a>.</p>
<div class="fragment"><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                                                                   {</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#ac9d34dcbb48b22bb0c34f699721b33bc">ExpectOneOrTwoTokens</a>(is, binary, <span class="stringliteral">&quot;&lt;RestrictedAttentionComponent&gt;&quot;</span>,</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                       <span class="stringliteral">&quot;&lt;NumHeads&gt;&quot;</span>);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, binary, &amp;<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">num_heads_</a>);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a41114607233f11aab89539abf08cf922">ExpectToken</a>(is, binary, <span class="stringliteral">&quot;&lt;KeyDim&gt;&quot;</span>);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, binary, &amp;<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a>);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a41114607233f11aab89539abf08cf922">ExpectToken</a>(is, binary, <span class="stringliteral">&quot;&lt;ValueDim&gt;&quot;</span>);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, binary, &amp;<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a>);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a41114607233f11aab89539abf08cf922">ExpectToken</a>(is, binary, <span class="stringliteral">&quot;&lt;NumLeftInputs&gt;&quot;</span>);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, binary, &amp;<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">num_left_inputs_</a>);</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a41114607233f11aab89539abf08cf922">ExpectToken</a>(is, binary, <span class="stringliteral">&quot;&lt;NumRightInputs&gt;&quot;</span>);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, binary, &amp;<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">num_right_inputs_</a>);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a41114607233f11aab89539abf08cf922">ExpectToken</a>(is, binary, <span class="stringliteral">&quot;&lt;TimeStride&gt;&quot;</span>);</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, binary, &amp;<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">time_stride_</a>);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a41114607233f11aab89539abf08cf922">ExpectToken</a>(is, binary, <span class="stringliteral">&quot;&lt;NumLeftInputsRequired&gt;&quot;</span>);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, binary, &amp;<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a0e898f815954c8234cc4c17527168eb9">num_left_inputs_required_</a>);</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a41114607233f11aab89539abf08cf922">ExpectToken</a>(is, binary, <span class="stringliteral">&quot;&lt;NumRightInputsRequired&gt;&quot;</span>);</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, binary, &amp;<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2d9705afdedc78fc1e64957f976085d0">num_right_inputs_required_</a>);</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a41114607233f11aab89539abf08cf922">ExpectToken</a>(is, binary, <span class="stringliteral">&quot;&lt;OutputContext&gt;&quot;</span>);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, binary, &amp;<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac81e565312ceebb6467353ca015ea7d6">output_context_</a>);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a41114607233f11aab89539abf08cf922">ExpectToken</a>(is, binary, <span class="stringliteral">&quot;&lt;KeyScale&gt;&quot;</span>);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, binary, &amp;<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acee63c613b77d9037649008e094ad585">key_scale_</a>);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a41114607233f11aab89539abf08cf922">ExpectToken</a>(is, binary, <span class="stringliteral">&quot;&lt;StatsCount&gt;&quot;</span>);</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, binary, &amp;<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">stats_count_</a>);</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a41114607233f11aab89539abf08cf922">ExpectToken</a>(is, binary, <span class="stringliteral">&quot;&lt;EntropyStats&gt;&quot;</span>);</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40a34aecd5f5f9754cf84d41be5375c0">entropy_stats_</a>.<a class="code" href="classkaldi_1_1Vector.html#aee763dab434f2d24c20edf16dada3abc">Read</a>(is, binary);</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a41114607233f11aab89539abf08cf922">ExpectToken</a>(is, binary, <span class="stringliteral">&quot;&lt;PosteriorStats&gt;&quot;</span>);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1cfb68dbd140132e24fa5ede76562e45">posterior_stats_</a>.<a class="code" href="classkaldi_1_1CuMatrix.html#a8e7d2790fc7e94fe9780ccc937de1270">Read</a>(is, binary);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a41114607233f11aab89539abf08cf922">ExpectToken</a>(is, binary, <span class="stringliteral">&quot;&lt;/RestrictedAttentionComponent&gt;&quot;</span>);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a> = <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">num_left_inputs_</a> + 1 + <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">num_right_inputs_</a>;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_acee63c613b77d9037649008e094ad585"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acee63c613b77d9037649008e094ad585">kaldi::nnet3::RestrictedAttentionComponent::key_scale_</a></div><div class="ttdeci">BaseFloat key_scale_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00292">nnet-attention-component.h:292</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a43d674ac6ba436481c1c4672fd1bea77"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">kaldi::nnet3::RestrictedAttentionComponent::time_stride_</a></div><div class="ttdeci">int32 time_stride_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00286">nnet-attention-component.h:286</a></div></div>
<div class="ttc" id="group__io__funcs__basic_html_ga1bd1af0ef712b76f2332febcec8d095a"><div class="ttname"><a href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">kaldi::ReadBasicType</a></div><div class="ttdeci">void ReadBasicType(std::istream &amp;is, bool binary, T *t)</div><div class="ttdoc">ReadBasicType is the name of the read function for bool, integer types, and floating-point types...</div><div class="ttdef"><b>Definition:</b> <a href="io-funcs-inl_8h_source.html#l00055">io-funcs-inl.h:55</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a0e898f815954c8234cc4c17527168eb9"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a0e898f815954c8234cc4c17527168eb9">kaldi::nnet3::RestrictedAttentionComponent::num_left_inputs_required_</a></div><div class="ttdeci">int32 num_left_inputs_required_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00289">nnet-attention-component.h:289</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ac9d34dcbb48b22bb0c34f699721b33bc"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ac9d34dcbb48b22bb0c34f699721b33bc">kaldi::nnet3::ExpectOneOrTwoTokens</a></div><div class="ttdeci">void ExpectOneOrTwoTokens(std::istream &amp;is, bool binary, const std::string &amp;token1, const std::string &amp;token2)</div><div class="ttdoc">This function is like ExpectToken but for two tokens, and it will either accept token1 and then token...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-parse_8cc_source.html#l00224">nnet-parse.cc:224</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_ac81e565312ceebb6467353ca015ea7d6"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac81e565312ceebb6467353ca015ea7d6">kaldi::nnet3::RestrictedAttentionComponent::output_context_</a></div><div class="ttdeci">bool output_context_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00291">nnet-attention-component.h:291</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a2d9705afdedc78fc1e64957f976085d0"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2d9705afdedc78fc1e64957f976085d0">kaldi::nnet3::RestrictedAttentionComponent::num_right_inputs_required_</a></div><div class="ttdeci">int32 num_right_inputs_required_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00290">nnet-attention-component.h:290</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a1cfb68dbd140132e24fa5ede76562e45"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1cfb68dbd140132e24fa5ede76562e45">kaldi::nnet3::RestrictedAttentionComponent::posterior_stats_</a></div><div class="ttdeci">CuMatrix&lt; double &gt; posterior_stats_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00298">nnet-attention-component.h:298</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a40571f26e91bce91b89f63840291c8ce"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">kaldi::nnet3::RestrictedAttentionComponent::num_right_inputs_</a></div><div class="ttdeci">int32 num_right_inputs_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00285">nnet-attention-component.h:285</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a40a34aecd5f5f9754cf84d41be5375c0"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40a34aecd5f5f9754cf84d41be5375c0">kaldi::nnet3::RestrictedAttentionComponent::entropy_stats_</a></div><div class="ttdeci">Vector&lt; double &gt; entropy_stats_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00295">nnet-attention-component.h:295</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a4a638e2d2a390900749819b63b06cba8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">kaldi::nnet3::RestrictedAttentionComponent::key_dim_</a></div><div class="ttdeci">int32 key_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00282">nnet-attention-component.h:282</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a41114607233f11aab89539abf08cf922"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a41114607233f11aab89539abf08cf922">kaldi::nnet3::ExpectToken</a></div><div class="ttdeci">static void ExpectToken(const std::string &amp;token, const std::string &amp;what_we_are_parsing, const std::string **next_token)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor_8cc_source.html#l00045">nnet-descriptor.cc:45</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a17d0f37c99e964fc99274cf984f383e8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">kaldi::nnet3::RestrictedAttentionComponent::stats_count_</a></div><div class="ttdeci">double stats_count_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00294">nnet-attention-component.h:294</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8fb0e7f13f5d151b88cf0af7a28e6817"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">kaldi::nnet3::RestrictedAttentionComponent::value_dim_</a></div><div class="ttdeci">int32 value_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00283">nnet-attention-component.h:283</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8f2ba24a43264b8812e3e1e83878a59c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">kaldi::nnet3::RestrictedAttentionComponent::context_dim_</a></div><div class="ttdeci">int32 context_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00287">nnet-attention-component.h:287</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrix_html_a8e7d2790fc7e94fe9780ccc937de1270"><div class="ttname"><a href="classkaldi_1_1CuMatrix.html#a8e7d2790fc7e94fe9780ccc937de1270">kaldi::CuMatrix::Read</a></div><div class="ttdeci">void Read(std::istream &amp;is, bool binary)</div><div class="ttdoc">I/O functions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l00461">cu-matrix.cc:461</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_ae53cc4977f9fbe6523374aaf5ba10c80"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">kaldi::nnet3::RestrictedAttentionComponent::num_heads_</a></div><div class="ttdeci">int32 num_heads_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00281">nnet-attention-component.h:281</a></div></div>
<div class="ttc" id="classkaldi_1_1Vector_html_aee763dab434f2d24c20edf16dada3abc"><div class="ttname"><a href="classkaldi_1_1Vector.html#aee763dab434f2d24c20edf16dada3abc">kaldi::Vector::Read</a></div><div class="ttdeci">void Read(std::istream &amp;in, bool binary, bool add=false)</div><div class="ttdoc">Read function using C++ streams. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l01108">kaldi-vector.cc:1108</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a4d7e5406fed09929350deb26767f25aa"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">kaldi::nnet3::RestrictedAttentionComponent::num_left_inputs_</a></div><div class="ttdeci">int32 num_left_inputs_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00284">nnet-attention-component.h:284</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2133bab2e5e5e64e8136a341971f2012"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2133bab2e5e5e64e8136a341971f2012">&#9670;&nbsp;</a></span>ReorderIndexes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ReorderIndexes </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; *&#160;</td>
          <td class="paramname"><em>input_indexes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; *&#160;</td>
          <td class="paramname"><em>output_indexes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function only does something interesting for non-simple Components. </p>
<p>It provides an opportunity for a <a class="el" href="classkaldi_1_1nnet3_1_1Component.html" title="Abstract base-class for neural-net components. ">Component</a> to reorder the or pad the indexes at its input and output. This might be useful, for instance, if a component requires a particular ordering of the indexes that doesn't correspond to their natural ordering. Components that might modify the indexes are required to return the kReordersIndexes flag in their <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a16a6da3a5108ec53e759722a51fd47" title="Return bitmask of the component&#39;s properties. ">Properties()</a>. The <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2133bab2e5e5e64e8136a341971f2012" title="This function only does something interesting for non-simple Components. ">ReorderIndexes()</a> function is now allowed to insert blanks into the indexes. The 'blanks' must be of the form (n,kNoTime,x), where the marker kNoTime (a very negative number) is there where the 't' indexes normally live. The reason we don't just have, say, (-1,-1,-1), relates to the need to preserve a regular pattern over the 'n' indexes so that 'shortcut compilation' (c.f. <a class="el" href="namespacekaldi_1_1nnet3.html#af8007bfceb176a3f8f7f3efb765c9062" title="This function is used in &#39;shortcut&#39; compilation to expand a computation that has been compiled for ex...">ExpandComputation()</a>) can work correctly</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Indexes</td><td>at the input of the <a class="el" href="classkaldi_1_1nnet3_1_1Component.html" title="Abstract base-class for neural-net components. ">Component</a>. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Indexes</td><td>at the output of the <a class="el" href="classkaldi_1_1nnet3_1_1Component.html" title="Abstract base-class for neural-net components. ">Component</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a92fc16eadbf5faafb1aeb4b90614d691">Component</a>.</p>

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8cc_source.html#l00375">375</a> of file <a class="el" href="nnet-attention-component_8cc_source.html">nnet-attention-component.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-attention-component_8cc_source.html#l00388">RestrictedAttentionComponent::GetComputationStructure()</a>, and <a class="el" href="nnet-attention-component_8cc_source.html#l00596">RestrictedAttentionComponent::GetIndexes()</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8h_source.html#l00158">RestrictedAttentionComponent::DeleteMemo()</a>.</p>
<div class="fragment"><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                                            {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keyword">using namespace </span>time_height_convolution;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  ConvolutionComputationIo io;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a38367562a48aa99e77d5d2f6eded46c1">GetComputationStructure</a>(*input_indexes, *output_indexes, &amp;io);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  std::vector&lt;Index&gt; new_input_indexes, new_output_indexes;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#afc71d7740bea7e0050f7ece2f3d575eb">GetIndexes</a>(*input_indexes, *output_indexes, io,</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;             &amp;new_input_indexes, &amp;new_output_indexes);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  input_indexes-&gt;swap(new_input_indexes);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  output_indexes-&gt;swap(new_output_indexes);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_afc71d7740bea7e0050f7ece2f3d575eb"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#afc71d7740bea7e0050f7ece2f3d575eb">kaldi::nnet3::RestrictedAttentionComponent::GetIndexes</a></div><div class="ttdeci">void GetIndexes(const std::vector&lt; Index &gt; &amp;input_indexes, const std::vector&lt; Index &gt; &amp;output_indexes, time_height_convolution::ConvolutionComputationIo &amp;io, std::vector&lt; Index &gt; *new_input_indexes, std::vector&lt; Index &gt; *new_output_indexes) const</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00596">nnet-attention-component.cc:596</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a38367562a48aa99e77d5d2f6eded46c1"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a38367562a48aa99e77d5d2f6eded46c1">kaldi::nnet3::RestrictedAttentionComponent::GetComputationStructure</a></div><div class="ttdeci">void GetComputationStructure(const std::vector&lt; Index &gt; &amp;input_indexes, const std::vector&lt; Index &gt; &amp;output_indexes, time_height_convolution::ConvolutionComputationIo *io) const</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8cc_source.html#l00388">nnet-attention-component.cc:388</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5a4fc4a0524ae8957baf45b8cb168843"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a4fc4a0524ae8957baf45b8cb168843">&#9670;&nbsp;</a></span>Scale()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Scale </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a>&#160;</td>
          <td class="paramname"><em>scale</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This virtual function when called on &ndash; an <a class="el" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html" title="Class UpdatableComponent is a Component which has trainable parameters; it extends the interface of C...">UpdatableComponent</a> scales the parameters by "scale" when called by an <a class="el" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html" title="Class UpdatableComponent is a Component which has trainable parameters; it extends the interface of C...">UpdatableComponent</a>. </p>
<p>&ndash; a Nonlinear component (or another component that stores stats, like <a class="el" href="classkaldi_1_1nnet3_1_1BatchNormComponent.html">BatchNormComponent</a>)&ndash; it relates to scaling activation stats, not parameters. Otherwise it will normally do nothing. </p>

<p>Reimplemented from <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a750ca3e44a00898afea53b54697226ba">Component</a>.</p>

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8cc_source.html#l00255">255</a> of file <a class="el" href="nnet-attention-component_8cc_source.html">nnet-attention-component.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-attention-component_8h_source.html#l00295">RestrictedAttentionComponent::entropy_stats_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00298">RestrictedAttentionComponent::posterior_stats_</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00962">VectorBase&lt; Real &gt;::Scale()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00610">CuMatrixBase&lt; Real &gt;::Scale()</a>, and <a class="el" href="nnet-attention-component_8h_source.html#l00294">RestrictedAttentionComponent::stats_count_</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8h_source.html#l00131">RestrictedAttentionComponent::Properties()</a>.</p>
<div class="fragment"><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                                                        {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40a34aecd5f5f9754cf84d41be5375c0">entropy_stats_</a>.<a class="code" href="classkaldi_1_1VectorBase.html#a3de2c6ff761b6879aae381fcfdfa36e6">Scale</a>(scale);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1cfb68dbd140132e24fa5ede76562e45">posterior_stats_</a>.<a class="code" href="classkaldi_1_1CuMatrixBase.html#ac54802d75d4c9025310b579e3fcea00c">Scale</a>(scale);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">stats_count_</a> *= scale;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a1cfb68dbd140132e24fa5ede76562e45"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1cfb68dbd140132e24fa5ede76562e45">kaldi::nnet3::RestrictedAttentionComponent::posterior_stats_</a></div><div class="ttdeci">CuMatrix&lt; double &gt; posterior_stats_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00298">nnet-attention-component.h:298</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a40a34aecd5f5f9754cf84d41be5375c0"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40a34aecd5f5f9754cf84d41be5375c0">kaldi::nnet3::RestrictedAttentionComponent::entropy_stats_</a></div><div class="ttdeci">Vector&lt; double &gt; entropy_stats_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00295">nnet-attention-component.h:295</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ac54802d75d4c9025310b579e3fcea00c"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ac54802d75d4c9025310b579e3fcea00c">kaldi::CuMatrixBase::Scale</a></div><div class="ttdeci">void Scale(Real value)</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l00610">cu-matrix.cc:610</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a17d0f37c99e964fc99274cf984f383e8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">kaldi::nnet3::RestrictedAttentionComponent::stats_count_</a></div><div class="ttdeci">double stats_count_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00294">nnet-attention-component.h:294</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_a3de2c6ff761b6879aae381fcfdfa36e6"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#a3de2c6ff761b6879aae381fcfdfa36e6">kaldi::VectorBase::Scale</a></div><div class="ttdeci">void Scale(Real alpha)</div><div class="ttdoc">Multiplies all elements by this constant. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l00962">kaldi-vector.cc:962</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acd6c79cbaf8c63ca2e31105dd55bb4ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd6c79cbaf8c63ca2e31105dd55bb4ab">&#9670;&nbsp;</a></span>StoreStats()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void StoreStats </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>in_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>out_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>memo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function may store stats on average activation values, and for some component types, the average value of the derivative of the nonlinearity. </p>
<p>It only does something for those components that have nonzero <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a16a6da3a5108ec53e759722a51fd47" title="Return bitmask of the component&#39;s properties. ">Properties()</a>&amp;kStoresStats.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">in_value</td><td>The input to the <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f1f1b05a170bd81a544caefe1acb040" title="Propagate function. ">Propagate()</a> function. Note: if the component sets the flag kPropagateInPlace, this should not be used; the empty matrix will be provided here if in-place propagation was used. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">out_value</td><td>The output of the <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f1f1b05a170bd81a544caefe1acb040" title="Propagate function. ">Propagate()</a> function. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">memo</td><td>The 'memo' returned by the <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f1f1b05a170bd81a544caefe1acb040" title="Propagate function. ">Propagate()</a> function; this will usually be NULL. </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a304cec15e1a696a5af5f2f5daae7bc4f">Component</a>.</p>

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8cc_source.html#l00200">200</a> of file <a class="el" href="nnet-attention-component_8cc_source.html">nnet-attention-component.cc</a>.</p>

<p class="reference">References <a class="el" href="cu-vector_8cc_source.html#l00583">CuVectorBase&lt; Real &gt;::AddDiagMatMat()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00941">CuMatrixBase&lt; Real &gt;::AddMat()</a>, <a class="el" href="cu-vector_8cc_source.html#l01242">CuVectorBase&lt; Real &gt;::AddRowSumMat()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l01043">VectorBase&lt; Real &gt;::AddVec()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02554">CuMatrixBase&lt; Real &gt;::ApplyFloor()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00632">CuMatrixBase&lt; Real &gt;::ApplyLog()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00208">RestrictedAttentionComponent::Memo::c</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00287">RestrictedAttentionComponent::context_dim_</a>, <a class="el" href="cu-vector_8h_source.html#l00071">CuVectorBase&lt; Real &gt;::Data()</a>, <a class="el" href="kaldi-vector_8h_source.html#l00063">VectorBase&lt; Real &gt;::Dim()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00295">RestrictedAttentionComponent::entropy_stats_</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="matrix-common_8h_source.html#l00034">kaldi::kNoTrans</a>, <a class="el" href="matrix-common_8h_source.html#l00033">kaldi::kTrans</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00281">RestrictedAttentionComponent::num_heads_</a>, <a class="el" href="cu-matrix_8h_source.html#l00215">CuMatrixBase&lt; Real &gt;::NumCols()</a>, <a class="el" href="cu-matrix_8h_source.html#l00214">CuMatrixBase&lt; Real &gt;::NumRows()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00298">RestrictedAttentionComponent::posterior_stats_</a>, <a class="el" href="kaldi-math_8cc_source.html#l00094">kaldi::RandInt()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00190">Vector&lt; Real &gt;::Resize()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00049">CuMatrix&lt; Real &gt;::Resize()</a>, and <a class="el" href="nnet-attention-component_8h_source.html#l00294">RestrictedAttentionComponent::stats_count_</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8h_source.html#l00131">RestrictedAttentionComponent::Properties()</a>.</p>
<div class="fragment"><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                   {</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keyword">const</span> Memo *memo = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span>Memo*<span class="keyword">&gt;</span>(memo_in);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(memo != NULL);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40a34aecd5f5f9754cf84d41be5375c0">entropy_stats_</a>.<a class="code" href="classkaldi_1_1VectorBase.html#af3d58f15749a15d89b0ec5819dd7b7f2">Dim</a>() != <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">num_heads_</a>) {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40a34aecd5f5f9754cf84d41be5375c0">entropy_stats_</a>.<a class="code" href="classkaldi_1_1Vector.html#ae98e624cca1982e866ff195131ed4427">Resize</a>(<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">num_heads_</a>);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1cfb68dbd140132e24fa5ede76562e45">posterior_stats_</a>.<a class="code" href="classkaldi_1_1CuMatrix.html#af7e3e65772a6eb29e22069822a0fb441">Resize</a>(<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">num_heads_</a>, <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a>);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">stats_count_</a> = 0.0;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  }</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keyword">const</span> CuMatrix&lt;BaseFloat&gt; &amp;c = memo-&gt;c;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 2) == 0)</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">return</span>;  <span class="comment">// only actually store the stats for one in three minibatches, to</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;             <span class="comment">// save time.</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  { <span class="comment">// first get the posterior stats.</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    CuVector&lt;BaseFloat&gt; c_sum(<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">num_heads_</a> * <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a>);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    c_sum.AddRowSumMat(1.0, c, 0.0);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="comment">// view the vector as a matrix.</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    CuSubMatrix&lt;BaseFloat&gt; c_sum_as_mat(c_sum.Data(), <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">num_heads_</a>,</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                        <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a>, <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a>);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    CuMatrix&lt;double&gt; c_sum_as_mat_dbl(c_sum_as_mat);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1cfb68dbd140132e24fa5ede76562e45">posterior_stats_</a>.<a class="code" href="classkaldi_1_1CuMatrixBase.html#a4bce9eaec860cf9d9a8aee7e440b976b">AddMat</a>(1.0, c_sum_as_mat_dbl);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(c.NumCols() == <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">num_heads_</a> * <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a>);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  { <span class="comment">// now get the entropy stats.</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    CuMatrix&lt;BaseFloat&gt; log_c(c);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    log_c.ApplyFloor(1.0e-20);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    log_c.ApplyLog();</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    CuVector&lt;BaseFloat&gt; dot_prod(<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">num_heads_</a> * context_dim_);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    dot_prod.AddDiagMatMat(-1.0, c, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>, log_c, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, 0.0);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">// dot_prod is the sum over the matrix&#39;s rows (which correspond</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">// to heads, and context positions), of - c * log(c), which is</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">// part of the entropy.  To get the actual contribution to the</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="comment">// entropy, we have to sum &#39;dot_prod&#39; over blocks of</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">// size &#39;context_dim_&#39;; that gives us the entropy contribution</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="comment">// per head.  We&#39;d have to divide by c.NumRows() to get the</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">// actual entropy, but that&#39;s reflected in stats_count_.</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    CuSubMatrix&lt;BaseFloat&gt; entropy_mat(dot_prod.Data(), <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">num_heads_</a>,</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                                       <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a>, <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">context_dim_</a>);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    CuVector&lt;BaseFloat&gt; entropy_vec(<a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">num_heads_</a>);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    entropy_vec.AddColSumMat(1.0, entropy_mat);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    Vector&lt;double&gt; entropy_vec_dbl(entropy_vec);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40a34aecd5f5f9754cf84d41be5375c0">entropy_stats_</a>.<a class="code" href="classkaldi_1_1VectorBase.html#ab109eed73378866c0e8747379378ca44">AddVec</a>(1.0, entropy_vec_dbl);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  }</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">stats_count_</a> += c.NumRows();</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a4bce9eaec860cf9d9a8aee7e440b976b"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a4bce9eaec860cf9d9a8aee7e440b976b">kaldi::CuMatrixBase::AddMat</a></div><div class="ttdeci">void AddMat(Real alpha, const CuMatrixBase&lt; Real &gt; &amp;A, MatrixTransposeType trans=kNoTrans)</div><div class="ttdoc">*this += alpha * A </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l00941">cu-matrix.cc:941</a></div></div>
<div class="ttc" id="classkaldi_1_1Vector_html_ae98e624cca1982e866ff195131ed4427"><div class="ttname"><a href="classkaldi_1_1Vector.html#ae98e624cca1982e866ff195131ed4427">kaldi::Vector::Resize</a></div><div class="ttdeci">void Resize(MatrixIndexT length, MatrixResizeType resize_type=kSetZero)</div><div class="ttdoc">Set vector to a specified size (can be zero). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l00190">kaldi-vector.cc:190</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a1cfb68dbd140132e24fa5ede76562e45"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1cfb68dbd140132e24fa5ede76562e45">kaldi::nnet3::RestrictedAttentionComponent::posterior_stats_</a></div><div class="ttdeci">CuMatrix&lt; double &gt; posterior_stats_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00298">nnet-attention-component.h:298</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a40a34aecd5f5f9754cf84d41be5375c0"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40a34aecd5f5f9754cf84d41be5375c0">kaldi::nnet3::RestrictedAttentionComponent::entropy_stats_</a></div><div class="ttdeci">Vector&lt; double &gt; entropy_stats_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00295">nnet-attention-component.h:295</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00033">matrix-common.h:33</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a17d0f37c99e964fc99274cf984f383e8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">kaldi::nnet3::RestrictedAttentionComponent::stats_count_</a></div><div class="ttdeci">double stats_count_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00294">nnet-attention-component.h:294</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00034">matrix-common.h:34</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_af3d58f15749a15d89b0ec5819dd7b7f2"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#af3d58f15749a15d89b0ec5819dd7b7f2">kaldi::VectorBase::Dim</a></div><div class="ttdeci">MatrixIndexT Dim() const</div><div class="ttdoc">Returns the dimension of the vector. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8h_source.html#l00063">kaldi-vector.h:63</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8f2ba24a43264b8812e3e1e83878a59c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8f2ba24a43264b8812e3e1e83878a59c">kaldi::nnet3::RestrictedAttentionComponent::context_dim_</a></div><div class="ttdeci">int32 context_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00287">nnet-attention-component.h:287</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_ae53cc4977f9fbe6523374aaf5ba10c80"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">kaldi::nnet3::RestrictedAttentionComponent::num_heads_</a></div><div class="ttdeci">int32 num_heads_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00281">nnet-attention-component.h:281</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_ab109eed73378866c0e8747379378ca44"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#ab109eed73378866c0e8747379378ca44">kaldi::VectorBase::AddVec</a></div><div class="ttdeci">void AddVec(const Real alpha, const VectorBase&lt; OtherReal &gt; &amp;v)</div><div class="ttdoc">Add vector : *this = *this + alpha * rv (with casting between floats and doubles) ...</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l01043">kaldi-vector.cc:1043</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrix_html_af7e3e65772a6eb29e22069822a0fb441"><div class="ttname"><a href="classkaldi_1_1CuMatrix.html#af7e3e65772a6eb29e22069822a0fb441">kaldi::CuMatrix::Resize</a></div><div class="ttdeci">void Resize(MatrixIndexT rows, MatrixIndexT cols, MatrixResizeType resize_type=kSetZero, MatrixStrideType stride_type=kDefaultStride)</div><div class="ttdoc">Allocate the memory. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l00049">cu-matrix.cc:49</a></div></div>
<div class="ttc" id="namespacekaldi_html_a0361eab3c5ebb78e6be060e6fa78e1a1"><div class="ttname"><a href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">kaldi::RandInt</a></div><div class="ttdeci">int32 RandInt(int32 min_val, int32 max_val, struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00094">kaldi-math.cc:94</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af2d951f58073f362411ee482aa469975"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2d951f58073f362411ee482aa469975">&#9670;&nbsp;</a></span>Type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::string Type </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns a string such as "SigmoidComponent", describing the type of the object. </p>

<p>Implements <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#ab6b6147feb5e0688469b735a6546c222">Component</a>.</p>

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8h_source.html#l00130">130</a> of file <a class="el" href="nnet-attention-component_8h_source.html">nnet-attention-component.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8cc_source.html#l00032">RestrictedAttentionComponent::Info()</a>.</p>
<div class="fragment"><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;{ <span class="keywordflow">return</span> <span class="stringliteral">&quot;RestrictedAttentionComponent&quot;</span>; }</div></div><!-- fragment -->
</div>
</div>
<a id="a68f354fd5f096134162f01719096e6fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68f354fd5f096134162f01719096e6fc">&#9670;&nbsp;</a></span>Write()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Write </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>binary</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write component to stream. </p>

<p>Implements <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a852bc7306aaa45b284f662f1ddb1a3d5">Component</a>.</p>

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8cc_source.html#l00441">441</a> of file <a class="el" href="nnet-attention-component_8cc_source.html">nnet-attention-component.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-attention-component_8h_source.html#l00295">RestrictedAttentionComponent::entropy_stats_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00282">RestrictedAttentionComponent::key_dim_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00292">RestrictedAttentionComponent::key_scale_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00281">RestrictedAttentionComponent::num_heads_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00284">RestrictedAttentionComponent::num_left_inputs_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00289">RestrictedAttentionComponent::num_left_inputs_required_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00285">RestrictedAttentionComponent::num_right_inputs_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00290">RestrictedAttentionComponent::num_right_inputs_required_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00291">RestrictedAttentionComponent::output_context_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00298">RestrictedAttentionComponent::posterior_stats_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00294">RestrictedAttentionComponent::stats_count_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00286">RestrictedAttentionComponent::time_stride_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00283">RestrictedAttentionComponent::value_dim_</a>, <a class="el" href="kaldi-vector_8cc_source.html#l01230">VectorBase&lt; Real &gt;::Write()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00469">CuMatrixBase&lt; Real &gt;::Write()</a>, <a class="el" href="io-funcs-inl_8h_source.html#l00034">kaldi::WriteBasicType()</a>, and <a class="el" href="io-funcs_8cc_source.html#l00134">kaldi::WriteToken()</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8h_source.html#l00131">RestrictedAttentionComponent::Properties()</a>.</p>
<div class="fragment"><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                                                                          {</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;RestrictedAttentionComponent&gt;&quot;</span>);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;NumHeads&gt;&quot;</span>);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">num_heads_</a>);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;KeyDim&gt;&quot;</span>);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">key_dim_</a>);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;ValueDim&gt;&quot;</span>);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">value_dim_</a>);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;NumLeftInputs&gt;&quot;</span>);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">num_left_inputs_</a>);</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;NumRightInputs&gt;&quot;</span>);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">num_right_inputs_</a>);</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;TimeStride&gt;&quot;</span>);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">time_stride_</a>);</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;NumLeftInputsRequired&gt;&quot;</span>);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a0e898f815954c8234cc4c17527168eb9">num_left_inputs_required_</a>);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;NumRightInputsRequired&gt;&quot;</span>);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2d9705afdedc78fc1e64957f976085d0">num_right_inputs_required_</a>);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;OutputContext&gt;&quot;</span>);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac81e565312ceebb6467353ca015ea7d6">output_context_</a>);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;KeyScale&gt;&quot;</span>);</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acee63c613b77d9037649008e094ad585">key_scale_</a>);</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;StatsCount&gt;&quot;</span>);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">stats_count_</a>);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;EntropyStats&gt;&quot;</span>);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40a34aecd5f5f9754cf84d41be5375c0">entropy_stats_</a>.<a class="code" href="classkaldi_1_1VectorBase.html#a6d155f5ee93a39aae545ae4becf6934c">Write</a>(os, binary);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;PosteriorStats&gt;&quot;</span>);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1cfb68dbd140132e24fa5ede76562e45">posterior_stats_</a>.<a class="code" href="classkaldi_1_1CuMatrixBase.html#a68f354fd5f096134162f01719096e6fc">Write</a>(os, binary);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;/RestrictedAttentionComponent&gt;&quot;</span>);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;}</div><div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a68f354fd5f096134162f01719096e6fc"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a68f354fd5f096134162f01719096e6fc">kaldi::CuMatrixBase::Write</a></div><div class="ttdeci">void Write(std::ostream &amp;os, bool binary) const</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l00469">cu-matrix.cc:469</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_acee63c613b77d9037649008e094ad585"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#acee63c613b77d9037649008e094ad585">kaldi::nnet3::RestrictedAttentionComponent::key_scale_</a></div><div class="ttdeci">BaseFloat key_scale_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00292">nnet-attention-component.h:292</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a43d674ac6ba436481c1c4672fd1bea77"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a43d674ac6ba436481c1c4672fd1bea77">kaldi::nnet3::RestrictedAttentionComponent::time_stride_</a></div><div class="ttdeci">int32 time_stride_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00286">nnet-attention-component.h:286</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_a6d155f5ee93a39aae545ae4becf6934c"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#a6d155f5ee93a39aae545ae4becf6934c">kaldi::VectorBase::Write</a></div><div class="ttdeci">void Write(std::ostream &amp;Out, bool binary) const</div><div class="ttdoc">Writes to C++ stream (option to write in binary). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l01230">kaldi-vector.cc:1230</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a0e898f815954c8234cc4c17527168eb9"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a0e898f815954c8234cc4c17527168eb9">kaldi::nnet3::RestrictedAttentionComponent::num_left_inputs_required_</a></div><div class="ttdeci">int32 num_left_inputs_required_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00289">nnet-attention-component.h:289</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_ac81e565312ceebb6467353ca015ea7d6"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ac81e565312ceebb6467353ca015ea7d6">kaldi::nnet3::RestrictedAttentionComponent::output_context_</a></div><div class="ttdeci">bool output_context_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00291">nnet-attention-component.h:291</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a2d9705afdedc78fc1e64957f976085d0"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a2d9705afdedc78fc1e64957f976085d0">kaldi::nnet3::RestrictedAttentionComponent::num_right_inputs_required_</a></div><div class="ttdeci">int32 num_right_inputs_required_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00290">nnet-attention-component.h:290</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a1cfb68dbd140132e24fa5ede76562e45"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1cfb68dbd140132e24fa5ede76562e45">kaldi::nnet3::RestrictedAttentionComponent::posterior_stats_</a></div><div class="ttdeci">CuMatrix&lt; double &gt; posterior_stats_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00298">nnet-attention-component.h:298</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a40571f26e91bce91b89f63840291c8ce"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40571f26e91bce91b89f63840291c8ce">kaldi::nnet3::RestrictedAttentionComponent::num_right_inputs_</a></div><div class="ttdeci">int32 num_right_inputs_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00285">nnet-attention-component.h:285</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a40a34aecd5f5f9754cf84d41be5375c0"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40a34aecd5f5f9754cf84d41be5375c0">kaldi::nnet3::RestrictedAttentionComponent::entropy_stats_</a></div><div class="ttdeci">Vector&lt; double &gt; entropy_stats_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00295">nnet-attention-component.h:295</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a4a638e2d2a390900749819b63b06cba8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4a638e2d2a390900749819b63b06cba8">kaldi::nnet3::RestrictedAttentionComponent::key_dim_</a></div><div class="ttdeci">int32 key_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00282">nnet-attention-component.h:282</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a17d0f37c99e964fc99274cf984f383e8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">kaldi::nnet3::RestrictedAttentionComponent::stats_count_</a></div><div class="ttdeci">double stats_count_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00294">nnet-attention-component.h:294</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a8fb0e7f13f5d151b88cf0af7a28e6817"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a8fb0e7f13f5d151b88cf0af7a28e6817">kaldi::nnet3::RestrictedAttentionComponent::value_dim_</a></div><div class="ttdeci">int32 value_dim_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00283">nnet-attention-component.h:283</a></div></div>
<div class="ttc" id="group__io__funcs__basic_html_ga87f1638ef3c0a3ee117178b202c2d02a"><div class="ttname"><a href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">kaldi::WriteToken</a></div><div class="ttdeci">void WriteToken(std::ostream &amp;os, bool binary, const char *token)</div><div class="ttdoc">The WriteToken functions are for writing nonempty sequences of non-space characters. </div><div class="ttdef"><b>Definition:</b> <a href="io-funcs_8cc_source.html#l00134">io-funcs.cc:134</a></div></div>
<div class="ttc" id="group__io__funcs__basic_html_ga108506a9aabafd9006926aa1b47617da"><div class="ttname"><a href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">kaldi::WriteBasicType</a></div><div class="ttdeci">void WriteBasicType(std::ostream &amp;os, bool binary, T t)</div><div class="ttdoc">WriteBasicType is the name of the write function for bool, integer types, and floating-point types...</div><div class="ttdef"><b>Definition:</b> <a href="io-funcs-inl_8h_source.html#l00034">io-funcs-inl.h:34</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_ae53cc4977f9fbe6523374aaf5ba10c80"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#ae53cc4977f9fbe6523374aaf5ba10c80">kaldi::nnet3::RestrictedAttentionComponent::num_heads_</a></div><div class="ttdeci">int32 num_heads_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00281">nnet-attention-component.h:281</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a4d7e5406fed09929350deb26767f25aa"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a4d7e5406fed09929350deb26767f25aa">kaldi::nnet3::RestrictedAttentionComponent::num_left_inputs_</a></div><div class="ttdeci">int32 num_left_inputs_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00284">nnet-attention-component.h:284</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abfee972431c5488d69a56fc1114c7cdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfee972431c5488d69a56fc1114c7cdc">&#9670;&nbsp;</a></span>ZeroStats()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ZeroStats </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Components that provide an implementation of StoreStats should also provide an implementation of <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#abfee972431c5488d69a56fc1114c7cdc" title="Components that provide an implementation of StoreStats should also provide an implementation of Zero...">ZeroStats()</a>, to set those stats to zero. </p>
<p>Other components that store other types of statistics (e.g. regarding gradient clipping) should implement <a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#abfee972431c5488d69a56fc1114c7cdc" title="Components that provide an implementation of StoreStats should also provide an implementation of Zero...">ZeroStats()</a> also. </p>

<p>Reimplemented from <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#ab162a2631e5335091d1f2bba1571e54d">Component</a>.</p>

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8cc_source.html#l00249">249</a> of file <a class="el" href="nnet-attention-component_8cc_source.html">nnet-attention-component.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-attention-component_8h_source.html#l00295">RestrictedAttentionComponent::entropy_stats_</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00298">RestrictedAttentionComponent::posterior_stats_</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00288">VectorBase&lt; Real &gt;::SetZero()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00476">CuMatrixBase&lt; Real &gt;::SetZero()</a>, and <a class="el" href="nnet-attention-component_8h_source.html#l00294">RestrictedAttentionComponent::stats_count_</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8h_source.html#l00131">RestrictedAttentionComponent::Properties()</a>.</p>
<div class="fragment"><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                                             {</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40a34aecd5f5f9754cf84d41be5375c0">entropy_stats_</a>.<a class="code" href="classkaldi_1_1VectorBase.html#ae57e5aca5db002545e4b9335c8d9dbfa">SetZero</a>();</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1cfb68dbd140132e24fa5ede76562e45">posterior_stats_</a>.<a class="code" href="classkaldi_1_1CuMatrixBase.html#ae57e5aca5db002545e4b9335c8d9dbfa">SetZero</a>();</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">stats_count_</a> = 0.0;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a1cfb68dbd140132e24fa5ede76562e45"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a1cfb68dbd140132e24fa5ede76562e45">kaldi::nnet3::RestrictedAttentionComponent::posterior_stats_</a></div><div class="ttdeci">CuMatrix&lt; double &gt; posterior_stats_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00298">nnet-attention-component.h:298</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a40a34aecd5f5f9754cf84d41be5375c0"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a40a34aecd5f5f9754cf84d41be5375c0">kaldi::nnet3::RestrictedAttentionComponent::entropy_stats_</a></div><div class="ttdeci">Vector&lt; double &gt; entropy_stats_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00295">nnet-attention-component.h:295</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent_html_a17d0f37c99e964fc99274cf984f383e8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html#a17d0f37c99e964fc99274cf984f383e8">kaldi::nnet3::RestrictedAttentionComponent::stats_count_</a></div><div class="ttdeci">double stats_count_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-attention-component_8h_source.html#l00294">nnet-attention-component.h:294</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ae57e5aca5db002545e4b9335c8d9dbfa"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ae57e5aca5db002545e4b9335c8d9dbfa">kaldi::CuMatrixBase::SetZero</a></div><div class="ttdeci">void SetZero()</div><div class="ttdoc">Math operations, some calling kernels. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l00476">cu-matrix.cc:476</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_ae57e5aca5db002545e4b9335c8d9dbfa"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#ae57e5aca5db002545e4b9335c8d9dbfa">kaldi::VectorBase::SetZero</a></div><div class="ttdeci">void SetZero()</div><div class="ttdoc">Set vector to all zeros. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l00288">kaldi-vector.cc:288</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a8f2ba24a43264b8812e3e1e83878a59c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f2ba24a43264b8812e3e1e83878a59c">&#9670;&nbsp;</a></span>context_dim_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 context_dim_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8h_source.html#l00287">287</a> of file <a class="el" href="nnet-attention-component_8h_source.html">nnet-attention-component.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8cc_source.html#l00292">RestrictedAttentionComponent::Backprop()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00334">RestrictedAttentionComponent::BackpropOneHead()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00277">RestrictedAttentionComponent::Check()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00506">RestrictedAttentionComponent::GetInputIndexes()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00032">RestrictedAttentionComponent::Info()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00080">RestrictedAttentionComponent::InitFromConfig()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00115">RestrictedAttentionComponent::InputDim()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00526">RestrictedAttentionComponent::IsComputable()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00121">RestrictedAttentionComponent::OutputDim()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00132">RestrictedAttentionComponent::Propagate()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00160">RestrictedAttentionComponent::PropagateOneHead()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00472">RestrictedAttentionComponent::Read()</a>, and <a class="el" href="nnet-attention-component_8cc_source.html#l00200">RestrictedAttentionComponent::StoreStats()</a>.</p>

</div>
</div>
<a id="a40a34aecd5f5f9754cf84d41be5375c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40a34aecd5f5f9754cf84d41be5375c0">&#9670;&nbsp;</a></span>entropy_stats_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1Vector.html">Vector</a>&lt;double&gt; entropy_stats_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8h_source.html#l00295">295</a> of file <a class="el" href="nnet-attention-component_8h_source.html">nnet-attention-component.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8cc_source.html#l00261">RestrictedAttentionComponent::Add()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00032">RestrictedAttentionComponent::Info()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00472">RestrictedAttentionComponent::Read()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00255">RestrictedAttentionComponent::Scale()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00200">RestrictedAttentionComponent::StoreStats()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00441">RestrictedAttentionComponent::Write()</a>, and <a class="el" href="nnet-attention-component_8cc_source.html#l00249">RestrictedAttentionComponent::ZeroStats()</a>.</p>

</div>
</div>
<a id="a4a638e2d2a390900749819b63b06cba8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a638e2d2a390900749819b63b06cba8">&#9670;&nbsp;</a></span>key_dim_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 key_dim_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8h_source.html#l00282">282</a> of file <a class="el" href="nnet-attention-component_8h_source.html">nnet-attention-component.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8cc_source.html#l00292">RestrictedAttentionComponent::Backprop()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00334">RestrictedAttentionComponent::BackpropOneHead()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00277">RestrictedAttentionComponent::Check()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00032">RestrictedAttentionComponent::Info()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00080">RestrictedAttentionComponent::InitFromConfig()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00115">RestrictedAttentionComponent::InputDim()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00132">RestrictedAttentionComponent::Propagate()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00160">RestrictedAttentionComponent::PropagateOneHead()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00472">RestrictedAttentionComponent::Read()</a>, and <a class="el" href="nnet-attention-component_8cc_source.html#l00441">RestrictedAttentionComponent::Write()</a>.</p>

</div>
</div>
<a id="acee63c613b77d9037649008e094ad585"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acee63c613b77d9037649008e094ad585">&#9670;&nbsp;</a></span>key_scale_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> key_scale_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8h_source.html#l00292">292</a> of file <a class="el" href="nnet-attention-component_8h_source.html">nnet-attention-component.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8cc_source.html#l00334">RestrictedAttentionComponent::BackpropOneHead()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00277">RestrictedAttentionComponent::Check()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00032">RestrictedAttentionComponent::Info()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00080">RestrictedAttentionComponent::InitFromConfig()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00160">RestrictedAttentionComponent::PropagateOneHead()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00472">RestrictedAttentionComponent::Read()</a>, and <a class="el" href="nnet-attention-component_8cc_source.html#l00441">RestrictedAttentionComponent::Write()</a>.</p>

</div>
</div>
<a id="ae53cc4977f9fbe6523374aaf5ba10c80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae53cc4977f9fbe6523374aaf5ba10c80">&#9670;&nbsp;</a></span>num_heads_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 num_heads_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8h_source.html#l00281">281</a> of file <a class="el" href="nnet-attention-component_8h_source.html">nnet-attention-component.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8cc_source.html#l00292">RestrictedAttentionComponent::Backprop()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00277">RestrictedAttentionComponent::Check()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00032">RestrictedAttentionComponent::Info()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00080">RestrictedAttentionComponent::InitFromConfig()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00115">RestrictedAttentionComponent::InputDim()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00121">RestrictedAttentionComponent::OutputDim()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00132">RestrictedAttentionComponent::Propagate()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00472">RestrictedAttentionComponent::Read()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00200">RestrictedAttentionComponent::StoreStats()</a>, and <a class="el" href="nnet-attention-component_8cc_source.html#l00441">RestrictedAttentionComponent::Write()</a>.</p>

</div>
</div>
<a id="a4d7e5406fed09929350deb26767f25aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d7e5406fed09929350deb26767f25aa">&#9670;&nbsp;</a></span>num_left_inputs_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 num_left_inputs_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8h_source.html#l00284">284</a> of file <a class="el" href="nnet-attention-component_8h_source.html">nnet-attention-component.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8cc_source.html#l00277">RestrictedAttentionComponent::Check()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00388">RestrictedAttentionComponent::GetComputationStructure()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00506">RestrictedAttentionComponent::GetInputIndexes()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00032">RestrictedAttentionComponent::Info()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00080">RestrictedAttentionComponent::InitFromConfig()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00526">RestrictedAttentionComponent::IsComputable()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00472">RestrictedAttentionComponent::Read()</a>, and <a class="el" href="nnet-attention-component_8cc_source.html#l00441">RestrictedAttentionComponent::Write()</a>.</p>

</div>
</div>
<a id="a0e898f815954c8234cc4c17527168eb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e898f815954c8234cc4c17527168eb9">&#9670;&nbsp;</a></span>num_left_inputs_required_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 num_left_inputs_required_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8h_source.html#l00289">289</a> of file <a class="el" href="nnet-attention-component_8h_source.html">nnet-attention-component.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8cc_source.html#l00277">RestrictedAttentionComponent::Check()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00388">RestrictedAttentionComponent::GetComputationStructure()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00032">RestrictedAttentionComponent::Info()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00080">RestrictedAttentionComponent::InitFromConfig()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00526">RestrictedAttentionComponent::IsComputable()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00472">RestrictedAttentionComponent::Read()</a>, and <a class="el" href="nnet-attention-component_8cc_source.html#l00441">RestrictedAttentionComponent::Write()</a>.</p>

</div>
</div>
<a id="a40571f26e91bce91b89f63840291c8ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40571f26e91bce91b89f63840291c8ce">&#9670;&nbsp;</a></span>num_right_inputs_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 num_right_inputs_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8h_source.html#l00285">285</a> of file <a class="el" href="nnet-attention-component_8h_source.html">nnet-attention-component.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8cc_source.html#l00277">RestrictedAttentionComponent::Check()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00388">RestrictedAttentionComponent::GetComputationStructure()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00506">RestrictedAttentionComponent::GetInputIndexes()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00032">RestrictedAttentionComponent::Info()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00080">RestrictedAttentionComponent::InitFromConfig()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00526">RestrictedAttentionComponent::IsComputable()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00472">RestrictedAttentionComponent::Read()</a>, and <a class="el" href="nnet-attention-component_8cc_source.html#l00441">RestrictedAttentionComponent::Write()</a>.</p>

</div>
</div>
<a id="a2d9705afdedc78fc1e64957f976085d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d9705afdedc78fc1e64957f976085d0">&#9670;&nbsp;</a></span>num_right_inputs_required_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 num_right_inputs_required_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8h_source.html#l00290">290</a> of file <a class="el" href="nnet-attention-component_8h_source.html">nnet-attention-component.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8cc_source.html#l00277">RestrictedAttentionComponent::Check()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00388">RestrictedAttentionComponent::GetComputationStructure()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00032">RestrictedAttentionComponent::Info()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00080">RestrictedAttentionComponent::InitFromConfig()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00526">RestrictedAttentionComponent::IsComputable()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00472">RestrictedAttentionComponent::Read()</a>, and <a class="el" href="nnet-attention-component_8cc_source.html#l00441">RestrictedAttentionComponent::Write()</a>.</p>

</div>
</div>
<a id="ac81e565312ceebb6467353ca015ea7d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac81e565312ceebb6467353ca015ea7d6">&#9670;&nbsp;</a></span>output_context_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> output_context_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8h_source.html#l00291">291</a> of file <a class="el" href="nnet-attention-component_8h_source.html">nnet-attention-component.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8cc_source.html#l00292">RestrictedAttentionComponent::Backprop()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00334">RestrictedAttentionComponent::BackpropOneHead()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00032">RestrictedAttentionComponent::Info()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00080">RestrictedAttentionComponent::InitFromConfig()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00121">RestrictedAttentionComponent::OutputDim()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00132">RestrictedAttentionComponent::Propagate()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00160">RestrictedAttentionComponent::PropagateOneHead()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00472">RestrictedAttentionComponent::Read()</a>, and <a class="el" href="nnet-attention-component_8cc_source.html#l00441">RestrictedAttentionComponent::Write()</a>.</p>

</div>
</div>
<a id="a1cfb68dbd140132e24fa5ede76562e45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cfb68dbd140132e24fa5ede76562e45">&#9670;&nbsp;</a></span>posterior_stats_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1CuMatrix.html">CuMatrix</a>&lt;double&gt; posterior_stats_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8h_source.html#l00298">298</a> of file <a class="el" href="nnet-attention-component_8h_source.html">nnet-attention-component.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8cc_source.html#l00261">RestrictedAttentionComponent::Add()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00032">RestrictedAttentionComponent::Info()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00472">RestrictedAttentionComponent::Read()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00255">RestrictedAttentionComponent::Scale()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00200">RestrictedAttentionComponent::StoreStats()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00441">RestrictedAttentionComponent::Write()</a>, and <a class="el" href="nnet-attention-component_8cc_source.html#l00249">RestrictedAttentionComponent::ZeroStats()</a>.</p>

</div>
</div>
<a id="a17d0f37c99e964fc99274cf984f383e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17d0f37c99e964fc99274cf984f383e8">&#9670;&nbsp;</a></span>stats_count_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double stats_count_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8h_source.html#l00294">294</a> of file <a class="el" href="nnet-attention-component_8h_source.html">nnet-attention-component.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8cc_source.html#l00261">RestrictedAttentionComponent::Add()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00277">RestrictedAttentionComponent::Check()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00032">RestrictedAttentionComponent::Info()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00080">RestrictedAttentionComponent::InitFromConfig()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00472">RestrictedAttentionComponent::Read()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00255">RestrictedAttentionComponent::Scale()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00200">RestrictedAttentionComponent::StoreStats()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00441">RestrictedAttentionComponent::Write()</a>, and <a class="el" href="nnet-attention-component_8cc_source.html#l00249">RestrictedAttentionComponent::ZeroStats()</a>.</p>

</div>
</div>
<a id="a43d674ac6ba436481c1c4672fd1bea77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43d674ac6ba436481c1c4672fd1bea77">&#9670;&nbsp;</a></span>time_stride_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 time_stride_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8h_source.html#l00286">286</a> of file <a class="el" href="nnet-attention-component_8h_source.html">nnet-attention-component.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8cc_source.html#l00277">RestrictedAttentionComponent::Check()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00388">RestrictedAttentionComponent::GetComputationStructure()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00506">RestrictedAttentionComponent::GetInputIndexes()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00032">RestrictedAttentionComponent::Info()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00080">RestrictedAttentionComponent::InitFromConfig()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00526">RestrictedAttentionComponent::IsComputable()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00472">RestrictedAttentionComponent::Read()</a>, and <a class="el" href="nnet-attention-component_8cc_source.html#l00441">RestrictedAttentionComponent::Write()</a>.</p>

</div>
</div>
<a id="a8fb0e7f13f5d151b88cf0af7a28e6817"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fb0e7f13f5d151b88cf0af7a28e6817">&#9670;&nbsp;</a></span>value_dim_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 value_dim_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-attention-component_8h_source.html#l00283">283</a> of file <a class="el" href="nnet-attention-component_8h_source.html">nnet-attention-component.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-attention-component_8cc_source.html#l00292">RestrictedAttentionComponent::Backprop()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00334">RestrictedAttentionComponent::BackpropOneHead()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00277">RestrictedAttentionComponent::Check()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00032">RestrictedAttentionComponent::Info()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00080">RestrictedAttentionComponent::InitFromConfig()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00115">RestrictedAttentionComponent::InputDim()</a>, <a class="el" href="nnet-attention-component_8h_source.html#l00121">RestrictedAttentionComponent::OutputDim()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00132">RestrictedAttentionComponent::Propagate()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00160">RestrictedAttentionComponent::PropagateOneHead()</a>, <a class="el" href="nnet-attention-component_8cc_source.html#l00472">RestrictedAttentionComponent::Read()</a>, and <a class="el" href="nnet-attention-component_8cc_source.html#l00441">RestrictedAttentionComponent::Write()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>nnet3/<a class="el" href="nnet-attention-component_8h_source.html">nnet-attention-component.h</a></li>
<li>nnet3/<a class="el" href="nnet-attention-component_8cc_source.html">nnet-attention-component.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacekaldi.html">kaldi</a></li><li class="navelem"><a class="el" href="namespacekaldi_1_1nnet3.html">nnet3</a></li><li class="navelem"><a class="el" href="classkaldi_1_1nnet3_1_1RestrictedAttentionComponent.html">RestrictedAttentionComponent</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
