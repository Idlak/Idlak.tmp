<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Kaldi: OnlinePitchFeatureImpl Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" /> 
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
 <td id="projectlogo"><a href="http://kaldi-asr.org/"><img alt="Logo" src="KaldiTextAndLogoSmall.png"/ style="padding: 3px 5px 1px 5px"></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname" style="display:none">Kaldi
   </div>
  </td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief" style="display:none"></div>
    </td>
   <!--END PROJECT_BRIEF-->
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classkaldi_1_1OnlinePitchFeatureImpl.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classkaldi_1_1OnlinePitchFeatureImpl-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">OnlinePitchFeatureImpl Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for OnlinePitchFeatureImpl:</div>
<div class="dyncontent">
<div class="center"><img src="classkaldi_1_1OnlinePitchFeatureImpl__coll__graph.png" border="0" usemap="#OnlinePitchFeatureImpl_coll__map" alt="Collaboration graph"/></div>
<map name="OnlinePitchFeatureImpl_coll__map" id="OnlinePitchFeatureImpl_coll__map">
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae5cf7bed213a066965a59659b5b6ddc8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#ae5cf7bed213a066965a59659b5b6ddc8">OnlinePitchFeatureImpl</a> (const <a class="el" href="structkaldi_1_1PitchExtractionOptions.html">PitchExtractionOptions</a> &amp;opts)</td></tr>
<tr class="separator:ae5cf7bed213a066965a59659b5b6ddc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6db7dfbac0d670f69c3754ed195b3c61"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a6db7dfbac0d670f69c3754ed195b3c61">Dim</a> () const</td></tr>
<tr class="separator:a6db7dfbac0d670f69c3754ed195b3c61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6c879cd7bb2077a2d6a089ed085fefb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#ab6c879cd7bb2077a2d6a089ed085fefb">FrameShiftInSeconds</a> () const</td></tr>
<tr class="separator:ab6c879cd7bb2077a2d6a089ed085fefb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a816b68dc299cc3ed745ba1f3036bc3cd"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a816b68dc299cc3ed745ba1f3036bc3cd">NumFramesReady</a> () const</td></tr>
<tr class="separator:a816b68dc299cc3ed745ba1f3036bc3cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf789f1122e6886e209aa0f149f8fd45"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adf789f1122e6886e209aa0f149f8fd45">IsLastFrame</a> (int32 frame) const</td></tr>
<tr class="separator:adf789f1122e6886e209aa0f149f8fd45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeef84368a0238c6c170d37e2c6b07dc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#afeef84368a0238c6c170d37e2c6b07dc">GetFrame</a> (int32 frame, <a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; *feat)</td></tr>
<tr class="separator:afeef84368a0238c6c170d37e2c6b07dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a622e8436805cef0c95f96b232bddd00e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a622e8436805cef0c95f96b232bddd00e">AcceptWaveform</a> (<a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> sampling_rate, const <a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;waveform)</td></tr>
<tr class="separator:a622e8436805cef0c95f96b232bddd00e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a639c1eee3381eb54c22c6f791af01bb5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a639c1eee3381eb54c22c6f791af01bb5">InputFinished</a> ()</td></tr>
<tr class="separator:a639c1eee3381eb54c22c6f791af01bb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb1ebe0699da298d2f09d95fd79f4303"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb1ebe0699da298d2f09d95fd79f4303">~OnlinePitchFeatureImpl</a> ()</td></tr>
<tr class="separator:adb1ebe0699da298d2f09d95fd79f4303"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04efdd59854f9e36521e4e8ccf99ae90"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a04efdd59854f9e36521e4e8ccf99ae90">OnlinePitchFeatureImpl</a> (const <a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html">OnlinePitchFeatureImpl</a> &amp;other)</td></tr>
<tr class="separator:a04efdd59854f9e36521e4e8ccf99ae90"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a2e2790b474cf0b02c140393fec0d108c"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a2e2790b474cf0b02c140393fec0d108c">NumFramesAvailable</a> (int64 num_downsampled_samples, <a class="el" href="classbool.html">bool</a> snip_edges) const</td></tr>
<tr class="memdesc:a2e2790b474cf0b02c140393fec0d108c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function works out from the signal how many frames are currently available to process (this is called from inside <a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a622e8436805cef0c95f96b232bddd00e">AcceptWaveform()</a>).  <a href="#a2e2790b474cf0b02c140393fec0d108c">More...</a><br /></td></tr>
<tr class="separator:a2e2790b474cf0b02c140393fec0d108c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a649e5859ff2651bcf21b60ad751d69d9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a649e5859ff2651bcf21b60ad751d69d9">ExtractFrame</a> (const <a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;downsampled_wave_part, int64 frame_index, <a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; *window)</td></tr>
<tr class="memdesc:a649e5859ff2651bcf21b60ad751d69d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function extracts from the signal the samples numbered from "sample_index" (numbered in the full downsampled signal, not just this part), and of length equal to window-&gt;<a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a6db7dfbac0d670f69c3754ed195b3c61">Dim()</a>.  <a href="#a649e5859ff2651bcf21b60ad751d69d9">More...</a><br /></td></tr>
<tr class="separator:a649e5859ff2651bcf21b60ad751d69d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae03e1460950b461f939b45f6218a57e5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#ae03e1460950b461f939b45f6218a57e5">RecomputeBacktraces</a> ()</td></tr>
<tr class="memdesc:ae03e1460950b461f939b45f6218a57e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is called after we reach frame "recompute_frame", or when <a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a639c1eee3381eb54c22c6f791af01bb5">InputFinished()</a> is called, whichever comes sooner.  <a href="#ae03e1460950b461f939b45f6218a57e5">More...</a><br /></td></tr>
<tr class="separator:ae03e1460950b461f939b45f6218a57e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60ff780ecb67fc68147b8a93a7903114"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a60ff780ecb67fc68147b8a93a7903114">UpdateRemainder</a> (const <a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;downsampled_wave_part)</td></tr>
<tr class="memdesc:a60ff780ecb67fc68147b8a93a7903114"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function updates downsampled_signal_remainder_, downsampled_samples_processed_, signal_sum_ and signal_sumsq_; it's called from <a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a622e8436805cef0c95f96b232bddd00e">AcceptWaveform()</a>.  <a href="#a60ff780ecb67fc68147b8a93a7903114">More...</a><br /></td></tr>
<tr class="separator:a60ff780ecb67fc68147b8a93a7903114"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:adb66b8c72a5eaf1361d3bb1d5c85ae6a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structkaldi_1_1PitchExtractionOptions.html">PitchExtractionOptions</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a></td></tr>
<tr class="separator:adb66b8c72a5eaf1361d3bb1d5c85ae6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0fa922a998005cb0ceb48d167b3743a"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#aa0fa922a998005cb0ceb48d167b3743a">nccf_first_lag_</a></td></tr>
<tr class="separator:aa0fa922a998005cb0ceb48d167b3743a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b005b3fdf280bbb7081f678bfecbf34"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a0b005b3fdf280bbb7081f678bfecbf34">nccf_last_lag_</a></td></tr>
<tr class="separator:a0b005b3fdf280bbb7081f678bfecbf34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8efe898284c62c9639d5b5cdb26a5b7f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1Vector.html">Vector</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a8efe898284c62c9639d5b5cdb26a5b7f">lags_</a></td></tr>
<tr class="separator:a8efe898284c62c9639d5b5cdb26a5b7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09bb1a83f1f8fcc242910e7b948bf91f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1ArbitraryResample.html">ArbitraryResample</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a09bb1a83f1f8fcc242910e7b948bf91f">nccf_resampler_</a></td></tr>
<tr class="separator:a09bb1a83f1f8fcc242910e7b948bf91f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e1142480851bd84b41838ed2fa7d86c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1LinearResample.html">LinearResample</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a3e1142480851bd84b41838ed2fa7d86c">signal_resampler_</a></td></tr>
<tr class="separator:a3e1142480851bd84b41838ed2fa7d86c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5921b1b4f2eb6fb2c3f9cba2b62a5041"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classkaldi_1_1PitchFrameInfo.html">PitchFrameInfo</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5921b1b4f2eb6fb2c3f9cba2b62a5041">frame_info_</a></td></tr>
<tr class="separator:a5921b1b4f2eb6fb2c3f9cba2b62a5041"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a074ffd9deb8e58b1765830aab0a424f8"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structkaldi_1_1NccfInfo.html">NccfInfo</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a074ffd9deb8e58b1765830aab0a424f8">nccf_info_</a></td></tr>
<tr class="separator:a074ffd9deb8e58b1765830aab0a424f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb8b9d748b4fd69949732bbfbc8b99d1"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#abb8b9d748b4fd69949732bbfbc8b99d1">frames_latency_</a></td></tr>
<tr class="separator:abb8b9d748b4fd69949732bbfbc8b99d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6b3331ec2fea8340aab94f2255df602"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1Vector.html">Vector</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#ae6b3331ec2fea8340aab94f2255df602">forward_cost_</a></td></tr>
<tr class="separator:ae6b3331ec2fea8340aab94f2255df602"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab681b385e3eb01292d20489015dc831b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#ab681b385e3eb01292d20489015dc831b">forward_cost_remainder_</a></td></tr>
<tr class="separator:ab681b385e3eb01292d20489015dc831b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50a4e42f8aa942d39dcbc18ac35c6044"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::pair&lt; int32, <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a50a4e42f8aa942d39dcbc18ac35c6044">lag_nccf_</a></td></tr>
<tr class="separator:a50a4e42f8aa942d39dcbc18ac35c6044"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacffa240aa012eb5bc6a2e9dd3ef3a59"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#aacffa240aa012eb5bc6a2e9dd3ef3a59">input_finished_</a></td></tr>
<tr class="separator:aacffa240aa012eb5bc6a2e9dd3ef3a59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28321a9272fde604ee386906c9f15af7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a28321a9272fde604ee386906c9f15af7">signal_sumsq_</a></td></tr>
<tr class="memdesc:a28321a9272fde604ee386906c9f15af7"><td class="mdescLeft">&#160;</td><td class="mdescRight">sum-squared of previously processed parts of signal; used to get NCCF ballast term.  <a href="#a28321a9272fde604ee386906c9f15af7">More...</a><br /></td></tr>
<tr class="separator:a28321a9272fde604ee386906c9f15af7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d48827066f901d2aaa77439bef176df"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5d48827066f901d2aaa77439bef176df">signal_sum_</a></td></tr>
<tr class="memdesc:a5d48827066f901d2aaa77439bef176df"><td class="mdescLeft">&#160;</td><td class="mdescRight">sum of previously processed parts of signal; used to do mean-subtraction when getting sum-squared, along with signal_sumsq_.  <a href="#a5d48827066f901d2aaa77439bef176df">More...</a><br /></td></tr>
<tr class="separator:a5d48827066f901d2aaa77439bef176df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a145a2a9ef62123289bd18524cf6a19ac"><td class="memItemLeft" align="right" valign="top">int64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a145a2a9ef62123289bd18524cf6a19ac">downsampled_samples_processed_</a></td></tr>
<tr class="memdesc:a145a2a9ef62123289bd18524cf6a19ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">downsampled_samples_processed is the number of samples (after downsampling) that we got in previous calls to <a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a622e8436805cef0c95f96b232bddd00e">AcceptWaveform()</a>.  <a href="#a145a2a9ef62123289bd18524cf6a19ac">More...</a><br /></td></tr>
<tr class="separator:a145a2a9ef62123289bd18524cf6a19ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a573d4f50811a6e765095c24c355a1fd3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1Vector.html">Vector</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a573d4f50811a6e765095c24c355a1fd3">downsampled_signal_remainder_</a></td></tr>
<tr class="memdesc:a573d4f50811a6e765095c24c355a1fd3"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is a small remainder of the previous downsampled signal; it's used by ExtractFrame for frames near the boundary of two waveforms supplied to <a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a622e8436805cef0c95f96b232bddd00e">AcceptWaveform()</a>.  <a href="#a573d4f50811a6e765095c24c355a1fd3">More...</a><br /></td></tr>
<tr class="separator:a573d4f50811a6e765095c24c355a1fd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00574">574</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ae5cf7bed213a066965a59659b5b6ddc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5cf7bed213a066965a59659b5b6ddc8">&#9670;&nbsp;</a></span>OnlinePitchFeatureImpl() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html">OnlinePitchFeatureImpl</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1PitchExtractionOptions.html">PitchExtractionOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>opts</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00715">715</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">References <a class="el" href="kaldi-vector_8cc_source.html#l00955">VectorBase&lt; Real &gt;::Add()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00685">OnlinePitchFeatureImpl::forward_cost_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00668">OnlinePitchFeatureImpl::frame_info_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00680">OnlinePitchFeatureImpl::frames_latency_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00654">OnlinePitchFeatureImpl::lags_</a>, <a class="el" href="pitch-functions_8h_source.html#l00053">PitchExtractionOptions::lowpass_cutoff</a>, <a class="el" href="pitch-functions_8h_source.html#l00060">PitchExtractionOptions::lowpass_filter_width</a>, <a class="el" href="pitch-functions_8h_source.html#l00049">PitchExtractionOptions::max_f0</a>, <a class="el" href="pitch-functions_8h_source.html#l00048">PitchExtractionOptions::min_f0</a>, <a class="el" href="pitch-functions_8cc_source.html#l00649">OnlinePitchFeatureImpl::nccf_first_lag_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00651">OnlinePitchFeatureImpl::nccf_last_lag_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00659">OnlinePitchFeatureImpl::nccf_resampler_</a>, <a class="el" href="pitch-functions_8h_source.html#l00054">PitchExtractionOptions::resample_freq</a>, <a class="el" href="pitch-functions_8h_source.html#l00044">PitchExtractionOptions::samp_freq</a>, <a class="el" href="pitch-functions_8cc_source.html#l00157">kaldi::SelectLags()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00664">OnlinePitchFeatureImpl::signal_resampler_</a>, and <a class="el" href="pitch-functions_8h_source.html#l00062">PitchExtractionOptions::upsample_filter_width</a>.</p>
<div class="fragment"><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                                       :</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>(opts), <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#ab681b385e3eb01292d20489015dc831b">forward_cost_remainder_</a>(0.0), <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#aacffa240aa012eb5bc6a2e9dd3ef3a59">input_finished_</a>(<span class="keyword">false</span>),</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a28321a9272fde604ee386906c9f15af7">signal_sumsq_</a>(0.0), <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5d48827066f901d2aaa77439bef176df">signal_sum_</a>(0.0), <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a145a2a9ef62123289bd18524cf6a19ac">downsampled_samples_processed_</a>(0) {</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a3e1142480851bd84b41838ed2fa7d86c">signal_resampler_</a> = <span class="keyword">new</span> LinearResample(opts.samp_freq, opts.resample_freq,</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                                         opts.lowpass_cutoff,</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                                         opts.lowpass_filter_width);</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="keywordtype">double</span> outer_min_lag = 1.0 / opts.max_f0 -</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      (opts.upsample_filter_width/(2.0 * opts.resample_freq));</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="keywordtype">double</span> outer_max_lag = 1.0 / opts.min_f0 +</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      (opts.upsample_filter_width/(2.0 * opts.resample_freq));</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#aa0fa922a998005cb0ceb48d167b3743a">nccf_first_lag_</a> = ceil(opts.resample_freq * outer_min_lag);</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a0b005b3fdf280bbb7081f678bfecbf34">nccf_last_lag_</a> = floor(opts.resample_freq * outer_max_lag);</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#abb8b9d748b4fd69949732bbfbc8b99d1">frames_latency_</a> = 0;  <span class="comment">// will be set in AcceptWaveform()</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <span class="comment">// Choose the lags at which we resample the NCCF.</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <a class="code" href="namespacekaldi.html#ae3888d51233249c4e59436a24b95da58">SelectLags</a>(opts, &amp;<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a8efe898284c62c9639d5b5cdb26a5b7f">lags_</a>);</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <span class="comment">// upsample_cutoff is the filter cutoff for upsampling the NCCF, which is the</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="comment">// Nyquist of the resampling frequency.  The NCCF is (almost completely)</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="comment">// bandlimited to around &quot;lowpass_cutoff&quot; (1000 by default), and when the</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="comment">// spectrum of this bandlimited signal is convolved with the spectrum of an</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <span class="comment">// impulse train with frequency &quot;resample_freq&quot;, which are separated by 4kHz,</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="comment">// we get energy at -5000,-3000, -1000...1000, 3000..5000, etc.  Filtering at</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <span class="comment">// half the Nyquist (2000 by default) is sufficient to get only the first</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <span class="comment">// repetition.</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> upsample_cutoff = opts.resample_freq * 0.5;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  Vector&lt;BaseFloat&gt; lags_offset(<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a8efe898284c62c9639d5b5cdb26a5b7f">lags_</a>);</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  <span class="comment">// lags_offset equals lags_ (which are the log-spaced lag values we want to</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  <span class="comment">// measure the NCCF at) with nccf_first_lag_ / opts.resample_freq subtracted</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <span class="comment">// from each element, so we can treat the measured NCCF values as as starting</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <span class="comment">// from sample zero in a signal that starts at the point start /</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  <span class="comment">// opts.resample_freq.  This is necessary because the ArbitraryResample code</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <span class="comment">// assumes that the input signal starts from sample zero.</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  lags_offset.Add(-<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#aa0fa922a998005cb0ceb48d167b3743a">nccf_first_lag_</a> / opts.resample_freq);</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  int32 num_measured_lags = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a0b005b3fdf280bbb7081f678bfecbf34">nccf_last_lag_</a> + 1 - <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#aa0fa922a998005cb0ceb48d167b3743a">nccf_first_lag_</a>;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a09bb1a83f1f8fcc242910e7b948bf91f">nccf_resampler_</a> = <span class="keyword">new</span> ArbitraryResample(num_measured_lags, opts.resample_freq,</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                                          upsample_cutoff, lags_offset,</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                                          opts.upsample_filter_width);</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  <span class="comment">// add a PitchInfo object for frame -1 (not a real frame).</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5921b1b4f2eb6fb2c3f9cba2b62a5041">frame_info_</a>.push_back(<span class="keyword">new</span> PitchFrameInfo(<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a8efe898284c62c9639d5b5cdb26a5b7f">lags_</a>.Dim()));</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="comment">// zeroes forward_cost_; this is what we want for the fake frame -1.</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#ae6b3331ec2fea8340aab94f2255df602">forward_cost_</a>.Resize(<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a8efe898284c62c9639d5b5cdb26a5b7f">lags_</a>.Dim());</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;}</div><div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a5921b1b4f2eb6fb2c3f9cba2b62a5041"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5921b1b4f2eb6fb2c3f9cba2b62a5041">kaldi::OnlinePitchFeatureImpl::frame_info_</a></div><div class="ttdeci">std::vector&lt; PitchFrameInfo * &gt; frame_info_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00668">pitch-functions.cc:668</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a8efe898284c62c9639d5b5cdb26a5b7f"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a8efe898284c62c9639d5b5cdb26a5b7f">kaldi::OnlinePitchFeatureImpl::lags_</a></div><div class="ttdeci">Vector&lt; BaseFloat &gt; lags_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00654">pitch-functions.cc:654</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_aa0fa922a998005cb0ceb48d167b3743a"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#aa0fa922a998005cb0ceb48d167b3743a">kaldi::OnlinePitchFeatureImpl::nccf_first_lag_</a></div><div class="ttdeci">int32 nccf_first_lag_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00649">pitch-functions.cc:649</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a5d48827066f901d2aaa77439bef176df"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5d48827066f901d2aaa77439bef176df">kaldi::OnlinePitchFeatureImpl::signal_sum_</a></div><div class="ttdeci">double signal_sum_</div><div class="ttdoc">sum of previously processed parts of signal; used to do mean-subtraction when getting sum-squared...</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00703">pitch-functions.cc:703</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a0b005b3fdf280bbb7081f678bfecbf34"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a0b005b3fdf280bbb7081f678bfecbf34">kaldi::OnlinePitchFeatureImpl::nccf_last_lag_</a></div><div class="ttdeci">int32 nccf_last_lag_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00651">pitch-functions.cc:651</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a09bb1a83f1f8fcc242910e7b948bf91f"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a09bb1a83f1f8fcc242910e7b948bf91f">kaldi::OnlinePitchFeatureImpl::nccf_resampler_</a></div><div class="ttdeci">ArbitraryResample * nccf_resampler_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00659">pitch-functions.cc:659</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_aacffa240aa012eb5bc6a2e9dd3ef3a59"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#aacffa240aa012eb5bc6a2e9dd3ef3a59">kaldi::OnlinePitchFeatureImpl::input_finished_</a></div><div class="ttdeci">bool input_finished_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00695">pitch-functions.cc:695</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_ae6b3331ec2fea8340aab94f2255df602"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#ae6b3331ec2fea8340aab94f2255df602">kaldi::OnlinePitchFeatureImpl::forward_cost_</a></div><div class="ttdeci">Vector&lt; BaseFloat &gt; forward_cost_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00685">pitch-functions.cc:685</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_adb66b8c72a5eaf1361d3bb1d5c85ae6a"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">kaldi::OnlinePitchFeatureImpl::opts_</a></div><div class="ttdeci">PitchExtractionOptions opts_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00646">pitch-functions.cc:646</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a145a2a9ef62123289bd18524cf6a19ac"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a145a2a9ef62123289bd18524cf6a19ac">kaldi::OnlinePitchFeatureImpl::downsampled_samples_processed_</a></div><div class="ttdeci">int64 downsampled_samples_processed_</div><div class="ttdoc">downsampled_samples_processed is the number of samples (after downsampling) that we got in previous c...</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00707">pitch-functions.cc:707</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_abb8b9d748b4fd69949732bbfbc8b99d1"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#abb8b9d748b4fd69949732bbfbc8b99d1">kaldi::OnlinePitchFeatureImpl::frames_latency_</a></div><div class="ttdeci">int32 frames_latency_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00680">pitch-functions.cc:680</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a3e1142480851bd84b41838ed2fa7d86c"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a3e1142480851bd84b41838ed2fa7d86c">kaldi::OnlinePitchFeatureImpl::signal_resampler_</a></div><div class="ttdeci">LinearResample * signal_resampler_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00664">pitch-functions.cc:664</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_ab681b385e3eb01292d20489015dc831b"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#ab681b385e3eb01292d20489015dc831b">kaldi::OnlinePitchFeatureImpl::forward_cost_remainder_</a></div><div class="ttdeci">double forward_cost_remainder_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00688">pitch-functions.cc:688</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a28321a9272fde604ee386906c9f15af7"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a28321a9272fde604ee386906c9f15af7">kaldi::OnlinePitchFeatureImpl::signal_sumsq_</a></div><div class="ttdeci">double signal_sumsq_</div><div class="ttdoc">sum-squared of previously processed parts of signal; used to get NCCF ballast term. </div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00699">pitch-functions.cc:699</a></div></div>
<div class="ttc" id="namespacekaldi_html_ae3888d51233249c4e59436a24b95da58"><div class="ttname"><a href="namespacekaldi.html#ae3888d51233249c4e59436a24b95da58">kaldi::SelectLags</a></div><div class="ttdeci">void SelectLags(const PitchExtractionOptions &amp;opts, Vector&lt; BaseFloat &gt; *lags)</div><div class="ttdoc">This function selects the lags at which we measure the NCCF: we need to select lags from 1/max_f0 to ...</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00157">pitch-functions.cc:157</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adb1ebe0699da298d2f09d95fd79f4303"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb1ebe0699da298d2f09d95fd79f4303">&#9670;&nbsp;</a></span>~OnlinePitchFeatureImpl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">~<a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html">OnlinePitchFeatureImpl</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l01037">1037</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">References <a class="el" href="pitch-functions_8cc_source.html#l00668">OnlinePitchFeatureImpl::frame_info_</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="pitch-functions_8cc_source.html#l00675">OnlinePitchFeatureImpl::nccf_info_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00659">OnlinePitchFeatureImpl::nccf_resampler_</a>, and <a class="el" href="pitch-functions_8cc_source.html#l00664">OnlinePitchFeatureImpl::signal_resampler_</a>.</p>
<div class="fragment"><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                                                {</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  <span class="keyword">delete</span> <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a09bb1a83f1f8fcc242910e7b948bf91f">nccf_resampler_</a>;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  <span class="keyword">delete</span> <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a3e1142480851bd84b41838ed2fa7d86c">signal_resampler_</a>;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5921b1b4f2eb6fb2c3f9cba2b62a5041">frame_info_</a>.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5921b1b4f2eb6fb2c3f9cba2b62a5041">frame_info_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a074ffd9deb8e58b1765830aab0a424f8">nccf_info_</a>.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a074ffd9deb8e58b1765830aab0a424f8">nccf_info_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;}</div><div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a5921b1b4f2eb6fb2c3f9cba2b62a5041"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5921b1b4f2eb6fb2c3f9cba2b62a5041">kaldi::OnlinePitchFeatureImpl::frame_info_</a></div><div class="ttdeci">std::vector&lt; PitchFrameInfo * &gt; frame_info_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00668">pitch-functions.cc:668</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a09bb1a83f1f8fcc242910e7b948bf91f"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a09bb1a83f1f8fcc242910e7b948bf91f">kaldi::OnlinePitchFeatureImpl::nccf_resampler_</a></div><div class="ttdeci">ArbitraryResample * nccf_resampler_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00659">pitch-functions.cc:659</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a074ffd9deb8e58b1765830aab0a424f8"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a074ffd9deb8e58b1765830aab0a424f8">kaldi::OnlinePitchFeatureImpl::nccf_info_</a></div><div class="ttdeci">std::vector&lt; NccfInfo * &gt; nccf_info_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00675">pitch-functions.cc:675</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a3e1142480851bd84b41838ed2fa7d86c"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a3e1142480851bd84b41838ed2fa7d86c">kaldi::OnlinePitchFeatureImpl::signal_resampler_</a></div><div class="ttdeci">LinearResample * signal_resampler_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00664">pitch-functions.cc:664</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a04efdd59854f9e36521e4e8ccf99ae90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04efdd59854f9e36521e4e8ccf99ae90">&#9670;&nbsp;</a></span>OnlinePitchFeatureImpl() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html">OnlinePitchFeatureImpl</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html">OnlinePitchFeatureImpl</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a622e8436805cef0c95f96b232bddd00e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a622e8436805cef0c95f96b232bddd00e">&#9670;&nbsp;</a></span>AcceptWaveform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AcceptWaveform </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a>&#160;</td>
          <td class="paramname"><em>sampling_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>waveform</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l01046">1046</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">References <a class="el" href="pitch-functions_8cc_source.html#l00102">kaldi::ComputeCorrelation()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00131">kaldi::ComputeNccf()</a>, <a class="el" href="kaldi-vector_8h_source.html#l00063">VectorBase&lt; Real &gt;::Dim()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00707">OnlinePitchFeatureImpl::downsampled_samples_processed_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00839">OnlinePitchFeatureImpl::ExtractFrame()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00685">OnlinePitchFeatureImpl::forward_cost_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00688">OnlinePitchFeatureImpl::forward_cost_remainder_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00668">OnlinePitchFeatureImpl::frame_info_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00680">OnlinePitchFeatureImpl::frames_latency_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00695">OnlinePitchFeatureImpl::input_finished_</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00135">KALDI_VLOG</a>, <a class="el" href="pitch-functions_8cc_source.html#l00693">OnlinePitchFeatureImpl::lag_nccf_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00654">OnlinePitchFeatureImpl::lags_</a>, <a class="el" href="pitch-functions_8h_source.html#l00074">PitchExtractionOptions::max_frames_latency</a>, <a class="el" href="pitch-functions_8h_source.html#l00057">PitchExtractionOptions::nccf_ballast</a>, <a class="el" href="pitch-functions_8h_source.html#l00111">PitchExtractionOptions::nccf_ballast_online</a>, <a class="el" href="pitch-functions_8cc_source.html#l00649">OnlinePitchFeatureImpl::nccf_first_lag_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00675">OnlinePitchFeatureImpl::nccf_info_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00651">OnlinePitchFeatureImpl::nccf_last_lag_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00659">OnlinePitchFeatureImpl::nccf_resampler_</a>, <a class="el" href="pitch-functions_8h_source.html#l00207">PitchExtractionOptions::NccfWindowShift()</a>, <a class="el" href="pitch-functions_8h_source.html#l00203">PitchExtractionOptions::NccfWindowSize()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00768">OnlinePitchFeatureImpl::NumFramesAvailable()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00646">OnlinePitchFeatureImpl::opts_</a>, <a class="el" href="pitch-functions_8h_source.html#l00104">PitchExtractionOptions::recompute_frame</a>, <a class="el" href="pitch-functions_8cc_source.html#l00945">OnlinePitchFeatureImpl::RecomputeBacktraces()</a>, <a class="el" href="resample_8cc_source.html#l00280">ArbitraryResample::Resample()</a>, <a class="el" href="resample_8cc_source.html#l00152">LinearResample::Resample()</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l00818">Matrix&lt; Real &gt;::Resize()</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00185">MatrixBase&lt; Real &gt;::Row()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00664">OnlinePitchFeatureImpl::signal_resampler_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00703">OnlinePitchFeatureImpl::signal_sum_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00699">OnlinePitchFeatureImpl::signal_sumsq_</a>, <a class="el" href="pitch-functions_8h_source.html#l00112">PitchExtractionOptions::snip_edges</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00693">VectorBase&lt; Real &gt;::Sum()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00794">OnlinePitchFeatureImpl::UpdateRemainder()</a>, and <a class="el" href="kaldi-vector_8cc_source.html#l00037">kaldi::VecVec()</a>.</p>

<p class="reference">Referenced by <a class="el" href="pitch-functions_8cc_source.html#l01223">OnlinePitchFeature::AcceptWaveform()</a>, and <a class="el" href="pitch-functions_8cc_source.html#l00928">OnlinePitchFeatureImpl::InputFinished()</a>.</p>
<div class="fragment"><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                                       {</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <span class="comment">// flush out the last few samples of input waveform only if input_finished_ ==</span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  <span class="comment">// true.</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> flush = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#aacffa240aa012eb5bc6a2e9dd3ef3a59">input_finished_</a>;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  Vector&lt;BaseFloat&gt; downsampled_wave;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a3e1142480851bd84b41838ed2fa7d86c">signal_resampler_</a>-&gt;<a class="code" href="classkaldi_1_1LinearResample.html#aee7dcedf0f288da82a190e2301183322">Resample</a>(wave, flush, &amp;downsampled_wave);</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  <span class="comment">// these variables will be used to compute the root-mean-square value of the</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  <span class="comment">// signal for the ballast term.</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  <span class="keywordtype">double</span> cur_sumsq = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a28321a9272fde604ee386906c9f15af7">signal_sumsq_</a>, cur_sum = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5d48827066f901d2aaa77439bef176df">signal_sum_</a>;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  int64 cur_num_samp = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a145a2a9ef62123289bd18524cf6a19ac">downsampled_samples_processed_</a>,</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      prev_frame_end_sample = 0;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#a7f1b3c2276f20e69d0fe6673472a95db">nccf_ballast_online</a>) {</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    cur_sumsq += <a class="code" href="group__matrix__funcs__scalar.html#ga4750cd6f7a02a013435779588056b153">VecVec</a>(downsampled_wave, downsampled_wave);</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    cur_sum += downsampled_wave.Sum();</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    cur_num_samp += downsampled_wave.Dim();</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  }</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  <span class="comment">// end_frame is the total number of frames we can now process, including</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  <span class="comment">// previously processed ones.</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  int32 end_frame = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a2e2790b474cf0b02c140393fec0d108c">NumFramesAvailable</a>(</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a145a2a9ef62123289bd18524cf6a19ac">downsampled_samples_processed_</a> + downsampled_wave.Dim(), <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#a9ff3e6c88fef66369c0f3b0e92f7cd57">snip_edges</a>);</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  <span class="comment">// &quot;start_frame&quot; is the first frame-index we process</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  int32 start_frame = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5921b1b4f2eb6fb2c3f9cba2b62a5041">frame_info_</a>.size() - 1,</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      num_new_frames = end_frame - start_frame;</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  <span class="keywordflow">if</span> (num_new_frames == 0) {</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a60ff780ecb67fc68147b8a93a7903114">UpdateRemainder</a>(downsampled_wave);</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <span class="comment">// continuing to the rest of the code would generate</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <span class="comment">// an error when sizing matrices with zero rows, and</span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <span class="comment">// anyway is a waste of time.</span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  }</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  int32 num_measured_lags = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a0b005b3fdf280bbb7081f678bfecbf34">nccf_last_lag_</a> + 1 - <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#aa0fa922a998005cb0ceb48d167b3743a">nccf_first_lag_</a>,</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;      num_resampled_lags = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a8efe898284c62c9639d5b5cdb26a5b7f">lags_</a>.Dim(),</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      frame_shift = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#aba781b9846354b930637853c6f66ba24">NccfWindowShift</a>(),</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      basic_frame_length = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#a803d884fa5668ce0949df59b75ad91ba">NccfWindowSize</a>(),</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;      full_frame_length = basic_frame_length + <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a0b005b3fdf280bbb7081f678bfecbf34">nccf_last_lag_</a>;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  Vector&lt;BaseFloat&gt; window(full_frame_length),</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;      inner_prod(num_measured_lags),</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;      norm_prod(num_measured_lags);</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  Matrix&lt;BaseFloat&gt; nccf_pitch(num_new_frames, num_measured_lags),</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      nccf_pov(num_new_frames, num_measured_lags);</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  Vector&lt;BaseFloat&gt; cur_forward_cost(num_resampled_lags);</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <span class="comment">// Because the resampling of the NCCF is more efficient when grouped together,</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  <span class="comment">// we first compute the NCCF for all frames, then resample as a matrix, then</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  <span class="comment">// do the Viterbi [that happens inside the constructor of PitchFrameInfo].</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <span class="keywordflow">for</span> (int32 frame = start_frame; frame &lt; end_frame; frame++) {</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="comment">// start_sample is index into the whole wave, not just this part.</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    int64 start_sample;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#a9ff3e6c88fef66369c0f3b0e92f7cd57">snip_edges</a>) {</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;      <span class="comment">// Usual case: offset starts at 0</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      start_sample = <span class="keyword">static_cast&lt;</span>int64<span class="keyword">&gt;</span>(frame) * frame_shift;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      <span class="comment">// When we are not snipping the edges, the first offsets may be</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      <span class="comment">// negative. In this case we will pad with zeros, it should not impact</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      <span class="comment">// the pitch tracker.</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      start_sample =</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        <span class="keyword">static_cast&lt;</span>int64<span class="keyword">&gt;</span>((frame + 0.5) * frame_shift) - full_frame_length / 2;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    }</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a649e5859ff2651bcf21b60ad751d69d9">ExtractFrame</a>(downsampled_wave, start_sample, &amp;window);</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#a7f1b3c2276f20e69d0fe6673472a95db">nccf_ballast_online</a>) {</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      <span class="comment">// use only up to end of current frame to compute root-mean-square value.</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      <span class="comment">// end_sample will be the sample-index into &quot;downsampled_wave&quot;, so</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;      <span class="comment">// not really comparable to start_sample.</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      int64 end_sample = start_sample + full_frame_length -</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;          <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a145a2a9ef62123289bd18524cf6a19ac">downsampled_samples_processed_</a>;</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(end_sample &gt; 0);  <span class="comment">// or should have processed this frame last</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                                     <span class="comment">// time.  Note: end_sample is one past last</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                                     <span class="comment">// sample.</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      <span class="keywordflow">if</span> (end_sample &gt; downsampled_wave.Dim()) {</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#aacffa240aa012eb5bc6a2e9dd3ef3a59">input_finished_</a>);</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        end_sample = downsampled_wave.Dim();</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      }</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      SubVector&lt;BaseFloat&gt; new_part(downsampled_wave, prev_frame_end_sample,</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                                    end_sample - prev_frame_end_sample);</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      cur_num_samp += new_part.Dim();</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;      cur_sumsq += <a class="code" href="group__matrix__funcs__scalar.html#ga4750cd6f7a02a013435779588056b153">VecVec</a>(new_part, new_part);</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;      cur_sum += new_part.Sum();</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      prev_frame_end_sample = end_sample;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    }</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <span class="keywordtype">double</span> mean_square = cur_sumsq / cur_num_samp -</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        pow(cur_sum / cur_num_samp, 2.0);</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <a class="code" href="namespacekaldi.html#a9138e190fe6864dccb41f35a4232ea63">ComputeCorrelation</a>(window, nccf_first_lag_, nccf_last_lag_,</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                       basic_frame_length, &amp;inner_prod, &amp;norm_prod);</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    <span class="keywordtype">double</span> nccf_ballast_pov = 0.0,</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        nccf_ballast_pitch = pow(mean_square * basic_frame_length, 2) *</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;             <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#accf1f11585d50c8e5bb7ea3640f63ad3">nccf_ballast</a>,</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        avg_norm_prod = norm_prod.Sum() / norm_prod.Dim();</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    SubVector&lt;BaseFloat&gt; nccf_pitch_row(nccf_pitch, frame - start_frame);</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    <a class="code" href="namespacekaldi.html#aad870ff0d8ab280cf7019385213ab252">ComputeNccf</a>(inner_prod, norm_prod, nccf_ballast_pitch,</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                &amp;nccf_pitch_row);</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    SubVector&lt;BaseFloat&gt; nccf_pov_row(nccf_pov, frame - start_frame);</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <a class="code" href="namespacekaldi.html#aad870ff0d8ab280cf7019385213ab252">ComputeNccf</a>(inner_prod, norm_prod, nccf_ballast_pov,</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                &amp;nccf_pov_row);</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordflow">if</span> (frame &lt; <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#a293dda65e3de1db818a210a9f982d522">recompute_frame</a>)</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a074ffd9deb8e58b1765830aab0a424f8">nccf_info_</a>.push_back(<span class="keyword">new</span> NccfInfo(avg_norm_prod, mean_square));</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  }</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  Matrix&lt;BaseFloat&gt; nccf_pitch_resampled(num_new_frames, num_resampled_lags);</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a09bb1a83f1f8fcc242910e7b948bf91f">nccf_resampler_</a>-&gt;<a class="code" href="classkaldi_1_1ArbitraryResample.html#a8fb0b8851b60b4fe83a564bc08a8c80f">Resample</a>(nccf_pitch, &amp;nccf_pitch_resampled);</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  nccf_pitch.Resize(0, 0);  <span class="comment">// no longer needed.</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  Matrix&lt;BaseFloat&gt; nccf_pov_resampled(num_new_frames, num_resampled_lags);</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a09bb1a83f1f8fcc242910e7b948bf91f">nccf_resampler_</a>-&gt;<a class="code" href="classkaldi_1_1ArbitraryResample.html#a8fb0b8851b60b4fe83a564bc08a8c80f">Resample</a>(nccf_pov, &amp;nccf_pov_resampled);</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  nccf_pov.Resize(0, 0);  <span class="comment">// no longer needed.</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  <span class="comment">// We&#39;ve finished dealing with the waveform so we can call UpdateRemainder</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  <span class="comment">// now; we need to call it before we possibly call RecomputeBacktraces()</span></div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  <span class="comment">// below, which is why we don&#39;t do it at the very end.</span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a60ff780ecb67fc68147b8a93a7903114">UpdateRemainder</a>(downsampled_wave);</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  std::vector&lt;std::pair&lt;int32, int32 &gt; &gt; index_info;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  <span class="keywordflow">for</span> (int32 frame = start_frame; frame &lt; end_frame; frame++) {</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    int32 frame_idx = frame - start_frame;</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    PitchFrameInfo *prev_info = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5921b1b4f2eb6fb2c3f9cba2b62a5041">frame_info_</a>.back(),</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;        *cur_info = <span class="keyword">new</span> PitchFrameInfo(prev_info);</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    cur_info-&gt;SetNccfPov(nccf_pov_resampled.Row(frame_idx));</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    cur_info-&gt;ComputeBacktraces(<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>, nccf_pitch_resampled.Row(frame_idx),</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                                <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a8efe898284c62c9639d5b5cdb26a5b7f">lags_</a>, <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#ae6b3331ec2fea8340aab94f2255df602">forward_cost_</a>, &amp;index_info,</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                                &amp;cur_forward_cost);</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    forward_cost_.Swap(&amp;cur_forward_cost);</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="comment">// Renormalize forward_cost so smallest element is zero.</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> remainder = forward_cost_.Min();</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#ab681b385e3eb01292d20489015dc831b">forward_cost_remainder_</a> += remainder;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    forward_cost_.Add(-remainder);</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5921b1b4f2eb6fb2c3f9cba2b62a5041">frame_info_</a>.push_back(cur_info);</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="keywordflow">if</span> (frame &lt; <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#a293dda65e3de1db818a210a9f982d522">recompute_frame</a>)</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;      <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a074ffd9deb8e58b1765830aab0a424f8">nccf_info_</a>[frame]-&gt;nccf_pitch_resampled =</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;          nccf_pitch_resampled.Row(frame_idx);</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keywordflow">if</span> (frame == <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#a293dda65e3de1db818a210a9f982d522">recompute_frame</a> - 1 &amp;&amp; !<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#a7f1b3c2276f20e69d0fe6673472a95db">nccf_ballast_online</a>)</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#ae03e1460950b461f939b45f6218a57e5">RecomputeBacktraces</a>();</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  }</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  <span class="comment">// Trace back the best-path.</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  int32 best_final_state;</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  forward_cost_.Min(&amp;best_final_state);</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a50a4e42f8aa942d39dcbc18ac35c6044">lag_nccf_</a>.resize(<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5921b1b4f2eb6fb2c3f9cba2b62a5041">frame_info_</a>.size() - 1);  <span class="comment">// will keep any existing data.</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5921b1b4f2eb6fb2c3f9cba2b62a5041">frame_info_</a>.back()-&gt;SetBestState(best_final_state, <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a50a4e42f8aa942d39dcbc18ac35c6044">lag_nccf_</a>);</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#abb8b9d748b4fd69949732bbfbc8b99d1">frames_latency_</a> =</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;      <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5921b1b4f2eb6fb2c3f9cba2b62a5041">frame_info_</a>.back()-&gt;ComputeLatency(<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#a3e2582c6c7a6411141a8e20b750d63c0">max_frames_latency</a>);</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  <a class="code" href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a>(4) &lt;&lt; <span class="stringliteral">&quot;Latency is &quot;</span> &lt;&lt; <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#abb8b9d748b4fd69949732bbfbc8b99d1">frames_latency_</a>;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;}</div><div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a5921b1b4f2eb6fb2c3f9cba2b62a5041"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5921b1b4f2eb6fb2c3f9cba2b62a5041">kaldi::OnlinePitchFeatureImpl::frame_info_</a></div><div class="ttdeci">std::vector&lt; PitchFrameInfo * &gt; frame_info_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00668">pitch-functions.cc:668</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a8efe898284c62c9639d5b5cdb26a5b7f"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a8efe898284c62c9639d5b5cdb26a5b7f">kaldi::OnlinePitchFeatureImpl::lags_</a></div><div class="ttdeci">Vector&lt; BaseFloat &gt; lags_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00654">pitch-functions.cc:654</a></div></div>
<div class="ttc" id="classkaldi_1_1LinearResample_html_aee7dcedf0f288da82a190e2301183322"><div class="ttname"><a href="classkaldi_1_1LinearResample.html#aee7dcedf0f288da82a190e2301183322">kaldi::LinearResample::Resample</a></div><div class="ttdeci">void Resample(const VectorBase&lt; BaseFloat &gt; &amp;input, bool flush, Vector&lt; BaseFloat &gt; *output)</div><div class="ttdoc">This function does the resampling. </div><div class="ttdef"><b>Definition:</b> <a href="resample_8cc_source.html#l00152">resample.cc:152</a></div></div>
<div class="ttc" id="structkaldi_1_1PitchExtractionOptions_html_accf1f11585d50c8e5bb7ea3640f63ad3"><div class="ttname"><a href="structkaldi_1_1PitchExtractionOptions.html#accf1f11585d50c8e5bb7ea3640f63ad3">kaldi::PitchExtractionOptions::nccf_ballast</a></div><div class="ttdeci">BaseFloat nccf_ballast</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8h_source.html#l00057">pitch-functions.h:57</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_aa0fa922a998005cb0ceb48d167b3743a"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#aa0fa922a998005cb0ceb48d167b3743a">kaldi::OnlinePitchFeatureImpl::nccf_first_lag_</a></div><div class="ttdeci">int32 nccf_first_lag_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00649">pitch-functions.cc:649</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a5d48827066f901d2aaa77439bef176df"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5d48827066f901d2aaa77439bef176df">kaldi::OnlinePitchFeatureImpl::signal_sum_</a></div><div class="ttdeci">double signal_sum_</div><div class="ttdoc">sum of previously processed parts of signal; used to do mean-subtraction when getting sum-squared...</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00703">pitch-functions.cc:703</a></div></div>
<div class="ttc" id="structkaldi_1_1PitchExtractionOptions_html_a3e2582c6c7a6411141a8e20b750d63c0"><div class="ttname"><a href="structkaldi_1_1PitchExtractionOptions.html#a3e2582c6c7a6411141a8e20b750d63c0">kaldi::PitchExtractionOptions::max_frames_latency</a></div><div class="ttdeci">int32 max_frames_latency</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8h_source.html#l00074">pitch-functions.h:74</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a649e5859ff2651bcf21b60ad751d69d9"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a649e5859ff2651bcf21b60ad751d69d9">kaldi::OnlinePitchFeatureImpl::ExtractFrame</a></div><div class="ttdeci">void ExtractFrame(const VectorBase&lt; BaseFloat &gt; &amp;downsampled_wave_part, int64 frame_index, VectorBase&lt; BaseFloat &gt; *window)</div><div class="ttdoc">This function extracts from the signal the samples numbered from &quot;sample_index&quot; (numbered in the full...</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00839">pitch-functions.cc:839</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a0b005b3fdf280bbb7081f678bfecbf34"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a0b005b3fdf280bbb7081f678bfecbf34">kaldi::OnlinePitchFeatureImpl::nccf_last_lag_</a></div><div class="ttdeci">int32 nccf_last_lag_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00651">pitch-functions.cc:651</a></div></div>
<div class="ttc" id="structkaldi_1_1PitchExtractionOptions_html_aba781b9846354b930637853c6f66ba24"><div class="ttname"><a href="structkaldi_1_1PitchExtractionOptions.html#aba781b9846354b930637853c6f66ba24">kaldi::PitchExtractionOptions::NccfWindowShift</a></div><div class="ttdeci">int32 NccfWindowShift() const</div><div class="ttdoc">Returns the window-shift in samples, after resampling. </div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8h_source.html#l00207">pitch-functions.h:207</a></div></div>
<div class="ttc" id="structkaldi_1_1PitchExtractionOptions_html_a7f1b3c2276f20e69d0fe6673472a95db"><div class="ttname"><a href="structkaldi_1_1PitchExtractionOptions.html#a7f1b3c2276f20e69d0fe6673472a95db">kaldi::PitchExtractionOptions::nccf_ballast_online</a></div><div class="ttdeci">bool nccf_ballast_online</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8h_source.html#l00111">pitch-functions.h:111</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a09bb1a83f1f8fcc242910e7b948bf91f"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a09bb1a83f1f8fcc242910e7b948bf91f">kaldi::OnlinePitchFeatureImpl::nccf_resampler_</a></div><div class="ttdeci">ArbitraryResample * nccf_resampler_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00659">pitch-functions.cc:659</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_aacffa240aa012eb5bc6a2e9dd3ef3a59"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#aacffa240aa012eb5bc6a2e9dd3ef3a59">kaldi::OnlinePitchFeatureImpl::input_finished_</a></div><div class="ttdeci">bool input_finished_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00695">pitch-functions.cc:695</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_ae03e1460950b461f939b45f6218a57e5"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#ae03e1460950b461f939b45f6218a57e5">kaldi::OnlinePitchFeatureImpl::RecomputeBacktraces</a></div><div class="ttdeci">void RecomputeBacktraces()</div><div class="ttdoc">This function is called after we reach frame &quot;recompute_frame&quot;, or when InputFinished() is called...</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00945">pitch-functions.cc:945</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="structkaldi_1_1PitchExtractionOptions_html_a293dda65e3de1db818a210a9f982d522"><div class="ttname"><a href="structkaldi_1_1PitchExtractionOptions.html#a293dda65e3de1db818a210a9f982d522">kaldi::PitchExtractionOptions::recompute_frame</a></div><div class="ttdeci">int32 recompute_frame</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8h_source.html#l00104">pitch-functions.h:104</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_ae6b3331ec2fea8340aab94f2255df602"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#ae6b3331ec2fea8340aab94f2255df602">kaldi::OnlinePitchFeatureImpl::forward_cost_</a></div><div class="ttdeci">Vector&lt; BaseFloat &gt; forward_cost_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00685">pitch-functions.cc:685</a></div></div>
<div class="ttc" id="classkaldi_1_1ArbitraryResample_html_a8fb0b8851b60b4fe83a564bc08a8c80f"><div class="ttname"><a href="classkaldi_1_1ArbitraryResample.html#a8fb0b8851b60b4fe83a564bc08a8c80f">kaldi::ArbitraryResample::Resample</a></div><div class="ttdeci">void Resample(const MatrixBase&lt; BaseFloat &gt; &amp;input, MatrixBase&lt; BaseFloat &gt; *output) const</div><div class="ttdoc">This function does the resampling. </div><div class="ttdef"><b>Definition:</b> <a href="resample_8cc_source.html#l00280">resample.cc:280</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_adb66b8c72a5eaf1361d3bb1d5c85ae6a"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">kaldi::OnlinePitchFeatureImpl::opts_</a></div><div class="ttdeci">PitchExtractionOptions opts_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00646">pitch-functions.cc:646</a></div></div>
<div class="ttc" id="namespacekaldi_html_aad870ff0d8ab280cf7019385213ab252"><div class="ttname"><a href="namespacekaldi.html#aad870ff0d8ab280cf7019385213ab252">kaldi::ComputeNccf</a></div><div class="ttdeci">void ComputeNccf(const VectorBase&lt; BaseFloat &gt; &amp;inner_prod, const VectorBase&lt; BaseFloat &gt; &amp;norm_prod, BaseFloat nccf_ballast, VectorBase&lt; BaseFloat &gt; *nccf_vec)</div><div class="ttdoc">Computes the NCCF as a fraction of the numerator term (a dot product between two vectors) and a denom...</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00131">pitch-functions.cc:131</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a145a2a9ef62123289bd18524cf6a19ac"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a145a2a9ef62123289bd18524cf6a19ac">kaldi::OnlinePitchFeatureImpl::downsampled_samples_processed_</a></div><div class="ttdeci">int64 downsampled_samples_processed_</div><div class="ttdoc">downsampled_samples_processed is the number of samples (after downsampling) that we got in previous c...</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00707">pitch-functions.cc:707</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_abb8b9d748b4fd69949732bbfbc8b99d1"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#abb8b9d748b4fd69949732bbfbc8b99d1">kaldi::OnlinePitchFeatureImpl::frames_latency_</a></div><div class="ttdeci">int32 frames_latency_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00680">pitch-functions.cc:680</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a2e2790b474cf0b02c140393fec0d108c"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a2e2790b474cf0b02c140393fec0d108c">kaldi::OnlinePitchFeatureImpl::NumFramesAvailable</a></div><div class="ttdeci">int32 NumFramesAvailable(int64 num_downsampled_samples, bool snip_edges) const</div><div class="ttdoc">This function works out from the signal how many frames are currently available to process (this is c...</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00768">pitch-functions.cc:768</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a074ffd9deb8e58b1765830aab0a424f8"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a074ffd9deb8e58b1765830aab0a424f8">kaldi::OnlinePitchFeatureImpl::nccf_info_</a></div><div class="ttdeci">std::vector&lt; NccfInfo * &gt; nccf_info_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00675">pitch-functions.cc:675</a></div></div>
<div class="ttc" id="structkaldi_1_1PitchExtractionOptions_html_a9ff3e6c88fef66369c0f3b0e92f7cd57"><div class="ttname"><a href="structkaldi_1_1PitchExtractionOptions.html#a9ff3e6c88fef66369c0f3b0e92f7cd57">kaldi::PitchExtractionOptions::snip_edges</a></div><div class="ttdeci">bool snip_edges</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8h_source.html#l00112">pitch-functions.h:112</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a3e1142480851bd84b41838ed2fa7d86c"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a3e1142480851bd84b41838ed2fa7d86c">kaldi::OnlinePitchFeatureImpl::signal_resampler_</a></div><div class="ttdeci">LinearResample * signal_resampler_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00664">pitch-functions.cc:664</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a50a4e42f8aa942d39dcbc18ac35c6044"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a50a4e42f8aa942d39dcbc18ac35c6044">kaldi::OnlinePitchFeatureImpl::lag_nccf_</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; int32, BaseFloat &gt; &gt; lag_nccf_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00693">pitch-functions.cc:693</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a60ff780ecb67fc68147b8a93a7903114"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a60ff780ecb67fc68147b8a93a7903114">kaldi::OnlinePitchFeatureImpl::UpdateRemainder</a></div><div class="ttdeci">void UpdateRemainder(const VectorBase&lt; BaseFloat &gt; &amp;downsampled_wave_part)</div><div class="ttdoc">This function updates downsampled_signal_remainder_, downsampled_samples_processed_, signal_sum_ and signal_sumsq_; it&amp;#39;s called from AcceptWaveform(). </div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00794">pitch-functions.cc:794</a></div></div>
<div class="ttc" id="namespacekaldi_html_a9138e190fe6864dccb41f35a4232ea63"><div class="ttname"><a href="namespacekaldi.html#a9138e190fe6864dccb41f35a4232ea63">kaldi::ComputeCorrelation</a></div><div class="ttdeci">void ComputeCorrelation(const VectorBase&lt; BaseFloat &gt; &amp;wave, int32 first_lag, int32 last_lag, int32 nccf_window_size, VectorBase&lt; BaseFloat &gt; *inner_prod, VectorBase&lt; BaseFloat &gt; *norm_prod)</div><div class="ttdoc">This function computes some dot products that are required while computing the NCCF. </div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00102">pitch-functions.cc:102</a></div></div>
<div class="ttc" id="structkaldi_1_1PitchExtractionOptions_html_a803d884fa5668ce0949df59b75ad91ba"><div class="ttname"><a href="structkaldi_1_1PitchExtractionOptions.html#a803d884fa5668ce0949df59b75ad91ba">kaldi::PitchExtractionOptions::NccfWindowSize</a></div><div class="ttdeci">int32 NccfWindowSize() const</div><div class="ttdoc">Returns the window-size in samples, after resampling. </div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8h_source.html#l00203">pitch-functions.h:203</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="group__error__group_html_ga16c81ec6ff3ba04c6ff96fdaed9d854e"><div class="ttname"><a href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a></div><div class="ttdeci">#define KALDI_VLOG(v)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00135">kaldi-error.h:135</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_ab681b385e3eb01292d20489015dc831b"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#ab681b385e3eb01292d20489015dc831b">kaldi::OnlinePitchFeatureImpl::forward_cost_remainder_</a></div><div class="ttdeci">double forward_cost_remainder_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00688">pitch-functions.cc:688</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a28321a9272fde604ee386906c9f15af7"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a28321a9272fde604ee386906c9f15af7">kaldi::OnlinePitchFeatureImpl::signal_sumsq_</a></div><div class="ttdeci">double signal_sumsq_</div><div class="ttdoc">sum-squared of previously processed parts of signal; used to get NCCF ballast term. </div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00699">pitch-functions.cc:699</a></div></div>
<div class="ttc" id="group__matrix__funcs__scalar_html_ga4750cd6f7a02a013435779588056b153"><div class="ttname"><a href="group__matrix__funcs__scalar.html#ga4750cd6f7a02a013435779588056b153">kaldi::VecVec</a></div><div class="ttdeci">Real VecVec(const VectorBase&lt; Real &gt; &amp;a, const VectorBase&lt; Real &gt; &amp;b)</div><div class="ttdoc">Returns dot product between v1 and v2. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l00037">kaldi-vector.cc:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6db7dfbac0d670f69c3754ed195b3c61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6db7dfbac0d670f69c3754ed195b3c61">&#9670;&nbsp;</a></span>Dim()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 Dim </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00578">578</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;{ <span class="keywordflow">return</span> 2; }</div></div><!-- fragment -->
</div>
</div>
<a id="a649e5859ff2651bcf21b60ad751d69d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a649e5859ff2651bcf21b60ad751d69d9">&#9670;&nbsp;</a></span>ExtractFrame()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ExtractFrame </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>downsampled_wave_part</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64&#160;</td>
          <td class="paramname"><em>frame_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; *&#160;</td>
          <td class="paramname"><em>window</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function extracts from the signal the samples numbered from "sample_index" (numbered in the full downsampled signal, not just this part), and of length equal to window-&gt;<a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a6db7dfbac0d670f69c3754ed195b3c61">Dim()</a>. </p>
<p>It uses the data members downsampled_samples_discarded_ and downsampled_signal_remainder_, as well as the more recent part of the downsampled wave "downsampled_wave_part" which is provided.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">downsampled_wave_part</td><td>One chunk of the downsampled wave, starting from sample-index downsampled_samples_discarded_. </td></tr>
    <tr><td class="paramname">sample_index</td><td>The desired starting sample index (measured from the start of the whole signal, not just this part). </td></tr>
    <tr><td class="paramname">window</td><td>The part of the signal is output to here. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00839">839</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">References <a class="el" href="kaldi-vector_8cc_source.html#l00228">VectorBase&lt; Real &gt;::CopyFromVec()</a>, <a class="el" href="kaldi-vector_8h_source.html#l00063">VectorBase&lt; Real &gt;::Dim()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00707">OnlinePitchFeatureImpl::downsampled_samples_processed_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00711">OnlinePitchFeatureImpl::downsampled_signal_remainder_</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="pitch-functions_8cc_source.html#l00695">OnlinePitchFeatureImpl::input_finished_</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="pitch-functions_8cc_source.html#l00646">OnlinePitchFeatureImpl::opts_</a>, <a class="el" href="pitch-functions_8h_source.html#l00047">PitchExtractionOptions::preemph_coeff</a>, <a class="el" href="kaldi-vector_8h_source.html#l00093">VectorBase&lt; Real &gt;::Range()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00288">VectorBase&lt; Real &gt;::SetZero()</a>, and <a class="el" href="pitch-functions_8h_source.html#l00112">PitchExtractionOptions::snip_edges</a>.</p>

<p class="reference">Referenced by <a class="el" href="pitch-functions_8cc_source.html#l01046">OnlinePitchFeatureImpl::AcceptWaveform()</a>.</p>
<div class="fragment"><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                                   {</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  int32 full_frame_length = window-&gt;Dim();</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  int32 offset = <span class="keyword">static_cast&lt;</span>int32<span class="keyword">&gt;</span>(sample_index -</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                                    <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a145a2a9ef62123289bd18524cf6a19ac">downsampled_samples_processed_</a>);</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <span class="comment">// Treat edge cases first</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <span class="keywordflow">if</span> (sample_index &lt; 0) {</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="comment">// Part of the frame is before the beginning of the signal. This</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="comment">// should only happen if opts_.snip_edges == false, when we are</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="comment">// processing the first few frames of signal. In this case</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="comment">// we pad with zeros.</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#a9ff3e6c88fef66369c0f3b0e92f7cd57">snip_edges</a> == <span class="keyword">false</span>);</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    int32 sub_frame_length = sample_index + full_frame_length;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    int32 sub_frame_index = full_frame_length - sub_frame_length;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(sub_frame_length &gt; 0 &amp;&amp; sub_frame_index &gt; 0);</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    window-&gt;SetZero();</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    SubVector&lt;BaseFloat&gt; sub_window(*window, sub_frame_index, sub_frame_length);</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a649e5859ff2651bcf21b60ad751d69d9">ExtractFrame</a>(downsampled_wave_part, 0, &amp;sub_window);</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  }</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  <span class="keywordflow">if</span> (offset + full_frame_length &gt; downsampled_wave_part.Dim()) {</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="comment">// Requested frame is past end of the signal.  This should only happen if</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="comment">// input_finished_ == true, when we&#39;re flushing out the last couple of</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="comment">// frames of signal.  In this case we pad with zeros.</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#aacffa240aa012eb5bc6a2e9dd3ef3a59">input_finished_</a>);</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    int32 sub_frame_length = downsampled_wave_part.Dim() - offset;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(sub_frame_length &gt; 0);</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    window-&gt;SetZero();</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    SubVector&lt;BaseFloat&gt; sub_window(*window, 0, sub_frame_length);</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a649e5859ff2651bcf21b60ad751d69d9">ExtractFrame</a>(downsampled_wave_part, sample_index, &amp;sub_window);</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  }</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="comment">// &quot;offset&quot; is the offset of the start of the frame, into this</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  <span class="comment">// signal.</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <span class="keywordflow">if</span> (offset &gt;= 0) {</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="comment">// frame is full inside the new part of the signal.</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    window-&gt;CopyFromVec(downsampled_wave_part.Range(offset, full_frame_length));</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="comment">// frame is partly in the remainder and partly in the new part.</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    int32 remainder_offset = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a573d4f50811a6e765095c24c355a1fd3">downsampled_signal_remainder_</a>.Dim() + offset;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(remainder_offset &gt;= 0);  <span class="comment">// or we didn&#39;t keep enough remainder.</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(offset + full_frame_length &gt; 0);  <span class="comment">// or we should have</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                                                   <span class="comment">// processed this frame last</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                                                   <span class="comment">// time.</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    int32 old_length = -offset, new_length = offset + full_frame_length;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    window-&gt;Range(0, old_length).CopyFromVec(</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a573d4f50811a6e765095c24c355a1fd3">downsampled_signal_remainder_</a>.Range(remainder_offset, old_length));</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    window-&gt;Range(old_length, new_length).CopyFromVec(</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        downsampled_wave_part.Range(0, new_length));</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  }</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#a4aed8d41fcb5959c34712e00cf957ea6">preemph_coeff</a> != 0.0) {</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> preemph_coeff = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#a4aed8d41fcb5959c34712e00cf957ea6">preemph_coeff</a>;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = window-&gt;Dim() - 1; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt; 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>--)</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      (*window)(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) -= preemph_coeff * (*window)(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>-1);</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    (*window)(0) *= (1.0 - preemph_coeff);</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  }</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;}</div><div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a649e5859ff2651bcf21b60ad751d69d9"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a649e5859ff2651bcf21b60ad751d69d9">kaldi::OnlinePitchFeatureImpl::ExtractFrame</a></div><div class="ttdeci">void ExtractFrame(const VectorBase&lt; BaseFloat &gt; &amp;downsampled_wave_part, int64 frame_index, VectorBase&lt; BaseFloat &gt; *window)</div><div class="ttdoc">This function extracts from the signal the samples numbered from &quot;sample_index&quot; (numbered in the full...</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00839">pitch-functions.cc:839</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a573d4f50811a6e765095c24c355a1fd3"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a573d4f50811a6e765095c24c355a1fd3">kaldi::OnlinePitchFeatureImpl::downsampled_signal_remainder_</a></div><div class="ttdeci">Vector&lt; BaseFloat &gt; downsampled_signal_remainder_</div><div class="ttdoc">This is a small remainder of the previous downsampled signal; it&amp;#39;s used by ExtractFrame for frames ne...</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00711">pitch-functions.cc:711</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_aacffa240aa012eb5bc6a2e9dd3ef3a59"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#aacffa240aa012eb5bc6a2e9dd3ef3a59">kaldi::OnlinePitchFeatureImpl::input_finished_</a></div><div class="ttdeci">bool input_finished_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00695">pitch-functions.cc:695</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_adb66b8c72a5eaf1361d3bb1d5c85ae6a"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">kaldi::OnlinePitchFeatureImpl::opts_</a></div><div class="ttdeci">PitchExtractionOptions opts_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00646">pitch-functions.cc:646</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a145a2a9ef62123289bd18524cf6a19ac"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a145a2a9ef62123289bd18524cf6a19ac">kaldi::OnlinePitchFeatureImpl::downsampled_samples_processed_</a></div><div class="ttdeci">int64 downsampled_samples_processed_</div><div class="ttdoc">downsampled_samples_processed is the number of samples (after downsampling) that we got in previous c...</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00707">pitch-functions.cc:707</a></div></div>
<div class="ttc" id="structkaldi_1_1PitchExtractionOptions_html_a9ff3e6c88fef66369c0f3b0e92f7cd57"><div class="ttname"><a href="structkaldi_1_1PitchExtractionOptions.html#a9ff3e6c88fef66369c0f3b0e92f7cd57">kaldi::PitchExtractionOptions::snip_edges</a></div><div class="ttdeci">bool snip_edges</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8h_source.html#l00112">pitch-functions.h:112</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="structkaldi_1_1PitchExtractionOptions_html_a4aed8d41fcb5959c34712e00cf957ea6"><div class="ttname"><a href="structkaldi_1_1PitchExtractionOptions.html#a4aed8d41fcb5959c34712e00cf957ea6">kaldi::PitchExtractionOptions::preemph_coeff</a></div><div class="ttdeci">BaseFloat preemph_coeff</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8h_source.html#l00047">pitch-functions.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab6c879cd7bb2077a2d6a089ed085fefb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6c879cd7bb2077a2d6a089ed085fefb">&#9670;&nbsp;</a></span>FrameShiftInSeconds()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> FrameShiftInSeconds </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00909">909</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">References <a class="el" href="pitch-functions_8h_source.html#l00045">PitchExtractionOptions::frame_shift_ms</a>, and <a class="el" href="pitch-functions_8cc_source.html#l00646">OnlinePitchFeatureImpl::opts_</a>.</p>

<p class="reference">Referenced by <a class="el" href="pitch-functions_8cc_source.html#l01215">OnlinePitchFeature::FrameShiftInSeconds()</a>.</p>
<div class="fragment"><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                                                            {</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#a9e286e640aca45ae4b56f769284886b7">frame_shift_ms</a> / 1000.0f;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;}</div><div class="ttc" id="structkaldi_1_1PitchExtractionOptions_html_a9e286e640aca45ae4b56f769284886b7"><div class="ttname"><a href="structkaldi_1_1PitchExtractionOptions.html#a9e286e640aca45ae4b56f769284886b7">kaldi::PitchExtractionOptions::frame_shift_ms</a></div><div class="ttdeci">BaseFloat frame_shift_ms</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8h_source.html#l00045">pitch-functions.h:45</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_adb66b8c72a5eaf1361d3bb1d5c85ae6a"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">kaldi::OnlinePitchFeatureImpl::opts_</a></div><div class="ttdeci">PitchExtractionOptions opts_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00646">pitch-functions.cc:646</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afeef84368a0238c6c170d37e2c6b07dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeef84368a0238c6c170d37e2c6b07dc">&#9670;&nbsp;</a></span>GetFrame()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GetFrame </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; *&#160;</td>
          <td class="paramname"><em>feat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00921">921</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">References <a class="el" href="kaldi-vector_8h_source.html#l00063">VectorBase&lt; Real &gt;::Dim()</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="pitch-functions_8cc_source.html#l00693">OnlinePitchFeatureImpl::lag_nccf_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00654">OnlinePitchFeatureImpl::lags_</a>, and <a class="el" href="pitch-functions_8cc_source.html#l00913">OnlinePitchFeatureImpl::NumFramesReady()</a>.</p>

<p class="reference">Referenced by <a class="el" href="pitch-functions_8cc_source.html#l01219">OnlinePitchFeature::GetFrame()</a>.</p>
<div class="fragment"><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                                                                   {</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(frame &lt; <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a816b68dc299cc3ed745ba1f3036bc3cd">NumFramesReady</a>() &amp;&amp; feat-&gt;Dim() == 2);</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  (*feat)(0) = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a50a4e42f8aa942d39dcbc18ac35c6044">lag_nccf_</a>[frame].second;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  (*feat)(1) = 1.0 / <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a8efe898284c62c9639d5b5cdb26a5b7f">lags_</a>(<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a50a4e42f8aa942d39dcbc18ac35c6044">lag_nccf_</a>[frame].first);</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;}</div><div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a8efe898284c62c9639d5b5cdb26a5b7f"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a8efe898284c62c9639d5b5cdb26a5b7f">kaldi::OnlinePitchFeatureImpl::lags_</a></div><div class="ttdeci">Vector&lt; BaseFloat &gt; lags_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00654">pitch-functions.cc:654</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a50a4e42f8aa942d39dcbc18ac35c6044"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a50a4e42f8aa942d39dcbc18ac35c6044">kaldi::OnlinePitchFeatureImpl::lag_nccf_</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; int32, BaseFloat &gt; &gt; lag_nccf_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00693">pitch-functions.cc:693</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a816b68dc299cc3ed745ba1f3036bc3cd"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a816b68dc299cc3ed745ba1f3036bc3cd">kaldi::OnlinePitchFeatureImpl::NumFramesReady</a></div><div class="ttdeci">int32 NumFramesReady() const</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00913">pitch-functions.cc:913</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a639c1eee3381eb54c22c6f791af01bb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a639c1eee3381eb54c22c6f791af01bb5">&#9670;&nbsp;</a></span>InputFinished()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void InputFinished </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00928">928</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">References <a class="el" href="pitch-functions_8cc_source.html#l01046">OnlinePitchFeatureImpl::AcceptWaveform()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00688">OnlinePitchFeatureImpl::forward_cost_remainder_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00668">OnlinePitchFeatureImpl::frame_info_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00680">OnlinePitchFeatureImpl::frames_latency_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00695">OnlinePitchFeatureImpl::input_finished_</a>, <a class="el" href="kaldi-error_8h_source.html#l00135">KALDI_VLOG</a>, <a class="el" href="pitch-functions_8h_source.html#l00111">PitchExtractionOptions::nccf_ballast_online</a>, <a class="el" href="pitch-functions_8cc_source.html#l00646">OnlinePitchFeatureImpl::opts_</a>, <a class="el" href="pitch-functions_8h_source.html#l00104">PitchExtractionOptions::recompute_frame</a>, <a class="el" href="pitch-functions_8cc_source.html#l00945">OnlinePitchFeatureImpl::RecomputeBacktraces()</a>, and <a class="el" href="pitch-functions_8h_source.html#l00044">PitchExtractionOptions::samp_freq</a>.</p>

<p class="reference">Referenced by <a class="el" href="pitch-functions_8cc_source.html#l01229">OnlinePitchFeature::InputFinished()</a>.</p>
<div class="fragment"><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                                           {</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#aacffa240aa012eb5bc6a2e9dd3ef3a59">input_finished_</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  <span class="comment">// Process an empty waveform; this has an effect because</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <span class="comment">// after setting input_finished_ to true, NumFramesAvailable()</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  <span class="comment">// will return a slightly larger number.</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a622e8436805cef0c95f96b232bddd00e">AcceptWaveform</a>(<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#a814c23fceef9259caed333e631974807">samp_freq</a>, Vector&lt;BaseFloat&gt;());</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  int32 num_frames = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5921b1b4f2eb6fb2c3f9cba2b62a5041">frame_info_</a>.size() - 1);</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <span class="keywordflow">if</span> (num_frames &lt; <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#a293dda65e3de1db818a210a9f982d522">recompute_frame</a> &amp;&amp; !<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#a7f1b3c2276f20e69d0fe6673472a95db">nccf_ballast_online</a>)</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#ae03e1460950b461f939b45f6218a57e5">RecomputeBacktraces</a>();</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#abb8b9d748b4fd69949732bbfbc8b99d1">frames_latency_</a> = 0;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <a class="code" href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a>(3) &lt;&lt; <span class="stringliteral">&quot;Pitch-tracking Viterbi cost is &quot;</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                &lt;&lt; (<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#ab681b385e3eb01292d20489015dc831b">forward_cost_remainder_</a> / num_frames)</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; per frame, over &quot;</span> &lt;&lt; num_frames &lt;&lt; <span class="stringliteral">&quot; frames.&quot;</span>;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;}</div><div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a5921b1b4f2eb6fb2c3f9cba2b62a5041"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5921b1b4f2eb6fb2c3f9cba2b62a5041">kaldi::OnlinePitchFeatureImpl::frame_info_</a></div><div class="ttdeci">std::vector&lt; PitchFrameInfo * &gt; frame_info_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00668">pitch-functions.cc:668</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a622e8436805cef0c95f96b232bddd00e"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a622e8436805cef0c95f96b232bddd00e">kaldi::OnlinePitchFeatureImpl::AcceptWaveform</a></div><div class="ttdeci">void AcceptWaveform(BaseFloat sampling_rate, const VectorBase&lt; BaseFloat &gt; &amp;waveform)</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l01046">pitch-functions.cc:1046</a></div></div>
<div class="ttc" id="structkaldi_1_1PitchExtractionOptions_html_a7f1b3c2276f20e69d0fe6673472a95db"><div class="ttname"><a href="structkaldi_1_1PitchExtractionOptions.html#a7f1b3c2276f20e69d0fe6673472a95db">kaldi::PitchExtractionOptions::nccf_ballast_online</a></div><div class="ttdeci">bool nccf_ballast_online</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8h_source.html#l00111">pitch-functions.h:111</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_aacffa240aa012eb5bc6a2e9dd3ef3a59"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#aacffa240aa012eb5bc6a2e9dd3ef3a59">kaldi::OnlinePitchFeatureImpl::input_finished_</a></div><div class="ttdeci">bool input_finished_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00695">pitch-functions.cc:695</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_ae03e1460950b461f939b45f6218a57e5"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#ae03e1460950b461f939b45f6218a57e5">kaldi::OnlinePitchFeatureImpl::RecomputeBacktraces</a></div><div class="ttdeci">void RecomputeBacktraces()</div><div class="ttdoc">This function is called after we reach frame &quot;recompute_frame&quot;, or when InputFinished() is called...</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00945">pitch-functions.cc:945</a></div></div>
<div class="ttc" id="structkaldi_1_1PitchExtractionOptions_html_a293dda65e3de1db818a210a9f982d522"><div class="ttname"><a href="structkaldi_1_1PitchExtractionOptions.html#a293dda65e3de1db818a210a9f982d522">kaldi::PitchExtractionOptions::recompute_frame</a></div><div class="ttdeci">int32 recompute_frame</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8h_source.html#l00104">pitch-functions.h:104</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_adb66b8c72a5eaf1361d3bb1d5c85ae6a"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">kaldi::OnlinePitchFeatureImpl::opts_</a></div><div class="ttdeci">PitchExtractionOptions opts_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00646">pitch-functions.cc:646</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_abb8b9d748b4fd69949732bbfbc8b99d1"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#abb8b9d748b4fd69949732bbfbc8b99d1">kaldi::OnlinePitchFeatureImpl::frames_latency_</a></div><div class="ttdeci">int32 frames_latency_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00680">pitch-functions.cc:680</a></div></div>
<div class="ttc" id="group__error__group_html_ga16c81ec6ff3ba04c6ff96fdaed9d854e"><div class="ttname"><a href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a></div><div class="ttdeci">#define KALDI_VLOG(v)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00135">kaldi-error.h:135</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_ab681b385e3eb01292d20489015dc831b"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#ab681b385e3eb01292d20489015dc831b">kaldi::OnlinePitchFeatureImpl::forward_cost_remainder_</a></div><div class="ttdeci">double forward_cost_remainder_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00688">pitch-functions.cc:688</a></div></div>
<div class="ttc" id="structkaldi_1_1PitchExtractionOptions_html_a814c23fceef9259caed333e631974807"><div class="ttname"><a href="structkaldi_1_1PitchExtractionOptions.html#a814c23fceef9259caed333e631974807">kaldi::PitchExtractionOptions::samp_freq</a></div><div class="ttdeci">BaseFloat samp_freq</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8h_source.html#l00044">pitch-functions.h:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adf789f1122e6886e209aa0f149f8fd45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf789f1122e6886e209aa0f149f8fd45">&#9670;&nbsp;</a></span>IsLastFrame()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> IsLastFrame </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>frame</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00903">903</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">References <a class="el" href="pitch-functions_8cc_source.html#l00695">OnlinePitchFeatureImpl::input_finished_</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, and <a class="el" href="pitch-functions_8cc_source.html#l00913">OnlinePitchFeatureImpl::NumFramesReady()</a>.</p>

<p class="reference">Referenced by <a class="el" href="pitch-functions_8cc_source.html#l01211">OnlinePitchFeature::IsLastFrame()</a>.</p>
<div class="fragment"><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                                                          {</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  int32 T = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a816b68dc299cc3ed745ba1f3036bc3cd">NumFramesReady</a>();</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(frame &lt; T);</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  <span class="keywordflow">return</span> (<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#aacffa240aa012eb5bc6a2e9dd3ef3a59">input_finished_</a> &amp;&amp; frame + 1 == T);</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;}</div><div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_aacffa240aa012eb5bc6a2e9dd3ef3a59"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#aacffa240aa012eb5bc6a2e9dd3ef3a59">kaldi::OnlinePitchFeatureImpl::input_finished_</a></div><div class="ttdeci">bool input_finished_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00695">pitch-functions.cc:695</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a816b68dc299cc3ed745ba1f3036bc3cd"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a816b68dc299cc3ed745ba1f3036bc3cd">kaldi::OnlinePitchFeatureImpl::NumFramesReady</a></div><div class="ttdeci">int32 NumFramesReady() const</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00913">pitch-functions.cc:913</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2e2790b474cf0b02c140393fec0d108c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e2790b474cf0b02c140393fec0d108c">&#9670;&nbsp;</a></span>NumFramesAvailable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 NumFramesAvailable </td>
          <td>(</td>
          <td class="paramtype">int64&#160;</td>
          <td class="paramname"><em>num_downsampled_samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>snip_edges</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function works out from the signal how many frames are currently available to process (this is called from inside <a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a622e8436805cef0c95f96b232bddd00e">AcceptWaveform()</a>). </p>
<p>Note: the number of frames differs slightly from the number the old pitch code gave. Note: the number this returns depends on whether input_finished_ == true; if it is, it will "force out" a final frame or two. </p>

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00768">768</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">References <a class="el" href="pitch-functions_8cc_source.html#l00695">OnlinePitchFeatureImpl::input_finished_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00651">OnlinePitchFeatureImpl::nccf_last_lag_</a>, <a class="el" href="pitch-functions_8h_source.html#l00207">PitchExtractionOptions::NccfWindowShift()</a>, <a class="el" href="pitch-functions_8h_source.html#l00203">PitchExtractionOptions::NccfWindowSize()</a>, and <a class="el" href="pitch-functions_8cc_source.html#l00646">OnlinePitchFeatureImpl::opts_</a>.</p>

<p class="reference">Referenced by <a class="el" href="pitch-functions_8cc_source.html#l01046">OnlinePitchFeatureImpl::AcceptWaveform()</a>.</p>
<div class="fragment"><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                                                          {</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  int32 frame_shift = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#aba781b9846354b930637853c6f66ba24">NccfWindowShift</a>(),</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      frame_length = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#a803d884fa5668ce0949df59b75ad91ba">NccfWindowSize</a>();</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <span class="comment">// Use the &quot;full frame length&quot; to compute the number</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  <span class="comment">// of frames only if the input is not finished.</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#aacffa240aa012eb5bc6a2e9dd3ef3a59">input_finished_</a>)</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    frame_length += <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a0b005b3fdf280bbb7081f678bfecbf34">nccf_last_lag_</a>;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <span class="keywordflow">if</span> (num_downsampled_samples &lt; frame_length) {</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="keywordflow">if</span> (!snip_edges) {</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#aacffa240aa012eb5bc6a2e9dd3ef3a59">input_finished_</a>) {</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>int32<span class="keyword">&gt;</span>(num_downsampled_samples * 1.0f /</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                                  frame_shift + 0.5f);</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>int32<span class="keyword">&gt;</span>((num_downsampled_samples - frame_length / 2) *</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                                   1.0f / frame_shift + 0.5f);</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      }</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>int32<span class="keyword">&gt;</span>((num_downsampled_samples - frame_length) /</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                                 frame_shift + 1);</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    }</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  }</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;}</div><div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a0b005b3fdf280bbb7081f678bfecbf34"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a0b005b3fdf280bbb7081f678bfecbf34">kaldi::OnlinePitchFeatureImpl::nccf_last_lag_</a></div><div class="ttdeci">int32 nccf_last_lag_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00651">pitch-functions.cc:651</a></div></div>
<div class="ttc" id="structkaldi_1_1PitchExtractionOptions_html_aba781b9846354b930637853c6f66ba24"><div class="ttname"><a href="structkaldi_1_1PitchExtractionOptions.html#aba781b9846354b930637853c6f66ba24">kaldi::PitchExtractionOptions::NccfWindowShift</a></div><div class="ttdeci">int32 NccfWindowShift() const</div><div class="ttdoc">Returns the window-shift in samples, after resampling. </div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8h_source.html#l00207">pitch-functions.h:207</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_aacffa240aa012eb5bc6a2e9dd3ef3a59"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#aacffa240aa012eb5bc6a2e9dd3ef3a59">kaldi::OnlinePitchFeatureImpl::input_finished_</a></div><div class="ttdeci">bool input_finished_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00695">pitch-functions.cc:695</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_adb66b8c72a5eaf1361d3bb1d5c85ae6a"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">kaldi::OnlinePitchFeatureImpl::opts_</a></div><div class="ttdeci">PitchExtractionOptions opts_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00646">pitch-functions.cc:646</a></div></div>
<div class="ttc" id="structkaldi_1_1PitchExtractionOptions_html_a803d884fa5668ce0949df59b75ad91ba"><div class="ttname"><a href="structkaldi_1_1PitchExtractionOptions.html#a803d884fa5668ce0949df59b75ad91ba">kaldi::PitchExtractionOptions::NccfWindowSize</a></div><div class="ttdeci">int32 NccfWindowSize() const</div><div class="ttdoc">Returns the window-size in samples, after resampling. </div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8h_source.html#l00203">pitch-functions.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a816b68dc299cc3ed745ba1f3036bc3cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a816b68dc299cc3ed745ba1f3036bc3cd">&#9670;&nbsp;</a></span>NumFramesReady()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32 NumFramesReady </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00913">913</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">References <a class="el" href="pitch-functions_8cc_source.html#l00680">OnlinePitchFeatureImpl::frames_latency_</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, and <a class="el" href="pitch-functions_8cc_source.html#l00693">OnlinePitchFeatureImpl::lag_nccf_</a>.</p>

<p class="reference">Referenced by <a class="el" href="pitch-functions_8cc_source.html#l00921">OnlinePitchFeatureImpl::GetFrame()</a>, and <a class="el" href="pitch-functions_8cc_source.html#l00903">OnlinePitchFeatureImpl::IsLastFrame()</a>.</p>
<div class="fragment"><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                                                   {</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  int32 num_frames = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a50a4e42f8aa942d39dcbc18ac35c6044">lag_nccf_</a>.size(),</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      latency = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#abb8b9d748b4fd69949732bbfbc8b99d1">frames_latency_</a>;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(latency &lt;= num_frames);</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  <span class="keywordflow">return</span> num_frames - latency;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;}</div><div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_abb8b9d748b4fd69949732bbfbc8b99d1"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#abb8b9d748b4fd69949732bbfbc8b99d1">kaldi::OnlinePitchFeatureImpl::frames_latency_</a></div><div class="ttdeci">int32 frames_latency_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00680">pitch-functions.cc:680</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a50a4e42f8aa942d39dcbc18ac35c6044"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a50a4e42f8aa942d39dcbc18ac35c6044">kaldi::OnlinePitchFeatureImpl::lag_nccf_</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; int32, BaseFloat &gt; &gt; lag_nccf_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00693">pitch-functions.cc:693</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae03e1460950b461f939b45f6218a57e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae03e1460950b461f939b45f6218a57e5">&#9670;&nbsp;</a></span>RecomputeBacktraces()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void RecomputeBacktraces </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function is called after we reach frame "recompute_frame", or when <a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a639c1eee3381eb54c22c6f791af01bb5">InputFinished()</a> is called, whichever comes sooner. </p>
<p>It recomputes the backtraces for frames zero through recompute_frame, if needed because the average energy of the signal has changed, affecting the nccf ballast term. It works out the average signal energy from downsampled_samples_processed_, signal_sum_ and signal_sumsq_ (which, if you see the calling code, might include more frames than just "recompute_frame", it might include up to the end of the current chunk). </p>

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00945">945</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">References <a class="el" href="kaldi-math_8h_source.html#l00264">kaldi::ApproxEqual()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00707">OnlinePitchFeatureImpl::downsampled_samples_processed_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00685">OnlinePitchFeatureImpl::forward_cost_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00688">OnlinePitchFeatureImpl::forward_cost_remainder_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00668">OnlinePitchFeatureImpl::frame_info_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00680">OnlinePitchFeatureImpl::frames_latency_</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00135">KALDI_VLOG</a>, <a class="el" href="pitch-functions_8cc_source.html#l00693">OnlinePitchFeatureImpl::lag_nccf_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00654">OnlinePitchFeatureImpl::lags_</a>, <a class="el" href="pitch-functions_8h_source.html#l00074">PitchExtractionOptions::max_frames_latency</a>, <a class="el" href="pitch-functions_8h_source.html#l00057">PitchExtractionOptions::nccf_ballast</a>, <a class="el" href="pitch-functions_8h_source.html#l00111">PitchExtractionOptions::nccf_ballast_online</a>, <a class="el" href="pitch-functions_8cc_source.html#l00675">OnlinePitchFeatureImpl::nccf_info_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00558">NccfInfo::nccf_pitch_resampled</a>, <a class="el" href="pitch-functions_8h_source.html#l00203">PitchExtractionOptions::NccfWindowSize()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00646">OnlinePitchFeatureImpl::opts_</a>, <a class="el" href="pitch-functions_8h_source.html#l00104">PitchExtractionOptions::recompute_frame</a>, <a class="el" href="pitch-functions_8cc_source.html#l00703">OnlinePitchFeatureImpl::signal_sum_</a>, and <a class="el" href="pitch-functions_8cc_source.html#l00699">OnlinePitchFeatureImpl::signal_sumsq_</a>.</p>

<p class="reference">Referenced by <a class="el" href="pitch-functions_8cc_source.html#l01046">OnlinePitchFeatureImpl::AcceptWaveform()</a>, and <a class="el" href="pitch-functions_8cc_source.html#l00928">OnlinePitchFeatureImpl::InputFinished()</a>.</p>
<div class="fragment"><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                                                 {</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#a7f1b3c2276f20e69d0fe6673472a95db">nccf_ballast_online</a>);</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  int32 num_frames = <span class="keyword">static_cast&lt;</span>int32<span class="keyword">&gt;</span>(<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5921b1b4f2eb6fb2c3f9cba2b62a5041">frame_info_</a>.size()) - 1;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <span class="comment">// The assertion reflects how we believe this function will be called.</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(num_frames &lt;= <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#a293dda65e3de1db818a210a9f982d522">recompute_frame</a>);</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a074ffd9deb8e58b1765830aab0a424f8">nccf_info_</a>.size() == <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(num_frames));</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  <span class="keywordflow">if</span> (num_frames == 0)</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  <span class="keywordtype">double</span> num_samp = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a145a2a9ef62123289bd18524cf6a19ac">downsampled_samples_processed_</a>, sum = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5d48827066f901d2aaa77439bef176df">signal_sum_</a>,</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;      sumsq = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a28321a9272fde604ee386906c9f15af7">signal_sumsq_</a>, mean = sum / num_samp;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> mean_square = sumsq / num_samp - mean * mean;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  <span class="keywordtype">bool</span> must_recompute = <span class="keyword">false</span>;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> threshold = 0.01;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  <span class="keywordflow">for</span> (int32 frame = 0; frame &lt; num_frames; frame++)</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi.html#a99dcbb9fdaa6c980ba67941d45adf017">ApproxEqual</a>(<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a074ffd9deb8e58b1765830aab0a424f8">nccf_info_</a>[frame]-&gt;mean_square_energy,</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                     mean_square, threshold))</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      must_recompute = <span class="keyword">true</span>;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  <span class="keywordflow">if</span> (!must_recompute) {</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="comment">// Nothing to do.  We&#39;ll reach here, for instance, if everything was in one</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="comment">// chunk and opts_.nccf_ballast_online == false.  This is the case for</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="comment">// offline processing.</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a074ffd9deb8e58b1765830aab0a424f8">nccf_info_</a>.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      <span class="keyword">delete</span> <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a074ffd9deb8e58b1765830aab0a424f8">nccf_info_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a074ffd9deb8e58b1765830aab0a424f8">nccf_info_</a>.clear();</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  }</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  int32 num_states = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#ae6b3331ec2fea8340aab94f2255df602">forward_cost_</a>.Dim(),</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      basic_frame_length = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#a803d884fa5668ce0949df59b75ad91ba">NccfWindowSize</a>();</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> new_nccf_ballast = pow(mean_square * basic_frame_length, 2) *</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#accf1f11585d50c8e5bb7ea3640f63ad3">nccf_ballast</a>;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  <span class="keywordtype">double</span> forward_cost_remainder = 0.0;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  Vector&lt;BaseFloat&gt; forward_cost(num_states),  <span class="comment">// start off at zero.</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;      next_forward_cost(forward_cost);</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  std::vector&lt;std::pair&lt;int32, int32 &gt; &gt; index_info;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  <span class="keywordflow">for</span> (int32 frame = 0; frame &lt; num_frames; frame++) {</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    NccfInfo &amp;nccf_info = *<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a074ffd9deb8e58b1765830aab0a424f8">nccf_info_</a>[frame];</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> old_mean_square = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a074ffd9deb8e58b1765830aab0a424f8">nccf_info_</a>[frame]-&gt;mean_square_energy,</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        avg_norm_prod = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a074ffd9deb8e58b1765830aab0a424f8">nccf_info_</a>[frame]-&gt;avg_norm_prod,</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        old_nccf_ballast = pow(old_mean_square * basic_frame_length, 2) *</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#accf1f11585d50c8e5bb7ea3640f63ad3">nccf_ballast</a>,</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        nccf_scale = pow((old_nccf_ballast + avg_norm_prod) /</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                         (new_nccf_ballast + avg_norm_prod),</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                         static_cast&lt;BaseFloat&gt;(0.5));</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="comment">// The &quot;nccf_scale&quot; is an estimate of the scaling factor by which the NCCF</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <span class="comment">// would change on this frame, on average, by changing the ballast term from</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="comment">// &quot;old_nccf_ballast&quot; to &quot;new_nccf_ballast&quot;.  It&#39;s not exact because the</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="comment">// &quot;avg_norm_prod&quot; is just an average of the product e1 * e2 of frame</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="comment">// energies of the (frame, shifted-frame), but these won&#39;t change that much</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="comment">// within a frame, and even if they do, the inaccuracy of the scaled NCCF</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="comment">// will still be very small if the ballast term didn&#39;t change much, or if</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="comment">// it&#39;s much larger or smaller than e1*e2.  By doing it as a simple scaling,</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <span class="comment">// we save the overhead of the NCCF resampling, which is a considerable part</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <span class="comment">// of the whole computation.</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    nccf_info.nccf_pitch_resampled.Scale(nccf_scale);</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5921b1b4f2eb6fb2c3f9cba2b62a5041">frame_info_</a>[frame + 1]-&gt;ComputeBacktraces(</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>, nccf_info.nccf_pitch_resampled, <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a8efe898284c62c9639d5b5cdb26a5b7f">lags_</a>,</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        forward_cost, &amp;index_info, &amp;next_forward_cost);</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    forward_cost.Swap(&amp;next_forward_cost);</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> remainder = forward_cost.Min();</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    forward_cost_remainder += remainder;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    forward_cost.Add(-remainder);</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  }</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  <a class="code" href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a>(3) &lt;&lt; <span class="stringliteral">&quot;Forward-cost per frame changed from &quot;</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                &lt;&lt; (<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#ab681b385e3eb01292d20489015dc831b">forward_cost_remainder_</a> / num_frames) &lt;&lt; <span class="stringliteral">&quot; to &quot;</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                &lt;&lt; (forward_cost_remainder / num_frames);</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#ab681b385e3eb01292d20489015dc831b">forward_cost_remainder_</a> = forward_cost_remainder;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#ae6b3331ec2fea8340aab94f2255df602">forward_cost_</a>.Swap(&amp;forward_cost);</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  int32 best_final_state;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#ae6b3331ec2fea8340aab94f2255df602">forward_cost_</a>.Min(&amp;best_final_state);</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a50a4e42f8aa942d39dcbc18ac35c6044">lag_nccf_</a>.size() != <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(num_frames))</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a50a4e42f8aa942d39dcbc18ac35c6044">lag_nccf_</a>.resize(num_frames);</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5921b1b4f2eb6fb2c3f9cba2b62a5041">frame_info_</a>.back()-&gt;SetBestState(best_final_state, <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a50a4e42f8aa942d39dcbc18ac35c6044">lag_nccf_</a>);</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#abb8b9d748b4fd69949732bbfbc8b99d1">frames_latency_</a> =</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5921b1b4f2eb6fb2c3f9cba2b62a5041">frame_info_</a>.back()-&gt;ComputeLatency(<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#a3e2582c6c7a6411141a8e20b750d63c0">max_frames_latency</a>);</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a074ffd9deb8e58b1765830aab0a424f8">nccf_info_</a>.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a074ffd9deb8e58b1765830aab0a424f8">nccf_info_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a074ffd9deb8e58b1765830aab0a424f8">nccf_info_</a>.clear();</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;}</div><div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a5921b1b4f2eb6fb2c3f9cba2b62a5041"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5921b1b4f2eb6fb2c3f9cba2b62a5041">kaldi::OnlinePitchFeatureImpl::frame_info_</a></div><div class="ttdeci">std::vector&lt; PitchFrameInfo * &gt; frame_info_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00668">pitch-functions.cc:668</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a8efe898284c62c9639d5b5cdb26a5b7f"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a8efe898284c62c9639d5b5cdb26a5b7f">kaldi::OnlinePitchFeatureImpl::lags_</a></div><div class="ttdeci">Vector&lt; BaseFloat &gt; lags_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00654">pitch-functions.cc:654</a></div></div>
<div class="ttc" id="structkaldi_1_1PitchExtractionOptions_html_accf1f11585d50c8e5bb7ea3640f63ad3"><div class="ttname"><a href="structkaldi_1_1PitchExtractionOptions.html#accf1f11585d50c8e5bb7ea3640f63ad3">kaldi::PitchExtractionOptions::nccf_ballast</a></div><div class="ttdeci">BaseFloat nccf_ballast</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8h_source.html#l00057">pitch-functions.h:57</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a5d48827066f901d2aaa77439bef176df"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5d48827066f901d2aaa77439bef176df">kaldi::OnlinePitchFeatureImpl::signal_sum_</a></div><div class="ttdeci">double signal_sum_</div><div class="ttdoc">sum of previously processed parts of signal; used to do mean-subtraction when getting sum-squared...</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00703">pitch-functions.cc:703</a></div></div>
<div class="ttc" id="structkaldi_1_1PitchExtractionOptions_html_a3e2582c6c7a6411141a8e20b750d63c0"><div class="ttname"><a href="structkaldi_1_1PitchExtractionOptions.html#a3e2582c6c7a6411141a8e20b750d63c0">kaldi::PitchExtractionOptions::max_frames_latency</a></div><div class="ttdeci">int32 max_frames_latency</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8h_source.html#l00074">pitch-functions.h:74</a></div></div>
<div class="ttc" id="structkaldi_1_1PitchExtractionOptions_html_a7f1b3c2276f20e69d0fe6673472a95db"><div class="ttname"><a href="structkaldi_1_1PitchExtractionOptions.html#a7f1b3c2276f20e69d0fe6673472a95db">kaldi::PitchExtractionOptions::nccf_ballast_online</a></div><div class="ttdeci">bool nccf_ballast_online</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8h_source.html#l00111">pitch-functions.h:111</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="structkaldi_1_1PitchExtractionOptions_html_a293dda65e3de1db818a210a9f982d522"><div class="ttname"><a href="structkaldi_1_1PitchExtractionOptions.html#a293dda65e3de1db818a210a9f982d522">kaldi::PitchExtractionOptions::recompute_frame</a></div><div class="ttdeci">int32 recompute_frame</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8h_source.html#l00104">pitch-functions.h:104</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_ae6b3331ec2fea8340aab94f2255df602"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#ae6b3331ec2fea8340aab94f2255df602">kaldi::OnlinePitchFeatureImpl::forward_cost_</a></div><div class="ttdeci">Vector&lt; BaseFloat &gt; forward_cost_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00685">pitch-functions.cc:685</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_adb66b8c72a5eaf1361d3bb1d5c85ae6a"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">kaldi::OnlinePitchFeatureImpl::opts_</a></div><div class="ttdeci">PitchExtractionOptions opts_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00646">pitch-functions.cc:646</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a145a2a9ef62123289bd18524cf6a19ac"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a145a2a9ef62123289bd18524cf6a19ac">kaldi::OnlinePitchFeatureImpl::downsampled_samples_processed_</a></div><div class="ttdeci">int64 downsampled_samples_processed_</div><div class="ttdoc">downsampled_samples_processed is the number of samples (after downsampling) that we got in previous c...</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00707">pitch-functions.cc:707</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_abb8b9d748b4fd69949732bbfbc8b99d1"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#abb8b9d748b4fd69949732bbfbc8b99d1">kaldi::OnlinePitchFeatureImpl::frames_latency_</a></div><div class="ttdeci">int32 frames_latency_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00680">pitch-functions.cc:680</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a074ffd9deb8e58b1765830aab0a424f8"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a074ffd9deb8e58b1765830aab0a424f8">kaldi::OnlinePitchFeatureImpl::nccf_info_</a></div><div class="ttdeci">std::vector&lt; NccfInfo * &gt; nccf_info_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00675">pitch-functions.cc:675</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a50a4e42f8aa942d39dcbc18ac35c6044"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a50a4e42f8aa942d39dcbc18ac35c6044">kaldi::OnlinePitchFeatureImpl::lag_nccf_</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; int32, BaseFloat &gt; &gt; lag_nccf_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00693">pitch-functions.cc:693</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="structkaldi_1_1PitchExtractionOptions_html_a803d884fa5668ce0949df59b75ad91ba"><div class="ttname"><a href="structkaldi_1_1PitchExtractionOptions.html#a803d884fa5668ce0949df59b75ad91ba">kaldi::PitchExtractionOptions::NccfWindowSize</a></div><div class="ttdeci">int32 NccfWindowSize() const</div><div class="ttdoc">Returns the window-size in samples, after resampling. </div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8h_source.html#l00203">pitch-functions.h:203</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="group__error__group_html_ga16c81ec6ff3ba04c6ff96fdaed9d854e"><div class="ttname"><a href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a></div><div class="ttdeci">#define KALDI_VLOG(v)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00135">kaldi-error.h:135</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_ab681b385e3eb01292d20489015dc831b"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#ab681b385e3eb01292d20489015dc831b">kaldi::OnlinePitchFeatureImpl::forward_cost_remainder_</a></div><div class="ttdeci">double forward_cost_remainder_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00688">pitch-functions.cc:688</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a28321a9272fde604ee386906c9f15af7"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a28321a9272fde604ee386906c9f15af7">kaldi::OnlinePitchFeatureImpl::signal_sumsq_</a></div><div class="ttdeci">double signal_sumsq_</div><div class="ttdoc">sum-squared of previously processed parts of signal; used to get NCCF ballast term. </div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00699">pitch-functions.cc:699</a></div></div>
<div class="ttc" id="namespacekaldi_html_a99dcbb9fdaa6c980ba67941d45adf017"><div class="ttname"><a href="namespacekaldi.html#a99dcbb9fdaa6c980ba67941d45adf017">kaldi::ApproxEqual</a></div><div class="ttdeci">static bool ApproxEqual(float a, float b, float relative_tolerance=0.001)</div><div class="ttdoc">return abs(a - b) &lt;= relative_tolerance * (abs(a)+abs(b)). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8h_source.html#l00264">kaldi-math.h:264</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a60ff780ecb67fc68147b8a93a7903114"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60ff780ecb67fc68147b8a93a7903114">&#9670;&nbsp;</a></span>UpdateRemainder()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void UpdateRemainder </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>downsampled_wave_part</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function updates downsampled_signal_remainder_, downsampled_samples_processed_, signal_sum_ and signal_sumsq_; it's called from <a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a622e8436805cef0c95f96b232bddd00e">AcceptWaveform()</a>. </p>

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00794">794</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">References <a class="el" href="kaldi-vector_8h_source.html#l00063">VectorBase&lt; Real &gt;::Dim()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00707">OnlinePitchFeatureImpl::downsampled_samples_processed_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00711">OnlinePitchFeatureImpl::downsampled_signal_remainder_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00668">OnlinePitchFeatureImpl::frame_info_</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="pitch-functions_8cc_source.html#l00651">OnlinePitchFeatureImpl::nccf_last_lag_</a>, <a class="el" href="pitch-functions_8h_source.html#l00207">PitchExtractionOptions::NccfWindowShift()</a>, <a class="el" href="pitch-functions_8h_source.html#l00203">PitchExtractionOptions::NccfWindowSize()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00646">OnlinePitchFeatureImpl::opts_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00703">OnlinePitchFeatureImpl::signal_sum_</a>, <a class="el" href="pitch-functions_8cc_source.html#l00699">OnlinePitchFeatureImpl::signal_sumsq_</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00693">VectorBase&lt; Real &gt;::Sum()</a>, and <a class="el" href="kaldi-vector_8cc_source.html#l00037">kaldi::VecVec()</a>.</p>

<p class="reference">Referenced by <a class="el" href="pitch-functions_8cc_source.html#l01046">OnlinePitchFeatureImpl::AcceptWaveform()</a>.</p>
<div class="fragment"><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                                                        {</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <span class="comment">// frame_info_ has an extra element at frame-1, so subtract</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="comment">// one from the length.</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  int64 num_frames = <span class="keyword">static_cast&lt;</span>int64<span class="keyword">&gt;</span>(<a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5921b1b4f2eb6fb2c3f9cba2b62a5041">frame_info_</a>.size()) - 1,</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      next_frame = num_frames,</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      frame_shift = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#aba781b9846354b930637853c6f66ba24">NccfWindowShift</a>(),</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      next_frame_sample = frame_shift * next_frame;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a28321a9272fde604ee386906c9f15af7">signal_sumsq_</a> += <a class="code" href="group__matrix__funcs__scalar.html#ga4750cd6f7a02a013435779588056b153">VecVec</a>(downsampled_wave_part, downsampled_wave_part);</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5d48827066f901d2aaa77439bef176df">signal_sum_</a> += downsampled_wave_part.Sum();</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <span class="comment">// next_frame_sample is the first sample index we&#39;ll need for the</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <span class="comment">// next frame.</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  int64 next_downsampled_samples_processed =</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a145a2a9ef62123289bd18524cf6a19ac">downsampled_samples_processed_</a> + downsampled_wave_part.Dim();</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <span class="keywordflow">if</span> (next_frame_sample &gt; next_downsampled_samples_processed) {</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="comment">// this could only happen in the weird situation that the full frame length</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="comment">// is less than the frame shift.</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    int32 full_frame_length = <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">opts_</a>.<a class="code" href="structkaldi_1_1PitchExtractionOptions.html#a803d884fa5668ce0949df59b75ad91ba">NccfWindowSize</a>() + <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a0b005b3fdf280bbb7081f678bfecbf34">nccf_last_lag_</a>;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(full_frame_length &lt; frame_shift &amp;&amp; <span class="stringliteral">&quot;Code error&quot;</span>);</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a573d4f50811a6e765095c24c355a1fd3">downsampled_signal_remainder_</a>.Resize(0);</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    Vector&lt;BaseFloat&gt; new_remainder(next_downsampled_samples_processed -</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                                    next_frame_sample);</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="comment">// note: next_frame_sample is the index into the entire signal, of</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="comment">// new_remainder(0).</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="comment">// i is the absolute index of the signal.</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="keywordflow">for</span> (int64 <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = next_frame_sample;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;         <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; next_downsampled_samples_processed; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt;= <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a145a2a9ef62123289bd18524cf6a19ac">downsampled_samples_processed_</a>) {  <span class="comment">// in current signal.</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        new_remainder(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> - next_frame_sample) =</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            downsampled_wave_part(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> - <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a145a2a9ef62123289bd18524cf6a19ac">downsampled_samples_processed_</a>);</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      } <span class="keywordflow">else</span> {  <span class="comment">// in old remainder; only reach here if waveform supplied is</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        new_remainder(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> - next_frame_sample) =                      <span class="comment">//  tiny.</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a573d4f50811a6e765095c24c355a1fd3">downsampled_signal_remainder_</a>(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> - <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a145a2a9ef62123289bd18524cf6a19ac">downsampled_samples_processed_</a> +</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                                          <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a573d4f50811a6e765095c24c355a1fd3">downsampled_signal_remainder_</a>.Dim());</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      }</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    }</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a573d4f50811a6e765095c24c355a1fd3">downsampled_signal_remainder_</a>.Swap(&amp;new_remainder);</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  }</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <a class="code" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a145a2a9ef62123289bd18524cf6a19ac">downsampled_samples_processed_</a> = next_downsampled_samples_processed;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;}</div><div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a5921b1b4f2eb6fb2c3f9cba2b62a5041"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5921b1b4f2eb6fb2c3f9cba2b62a5041">kaldi::OnlinePitchFeatureImpl::frame_info_</a></div><div class="ttdeci">std::vector&lt; PitchFrameInfo * &gt; frame_info_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00668">pitch-functions.cc:668</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a5d48827066f901d2aaa77439bef176df"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a5d48827066f901d2aaa77439bef176df">kaldi::OnlinePitchFeatureImpl::signal_sum_</a></div><div class="ttdeci">double signal_sum_</div><div class="ttdoc">sum of previously processed parts of signal; used to do mean-subtraction when getting sum-squared...</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00703">pitch-functions.cc:703</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a0b005b3fdf280bbb7081f678bfecbf34"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a0b005b3fdf280bbb7081f678bfecbf34">kaldi::OnlinePitchFeatureImpl::nccf_last_lag_</a></div><div class="ttdeci">int32 nccf_last_lag_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00651">pitch-functions.cc:651</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a573d4f50811a6e765095c24c355a1fd3"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a573d4f50811a6e765095c24c355a1fd3">kaldi::OnlinePitchFeatureImpl::downsampled_signal_remainder_</a></div><div class="ttdeci">Vector&lt; BaseFloat &gt; downsampled_signal_remainder_</div><div class="ttdoc">This is a small remainder of the previous downsampled signal; it&amp;#39;s used by ExtractFrame for frames ne...</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00711">pitch-functions.cc:711</a></div></div>
<div class="ttc" id="structkaldi_1_1PitchExtractionOptions_html_aba781b9846354b930637853c6f66ba24"><div class="ttname"><a href="structkaldi_1_1PitchExtractionOptions.html#aba781b9846354b930637853c6f66ba24">kaldi::PitchExtractionOptions::NccfWindowShift</a></div><div class="ttdeci">int32 NccfWindowShift() const</div><div class="ttdoc">Returns the window-shift in samples, after resampling. </div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8h_source.html#l00207">pitch-functions.h:207</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_adb66b8c72a5eaf1361d3bb1d5c85ae6a"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#adb66b8c72a5eaf1361d3bb1d5c85ae6a">kaldi::OnlinePitchFeatureImpl::opts_</a></div><div class="ttdeci">PitchExtractionOptions opts_</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00646">pitch-functions.cc:646</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a145a2a9ef62123289bd18524cf6a19ac"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a145a2a9ef62123289bd18524cf6a19ac">kaldi::OnlinePitchFeatureImpl::downsampled_samples_processed_</a></div><div class="ttdeci">int64 downsampled_samples_processed_</div><div class="ttdoc">downsampled_samples_processed is the number of samples (after downsampling) that we got in previous c...</div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00707">pitch-functions.cc:707</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="structkaldi_1_1PitchExtractionOptions_html_a803d884fa5668ce0949df59b75ad91ba"><div class="ttname"><a href="structkaldi_1_1PitchExtractionOptions.html#a803d884fa5668ce0949df59b75ad91ba">kaldi::PitchExtractionOptions::NccfWindowSize</a></div><div class="ttdeci">int32 NccfWindowSize() const</div><div class="ttdoc">Returns the window-size in samples, after resampling. </div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8h_source.html#l00203">pitch-functions.h:203</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlinePitchFeatureImpl_html_a28321a9272fde604ee386906c9f15af7"><div class="ttname"><a href="classkaldi_1_1OnlinePitchFeatureImpl.html#a28321a9272fde604ee386906c9f15af7">kaldi::OnlinePitchFeatureImpl::signal_sumsq_</a></div><div class="ttdeci">double signal_sumsq_</div><div class="ttdoc">sum-squared of previously processed parts of signal; used to get NCCF ballast term. </div><div class="ttdef"><b>Definition:</b> <a href="pitch-functions_8cc_source.html#l00699">pitch-functions.cc:699</a></div></div>
<div class="ttc" id="group__matrix__funcs__scalar_html_ga4750cd6f7a02a013435779588056b153"><div class="ttname"><a href="group__matrix__funcs__scalar.html#ga4750cd6f7a02a013435779588056b153">kaldi::VecVec</a></div><div class="ttdeci">Real VecVec(const VectorBase&lt; Real &gt; &amp;a, const VectorBase&lt; Real &gt; &amp;b)</div><div class="ttdoc">Returns dot product between v1 and v2. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l00037">kaldi-vector.cc:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a145a2a9ef62123289bd18524cf6a19ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a145a2a9ef62123289bd18524cf6a19ac">&#9670;&nbsp;</a></span>downsampled_samples_processed_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int64 downsampled_samples_processed_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>downsampled_samples_processed is the number of samples (after downsampling) that we got in previous calls to <a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a622e8436805cef0c95f96b232bddd00e">AcceptWaveform()</a>. </p>

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00707">707</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="pitch-functions_8cc_source.html#l01046">OnlinePitchFeatureImpl::AcceptWaveform()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00839">OnlinePitchFeatureImpl::ExtractFrame()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00945">OnlinePitchFeatureImpl::RecomputeBacktraces()</a>, and <a class="el" href="pitch-functions_8cc_source.html#l00794">OnlinePitchFeatureImpl::UpdateRemainder()</a>.</p>

</div>
</div>
<a id="a573d4f50811a6e765095c24c355a1fd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a573d4f50811a6e765095c24c355a1fd3">&#9670;&nbsp;</a></span>downsampled_signal_remainder_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1Vector.html">Vector</a>&lt;<a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a>&gt; downsampled_signal_remainder_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This is a small remainder of the previous downsampled signal; it's used by ExtractFrame for frames near the boundary of two waveforms supplied to <a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html#a622e8436805cef0c95f96b232bddd00e">AcceptWaveform()</a>. </p>

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00711">711</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="pitch-functions_8cc_source.html#l00839">OnlinePitchFeatureImpl::ExtractFrame()</a>, and <a class="el" href="pitch-functions_8cc_source.html#l00794">OnlinePitchFeatureImpl::UpdateRemainder()</a>.</p>

</div>
</div>
<a id="ae6b3331ec2fea8340aab94f2255df602"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6b3331ec2fea8340aab94f2255df602">&#9670;&nbsp;</a></span>forward_cost_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1Vector.html">Vector</a>&lt;<a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a>&gt; forward_cost_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00685">685</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="pitch-functions_8cc_source.html#l01046">OnlinePitchFeatureImpl::AcceptWaveform()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00715">OnlinePitchFeatureImpl::OnlinePitchFeatureImpl()</a>, and <a class="el" href="pitch-functions_8cc_source.html#l00945">OnlinePitchFeatureImpl::RecomputeBacktraces()</a>.</p>

</div>
</div>
<a id="ab681b385e3eb01292d20489015dc831b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab681b385e3eb01292d20489015dc831b">&#9670;&nbsp;</a></span>forward_cost_remainder_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double forward_cost_remainder_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00688">688</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="pitch-functions_8cc_source.html#l01046">OnlinePitchFeatureImpl::AcceptWaveform()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00928">OnlinePitchFeatureImpl::InputFinished()</a>, and <a class="el" href="pitch-functions_8cc_source.html#l00945">OnlinePitchFeatureImpl::RecomputeBacktraces()</a>.</p>

</div>
</div>
<a id="a5921b1b4f2eb6fb2c3f9cba2b62a5041"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5921b1b4f2eb6fb2c3f9cba2b62a5041">&#9670;&nbsp;</a></span>frame_info_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classkaldi_1_1PitchFrameInfo.html">PitchFrameInfo</a>*&gt; frame_info_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00668">668</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="pitch-functions_8cc_source.html#l01046">OnlinePitchFeatureImpl::AcceptWaveform()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00928">OnlinePitchFeatureImpl::InputFinished()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00715">OnlinePitchFeatureImpl::OnlinePitchFeatureImpl()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00945">OnlinePitchFeatureImpl::RecomputeBacktraces()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00794">OnlinePitchFeatureImpl::UpdateRemainder()</a>, and <a class="el" href="pitch-functions_8cc_source.html#l01037">OnlinePitchFeatureImpl::~OnlinePitchFeatureImpl()</a>.</p>

</div>
</div>
<a id="abb8b9d748b4fd69949732bbfbc8b99d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb8b9d748b4fd69949732bbfbc8b99d1">&#9670;&nbsp;</a></span>frames_latency_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 frames_latency_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00680">680</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="pitch-functions_8cc_source.html#l01046">OnlinePitchFeatureImpl::AcceptWaveform()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00928">OnlinePitchFeatureImpl::InputFinished()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00913">OnlinePitchFeatureImpl::NumFramesReady()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00715">OnlinePitchFeatureImpl::OnlinePitchFeatureImpl()</a>, and <a class="el" href="pitch-functions_8cc_source.html#l00945">OnlinePitchFeatureImpl::RecomputeBacktraces()</a>.</p>

</div>
</div>
<a id="aacffa240aa012eb5bc6a2e9dd3ef3a59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacffa240aa012eb5bc6a2e9dd3ef3a59">&#9670;&nbsp;</a></span>input_finished_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> input_finished_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00695">695</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="pitch-functions_8cc_source.html#l01046">OnlinePitchFeatureImpl::AcceptWaveform()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00839">OnlinePitchFeatureImpl::ExtractFrame()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00928">OnlinePitchFeatureImpl::InputFinished()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00903">OnlinePitchFeatureImpl::IsLastFrame()</a>, and <a class="el" href="pitch-functions_8cc_source.html#l00768">OnlinePitchFeatureImpl::NumFramesAvailable()</a>.</p>

</div>
</div>
<a id="a50a4e42f8aa942d39dcbc18ac35c6044"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50a4e42f8aa942d39dcbc18ac35c6044">&#9670;&nbsp;</a></span>lag_nccf_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::pair&lt;int32, <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a>&gt; &gt; lag_nccf_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00693">693</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="pitch-functions_8cc_source.html#l01046">OnlinePitchFeatureImpl::AcceptWaveform()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00921">OnlinePitchFeatureImpl::GetFrame()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00913">OnlinePitchFeatureImpl::NumFramesReady()</a>, and <a class="el" href="pitch-functions_8cc_source.html#l00945">OnlinePitchFeatureImpl::RecomputeBacktraces()</a>.</p>

</div>
</div>
<a id="a8efe898284c62c9639d5b5cdb26a5b7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8efe898284c62c9639d5b5cdb26a5b7f">&#9670;&nbsp;</a></span>lags_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1Vector.html">Vector</a>&lt;<a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a>&gt; lags_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00654">654</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="pitch-functions_8cc_source.html#l01046">OnlinePitchFeatureImpl::AcceptWaveform()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00921">OnlinePitchFeatureImpl::GetFrame()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00715">OnlinePitchFeatureImpl::OnlinePitchFeatureImpl()</a>, and <a class="el" href="pitch-functions_8cc_source.html#l00945">OnlinePitchFeatureImpl::RecomputeBacktraces()</a>.</p>

</div>
</div>
<a id="aa0fa922a998005cb0ceb48d167b3743a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0fa922a998005cb0ceb48d167b3743a">&#9670;&nbsp;</a></span>nccf_first_lag_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 nccf_first_lag_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00649">649</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="pitch-functions_8cc_source.html#l01046">OnlinePitchFeatureImpl::AcceptWaveform()</a>, and <a class="el" href="pitch-functions_8cc_source.html#l00715">OnlinePitchFeatureImpl::OnlinePitchFeatureImpl()</a>.</p>

</div>
</div>
<a id="a074ffd9deb8e58b1765830aab0a424f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a074ffd9deb8e58b1765830aab0a424f8">&#9670;&nbsp;</a></span>nccf_info_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structkaldi_1_1NccfInfo.html">NccfInfo</a>*&gt; nccf_info_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00675">675</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="pitch-functions_8cc_source.html#l01046">OnlinePitchFeatureImpl::AcceptWaveform()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00945">OnlinePitchFeatureImpl::RecomputeBacktraces()</a>, and <a class="el" href="pitch-functions_8cc_source.html#l01037">OnlinePitchFeatureImpl::~OnlinePitchFeatureImpl()</a>.</p>

</div>
</div>
<a id="a0b005b3fdf280bbb7081f678bfecbf34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b005b3fdf280bbb7081f678bfecbf34">&#9670;&nbsp;</a></span>nccf_last_lag_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 nccf_last_lag_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00651">651</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="pitch-functions_8cc_source.html#l01046">OnlinePitchFeatureImpl::AcceptWaveform()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00768">OnlinePitchFeatureImpl::NumFramesAvailable()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00715">OnlinePitchFeatureImpl::OnlinePitchFeatureImpl()</a>, and <a class="el" href="pitch-functions_8cc_source.html#l00794">OnlinePitchFeatureImpl::UpdateRemainder()</a>.</p>

</div>
</div>
<a id="a09bb1a83f1f8fcc242910e7b948bf91f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09bb1a83f1f8fcc242910e7b948bf91f">&#9670;&nbsp;</a></span>nccf_resampler_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1ArbitraryResample.html">ArbitraryResample</a>* nccf_resampler_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00659">659</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="pitch-functions_8cc_source.html#l01046">OnlinePitchFeatureImpl::AcceptWaveform()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00715">OnlinePitchFeatureImpl::OnlinePitchFeatureImpl()</a>, and <a class="el" href="pitch-functions_8cc_source.html#l01037">OnlinePitchFeatureImpl::~OnlinePitchFeatureImpl()</a>.</p>

</div>
</div>
<a id="adb66b8c72a5eaf1361d3bb1d5c85ae6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb66b8c72a5eaf1361d3bb1d5c85ae6a">&#9670;&nbsp;</a></span>opts_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structkaldi_1_1PitchExtractionOptions.html">PitchExtractionOptions</a> opts_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00646">646</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="pitch-functions_8cc_source.html#l01046">OnlinePitchFeatureImpl::AcceptWaveform()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00839">OnlinePitchFeatureImpl::ExtractFrame()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00909">OnlinePitchFeatureImpl::FrameShiftInSeconds()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00928">OnlinePitchFeatureImpl::InputFinished()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00768">OnlinePitchFeatureImpl::NumFramesAvailable()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00945">OnlinePitchFeatureImpl::RecomputeBacktraces()</a>, and <a class="el" href="pitch-functions_8cc_source.html#l00794">OnlinePitchFeatureImpl::UpdateRemainder()</a>.</p>

</div>
</div>
<a id="a3e1142480851bd84b41838ed2fa7d86c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e1142480851bd84b41838ed2fa7d86c">&#9670;&nbsp;</a></span>signal_resampler_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1LinearResample.html">LinearResample</a>* signal_resampler_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00664">664</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="pitch-functions_8cc_source.html#l01046">OnlinePitchFeatureImpl::AcceptWaveform()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00715">OnlinePitchFeatureImpl::OnlinePitchFeatureImpl()</a>, and <a class="el" href="pitch-functions_8cc_source.html#l01037">OnlinePitchFeatureImpl::~OnlinePitchFeatureImpl()</a>.</p>

</div>
</div>
<a id="a5d48827066f901d2aaa77439bef176df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d48827066f901d2aaa77439bef176df">&#9670;&nbsp;</a></span>signal_sum_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double signal_sum_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>sum of previously processed parts of signal; used to do mean-subtraction when getting sum-squared, along with signal_sumsq_. </p>

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00703">703</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="pitch-functions_8cc_source.html#l01046">OnlinePitchFeatureImpl::AcceptWaveform()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00945">OnlinePitchFeatureImpl::RecomputeBacktraces()</a>, and <a class="el" href="pitch-functions_8cc_source.html#l00794">OnlinePitchFeatureImpl::UpdateRemainder()</a>.</p>

</div>
</div>
<a id="a28321a9272fde604ee386906c9f15af7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28321a9272fde604ee386906c9f15af7">&#9670;&nbsp;</a></span>signal_sumsq_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double signal_sumsq_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>sum-squared of previously processed parts of signal; used to get NCCF ballast term. </p>
<p>Denominator is downsampled_samples_processed_. </p>

<p class="definition">Definition at line <a class="el" href="pitch-functions_8cc_source.html#l00699">699</a> of file <a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="pitch-functions_8cc_source.html#l01046">OnlinePitchFeatureImpl::AcceptWaveform()</a>, <a class="el" href="pitch-functions_8cc_source.html#l00945">OnlinePitchFeatureImpl::RecomputeBacktraces()</a>, and <a class="el" href="pitch-functions_8cc_source.html#l00794">OnlinePitchFeatureImpl::UpdateRemainder()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>feat/<a class="el" href="pitch-functions_8cc_source.html">pitch-functions.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacekaldi.html">kaldi</a></li><li class="navelem"><a class="el" href="classkaldi_1_1OnlinePitchFeatureImpl.html">OnlinePitchFeatureImpl</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
