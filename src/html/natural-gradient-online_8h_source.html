<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Kaldi: nnet3/natural-gradient-online.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" /> 
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
 <td id="projectlogo"><a href="http://kaldi-asr.org/"><img alt="Logo" src="KaldiTextAndLogoSmall.png"/ style="padding: 3px 5px 1px 5px"></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname" style="display:none">Kaldi
   </div>
  </td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief" style="display:none"></div>
    </td>
   <!--END PROJECT_BRIEF-->
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('natural-gradient-online_8h_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">natural-gradient-online.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="natural-gradient-online_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// nnet3/natural-gradient-online.h</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Copyright 2013-2015   Johns Hopkins University (author: Daniel Povey)</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// See ../../COPYING for clarification regarding multiple authors</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// you may not use this file except in compliance with the License.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// You may obtain a copy of the License at</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//  http://www.apache.org/licenses/LICENSE-2.0</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// THIS CODE IS PROVIDED *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// MERCHANTABLITY OR NON-INFRINGEMENT.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// See the Apache 2 License for the specific language governing permissions and</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// limitations under the License.</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#ifndef KALDI_NNET3_NATURAL_GRADIENT_ONLINE_H_</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#define KALDI_NNET3_NATURAL_GRADIENT_ONLINE_H_</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="kaldi-common_8h.html">base/kaldi-common.h</a>&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="matrix-lib_8h.html">matrix/matrix-lib.h</a>&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cu-matrix-lib_8h.html">cudamatrix/cu-matrix-lib.h</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacekaldi.html">kaldi</a> {</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">namespace </span>nnet3 {</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html">  414</a></span>&#160;<span class="keyword">class </span><a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html">OnlineNaturalGradient</a> {</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#ac415c4be36a5c62618b5d50c3d8868dd">OnlineNaturalGradient</a>();</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#afb9bffca178027f3e5d52ec73a1ee0fe">SetRank</a>(int32 rank);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#af830848160afd5bf477387d1c5825d8c">SetUpdatePeriod</a>(int32 update_period);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="comment">// num_samples_history is a time-constant (in samples) that determines eta.</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a92a77e900ccaf0f3a722e2a4a9dedb77">SetNumSamplesHistory</a>(<a class="code" href="classfloat.html">BaseFloat</a> num_samples_history);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="comment">// num_minibatches_history is a time-constant measured in minibatches that</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="comment">// provides an alternative way to set eta (the constant that determines how</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="comment">// fast we update the Fisher matrix).  If set to a value &gt;0, it overrides any</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="comment">// value of &#39;num_samples_history&#39; that is present.</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a6fa49a23b816a2a52721b7a8dcf0ce42">SetNumMinibatchesHistory</a>(<a class="code" href="classfloat.html">BaseFloat</a> num_minibatches_history);</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a885862c5b0a0cf88d75bee40f5cf29f2">SetAlpha</a>(<a class="code" href="classfloat.html">BaseFloat</a> alpha);</div><div class="line"><a name="l00429"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a35086953bbc759bd2ac9cb660d87d83f">  429</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a35086953bbc759bd2ac9cb660d87d83f">TurnOnDebug</a>() { <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a1bffda16ce504620d0ea2d1118cd0653">self_debug_</a> = <span class="keyword">true</span>; }</div><div class="line"><a name="l00430"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#acf6a1777407d36e2173dd1de0e60b322">  430</a></span>&#160;  <a class="code" href="classfloat.html">BaseFloat</a> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#acf6a1777407d36e2173dd1de0e60b322">GetNumSamplesHistory</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#af659a9e1c6ede20999b0996a58f97f34">num_samples_history_</a>; }</div><div class="line"><a name="l00431"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#ade740d3baed295663ceaa07aa6951099">  431</a></span>&#160;  <a class="code" href="classfloat.html">BaseFloat</a> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#ade740d3baed295663ceaa07aa6951099">GetNumMinibatchesHistory</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a44ea2235aeffb077900c6b2ece6f9c7b">num_minibatches_history_</a>; }</div><div class="line"><a name="l00432"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#aecff47257feb076ddd824437cd4bb760">  432</a></span>&#160;  <a class="code" href="classfloat.html">BaseFloat</a> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#aecff47257feb076ddd824437cd4bb760">GetAlpha</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a43efd606b8c638dd071888c30b741e91">alpha_</a>; }</div><div class="line"><a name="l00433"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a1fd2929c7565d8aeebac17374c7ae45d">  433</a></span>&#160;  int32 <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a1fd2929c7565d8aeebac17374c7ae45d">GetRank</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#af679b81005104cca1fc03ef8ee3b36d0">rank_</a>; }</div><div class="line"><a name="l00434"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a58d61a9b39bd466823c1d1710615dd90">  434</a></span>&#160;  int32 <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a58d61a9b39bd466823c1d1710615dd90">GetUpdatePeriod</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#ab35b32394fce8242b6fb4ae4ba4e54e1">update_period_</a>; }</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="comment">// see comment where &#39;frozen_&#39; is declared.</span></div><div class="line"><a name="l00437"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a73b9201eebf7d9e9179495c3025fa89e">  437</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a73b9201eebf7d9e9179495c3025fa89e">Freeze</a>(<span class="keywordtype">bool</span> frozen) { <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a72e3e9b2ee0ed5ab8aa688b9422d8138">frozen_</a> = frozen; }</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#aa3bcd897525db0c5caa855f1fe5b69ff">PreconditionDirections</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> *R,</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                              <a class="code" href="classfloat.html">BaseFloat</a> *scale);</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="comment">// Copy constructor.</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="keyword">explicit</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#ac415c4be36a5c62618b5d50c3d8868dd">OnlineNaturalGradient</a>(<span class="keyword">const</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html">OnlineNaturalGradient</a> &amp;other);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="comment">// Assignent operator</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html">OnlineNaturalGradient</a> &amp;<a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#ab5eb4e0382c25808345f1d7a963a148f">operator = </a>(<span class="keyword">const</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html">OnlineNaturalGradient</a> &amp;other);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="comment">// Shallow swap</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#aff2f0bd6b38f9056268da28ae91aa316">Swap</a>(<a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html">OnlineNaturalGradient</a> *other);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="comment">// This is an internal function called from PreconditionDirections().</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="comment">// Note: WJKL_t (dimension 2*R by D + R) is [ W_t L_t; J_t K_t ].</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#aa413657960e4ce64b0f6bdfa7d121ad2">PreconditionDirectionsInternal</a>(<span class="keyword">const</span> <a class="code" href="classfloat.html">BaseFloat</a> rho_t,</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                                      <span class="keyword">const</span> <a class="code" href="classfloat.html">BaseFloat</a> tr_X_Xt,</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                                      <span class="keywordtype">bool</span> updating,</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                                      <span class="keyword">const</span> <a class="code" href="classkaldi_1_1Vector.html">Vector&lt;BaseFloat&gt;</a> &amp;d_t,</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                                      <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> *WJKL_t,</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                                      <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> *X_t);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="comment">// Works out from t_ and various class variables whether we will update</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="comment">// the parameters on this iteration (returns true if so).</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a2ac3ca97170e3246ee3eafabdacc90c2">Updating</a>() <span class="keyword">const</span>;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a2bdc60d5b8ab06b11d20695a71da1024">ComputeEt</a>(<span class="keyword">const</span> <a class="code" href="classkaldi_1_1VectorBase.html">VectorBase&lt;BaseFloat&gt;</a> &amp;d_t,</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                 <a class="code" href="classfloat.html">BaseFloat</a> beta_t,</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                 <a class="code" href="classkaldi_1_1VectorBase.html">VectorBase&lt;BaseFloat&gt;</a> *e_t,</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                 <a class="code" href="classkaldi_1_1VectorBase.html">VectorBase&lt;BaseFloat&gt;</a> *sqrt_e_t,</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                 <a class="code" href="classkaldi_1_1VectorBase.html">VectorBase&lt;BaseFloat&gt;</a> *inv_sqrt_e_t) <span class="keyword">const</span>;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a9d2db282e47c56f778322ddf9631a0ee">ComputeZt</a>(int32 N,</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                 <a class="code" href="classfloat.html">BaseFloat</a> rho_t,</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                 <span class="keyword">const</span> <a class="code" href="classkaldi_1_1VectorBase.html">VectorBase&lt;BaseFloat&gt;</a> &amp;d_t,</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                 <span class="keyword">const</span> <a class="code" href="classkaldi_1_1VectorBase.html">VectorBase&lt;BaseFloat&gt;</a> &amp;inv_sqrt_e_t,</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                 <span class="keyword">const</span> <a class="code" href="classkaldi_1_1MatrixBase.html">MatrixBase&lt;BaseFloat&gt;</a> &amp;K_t,</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                 <span class="keyword">const</span> <a class="code" href="classkaldi_1_1MatrixBase.html">MatrixBase&lt;BaseFloat&gt;</a> &amp;L_t,</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                 <a class="code" href="classkaldi_1_1SpMatrix.html">SpMatrix&lt;double&gt;</a> *Z_t) <span class="keyword">const</span>;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="comment">// Computes W_{t+1}.  Overwrites J_t.</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#aa648b298424a1fc8789b6c7efa4d2c8d">ComputeWt1</a>(int32 N,</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classkaldi_1_1VectorBase.html">VectorBase&lt;BaseFloat&gt;</a> &amp;d_t,</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classkaldi_1_1VectorBase.html">VectorBase&lt;BaseFloat&gt;</a> &amp;d_t1,</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                  <a class="code" href="classfloat.html">BaseFloat</a> rho_t,</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                  <a class="code" href="classfloat.html">BaseFloat</a> rho_t1,</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classkaldi_1_1MatrixBase.html">MatrixBase&lt;BaseFloat&gt;</a> &amp;U_t,</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classkaldi_1_1VectorBase.html">VectorBase&lt;BaseFloat&gt;</a> &amp;sqrt_c_t,</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classkaldi_1_1VectorBase.html">VectorBase&lt;BaseFloat&gt;</a> &amp;inv_sqrt_e_t,</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> &amp;W_t,</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                  <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> *J_t,</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                  <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> *W_t1) <span class="keyword">const</span>;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="comment">// This function is called if C_t has high condition number; it makes sure</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <span class="comment">// that R_{t+1} is orthogonal.  See the section in the extended comment above</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="comment">// on &quot;keeping R_t orthogonal&quot;.</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a04f608ae169f9f8893c5611d379ce5ae">ReorthogonalizeXt1</a>(<span class="keyword">const</span> <a class="code" href="classkaldi_1_1VectorBase.html">VectorBase&lt;BaseFloat&gt;</a> &amp;d_t1,</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                          <a class="code" href="classfloat.html">BaseFloat</a> rho_t1,</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                          <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> *W_t1,</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                          <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> *temp_W,</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                          <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> *temp_O);</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#af101bbf82527b43a60a43a287270fd0f">Init</a>(<span class="keyword">const</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> &amp;R0);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="comment">// Initialize to some small &#39;default&#39; values, called from Init().  Init() then</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="comment">// does a few iterations of update with the first batch&#39;s data to give more</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="comment">// reasonable values.</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a8dcc86ffa0412cb5f8dcb8d6c98eca5a">InitDefault</a>(int32 D);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="comment">// initializes R, which is assumed to have at least as many columns as rows,</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="comment">// to a specially designed matrix with orthonormal rows, that has no zero rows</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="comment">// or columns.</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a898dc92e6358fb2aa0306c4ce31b3a7b">InitOrthonormalSpecial</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> *R);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="comment">// Returns the value eta (with 0 &lt; eta &lt; 1) which reflects how fast we update</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="comment">// the estimate of the Fisher matrix (larger == faster).  This is a function</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="comment">// rather than a constant because we set this indirectly, via</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <span class="comment">// num_samples_history_ or num_minibatches_history_.  The argument N is the</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="comment">// number of vectors we&#39;re preconditioning, which is the number of rows in the</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="comment">// argument R to PreconditionDirections(); you can think of it as the number</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="comment">// of vectors we&#39;re preconditioning (and in the common case it&#39;s some multiple</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="comment">// of the minibatch size)</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <a class="code" href="classfloat.html">BaseFloat</a> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#ae9146ef05a20cd050436475ff208c6ae">Eta</a>(int32 N) <span class="keyword">const</span>;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="comment">// called if self_debug_ = true, makes sure the members satisfy certain</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="comment">// properties.</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a1d419f9b6bc532b8960a93ce3f54f3be">SelfTest</a>() <span class="keyword">const</span>;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="comment">// Configuration values:</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="comment">// The rank of the correction to the unit matrix (e.g. 20).</span></div><div class="line"><a name="l00553"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#af679b81005104cca1fc03ef8ee3b36d0">  553</a></span>&#160;  int32 <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#af679b81005104cca1fc03ef8ee3b36d0">rank_</a>;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="comment">// After a few initial iterations of updating whenever we can, we start only</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="comment">// updating the Fisher-matrix parameters every &quot;update_period_&quot; minibatches;</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="comment">// this saves time.</span></div><div class="line"><a name="l00558"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#ab35b32394fce8242b6fb4ae4ba4e54e1">  558</a></span>&#160;  int32 <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#ab35b32394fce8242b6fb4ae4ba4e54e1">update_period_</a>;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="comment">// num_samples_history_ determines the value of eta, which in turn affects how</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <span class="comment">// fast we update our estimate of the covariance matrix.  We&#39;ve done it this</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="comment">// way in order to make it easy to have a single configuration value that</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <span class="comment">// doesn&#39;t have to be changed when we change the minibatch size.</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="comment">// Note: if num_minibatches_history_ is &gt;0.0, it overrides this.</span></div><div class="line"><a name="l00566"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#af659a9e1c6ede20999b0996a58f97f34">  566</a></span>&#160;  <a class="code" href="classfloat.html">BaseFloat</a> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#af659a9e1c6ede20999b0996a58f97f34">num_samples_history_</a>;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="comment">// num_minibatches_history_ is simpler alternative to num_samples_history_ for</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="comment">// determining the value of eta, which in turn affects how fast we update our</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="comment">// estimate of the covariance matrix.  eta will be set to 1.0 /</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="comment">// num_minibatches_history_.  We require that num_minibatches_history_ &gt; 0.0;</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="comment">// it will normally be something like 10.0, if set.  It makes sense to set</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="comment">// &#39;num_minibatches_history_&#39; when the rows of the matrix we are</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="comment">// preconditioning can&#39;t be interpreted as independent samples, so the number</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <span class="comment">// of rows is not relevant to determining how fast to update the covariance</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="comment">// matrix.</span></div><div class="line"><a name="l00578"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a44ea2235aeffb077900c6b2ece6f9c7b">  578</a></span>&#160;  <a class="code" href="classfloat.html">BaseFloat</a> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a44ea2235aeffb077900c6b2ece6f9c7b">num_minibatches_history_</a>;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <span class="comment">// alpha controls how much we smooth the Fisher matrix with the unit matrix.</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <span class="comment">// e.g. alpha = 4.0.</span></div><div class="line"><a name="l00583"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a43efd606b8c638dd071888c30b741e91">  583</a></span>&#160;  <a class="code" href="classfloat.html">BaseFloat</a> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a43efd606b8c638dd071888c30b741e91">alpha_</a>;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="comment">// epsilon is an absolute floor on the unit-matrix scaling factor rho_t in our</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="comment">// Fisher estimate, which we set to 1.0e-10.  We don&#39;t actually make this</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="comment">// configurable from the command line.  It&#39;s needed to avoid crashes on</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="comment">// all-zero inputs.</span></div><div class="line"><a name="l00589"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a008c4e6cc13410d1b983ad2b06fffeaf">  589</a></span>&#160;  <a class="code" href="classfloat.html">BaseFloat</a> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a008c4e6cc13410d1b983ad2b06fffeaf">epsilon_</a>;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="comment">// delta is a relative floor on the unit-matrix scaling factor rho_t in our</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="comment">// Fisher estimate, which we set to 1.0e-05: this is relative to the largest</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="comment">// value of D_t.  It&#39;s needed to control roundoff error.  We apply the same</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="comment">// floor to the eigenvalues in D_t.</span></div><div class="line"><a name="l00595"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#aa0ae63e5e17bafaf1ab9c9328517bb5b">  595</a></span>&#160;  <a class="code" href="classfloat.html">BaseFloat</a> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#aa0ae63e5e17bafaf1ab9c9328517bb5b">delta_</a>;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="comment">// this is set to true if the user has called the function Freeze(true), until</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="comment">// they call  Freeze(false).  It&#39;s used to disable the natural gradient</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="comment">// update (and stop incrementing t_).  However, if the object is uninitialized</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="comment">// (t_ == 0) it doesn&#39;t prevent it from being initialized.  This is used</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="comment">// in adversarial training to ensure that the Fisher matrix is updated only</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <span class="comment">// the *second* time we see the same data (to avoid biasing the update).</span></div><div class="line"><a name="l00603"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a72e3e9b2ee0ed5ab8aa688b9422d8138">  603</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a72e3e9b2ee0ed5ab8aa688b9422d8138">frozen_</a>;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <span class="comment">// t is a counter that measures how many times the user has previously called</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="comment">// PreconditionDirections(); it&#39;s 0 if that has never been called.</span></div><div class="line"><a name="l00607"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#abd17f633a8fc0939bc5bd0e83bd7153c">  607</a></span>&#160;  int32 <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#abd17f633a8fc0939bc5bd0e83bd7153c">t_</a>;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="comment">// If true, activates certain checks.</span></div><div class="line"><a name="l00610"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a1bffda16ce504620d0ea2d1118cd0653">  610</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a1bffda16ce504620d0ea2d1118cd0653">self_debug_</a>;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a5a1f65814903de3b91358880a8955c1c">  612</a></span>&#160;  <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a5a1f65814903de3b91358880a8955c1c">W_t_</a>;</div><div class="line"><a name="l00613"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a9c611c2de39a87a3ad90640fd024b048">  613</a></span>&#160;  <a class="code" href="classfloat.html">BaseFloat</a> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a9c611c2de39a87a3ad90640fd024b048">rho_t_</a>;</div><div class="line"><a name="l00614"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#af12dc036070d7e3229a0232e214c226e">  614</a></span>&#160;  <a class="code" href="classkaldi_1_1Vector.html">Vector&lt;BaseFloat&gt;</a> <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#af12dc036070d7e3229a0232e214c226e">d_t_</a>;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;};</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;} <span class="comment">// namespace nnet3</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;} <span class="comment">// namespace kaldi</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="namespacekaldi_html"><div class="ttname"><a href="namespacekaldi.html">kaldi</a></div><div class="ttdoc">Relabels neural network egs with the read pdf-id alignments. </div><div class="ttdef"><b>Definition:</b> <a href="chain_8dox_source.html#l00020">chain.dox:20</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_a898dc92e6358fb2aa0306c4ce31b3a7b"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a898dc92e6358fb2aa0306c4ce31b3a7b">kaldi::nnet3::OnlineNaturalGradient::InitOrthonormalSpecial</a></div><div class="ttdeci">static void InitOrthonormalSpecial(CuMatrixBase&lt; BaseFloat &gt; *R)</div><div class="ttdoc">This function creates a matrix with orthonormal rows that is like the following matrix, except with each row normalized to have unit 2-norm: [ 1.1 0 1 0 1 0 0 1.1 0 1 0 1 ] The reason why the first element in each row is 1.1 and not 1, is for symmetry-breaking... </div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8cc_source.html#l00046">natural-gradient-online.cc:46</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_a5a1f65814903de3b91358880a8955c1c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a5a1f65814903de3b91358880a8955c1c">kaldi::nnet3::OnlineNaturalGradient::W_t_</a></div><div class="ttdeci">CuMatrix&lt; BaseFloat &gt; W_t_</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8h_source.html#l00612">natural-gradient-online.h:612</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_ae9146ef05a20cd050436475ff208c6ae"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#ae9146ef05a20cd050436475ff208c6ae">kaldi::nnet3::OnlineNaturalGradient::Eta</a></div><div class="ttdeci">BaseFloat Eta(int32 N) const</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8cc_source.html#l00468">natural-gradient-online.cc:468</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_a1bffda16ce504620d0ea2d1118cd0653"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a1bffda16ce504620d0ea2d1118cd0653">kaldi::nnet3::OnlineNaturalGradient::self_debug_</a></div><div class="ttdeci">bool self_debug_</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8h_source.html#l00610">natural-gradient-online.h:610</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_a44ea2235aeffb077900c6b2ece6f9c7b"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a44ea2235aeffb077900c6b2ece6f9c7b">kaldi::nnet3::OnlineNaturalGradient::num_minibatches_history_</a></div><div class="ttdeci">BaseFloat num_minibatches_history_</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8h_source.html#l00578">natural-gradient-online.h:578</a></div></div>
<div class="ttc" id="classkaldi_1_1SpMatrix_html"><div class="ttname"><a href="classkaldi_1_1SpMatrix.html">kaldi::SpMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_af679b81005104cca1fc03ef8ee3b36d0"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#af679b81005104cca1fc03ef8ee3b36d0">kaldi::nnet3::OnlineNaturalGradient::rank_</a></div><div class="ttdeci">int32 rank_</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8h_source.html#l00553">natural-gradient-online.h:553</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_a8dcc86ffa0412cb5f8dcb8d6c98eca5a"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a8dcc86ffa0412cb5f8dcb8d6c98eca5a">kaldi::nnet3::OnlineNaturalGradient::InitDefault</a></div><div class="ttdeci">void InitDefault(int32 D)</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8cc_source.html#l00071">natural-gradient-online.cc:71</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_a73b9201eebf7d9e9179495c3025fa89e"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a73b9201eebf7d9e9179495c3025fa89e">kaldi::nnet3::OnlineNaturalGradient::Freeze</a></div><div class="ttdeci">void Freeze(bool frozen)</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8h_source.html#l00437">natural-gradient-online.h:437</a></div></div>
<div class="ttc" id="matrix-lib_8h_html"><div class="ttname"><a href="matrix-lib_8h.html">matrix-lib.h</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_af12dc036070d7e3229a0232e214c226e"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#af12dc036070d7e3229a0232e214c226e">kaldi::nnet3::OnlineNaturalGradient::d_t_</a></div><div class="ttdeci">Vector&lt; BaseFloat &gt; d_t_</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8h_source.html#l00614">natural-gradient-online.h:614</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_ab35b32394fce8242b6fb4ae4ba4e54e1"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#ab35b32394fce8242b6fb4ae4ba4e54e1">kaldi::nnet3::OnlineNaturalGradient::update_period_</a></div><div class="ttdeci">int32 update_period_</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8h_source.html#l00558">natural-gradient-online.h:558</a></div></div>
<div class="ttc" id="classkaldi_1_1MatrixBase_html"><div class="ttname"><a href="classkaldi_1_1MatrixBase.html">kaldi::MatrixBase</a></div><div class="ttdoc">Base class which provides matrix operations not involving resizing or allocation. ...</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l00046">kaldi-matrix.h:46</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_af830848160afd5bf477387d1c5825d8c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#af830848160afd5bf477387d1c5825d8c">kaldi::nnet3::OnlineNaturalGradient::SetUpdatePeriod</a></div><div class="ttdeci">void SetUpdatePeriod(int32 update_period)</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8cc_source.html#l00606">natural-gradient-online.cc:606</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_a92a77e900ccaf0f3a722e2a4a9dedb77"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a92a77e900ccaf0f3a722e2a4a9dedb77">kaldi::nnet3::OnlineNaturalGradient::SetNumSamplesHistory</a></div><div class="ttdeci">void SetNumSamplesHistory(BaseFloat num_samples_history)</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8cc_source.html#l00610">natural-gradient-online.cc:610</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_ab5eb4e0382c25808345f1d7a963a148f"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#ab5eb4e0382c25808345f1d7a963a148f">kaldi::nnet3::OnlineNaturalGradient::operator=</a></div><div class="ttdeci">OnlineNaturalGradient &amp; operator=(const OnlineNaturalGradient &amp;other)</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8cc_source.html#l00586">natural-gradient-online.cc:586</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_a72e3e9b2ee0ed5ab8aa688b9422d8138"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a72e3e9b2ee0ed5ab8aa688b9422d8138">kaldi::nnet3::OnlineNaturalGradient::frozen_</a></div><div class="ttdeci">bool frozen_</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8h_source.html#l00603">natural-gradient-online.h:603</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_afb9bffca178027f3e5d52ec73a1ee0fe"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#afb9bffca178027f3e5d52ec73a1ee0fe">kaldi::nnet3::OnlineNaturalGradient::SetRank</a></div><div class="ttdeci">void SetRank(int32 rank)</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8cc_source.html#l00602">natural-gradient-online.cc:602</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html">kaldi::nnet3::OnlineNaturalGradient</a></div><div class="ttdoc">Keywords for search: natural gradient, naturalgradient, NG-SGD. </div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8h_source.html#l00414">natural-gradient-online.h:414</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrix_html"><div class="ttname"><a href="classkaldi_1_1CuMatrix.html">kaldi::CuMatrix</a></div><div class="ttdoc">This class represents a matrix that&amp;#39;s stored on the GPU if we have one, and in memory if not...</div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00071">matrix-common.h:71</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_aa0ae63e5e17bafaf1ab9c9328517bb5b"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#aa0ae63e5e17bafaf1ab9c9328517bb5b">kaldi::nnet3::OnlineNaturalGradient::delta_</a></div><div class="ttdeci">BaseFloat delta_</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8h_source.html#l00595">natural-gradient-online.h:595</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_aa648b298424a1fc8789b6c7efa4d2c8d"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#aa648b298424a1fc8789b6c7efa4d2c8d">kaldi::nnet3::OnlineNaturalGradient::ComputeWt1</a></div><div class="ttdeci">void ComputeWt1(int32 N, const VectorBase&lt; BaseFloat &gt; &amp;d_t, const VectorBase&lt; BaseFloat &gt; &amp;d_t1, BaseFloat rho_t, BaseFloat rho_t1, const MatrixBase&lt; BaseFloat &gt; &amp;U_t, const VectorBase&lt; BaseFloat &gt; &amp;sqrt_c_t, const VectorBase&lt; BaseFloat &gt; &amp;inv_sqrt_e_t, const CuMatrixBase&lt; BaseFloat &gt; &amp;W_t, CuMatrixBase&lt; BaseFloat &gt; *J_t, CuMatrixBase&lt; BaseFloat &gt; *W_t1) const</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8cc_source.html#l00482">natural-gradient-online.cc:482</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_ac415c4be36a5c62618b5d50c3d8868dd"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#ac415c4be36a5c62618b5d50c3d8868dd">kaldi::nnet3::OnlineNaturalGradient::OnlineNaturalGradient</a></div><div class="ttdeci">OnlineNaturalGradient()</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8cc_source.html#l00027">natural-gradient-online.cc:27</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_a35086953bbc759bd2ac9cb660d87d83f"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a35086953bbc759bd2ac9cb660d87d83f">kaldi::nnet3::OnlineNaturalGradient::TurnOnDebug</a></div><div class="ttdeci">void TurnOnDebug()</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8h_source.html#l00429">natural-gradient-online.h:429</a></div></div>
<div class="ttc" id="classfloat_html"><div class="ttname"><a href="classfloat.html">float</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_a9c611c2de39a87a3ad90640fd024b048"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a9c611c2de39a87a3ad90640fd024b048">kaldi::nnet3::OnlineNaturalGradient::rho_t_</a></div><div class="ttdeci">BaseFloat rho_t_</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8h_source.html#l00613">natural-gradient-online.h:613</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_a04f608ae169f9f8893c5611d379ce5ae"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a04f608ae169f9f8893c5611d379ce5ae">kaldi::nnet3::OnlineNaturalGradient::ReorthogonalizeXt1</a></div><div class="ttdeci">void ReorthogonalizeXt1(const VectorBase&lt; BaseFloat &gt; &amp;d_t1, BaseFloat rho_t1, CuMatrixBase&lt; BaseFloat &gt; *W_t1, CuMatrixBase&lt; BaseFloat &gt; *temp_W, CuMatrixBase&lt; BaseFloat &gt; *temp_O)</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8cc_source.html#l00200">natural-gradient-online.cc:200</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_a2bdc60d5b8ab06b11d20695a71da1024"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a2bdc60d5b8ab06b11d20695a71da1024">kaldi::nnet3::OnlineNaturalGradient::ComputeEt</a></div><div class="ttdeci">void ComputeEt(const VectorBase&lt; BaseFloat &gt; &amp;d_t, BaseFloat beta_t, VectorBase&lt; BaseFloat &gt; *e_t, VectorBase&lt; BaseFloat &gt; *sqrt_e_t, VectorBase&lt; BaseFloat &gt; *inv_sqrt_e_t) const</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8cc_source.html#l00558">natural-gradient-online.cc:558</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_a2ac3ca97170e3246ee3eafabdacc90c2"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a2ac3ca97170e3246ee3eafabdacc90c2">kaldi::nnet3::OnlineNaturalGradient::Updating</a></div><div class="ttdeci">bool Updating() const</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8cc_source.html#l00457">natural-gradient-online.cc:457</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_aff2f0bd6b38f9056268da28ae91aa316"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#aff2f0bd6b38f9056268da28ae91aa316">kaldi::nnet3::OnlineNaturalGradient::Swap</a></div><div class="ttdeci">void Swap(OnlineNaturalGradient *other)</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8cc_source.html#l00626">natural-gradient-online.cc:626</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_a885862c5b0a0cf88d75bee40f5cf29f2"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a885862c5b0a0cf88d75bee40f5cf29f2">kaldi::nnet3::OnlineNaturalGradient::SetAlpha</a></div><div class="ttdeci">void SetAlpha(BaseFloat alpha)</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8cc_source.html#l00621">natural-gradient-online.cc:621</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_ade740d3baed295663ceaa07aa6951099"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#ade740d3baed295663ceaa07aa6951099">kaldi::nnet3::OnlineNaturalGradient::GetNumMinibatchesHistory</a></div><div class="ttdeci">BaseFloat GetNumMinibatchesHistory() const</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8h_source.html#l00431">natural-gradient-online.h:431</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_a43efd606b8c638dd071888c30b741e91"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a43efd606b8c638dd071888c30b741e91">kaldi::nnet3::OnlineNaturalGradient::alpha_</a></div><div class="ttdeci">BaseFloat alpha_</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8h_source.html#l00583">natural-gradient-online.h:583</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_a008c4e6cc13410d1b983ad2b06fffeaf"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a008c4e6cc13410d1b983ad2b06fffeaf">kaldi::nnet3::OnlineNaturalGradient::epsilon_</a></div><div class="ttdeci">BaseFloat epsilon_</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8h_source.html#l00589">natural-gradient-online.h:589</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_aa3bcd897525db0c5caa855f1fe5b69ff"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#aa3bcd897525db0c5caa855f1fe5b69ff">kaldi::nnet3::OnlineNaturalGradient::PreconditionDirections</a></div><div class="ttdeci">void PreconditionDirections(CuMatrixBase&lt; BaseFloat &gt; *R, BaseFloat *scale)</div><div class="ttdoc">This call implements the main functionality of this class. </div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8cc_source.html#l00159">natural-gradient-online.cc:159</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html">kaldi::CuMatrixBase</a></div><div class="ttdoc">Matrix for CUDA computing. </div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00069">matrix-common.h:69</a></div></div>
<div class="ttc" id="cu-matrix-lib_8h_html"><div class="ttname"><a href="cu-matrix-lib_8h.html">cu-matrix-lib.h</a></div></div>
<div class="ttc" id="classkaldi_1_1Vector_html"><div class="ttname"><a href="classkaldi_1_1Vector.html">kaldi::Vector</a></div><div class="ttdoc">A class representing a vector. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8h_source.html#l00390">kaldi-vector.h:390</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_abd17f633a8fc0939bc5bd0e83bd7153c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#abd17f633a8fc0939bc5bd0e83bd7153c">kaldi::nnet3::OnlineNaturalGradient::t_</a></div><div class="ttdeci">int32 t_</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8h_source.html#l00607">natural-gradient-online.h:607</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_a9d2db282e47c56f778322ddf9631a0ee"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a9d2db282e47c56f778322ddf9631a0ee">kaldi::nnet3::OnlineNaturalGradient::ComputeZt</a></div><div class="ttdeci">void ComputeZt(int32 N, BaseFloat rho_t, const VectorBase&lt; BaseFloat &gt; &amp;d_t, const VectorBase&lt; BaseFloat &gt; &amp;inv_sqrt_e_t, const MatrixBase&lt; BaseFloat &gt; &amp;K_t, const MatrixBase&lt; BaseFloat &gt; &amp;L_t, SpMatrix&lt; double &gt; *Z_t) const</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8cc_source.html#l00527">natural-gradient-online.cc:527</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_a6fa49a23b816a2a52721b7a8dcf0ce42"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a6fa49a23b816a2a52721b7a8dcf0ce42">kaldi::nnet3::OnlineNaturalGradient::SetNumMinibatchesHistory</a></div><div class="ttdeci">void SetNumMinibatchesHistory(BaseFloat num_minibatches_history)</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8cc_source.html#l00615">natural-gradient-online.cc:615</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_af659a9e1c6ede20999b0996a58f97f34"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#af659a9e1c6ede20999b0996a58f97f34">kaldi::nnet3::OnlineNaturalGradient::num_samples_history_</a></div><div class="ttdeci">BaseFloat num_samples_history_</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8h_source.html#l00566">natural-gradient-online.h:566</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_aecff47257feb076ddd824437cd4bb760"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#aecff47257feb076ddd824437cd4bb760">kaldi::nnet3::OnlineNaturalGradient::GetAlpha</a></div><div class="ttdeci">BaseFloat GetAlpha() const</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8h_source.html#l00432">natural-gradient-online.h:432</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html"><div class="ttname"><a href="classkaldi_1_1VectorBase.html">kaldi::VectorBase</a></div><div class="ttdoc">Provides a vector abstraction class. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8h_source.html#l00040">kaldi-vector.h:40</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_a58d61a9b39bd466823c1d1710615dd90"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a58d61a9b39bd466823c1d1710615dd90">kaldi::nnet3::OnlineNaturalGradient::GetUpdatePeriod</a></div><div class="ttdeci">int32 GetUpdatePeriod() const</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8h_source.html#l00434">natural-gradient-online.h:434</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_af101bbf82527b43a60a43a287270fd0f"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#af101bbf82527b43a60a43a287270fd0f">kaldi::nnet3::OnlineNaturalGradient::Init</a></div><div class="ttdeci">void Init(const CuMatrixBase&lt; BaseFloat &gt; &amp;R0)</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8cc_source.html#l00122">natural-gradient-online.cc:122</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_aa413657960e4ce64b0f6bdfa7d121ad2"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#aa413657960e4ce64b0f6bdfa7d121ad2">kaldi::nnet3::OnlineNaturalGradient::PreconditionDirectionsInternal</a></div><div class="ttdeci">void PreconditionDirectionsInternal(const BaseFloat rho_t, const BaseFloat tr_X_Xt, bool updating, const Vector&lt; BaseFloat &gt; &amp;d_t, CuMatrixBase&lt; BaseFloat &gt; *WJKL_t, CuMatrixBase&lt; BaseFloat &gt; *X_t)</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8cc_source.html#l00323">natural-gradient-online.cc:323</a></div></div>
<div class="ttc" id="kaldi-common_8h_html"><div class="ttname"><a href="kaldi-common_8h.html">kaldi-common.h</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_a1d419f9b6bc532b8960a93ce3f54f3be"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a1d419f9b6bc532b8960a93ce3f54f3be">kaldi::nnet3::OnlineNaturalGradient::SelfTest</a></div><div class="ttdeci">void SelfTest() const</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8cc_source.html#l00278">natural-gradient-online.cc:278</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_acf6a1777407d36e2173dd1de0e60b322"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#acf6a1777407d36e2173dd1de0e60b322">kaldi::nnet3::OnlineNaturalGradient::GetNumSamplesHistory</a></div><div class="ttdeci">BaseFloat GetNumSamplesHistory() const</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8h_source.html#l00430">natural-gradient-online.h:430</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_a1fd2929c7565d8aeebac17374c7ae45d"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a1fd2929c7565d8aeebac17374c7ae45d">kaldi::nnet3::OnlineNaturalGradient::GetRank</a></div><div class="ttdeci">int32 GetRank() const</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8h_source.html#l00433">natural-gradient-online.h:433</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_67a0a17020b8eedc08ffa5626b1d53a1.html">nnet3</a></li><li class="navelem"><a class="el" href="natural-gradient-online_8h.html">natural-gradient-online.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
