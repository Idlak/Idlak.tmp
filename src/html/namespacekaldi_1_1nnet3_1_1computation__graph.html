<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Kaldi: kaldi::nnet3::computation_graph Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" /> 
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
 <td id="projectlogo"><a href="http://kaldi-asr.org/"><img alt="Logo" src="KaldiTextAndLogoSmall.png"/ style="padding: 3px 5px 1px 5px"></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname" style="display:none">Kaldi
   </div>
  </td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief" style="display:none"></div>
    </td>
   <!--END PROJECT_BRIEF-->
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('namespacekaldi_1_1nnet3_1_1computation__graph.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">kaldi::nnet3::computation_graph Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abcf4ea50e642bf894660a735b0fa3f5c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3_1_1computation__graph.html#abcf4ea50e642bf894660a735b0fa3f5c">AddOutputToGraph</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> &amp;request, const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, <a class="el" href="structkaldi_1_1nnet3_1_1ComputationGraph.html">ComputationGraph</a> *graph)</td></tr>
<tr class="separator:abcf4ea50e642bf894660a735b0fa3f5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade326e1f7b5aed9de211eb7327ecde6b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3_1_1computation__graph.html#ade326e1f7b5aed9de211eb7327ecde6b">AddInputToGraph</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> &amp;request, const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, <a class="el" href="structkaldi_1_1nnet3_1_1ComputationGraph.html">ComputationGraph</a> *graph)</td></tr>
<tr class="separator:ade326e1f7b5aed9de211eb7327ecde6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3763a49ed71b20704d8479482659a9b8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3_1_1computation__graph.html#a3763a49ed71b20704d8479482659a9b8">ComputeDependenciesSubset</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationGraph.html">ComputationGraph</a> &amp;graph, const std::vector&lt; int32 &gt; &amp;cindex_id_to_segment_and_epoch, std::vector&lt; std::vector&lt; int32 &gt; &gt; *dependencies_subset)</td></tr>
<tr class="memdesc:a3763a49ed71b20704d8479482659a9b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function outputs to dependencies_subset[c], for each cindex_id c, the subset of elements d of graph.dependencies[c] such that cindex_id_to_segment_and_epoch[d] == cindex_id_to_segment_and_epoch[c].  <a href="#a3763a49ed71b20704d8479482659a9b8">More...</a><br /></td></tr>
<tr class="separator:a3763a49ed71b20704d8479482659a9b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0085866e63cd0b15d4295476f08a3a68"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3_1_1computation__graph.html#a0085866e63cd0b15d4295476f08a3a68">ComputeEpochInfo</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationGraph.html">ComputationGraph</a> &amp;graph, std::vector&lt; int32 &gt; *cindex_id_to_segment_and_epoch, std::vector&lt; std::vector&lt; std::vector&lt; int32 &gt; &gt; &gt; *epochs_per_segment, std::vector&lt; <a class="el" href="classbool.html">bool</a> &gt; *epoch_is_trivial)</td></tr>
<tr class="memdesc:a0085866e63cd0b15d4295476f08a3a68"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes certain information about "epochs" of cindex_ids.  <a href="#a0085866e63cd0b15d4295476f08a3a68">More...</a><br /></td></tr>
<tr class="separator:a0085866e63cd0b15d4295476f08a3a68"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ade326e1f7b5aed9de211eb7327ecde6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade326e1f7b5aed9de211eb7327ecde6b">&#9670;&nbsp;</a></span>AddInputToGraph()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::computation_graph::AddInputToGraph </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structkaldi_1_1nnet3_1_1ComputationGraph.html">ComputationGraph</a> *&#160;</td>
          <td class="paramname"><em>graph</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-computation-graph_8cc_source.html#l01013">1013</a> of file <a class="el" href="nnet-computation-graph_8cc_source.html">nnet-computation-graph.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-computation-graph_8cc_source.html#l00028">ComputationGraph::GetCindexId()</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00146">Nnet::GetNode()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00466">Nnet::GetNodeIndex()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-computation_8h_source.html#l00115">ComputationRequest::inputs</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00126">KALDI_ERR</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00055">kaldi::nnet3::kComponent</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00055">kaldi::nnet3::kInput</a>, <a class="el" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">rnnlm::n</a>, and <a class="el" href="_2nnet-nnet_8h_source.html#l00082">NetworkNode::node_type</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-computation-graph_8cc_source.html#l01171">kaldi::nnet3::ComputeComputationGraph()</a>.</p>
<div class="fragment"><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                                              {</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  int32 num_added = 0;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; request.inputs.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    int32 <a class="code" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">n</a> = nnet.GetNodeIndex(request.inputs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].name);</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keywordflow">if</span> (n == -1)</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Network has no input with name &quot;</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                &lt;&lt; request.inputs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].name;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16">NodeType</a> t = nnet.GetNode(n).node_type;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>((t == <a class="code" href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16aa3512d23926af0e0dad8c3293443d04c">kInput</a> || t == <a class="code" href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16a02fee4c0e0e6f1b7ab7a678d61627461">kComponent</a>) &amp;&amp;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                 <span class="stringliteral">&quot;Inputs to graph only allowed for Input and Component nodes.&quot;</span>);</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; request.inputs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].indexes.size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> cindex(n, request.inputs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].indexes[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>]);</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      <span class="keywordtype">bool</span> is_input = <span class="keyword">true</span>, is_new;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;      graph-&gt;GetCindexId(cindex, is_input, &amp;is_new);  <span class="comment">// ignore the return value.</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(is_new &amp;&amp; <span class="stringliteral">&quot;Input index seems to be listed more than once&quot;</span>);</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      num_added++;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    }</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  }</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(num_added &gt; 0 &amp;&amp; <span class="stringliteral">&quot;AddInputToGraph: nothing to add.&quot;</span>);</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;}</div><div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_acac9cbaeea226ed297804c012dc12b16"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16">kaldi::nnet3::NodeType</a></div><div class="ttdeci">NodeType</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00055">nnet-nnet.h:55</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ac8344e7587df9247d6cc492874901d4d"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">kaldi::nnet3::Cindex</a></div><div class="ttdeci">std::pair&lt; int32, Index &gt; Cindex</div><div class="ttdef"><b>Definition:</b> <a href="nnet-common_8h_source.html#l00115">nnet-common.h:115</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_acac9cbaeea226ed297804c012dc12b16a02fee4c0e0e6f1b7ab7a678d61627461"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16a02fee4c0e0e6f1b7ab7a678d61627461">kaldi::nnet3::kComponent</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00055">nnet-nnet.h:55</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_acac9cbaeea226ed297804c012dc12b16aa3512d23926af0e0dad8c3293443d04c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16aa3512d23926af0e0dad8c3293443d04c">kaldi::nnet3::kInput</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00055">nnet-nnet.h:55</a></div></div>
<div class="ttc" id="namespacernnlm_html_ab4871778d570f724a07823e0a2fb9884"><div class="ttname"><a href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@11::@12 n</div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00126">kaldi-error.h:126</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abcf4ea50e642bf894660a735b0fa3f5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcf4ea50e642bf894660a735b0fa3f5c">&#9670;&nbsp;</a></span>AddOutputToGraph()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::computation_graph::AddOutputToGraph </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structkaldi_1_1nnet3_1_1ComputationGraph.html">ComputationGraph</a> *&#160;</td>
          <td class="paramname"><em>graph</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-computation-graph_8cc_source.html#l00990">990</a> of file <a class="el" href="nnet-computation-graph_8cc_source.html">nnet-computation-graph.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-computation-graph_8cc_source.html#l00028">ComputationGraph::GetCindexId()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00466">Nnet::GetNodeIndex()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00126">KALDI_ERR</a>, <a class="el" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">rnnlm::n</a>, and <a class="el" href="nnet-computation_8h_source.html#l00116">ComputationRequest::outputs</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-computation-graph_8cc_source.html#l01171">kaldi::nnet3::ComputeComputationGraph()</a>.</p>
<div class="fragment"><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                                               {</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  int32 num_added = 0;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; request.outputs.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    int32 <a class="code" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">n</a> = nnet.GetNodeIndex(request.outputs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].name);</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <span class="keywordflow">if</span> (n == -1)</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Network has no output with name &quot;</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                &lt;&lt; request.outputs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].name;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; request.outputs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].indexes.size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> cindex(n, request.outputs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].indexes[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>]);</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      <span class="keywordtype">bool</span> is_input = <span class="keyword">false</span>, is_new;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;      graph-&gt;GetCindexId(cindex, is_input, &amp;is_new);  <span class="comment">// ignore the return value.</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(is_new &amp;&amp; <span class="stringliteral">&quot;Output index seems to be listed more than once&quot;</span>);</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      num_added++;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    }</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  }</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(num_added &gt; 0 &amp;&amp; <span class="stringliteral">&quot;AddOutputToGraph: nothing to add.&quot;</span>);</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;}</div><div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ac8344e7587df9247d6cc492874901d4d"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">kaldi::nnet3::Cindex</a></div><div class="ttdeci">std::pair&lt; int32, Index &gt; Cindex</div><div class="ttdef"><b>Definition:</b> <a href="nnet-common_8h_source.html#l00115">nnet-common.h:115</a></div></div>
<div class="ttc" id="namespacernnlm_html_ab4871778d570f724a07823e0a2fb9884"><div class="ttname"><a href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@11::@12 n</div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00126">kaldi-error.h:126</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3763a49ed71b20704d8479482659a9b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3763a49ed71b20704d8479482659a9b8">&#9670;&nbsp;</a></span>ComputeDependenciesSubset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kaldi::nnet3::computation_graph::ComputeDependenciesSubset </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationGraph.html">ComputationGraph</a> &amp;&#160;</td>
          <td class="paramname"><em>graph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>cindex_id_to_segment_and_epoch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>dependencies_subset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function outputs to dependencies_subset[c], for each cindex_id c, the subset of elements d of graph.dependencies[c] such that cindex_id_to_segment_and_epoch[d] == cindex_id_to_segment_and_epoch[c]. </p>
<p>That is, it's the dependency graph of the entire computation, but removing links that go from one segment/epoch to another segment/epoch. Topologically, 'dependencies_subset' would therefore consist of a bunch of disconnected graphs. </p>

<p class="definition">Definition at line <a class="el" href="nnet-computation-graph_8cc_source.html#l01047">1047</a> of file <a class="el" href="nnet-computation-graph_8cc_source.html">nnet-computation-graph.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-computation-graph_8h_source.html#l00046">ComputationGraph::cindexes</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00064">rnnlm::d</a>, <a class="el" href="nnet-computation-graph_8h_source.html#l00063">ComputationGraph::dependencies</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, and <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-computation-graph_8cc_source.html#l01425">kaldi::nnet3::ComputeComputationPhases()</a>.</p>
<div class="fragment"><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                                                       {</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  int32 num_cindex_ids = graph.cindexes.size();</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cindex_id_to_segment_and_epoch.size() == num_cindex_ids);</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  dependencies_subset-&gt;resize(num_cindex_ids);</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  <span class="keywordflow">for</span> (int32 cindex_id = 0; cindex_id &lt; num_cindex_ids; cindex_id++) {</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    int32 phase_index = cindex_id_to_segment_and_epoch[cindex_id];</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <span class="keyword">const</span> std::vector&lt;int32&gt; &amp;dependencies = graph.dependencies[cindex_id];</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    std::vector&lt;int32&gt; &amp;dep_subset = (*dependencies_subset)[cindex_id];</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    int32 num_dep = dependencies.size();</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; num_dep; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      int32 <a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = dependencies[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;      <span class="keywordflow">if</span> (cindex_id_to_segment_and_epoch[d] == phase_index)</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        dep_subset.push_back(d);</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    }</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  }</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;}</div><div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="namespacernnlm_html_a873684cefeb665f3d5e6b495de57fc0d"><div class="ttname"><a href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">rnnlm::d</a></div><div class="ttdeci">double d</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00064">mikolov-rnnlm-lib.cc:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0085866e63cd0b15d4295476f08a3a68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0085866e63cd0b15d4295476f08a3a68">&#9670;&nbsp;</a></span>ComputeEpochInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kaldi::nnet3::computation_graph::ComputeEpochInfo </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationGraph.html">ComputationGraph</a> &amp;&#160;</td>
          <td class="paramname"><em>graph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32 &gt; *&#160;</td>
          <td class="paramname"><em>cindex_id_to_segment_and_epoch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; std::vector&lt; int32 &gt; &gt; &gt; *&#160;</td>
          <td class="paramname"><em>epochs_per_segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classbool.html">bool</a> &gt; *&#160;</td>
          <td class="paramname"><em>epoch_is_trivial</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function computes certain information about "epochs" of cindex_ids. </p>
<p>The function <a class="el" href="namespacekaldi_1_1nnet3.html#a380175b61aef188f214827ad6c2faca2" title="This function computes the order in which we need to compute each node in the graph, where each node-index n maps to an epoch-index t = 0, 1, ... ">ComputeNnetComputationEpochs()</a> from <a class="el" href="nnet-graph_8h.html" title="This file contains a few functions that treat the neural net as a graph on nodes: e...">nnet-graph.h</a> gives us a map from the <a class="el" href="structkaldi_1_1nnet3_1_1NetworkNode.html" title="NetworkNode is used to represent, three types of thing: either an input of the network (which pretty ...">NetworkNode</a> index to an index we call the "epoch" index: basically, nodes that are computed first have a lower epoch index, and all nodes that are part of strongly connected components have the same epoch index. In an acyclic nnet graph each component will usually have its own epoch index, but in things like LSTMs, each LSTM layer (with multiple components) will have its own epoch index.</p>
<p>The overall computation order that we compute, will respect this ordering into epochs (except that outputs of nodes of type kComponent that are actually provided as inputs to the network, won't be subject to these limitations but will come first in the order)... we will just ignore the output of this function as it concerns cindex-ids that are provided as input to the network.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nnet</td><td>[in] The neural net </td></tr>
    <tr><td class="paramname">graph</td><td>[in] The computation graph </td></tr>
    <tr><td class="paramname">cindex_id_to_segment_and_epoch</td><td>[out] A vector that maps cindex_id to a number that is the same if two cindex_ids are in the same segment and same epoch, and different otherwise. This number combines the segment index and the epoch index; the details are not important to the calling code. </td></tr>
    <tr><td class="paramname">epochs_per_segment</td><td>[out] This is a listing of all the cindex_ids in the computation graph, divided up first by segment and then by epoch. </td></tr>
    <tr><td class="paramname">epoch_is_trivial</td><td>[out] A vector of bool, indexed by the epoch index which is the same as the second index of 'epochs_per_segment', that's true if this epoch index corresponds to just a single <a class="el" href="structkaldi_1_1nnet3_1_1NetworkNode.html" title="NetworkNode is used to represent, three types of thing: either an input of the network (which pretty ...">NetworkNode</a> (and also true for epoch indexes corresponding to inputs to the network, which will be the first epoch of each segment). This depends on the neural network structure only. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="nnet-computation-graph_8cc_source.html#l01101">1101</a> of file <a class="el" href="nnet-computation-graph_8cc_source.html">nnet-computation-graph.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-computation-graph_8h_source.html#l00046">ComputationGraph::cindexes</a>, <a class="el" href="nnet-graph_8cc_source.html#l00265">kaldi::nnet3::ComputeNnetComputationEpochs()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-computation-graph_8h_source.html#l00055">ComputationGraph::is_input</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00135">KALDI_VLOG</a>, <a class="el" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">rnnlm::n</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00126">Nnet::NumNodes()</a>, <a class="el" href="nnet-common_8cc_source.html#l00525">kaldi::nnet3::PrintIntegerVector()</a>, and <a class="el" href="nnet-computation-graph_8h_source.html#l00080">ComputationGraph::segment_ends</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-computation-graph_8cc_source.html#l01425">kaldi::nnet3::ComputeComputationPhases()</a>.</p>
<div class="fragment"><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                                       {</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  <span class="comment">// node_to_epoch maps each nnet node to an index &gt;= 0 that tells us coarsely</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  <span class="comment">// what order to compute them in... but we may need to compute a finer</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  <span class="comment">// ordering at the cindex_id level in cases like RNNs.</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  std::vector&lt;int32&gt; node_to_epoch;</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a380175b61aef188f214827ad6c2faca2">ComputeNnetComputationEpochs</a>(nnet, &amp;node_to_epoch);</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  {</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    std::ostringstream os;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a91ad7b2e440d9b50c196a361f559a427">PrintIntegerVector</a>(os, node_to_epoch);</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <a class="code" href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a>(6) &lt;&lt; <span class="stringliteral">&quot;node_to_epoch: &quot;</span> &lt;&lt; os.str();</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  }</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  <span class="comment">// Add one to the epoch numbering because we will be reserving</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  <span class="comment">// zero for inputs to the network, and we don&#39;t want to have to</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;  <span class="comment">// prove that epoch number 0 would correspond only to inputs.</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; node_to_epoch.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    node_to_epoch[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]++;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  int32 num_nodes = nnet.NumNodes(),</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      num_cindex_ids = graph.cindexes.size(),</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;      num_segments = graph.segment_ends.size(),</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      num_epoch_indexes = 1 + *std::max_element(node_to_epoch.begin(),</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                                                node_to_epoch.end());</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(node_to_epoch.size() == num_nodes);</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  epochs_per_segment-&gt;clear();</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  epochs_per_segment-&gt;resize(num_segments);</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <span class="comment">// epoch_to_num_nodes is only used so we know whether each epoch</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  <span class="comment">// index corresponds to multiple nodes; if it&#39;s just one node then we know</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  <span class="comment">// the computation is very simple and we can do an optimization.</span></div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  std::vector&lt;int32&gt; epoch_to_num_nodes(num_epoch_indexes, 0);</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">n</a> = 0; <a class="code" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">n</a> &lt; num_nodes; <a class="code" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">n</a>++)</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    epoch_to_num_nodes[node_to_epoch[<a class="code" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">n</a>]]++;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;  epoch_is_trivial-&gt;resize(num_epoch_indexes);</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  <span class="keywordflow">for</span> (int32 o = 0; o &lt; num_epoch_indexes; o++) {</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(o == 0 || epoch_to_num_nodes[o] &gt; 0);</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    (*epoch_is_trivial)[o] = (epoch_to_num_nodes[o] &lt;= 1);</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  }</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  cindex_id_to_segment_and_epoch-&gt;resize(num_cindex_ids);</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(graph.segment_ends.back() == num_cindex_ids);</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  int32 cur_segment_start = 0, cur_segment_end;</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <span class="keywordflow">for</span> (int32 segment = 0; segment &lt; num_segments; segment++) {</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    cur_segment_end = graph.segment_ends[segment];</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    std::vector&lt;std::vector&lt;int32&gt; &gt; &amp;epochs = (*epochs_per_segment)[segment];</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    epochs.resize(num_epoch_indexes);</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <span class="keywordflow">for</span> (int32 cindex_id = cur_segment_start;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;         cindex_id &lt; cur_segment_end; cindex_id++) {</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      int32 node_index = graph.cindexes[cindex_id].first,</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;          epoch_index = (graph.is_input[cindex_id] ? 0 :</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                         node_to_epoch[node_index]);</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;      (*cindex_id_to_segment_and_epoch)[cindex_id] =</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;          epoch_index + segment * num_epoch_indexes;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      epochs[epoch_index].push_back(cindex_id);</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    }</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    cur_segment_start = cur_segment_end;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  }</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;}</div><div class="ttc" id="namespacernnlm_html_ab4871778d570f724a07823e0a2fb9884"><div class="ttname"><a href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@11::@12 n</div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a380175b61aef188f214827ad6c2faca2"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a380175b61aef188f214827ad6c2faca2">kaldi::nnet3::ComputeNnetComputationEpochs</a></div><div class="ttdeci">void ComputeNnetComputationEpochs(const Nnet &amp;nnet, std::vector&lt; int32 &gt; *node_to_epoch)</div><div class="ttdoc">This function computes the order in which we need to compute each node in the graph, where each node-index n maps to an epoch-index t = 0, 1, ... </div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph_8cc_source.html#l00265">nnet-graph.cc:265</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a91ad7b2e440d9b50c196a361f559a427"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a91ad7b2e440d9b50c196a361f559a427">kaldi::nnet3::PrintIntegerVector</a></div><div class="ttdeci">void PrintIntegerVector(std::ostream &amp;os, const std::vector&lt; int32 &gt; &amp;ints)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-common_8cc_source.html#l00525">nnet-common.cc:525</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="group__error__group_html_ga16c81ec6ff3ba04c6ff96fdaed9d854e"><div class="ttname"><a href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a></div><div class="ttdeci">#define KALDI_VLOG(v)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00135">kaldi-error.h:135</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacekaldi.html">kaldi</a></li><li class="navelem"><a class="el" href="namespacekaldi_1_1nnet3.html">nnet3</a></li><li class="navelem"><a class="el" href="namespacekaldi_1_1nnet3_1_1computation__graph.html">computation_graph</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
