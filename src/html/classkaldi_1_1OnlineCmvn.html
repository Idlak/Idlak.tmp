<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Kaldi: OnlineCmvn Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" /> 
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
 <td id="projectlogo"><a href="http://kaldi-asr.org/"><img alt="Logo" src="KaldiTextAndLogoSmall.png"/ style="padding: 3px 5px 1px 5px"></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname" style="display:none">Kaldi
   </div>
  </td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief" style="display:none"></div>
    </td>
   <!--END PROJECT_BRIEF-->
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classkaldi_1_1OnlineCmvn.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classkaldi_1_1OnlineCmvn-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">OnlineCmvn Class Reference<div class="ingroups"><a class="el" href="group__onlinefeat.html">OnlineFeatureExtraction</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>This class does an online version of the cepstral mean and [optionally] variance, but note that this is not equivalent to the offline version.  
 <a href="classkaldi_1_1OnlineCmvn.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="online-feature_8h_source.html">online-feature.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for OnlineCmvn:</div>
<div class="dyncontent">
<div class="center"><img src="classkaldi_1_1OnlineCmvn__inherit__graph.png" border="0" usemap="#OnlineCmvn_inherit__map" alt="Inheritance graph"/></div>
<map name="OnlineCmvn_inherit__map" id="OnlineCmvn_inherit__map">
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for OnlineCmvn:</div>
<div class="dyncontent">
<div class="center"><img src="classkaldi_1_1OnlineCmvn__coll__graph.png" border="0" usemap="#OnlineCmvn_coll__map" alt="Collaboration graph"/></div>
<map name="OnlineCmvn_coll__map" id="OnlineCmvn_coll__map">
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1a121442e95f6b43f46a61cefffb2252"><td class="memItemLeft" align="right" valign="top">virtual int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlineCmvn.html#a1a121442e95f6b43f46a61cefffb2252">Dim</a> () const</td></tr>
<tr class="separator:a1a121442e95f6b43f46a61cefffb2252"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09424857e2822aa52300244882a1307b"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlineCmvn.html#a09424857e2822aa52300244882a1307b">IsLastFrame</a> (int32 frame) const</td></tr>
<tr class="memdesc:a09424857e2822aa52300244882a1307b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if this is the last frame.  <a href="#a09424857e2822aa52300244882a1307b">More...</a><br /></td></tr>
<tr class="separator:a09424857e2822aa52300244882a1307b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7f952bcbfcdeb496dad5dff0ebc74fc"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlineCmvn.html#ae7f952bcbfcdeb496dad5dff0ebc74fc">FrameShiftInSeconds</a> () const</td></tr>
<tr class="separator:ae7f952bcbfcdeb496dad5dff0ebc74fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60b0869d95fc438d1723671fef3e2c08"><td class="memItemLeft" align="right" valign="top">virtual int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlineCmvn.html#a60b0869d95fc438d1723671fef3e2c08">NumFramesReady</a> () const</td></tr>
<tr class="memdesc:a60b0869d95fc438d1723671fef3e2c08"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns the feature dimension.  <a href="#a60b0869d95fc438d1723671fef3e2c08">More...</a><br /></td></tr>
<tr class="separator:a60b0869d95fc438d1723671fef3e2c08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeef84368a0238c6c170d37e2c6b07dc"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlineCmvn.html#afeef84368a0238c6c170d37e2c6b07dc">GetFrame</a> (int32 frame, <a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; *feat)</td></tr>
<tr class="memdesc:afeef84368a0238c6c170d37e2c6b07dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the feature vector for this frame.  <a href="#afeef84368a0238c6c170d37e2c6b07dc">More...</a><br /></td></tr>
<tr class="separator:afeef84368a0238c6c170d37e2c6b07dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeed604506a70f91759c4f9e3f0552515"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlineCmvn.html#aeed604506a70f91759c4f9e3f0552515">OnlineCmvn</a> (const <a class="el" href="structkaldi_1_1OnlineCmvnOptions.html">OnlineCmvnOptions</a> &amp;opts, const <a class="el" href="structkaldi_1_1OnlineCmvnState.html">OnlineCmvnState</a> &amp;cmvn_state, <a class="el" href="classkaldi_1_1OnlineFeatureInterface.html">OnlineFeatureInterface</a> *src)</td></tr>
<tr class="memdesc:aeed604506a70f91759c4f9e3f0552515"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializer that sets the cmvn state.  <a href="#aeed604506a70f91759c4f9e3f0552515">More...</a><br /></td></tr>
<tr class="separator:aeed604506a70f91759c4f9e3f0552515"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfffb10faf9f3af42b26e0a463d081b4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlineCmvn.html#abfffb10faf9f3af42b26e0a463d081b4">OnlineCmvn</a> (const <a class="el" href="structkaldi_1_1OnlineCmvnOptions.html">OnlineCmvnOptions</a> &amp;opts, <a class="el" href="classkaldi_1_1OnlineFeatureInterface.html">OnlineFeatureInterface</a> *src)</td></tr>
<tr class="memdesc:abfffb10faf9f3af42b26e0a463d081b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializer that does not set the cmvn state: after calling this, you should call <a class="el" href="classkaldi_1_1OnlineCmvn.html#a98d07ab5d7731e6fb8233a090f8327ad">SetState()</a>.  <a href="#abfffb10faf9f3af42b26e0a463d081b4">More...</a><br /></td></tr>
<tr class="separator:abfffb10faf9f3af42b26e0a463d081b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae245a5a0b840f3e5e028956d0bff5141"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlineCmvn.html#ae245a5a0b840f3e5e028956d0bff5141">GetState</a> (int32 cur_frame, <a class="el" href="structkaldi_1_1OnlineCmvnState.html">OnlineCmvnState</a> *cmvn_state)</td></tr>
<tr class="separator:ae245a5a0b840f3e5e028956d0bff5141"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98d07ab5d7731e6fb8233a090f8327ad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlineCmvn.html#a98d07ab5d7731e6fb8233a090f8327ad">SetState</a> (const <a class="el" href="structkaldi_1_1OnlineCmvnState.html">OnlineCmvnState</a> &amp;cmvn_state)</td></tr>
<tr class="separator:a98d07ab5d7731e6fb8233a090f8327ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5718bd1d5354dfcdf15054cbac622f7e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlineCmvn.html#a5718bd1d5354dfcdf15054cbac622f7e">Freeze</a> (int32 cur_frame)</td></tr>
<tr class="separator:a5718bd1d5354dfcdf15054cbac622f7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a5c3acab55a57f37b70d524ee9595ca"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlineCmvn.html#a7a5c3acab55a57f37b70d524ee9595ca">~OnlineCmvn</a> ()</td></tr>
<tr class="separator:a7a5c3acab55a57f37b70d524ee9595ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classkaldi_1_1OnlineFeatureInterface"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classkaldi_1_1OnlineFeatureInterface')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classkaldi_1_1OnlineFeatureInterface.html">OnlineFeatureInterface</a></td></tr>
<tr class="memitem:a6909b3bbd5e5f0434831f294b12fcb4b inherit pub_methods_classkaldi_1_1OnlineFeatureInterface"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlineFeatureInterface.html#a6909b3bbd5e5f0434831f294b12fcb4b">~OnlineFeatureInterface</a> ()</td></tr>
<tr class="memdesc:a6909b3bbd5e5f0434831f294b12fcb4b inherit pub_methods_classkaldi_1_1OnlineFeatureInterface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual destructor.  <a href="classkaldi_1_1OnlineFeatureInterface.html#a6909b3bbd5e5f0434831f294b12fcb4b">More...</a><br /></td></tr>
<tr class="separator:a6909b3bbd5e5f0434831f294b12fcb4b inherit pub_methods_classkaldi_1_1OnlineFeatureInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a984d80cbec6e4b952e1438dee0a473b1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlineCmvn.html#a984d80cbec6e4b952e1438dee0a473b1">GetMostRecentCachedFrame</a> (int32 frame, int32 *cached_frame, <a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>&lt; double &gt; *stats)</td></tr>
<tr class="memdesc:a984d80cbec6e4b952e1438dee0a473b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the most recent cached frame of CMVN stats.  <a href="#a984d80cbec6e4b952e1438dee0a473b1">More...</a><br /></td></tr>
<tr class="separator:a984d80cbec6e4b952e1438dee0a473b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d698dd73768d8efb633a91f71861692"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlineCmvn.html#a2d698dd73768d8efb633a91f71861692">CacheFrame</a> (int32 frame, const <a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>&lt; double &gt; &amp;stats)</td></tr>
<tr class="memdesc:a2d698dd73768d8efb633a91f71861692"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cache this frame of stats.  <a href="#a2d698dd73768d8efb633a91f71861692">More...</a><br /></td></tr>
<tr class="separator:a2d698dd73768d8efb633a91f71861692"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92641d93c3b407c3c2e63124ed783d6f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlineCmvn.html#a92641d93c3b407c3c2e63124ed783d6f">InitRingBufferIfNeeded</a> ()</td></tr>
<tr class="memdesc:a92641d93c3b407c3c2e63124ed783d6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize ring buffer for caching stats.  <a href="#a92641d93c3b407c3c2e63124ed783d6f">More...</a><br /></td></tr>
<tr class="separator:a92641d93c3b407c3c2e63124ed783d6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57b7e0b87dbf1038195e05d4626ecc6f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlineCmvn.html#a57b7e0b87dbf1038195e05d4626ecc6f">ComputeStatsForFrame</a> (int32 frame, <a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; double &gt; *stats)</td></tr>
<tr class="memdesc:a57b7e0b87dbf1038195e05d4626ecc6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the raw CMVN stats for this frame, making use of (and updating if necessary) the cached statistics in raw_stats_.  <a href="#a57b7e0b87dbf1038195e05d4626ecc6f">More...</a><br /></td></tr>
<tr class="separator:a57b7e0b87dbf1038195e05d4626ecc6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:a01a55231d7eef11d4049e3f1cc7dafdb"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlineCmvn.html#a01a55231d7eef11d4049e3f1cc7dafdb">SmoothOnlineCmvnStats</a> (const <a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; double &gt; &amp;speaker_stats, const <a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; double &gt; &amp;global_stats, const <a class="el" href="structkaldi_1_1OnlineCmvnOptions.html">OnlineCmvnOptions</a> &amp;opts, <a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; double &gt; *stats)</td></tr>
<tr class="memdesc:a01a55231d7eef11d4049e3f1cc7dafdb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Smooth the CMVN stats "stats" (which are stored in the normal format as a 2 x (dim+1) matrix), by possibly adding some stats from "global_stats" and/or "speaker_stats", controlled by the config.  <a href="#a01a55231d7eef11d4049e3f1cc7dafdb">More...</a><br /></td></tr>
<tr class="separator:a01a55231d7eef11d4049e3f1cc7dafdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a023608b4ebeadd89bac7a8bbfcb7b72f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structkaldi_1_1OnlineCmvnOptions.html">OnlineCmvnOptions</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlineCmvn.html#a023608b4ebeadd89bac7a8bbfcb7b72f">opts_</a></td></tr>
<tr class="separator:a023608b4ebeadd89bac7a8bbfcb7b72f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab66ecef3ba859e18a3d4fb31ab4d780b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int32 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlineCmvn.html#ab66ecef3ba859e18a3d4fb31ab4d780b">skip_dims_</a></td></tr>
<tr class="separator:ab66ecef3ba859e18a3d4fb31ab4d780b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33a20a5700c3883769ce49801bc80839"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structkaldi_1_1OnlineCmvnState.html">OnlineCmvnState</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlineCmvn.html#a33a20a5700c3883769ce49801bc80839">orig_state_</a></td></tr>
<tr class="separator:a33a20a5700c3883769ce49801bc80839"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a680635335d7ce64a8c4cb6285309455c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlineCmvn.html#a680635335d7ce64a8c4cb6285309455c">frozen_state_</a></td></tr>
<tr class="separator:a680635335d7ce64a8c4cb6285309455c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ce1d4486b9d32ecf34ea6b7ff24d721"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>&lt; double &gt; * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlineCmvn.html#a7ce1d4486b9d32ecf34ea6b7ff24d721">cached_stats_modulo_</a></td></tr>
<tr class="separator:a7ce1d4486b9d32ecf34ea6b7ff24d721"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4290d1d4db51bdeff3b3cad91c904ae9"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::pair&lt; int32, <a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>&lt; double &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlineCmvn.html#a4290d1d4db51bdeff3b3cad91c904ae9">cached_stats_ring_</a></td></tr>
<tr class="separator:a4290d1d4db51bdeff3b3cad91c904ae9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a322065dc5fc38765ec548e481e1fc29d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1OnlineFeatureInterface.html">OnlineFeatureInterface</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1OnlineCmvn.html#a322065dc5fc38765ec548e481e1fc29d">src_</a></td></tr>
<tr class="separator:a322065dc5fc38765ec548e481e1fc29d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class does an online version of the cepstral mean and [optionally] variance, but note that this is not equivalent to the offline version. </p>
<p>This is necessarily so, as the offline computation involves looking into the future. If you plan to use features normalized with this type of CMVN then you need to train in a `matched' way, i.e. with the same type of features. We normally only do so in the "online" GMM-based decoding, e.g. in online2bin/online2-wav-gmm-latgen-faster.cc; see also the script steps/online/prepare_online_decoding.sh and steps/online/decode.sh.</p>
<p>In the steady state (in the middle of a long utterance), this class accumulates CMVN statistics from the previous "cmn_window" frames (default 600 frames, or 6 seconds), and uses these to normalize the mean and possibly variance of the current frame.</p>
<p>The config variables "speaker_frames" and "global_frames" relate to what happens at the beginning of the utterance when we have seen fewer than "cmn_window" frames of context, and so might not have very good stats to normalize with. Basically, we first augment any existing stats with up to "speaker_frames" frames of stats from previous utterances of the current speaker, and if this doesn't take us up to the required "cmn_window" frame count, we further augment with up to "global_frames" frames of global stats. The global stats are CMVN stats accumulated from training or testing data, that give us a reasonable source of mean and variance for "typical" data. </p>

<p class="definition">Definition at line <a class="el" href="online-feature_8h_source.html#l00291">291</a> of file <a class="el" href="online-feature_8h_source.html">online-feature.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aeed604506a70f91759c4f9e3f0552515"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeed604506a70f91759c4f9e3f0552515">&#9670;&nbsp;</a></span>OnlineCmvn() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1OnlineCmvn.html">OnlineCmvn</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1OnlineCmvnOptions.html">OnlineCmvnOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1OnlineCmvnState.html">OnlineCmvnState</a> &amp;&#160;</td>
          <td class="paramname"><em>cmvn_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1OnlineFeatureInterface.html">OnlineFeatureInterface</a> *&#160;</td>
          <td class="paramname"><em>src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializer that sets the cmvn state. </p>
<p>If you don't have previous utterances from the same speaker you are supposed to initialize the CMVN state from some global CMVN stats, which you can get from summing all cmvn stats you have in your training data using "sum-matrix". This just gives it a reasonable starting point at the start of the file. If you do have previous utterances from the same speaker or at least a similar environment, you are supposed to initialize it by calling GetState from the previous utterance </p>

<p class="definition">Definition at line <a class="el" href="online-feature_8cc_source.html#l00143">143</a> of file <a class="el" href="online-feature_8cc_source.html">online-feature.cc</a>.</p>

<p class="reference">References <a class="el" href="kaldi-error_8h_source.html#l00126">KALDI_ERR</a>, <a class="el" href="online-feature_8cc_source.html#l00377">OnlineCmvn::SetState()</a>, <a class="el" href="online-feature_8h_source.html#l00186">OnlineCmvnOptions::skip_dims</a>, <a class="el" href="online-feature_8h_source.html#l00390">OnlineCmvn::skip_dims_</a>, and <a class="el" href="text-utils_8h_source.html#l00068">kaldi::SplitStringToIntegers()</a>.</p>
<div class="fragment"><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                                                   :</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="classkaldi_1_1OnlineCmvn.html#a023608b4ebeadd89bac7a8bbfcb7b72f">opts_</a>(opts), <a class="code" href="classkaldi_1_1OnlineCmvn.html#a322065dc5fc38765ec548e481e1fc29d">src_</a>(src) {</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <a class="code" href="classkaldi_1_1OnlineCmvn.html#a98d07ab5d7731e6fb8233a090f8327ad">SetState</a>(cmvn_state);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi.html#ae95740f87fc2fb79419753e21396c647">SplitStringToIntegers</a>(opts.skip_dims, <span class="stringliteral">&quot;:&quot;</span>, <span class="keyword">false</span>, &amp;<a class="code" href="classkaldi_1_1OnlineCmvn.html#ab66ecef3ba859e18a3d4fb31ab4d780b">skip_dims_</a>))</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Bad --skip-dims option (should be colon-separated list of &quot;</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;              &lt;&lt;  <span class="stringliteral">&quot;integers)&quot;</span>;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;}</div><div class="ttc" id="namespacekaldi_html_ae95740f87fc2fb79419753e21396c647"><div class="ttname"><a href="namespacekaldi.html#ae95740f87fc2fb79419753e21396c647">kaldi::SplitStringToIntegers</a></div><div class="ttdeci">bool SplitStringToIntegers(const std::string &amp;full, const char *delim, bool omit_empty_strings, std::vector&lt; I &gt; *out)</div><div class="ttdoc">Split a string (e.g. </div><div class="ttdef"><b>Definition:</b> <a href="text-utils_8h_source.html#l00068">text-utils.h:68</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a322065dc5fc38765ec548e481e1fc29d"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a322065dc5fc38765ec548e481e1fc29d">kaldi::OnlineCmvn::src_</a></div><div class="ttdeci">OnlineFeatureInterface * src_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00406">online-feature.h:406</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a98d07ab5d7731e6fb8233a090f8327ad"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a98d07ab5d7731e6fb8233a090f8327ad">kaldi::OnlineCmvn::SetState</a></div><div class="ttdeci">void SetState(const OnlineCmvnState &amp;cmvn_state)</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8cc_source.html#l00377">online-feature.cc:377</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00126">kaldi-error.h:126</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_ab66ecef3ba859e18a3d4fb31ab4d780b"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#ab66ecef3ba859e18a3d4fb31ab4d780b">kaldi::OnlineCmvn::skip_dims_</a></div><div class="ttdeci">std::vector&lt; int32 &gt; skip_dims_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00390">online-feature.h:390</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a023608b4ebeadd89bac7a8bbfcb7b72f"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a023608b4ebeadd89bac7a8bbfcb7b72f">kaldi::OnlineCmvn::opts_</a></div><div class="ttdeci">OnlineCmvnOptions opts_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00389">online-feature.h:389</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abfffb10faf9f3af42b26e0a463d081b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfffb10faf9f3af42b26e0a463d081b4">&#9670;&nbsp;</a></span>OnlineCmvn() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1OnlineCmvn.html">OnlineCmvn</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1OnlineCmvnOptions.html">OnlineCmvnOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1OnlineFeatureInterface.html">OnlineFeatureInterface</a> *&#160;</td>
          <td class="paramname"><em>src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializer that does not set the cmvn state: after calling this, you should call <a class="el" href="classkaldi_1_1OnlineCmvn.html#a98d07ab5d7731e6fb8233a090f8327ad">SetState()</a>. </p>

<p class="definition">Definition at line <a class="el" href="online-feature_8cc_source.html#l00153">153</a> of file <a class="el" href="online-feature_8cc_source.html">online-feature.cc</a>.</p>

<p class="reference">References <a class="el" href="kaldi-error_8h_source.html#l00126">KALDI_ERR</a>, <a class="el" href="online-feature_8h_source.html#l00186">OnlineCmvnOptions::skip_dims</a>, <a class="el" href="online-feature_8h_source.html#l00390">OnlineCmvn::skip_dims_</a>, and <a class="el" href="text-utils_8h_source.html#l00068">kaldi::SplitStringToIntegers()</a>.</p>
<div class="fragment"><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                                                   : <a class="code" href="classkaldi_1_1OnlineCmvn.html#a023608b4ebeadd89bac7a8bbfcb7b72f">opts_</a>(opts), <a class="code" href="classkaldi_1_1OnlineCmvn.html#a322065dc5fc38765ec548e481e1fc29d">src_</a>(src) {</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi.html#ae95740f87fc2fb79419753e21396c647">SplitStringToIntegers</a>(opts.skip_dims, <span class="stringliteral">&quot;:&quot;</span>, <span class="keyword">false</span>, &amp;<a class="code" href="classkaldi_1_1OnlineCmvn.html#ab66ecef3ba859e18a3d4fb31ab4d780b">skip_dims_</a>))</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Bad --skip-dims option (should be colon-separated list of &quot;</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;              &lt;&lt;  <span class="stringliteral">&quot;integers)&quot;</span>;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;}</div><div class="ttc" id="namespacekaldi_html_ae95740f87fc2fb79419753e21396c647"><div class="ttname"><a href="namespacekaldi.html#ae95740f87fc2fb79419753e21396c647">kaldi::SplitStringToIntegers</a></div><div class="ttdeci">bool SplitStringToIntegers(const std::string &amp;full, const char *delim, bool omit_empty_strings, std::vector&lt; I &gt; *out)</div><div class="ttdoc">Split a string (e.g. </div><div class="ttdef"><b>Definition:</b> <a href="text-utils_8h_source.html#l00068">text-utils.h:68</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a322065dc5fc38765ec548e481e1fc29d"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a322065dc5fc38765ec548e481e1fc29d">kaldi::OnlineCmvn::src_</a></div><div class="ttdeci">OnlineFeatureInterface * src_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00406">online-feature.h:406</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00126">kaldi-error.h:126</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_ab66ecef3ba859e18a3d4fb31ab4d780b"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#ab66ecef3ba859e18a3d4fb31ab4d780b">kaldi::OnlineCmvn::skip_dims_</a></div><div class="ttdeci">std::vector&lt; int32 &gt; skip_dims_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00390">online-feature.h:390</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a023608b4ebeadd89bac7a8bbfcb7b72f"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a023608b4ebeadd89bac7a8bbfcb7b72f">kaldi::OnlineCmvn::opts_</a></div><div class="ttdeci">OnlineCmvnOptions opts_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00389">online-feature.h:389</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a5c3acab55a57f37b70d524ee9595ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a5c3acab55a57f37b70d524ee9595ca">&#9670;&nbsp;</a></span>~OnlineCmvn()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">~<a class="el" href="classkaldi_1_1OnlineCmvn.html">OnlineCmvn</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="online-feature_8cc_source.html#l00231">231</a> of file <a class="el" href="online-feature_8cc_source.html">online-feature.cc</a>.</p>

<p class="reference">References <a class="el" href="online-feature_8h_source.html#l00401">OnlineCmvn::cached_stats_modulo_</a>, and <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>.</p>
<div class="fragment"><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                        {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classkaldi_1_1OnlineCmvn.html#a7ce1d4486b9d32ecf34ea6b7ff24d721">cached_stats_modulo_</a>.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classkaldi_1_1OnlineCmvn.html#a7ce1d4486b9d32ecf34ea6b7ff24d721">cached_stats_modulo_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <a class="code" href="classkaldi_1_1OnlineCmvn.html#a7ce1d4486b9d32ecf34ea6b7ff24d721">cached_stats_modulo_</a>.clear();</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;}</div><div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a7ce1d4486b9d32ecf34ea6b7ff24d721"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a7ce1d4486b9d32ecf34ea6b7ff24d721">kaldi::OnlineCmvn::cached_stats_modulo_</a></div><div class="ttdeci">std::vector&lt; Matrix&lt; double &gt; * &gt; cached_stats_modulo_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00401">online-feature.h:401</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a2d698dd73768d8efb633a91f71861692"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d698dd73768d8efb633a91f71861692">&#9670;&nbsp;</a></span>CacheFrame()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CacheFrame </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>stats</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Cache this frame of stats. </p>

<p class="definition">Definition at line <a class="el" href="online-feature_8cc_source.html#l00205">205</a> of file <a class="el" href="online-feature_8cc_source.html">online-feature.cc</a>.</p>

<p class="reference">References <a class="el" href="online-feature_8h_source.html#l00401">OnlineCmvn::cached_stats_modulo_</a>, <a class="el" href="online-feature_8h_source.html#l00404">OnlineCmvn::cached_stats_ring_</a>, <a class="el" href="online-feature_8cc_source.html#l00197">OnlineCmvn::InitRingBufferIfNeeded()</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00129">KALDI_WARN</a>, <a class="el" href="online-feature_8h_source.html#l00181">OnlineCmvnOptions::modulus</a>, <a class="el" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">rnnlm::n</a>, and <a class="el" href="online-feature_8h_source.html#l00389">OnlineCmvn::opts_</a>.</p>

<p class="reference">Referenced by <a class="el" href="online-feature_8cc_source.html#l00237">OnlineCmvn::ComputeStatsForFrame()</a>.</p>
<div class="fragment"><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                                                                    {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(frame &gt;= 0);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordflow">if</span> (frame % <a class="code" href="classkaldi_1_1OnlineCmvn.html#a023608b4ebeadd89bac7a8bbfcb7b72f">opts_</a>.<a class="code" href="structkaldi_1_1OnlineCmvnOptions.html#abaa9b3622a4dd9d14c5dcf93611a2664">modulus</a> == 0) {  <span class="comment">// store in cached_stats_modulo_.</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    int32 <a class="code" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">n</a> = frame / <a class="code" href="classkaldi_1_1OnlineCmvn.html#a023608b4ebeadd89bac7a8bbfcb7b72f">opts_</a>.<a class="code" href="structkaldi_1_1OnlineCmvnOptions.html#abaa9b3622a4dd9d14c5dcf93611a2664">modulus</a>;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">if</span> (n &gt;= <a class="code" href="classkaldi_1_1OnlineCmvn.html#a7ce1d4486b9d32ecf34ea6b7ff24d721">cached_stats_modulo_</a>.size()) {</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="comment">// The following assert is a limitation on in what order you can call</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="comment">// CacheFrame.  Fortunately the calling code always calls it in sequence,</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="comment">// which it has to because you need a previous frame to compute the</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <span class="comment">// current one.</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(n == <a class="code" href="classkaldi_1_1OnlineCmvn.html#a7ce1d4486b9d32ecf34ea6b7ff24d721">cached_stats_modulo_</a>.size());</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <a class="code" href="classkaldi_1_1OnlineCmvn.html#a7ce1d4486b9d32ecf34ea6b7ff24d721">cached_stats_modulo_</a>.push_back(<span class="keyword">new</span> Matrix&lt;double&gt;(stats));</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Did not expect to reach this part of code.&quot;</span>;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <span class="comment">// do what seems right, but we shouldn&#39;t get here.</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <a class="code" href="classkaldi_1_1OnlineCmvn.html#a7ce1d4486b9d32ecf34ea6b7ff24d721">cached_stats_modulo_</a>[<a class="code" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">n</a>]-&gt;CopyFromMat(stats);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    }</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  } <span class="keywordflow">else</span> {  <span class="comment">// store in the ring buffer.</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <a class="code" href="classkaldi_1_1OnlineCmvn.html#a92641d93c3b407c3c2e63124ed783d6f">InitRingBufferIfNeeded</a>();</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classkaldi_1_1OnlineCmvn.html#a4290d1d4db51bdeff3b3cad91c904ae9">cached_stats_ring_</a>.empty()) {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      int32 index = frame % <a class="code" href="classkaldi_1_1OnlineCmvn.html#a4290d1d4db51bdeff3b3cad91c904ae9">cached_stats_ring_</a>.size();</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <a class="code" href="classkaldi_1_1OnlineCmvn.html#a4290d1d4db51bdeff3b3cad91c904ae9">cached_stats_ring_</a>[index].first = frame;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <a class="code" href="classkaldi_1_1OnlineCmvn.html#a4290d1d4db51bdeff3b3cad91c904ae9">cached_stats_ring_</a>[index].second.CopyFromMat(stats);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    }</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  }</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;}</div><div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a92641d93c3b407c3c2e63124ed783d6f"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a92641d93c3b407c3c2e63124ed783d6f">kaldi::OnlineCmvn::InitRingBufferIfNeeded</a></div><div class="ttdeci">void InitRingBufferIfNeeded()</div><div class="ttdoc">Initialize ring buffer for caching stats. </div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8cc_source.html#l00197">online-feature.cc:197</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a4290d1d4db51bdeff3b3cad91c904ae9"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a4290d1d4db51bdeff3b3cad91c904ae9">kaldi::OnlineCmvn::cached_stats_ring_</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; int32, Matrix&lt; double &gt; &gt; &gt; cached_stats_ring_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00404">online-feature.h:404</a></div></div>
<div class="ttc" id="namespacernnlm_html_ab4871778d570f724a07823e0a2fb9884"><div class="ttname"><a href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@11::@12 n</div></div>
<div class="ttc" id="structkaldi_1_1OnlineCmvnOptions_html_abaa9b3622a4dd9d14c5dcf93611a2664"><div class="ttname"><a href="structkaldi_1_1OnlineCmvnOptions.html#abaa9b3622a4dd9d14c5dcf93611a2664">kaldi::OnlineCmvnOptions::modulus</a></div><div class="ttdeci">int32 modulus</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00181">online-feature.h:181</a></div></div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00129">kaldi-error.h:129</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a023608b4ebeadd89bac7a8bbfcb7b72f"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a023608b4ebeadd89bac7a8bbfcb7b72f">kaldi::OnlineCmvn::opts_</a></div><div class="ttdeci">OnlineCmvnOptions opts_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00389">online-feature.h:389</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a7ce1d4486b9d32ecf34ea6b7ff24d721"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a7ce1d4486b9d32ecf34ea6b7ff24d721">kaldi::OnlineCmvn::cached_stats_modulo_</a></div><div class="ttdeci">std::vector&lt; Matrix&lt; double &gt; * &gt; cached_stats_modulo_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00401">online-feature.h:401</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a57b7e0b87dbf1038195e05d4626ecc6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57b7e0b87dbf1038195e05d4626ecc6f">&#9670;&nbsp;</a></span>ComputeStatsForFrame()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ComputeStatsForFrame </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>stats</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the raw CMVN stats for this frame, making use of (and updating if necessary) the cached statistics in raw_stats_. </p>
<p>This means the (x, x^2, count) stats for the last up to opts_.cmn_window frames. </p>

<p class="definition">Definition at line <a class="el" href="online-feature_8cc_source.html#l00237">237</a> of file <a class="el" href="online-feature_8cc_source.html">online-feature.cc</a>.</p>

<p class="reference">References <a class="el" href="online-feature_8cc_source.html#l00205">OnlineCmvn::CacheFrame()</a>, <a class="el" href="online-feature_8h_source.html#l00175">OnlineCmvnOptions::cmn_window</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l00861">MatrixBase&lt; Real &gt;::CopyFromMat()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00228">VectorBase&lt; Real &gt;::CopyFromVec()</a>, <a class="el" href="online-feature_8h_source.html#l00297">OnlineCmvn::Dim()</a>, <a class="el" href="classkaldi_1_1OnlineFeatureInterface.html#a7ee271dbb4707753e1ee4b0aa45eae37">OnlineFeatureInterface::GetFrame()</a>, <a class="el" href="online-feature_8cc_source.html#l00161">OnlineCmvn::GetMostRecentCachedFrame()</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="online-feature_8h_source.html#l00307">OnlineCmvn::NumFramesReady()</a>, <a class="el" href="online-feature_8h_source.html#l00389">OnlineCmvn::opts_</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00185">MatrixBase&lt; Real &gt;::Row()</a>, and <a class="el" href="online-feature_8h_source.html#l00406">OnlineCmvn::src_</a>.</p>

<p class="reference">Referenced by <a class="el" href="online-feature_8cc_source.html#l00342">OnlineCmvn::Freeze()</a>, and <a class="el" href="online-feature_8cc_source.html#l00309">OnlineCmvn::GetFrame()</a>.</p>
<div class="fragment"><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                                                                     {</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(frame &gt;= 0 &amp;&amp; frame &lt; src_-&gt;<a class="code" href="classkaldi_1_1OnlineCmvn.html#a60b0869d95fc438d1723671fef3e2c08">NumFramesReady</a>());</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  int32 dim = this-&gt;<a class="code" href="classkaldi_1_1OnlineCmvn.html#a1a121442e95f6b43f46a61cefffb2252">Dim</a>(), cur_frame;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  Matrix&lt;double&gt; stats(2, dim + 1);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <a class="code" href="classkaldi_1_1OnlineCmvn.html#a984d80cbec6e4b952e1438dee0a473b1">GetMostRecentCachedFrame</a>(frame, &amp;cur_frame, &amp;stats);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  Vector&lt;BaseFloat&gt; feats(dim);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  Vector&lt;double&gt; feats_dbl(dim);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordflow">while</span> (cur_frame &lt; frame) {</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    cur_frame++;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="classkaldi_1_1OnlineCmvn.html#a322065dc5fc38765ec548e481e1fc29d">src_</a>-&gt;<a class="code" href="classkaldi_1_1OnlineFeatureInterface.html#a7ee271dbb4707753e1ee4b0aa45eae37">GetFrame</a>(cur_frame, &amp;feats);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    feats_dbl.CopyFromVec(feats);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    stats.Row(0).Range(0, dim).AddVec(1.0, feats_dbl);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    stats.Row(1).Range(0, dim).AddVec2(1.0, feats_dbl);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    stats(0, dim) += 1.0;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">// it&#39;s a sliding buffer; a frame at the back may be</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">// leaving the buffer so we have to subtract that.</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    int32 prev_frame = cur_frame - <a class="code" href="classkaldi_1_1OnlineCmvn.html#a023608b4ebeadd89bac7a8bbfcb7b72f">opts_</a>.<a class="code" href="structkaldi_1_1OnlineCmvnOptions.html#a4070d4c67ffe35fc616357be9ebe25d4">cmn_window</a>;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">if</span> (prev_frame &gt;= 0) {</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <span class="comment">// we need to subtract frame prev_f from the stats.</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <a class="code" href="classkaldi_1_1OnlineCmvn.html#a322065dc5fc38765ec548e481e1fc29d">src_</a>-&gt;<a class="code" href="classkaldi_1_1OnlineFeatureInterface.html#a7ee271dbb4707753e1ee4b0aa45eae37">GetFrame</a>(prev_frame, &amp;feats);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      feats_dbl.CopyFromVec(feats);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      stats.Row(0).Range(0, dim).AddVec(-1.0, feats_dbl);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      stats.Row(1).Range(0, dim).AddVec2(-1.0, feats_dbl);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      stats(0, dim) -= 1.0;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    }</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <a class="code" href="classkaldi_1_1OnlineCmvn.html#a2d698dd73768d8efb633a91f71861692">CacheFrame</a>(cur_frame, stats);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  }</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  stats_out-&gt;CopyFromMat(stats);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;}</div><div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a1a121442e95f6b43f46a61cefffb2252"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a1a121442e95f6b43f46a61cefffb2252">kaldi::OnlineCmvn::Dim</a></div><div class="ttdeci">virtual int32 Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00297">online-feature.h:297</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineFeatureInterface_html_a7ee271dbb4707753e1ee4b0aa45eae37"><div class="ttname"><a href="classkaldi_1_1OnlineFeatureInterface.html#a7ee271dbb4707753e1ee4b0aa45eae37">kaldi::OnlineFeatureInterface::GetFrame</a></div><div class="ttdeci">virtual void GetFrame(int32 frame, VectorBase&lt; BaseFloat &gt; *feat)=0</div><div class="ttdoc">Gets the feature vector for this frame. </div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a322065dc5fc38765ec548e481e1fc29d"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a322065dc5fc38765ec548e481e1fc29d">kaldi::OnlineCmvn::src_</a></div><div class="ttdeci">OnlineFeatureInterface * src_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00406">online-feature.h:406</a></div></div>
<div class="ttc" id="structkaldi_1_1OnlineCmvnOptions_html_a4070d4c67ffe35fc616357be9ebe25d4"><div class="ttname"><a href="structkaldi_1_1OnlineCmvnOptions.html#a4070d4c67ffe35fc616357be9ebe25d4">kaldi::OnlineCmvnOptions::cmn_window</a></div><div class="ttdeci">int32 cmn_window</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00175">online-feature.h:175</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a984d80cbec6e4b952e1438dee0a473b1"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a984d80cbec6e4b952e1438dee0a473b1">kaldi::OnlineCmvn::GetMostRecentCachedFrame</a></div><div class="ttdeci">void GetMostRecentCachedFrame(int32 frame, int32 *cached_frame, Matrix&lt; double &gt; *stats)</div><div class="ttdoc">Get the most recent cached frame of CMVN stats. </div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8cc_source.html#l00161">online-feature.cc:161</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a023608b4ebeadd89bac7a8bbfcb7b72f"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a023608b4ebeadd89bac7a8bbfcb7b72f">kaldi::OnlineCmvn::opts_</a></div><div class="ttdeci">OnlineCmvnOptions opts_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00389">online-feature.h:389</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a2d698dd73768d8efb633a91f71861692"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a2d698dd73768d8efb633a91f71861692">kaldi::OnlineCmvn::CacheFrame</a></div><div class="ttdeci">void CacheFrame(int32 frame, const Matrix&lt; double &gt; &amp;stats)</div><div class="ttdoc">Cache this frame of stats. </div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8cc_source.html#l00205">online-feature.cc:205</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a60b0869d95fc438d1723671fef3e2c08"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a60b0869d95fc438d1723671fef3e2c08">kaldi::OnlineCmvn::NumFramesReady</a></div><div class="ttdeci">virtual int32 NumFramesReady() const</div><div class="ttdoc">returns the feature dimension. </div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00307">online-feature.h:307</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1a121442e95f6b43f46a61cefffb2252"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a121442e95f6b43f46a61cefffb2252">&#9670;&nbsp;</a></span>Dim()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual int32 Dim </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classkaldi_1_1OnlineFeatureInterface.html#a1e6abebbe836e85e2eac912470f2a9e8">OnlineFeatureInterface</a>.</p>

<p class="definition">Definition at line <a class="el" href="online-feature_8h_source.html#l00297">297</a> of file <a class="el" href="online-feature_8h_source.html">online-feature.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="online-feature_8cc_source.html#l00237">OnlineCmvn::ComputeStatsForFrame()</a>, <a class="el" href="online-feature_8cc_source.html#l00342">OnlineCmvn::Freeze()</a>, <a class="el" href="online-feature_8cc_source.html#l00309">OnlineCmvn::GetFrame()</a>, <a class="el" href="online-feature_8cc_source.html#l00161">OnlineCmvn::GetMostRecentCachedFrame()</a>, <a class="el" href="online-feature_8cc_source.html#l00355">OnlineCmvn::GetState()</a>, and <a class="el" href="online-feature_8cc_source.html#l00197">OnlineCmvn::InitRingBufferIfNeeded()</a>.</p>
<div class="fragment"><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1OnlineCmvn.html#a322065dc5fc38765ec548e481e1fc29d">src_</a>-&gt;<a class="code" href="classkaldi_1_1OnlineFeatureInterface.html#a1e6abebbe836e85e2eac912470f2a9e8">Dim</a>(); }</div><div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a322065dc5fc38765ec548e481e1fc29d"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a322065dc5fc38765ec548e481e1fc29d">kaldi::OnlineCmvn::src_</a></div><div class="ttdeci">OnlineFeatureInterface * src_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00406">online-feature.h:406</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineFeatureInterface_html_a1e6abebbe836e85e2eac912470f2a9e8"><div class="ttname"><a href="classkaldi_1_1OnlineFeatureInterface.html#a1e6abebbe836e85e2eac912470f2a9e8">kaldi::OnlineFeatureInterface::Dim</a></div><div class="ttdeci">virtual int32 Dim() const =0</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae7f952bcbfcdeb496dad5dff0ebc74fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7f952bcbfcdeb496dad5dff0ebc74fc">&#9670;&nbsp;</a></span>FrameShiftInSeconds()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> FrameShiftInSeconds </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classkaldi_1_1OnlineFeatureInterface.html#a81fe3a217e16fbe4c2e680c34051bc8b">OnlineFeatureInterface</a>.</p>

<p class="definition">Definition at line <a class="el" href="online-feature_8h_source.html#l00302">302</a> of file <a class="el" href="online-feature_8h_source.html">online-feature.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                                                {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1OnlineCmvn.html#a322065dc5fc38765ec548e481e1fc29d">src_</a>-&gt;<a class="code" href="classkaldi_1_1OnlineFeatureInterface.html#a81fe3a217e16fbe4c2e680c34051bc8b">FrameShiftInSeconds</a>();</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  }</div><div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a322065dc5fc38765ec548e481e1fc29d"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a322065dc5fc38765ec548e481e1fc29d">kaldi::OnlineCmvn::src_</a></div><div class="ttdeci">OnlineFeatureInterface * src_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00406">online-feature.h:406</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineFeatureInterface_html_a81fe3a217e16fbe4c2e680c34051bc8b"><div class="ttname"><a href="classkaldi_1_1OnlineFeatureInterface.html#a81fe3a217e16fbe4c2e680c34051bc8b">kaldi::OnlineFeatureInterface::FrameShiftInSeconds</a></div><div class="ttdeci">virtual BaseFloat FrameShiftInSeconds() const =0</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5718bd1d5354dfcdf15054cbac622f7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5718bd1d5354dfcdf15054cbac622f7e">&#9670;&nbsp;</a></span>Freeze()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Freeze </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>cur_frame</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="online-feature_8cc_source.html#l00342">342</a> of file <a class="el" href="online-feature_8cc_source.html">online-feature.cc</a>.</p>

<p class="reference">References <a class="el" href="online-feature_8cc_source.html#l00237">OnlineCmvn::ComputeStatsForFrame()</a>, <a class="el" href="online-feature_8h_source.html#l00297">OnlineCmvn::Dim()</a>, <a class="el" href="online-feature_8h_source.html#l00393">OnlineCmvn::frozen_state_</a>, <a class="el" href="online-feature_8h_source.html#l00244">OnlineCmvnState::global_cmvn_stats</a>, <a class="el" href="online-feature_8h_source.html#l00389">OnlineCmvn::opts_</a>, <a class="el" href="online-feature_8h_source.html#l00391">OnlineCmvn::orig_state_</a>, <a class="el" href="online-feature_8cc_source.html#l00272">OnlineCmvn::SmoothOnlineCmvnStats()</a>, and <a class="el" href="online-feature_8h_source.html#l00239">OnlineCmvnState::speaker_cmvn_stats</a>.</p>
<div class="fragment"><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                                       {</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  int32 dim = this-&gt;<a class="code" href="classkaldi_1_1OnlineCmvn.html#a1a121442e95f6b43f46a61cefffb2252">Dim</a>();</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  Matrix&lt;double&gt; stats(2, dim + 1);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="comment">// get the raw CMVN stats</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  this-&gt;<a class="code" href="classkaldi_1_1OnlineCmvn.html#a57b7e0b87dbf1038195e05d4626ecc6f">ComputeStatsForFrame</a>(cur_frame, &amp;stats);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="comment">// now smooth them.</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <a class="code" href="classkaldi_1_1OnlineCmvn.html#a01a55231d7eef11d4049e3f1cc7dafdb">SmoothOnlineCmvnStats</a>(<a class="code" href="classkaldi_1_1OnlineCmvn.html#a33a20a5700c3883769ce49801bc80839">orig_state_</a>.<a class="code" href="structkaldi_1_1OnlineCmvnState.html#a9cc9f620f9068a0d8ac8ad656fb02d87">speaker_cmvn_stats</a>,</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                        <a class="code" href="classkaldi_1_1OnlineCmvn.html#a33a20a5700c3883769ce49801bc80839">orig_state_</a>.<a class="code" href="structkaldi_1_1OnlineCmvnState.html#a8d6a490cb46075f60cd7466764d47542">global_cmvn_stats</a>,</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                        <a class="code" href="classkaldi_1_1OnlineCmvn.html#a023608b4ebeadd89bac7a8bbfcb7b72f">opts_</a>,</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                        &amp;stats);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  this-&gt;<a class="code" href="classkaldi_1_1OnlineCmvn.html#a680635335d7ce64a8c4cb6285309455c">frozen_state_</a> = stats;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;}</div><div class="ttc" id="structkaldi_1_1OnlineCmvnState_html_a9cc9f620f9068a0d8ac8ad656fb02d87"><div class="ttname"><a href="structkaldi_1_1OnlineCmvnState.html#a9cc9f620f9068a0d8ac8ad656fb02d87">kaldi::OnlineCmvnState::speaker_cmvn_stats</a></div><div class="ttdeci">Matrix&lt; double &gt; speaker_cmvn_stats</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00239">online-feature.h:239</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a1a121442e95f6b43f46a61cefffb2252"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a1a121442e95f6b43f46a61cefffb2252">kaldi::OnlineCmvn::Dim</a></div><div class="ttdeci">virtual int32 Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00297">online-feature.h:297</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a680635335d7ce64a8c4cb6285309455c"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a680635335d7ce64a8c4cb6285309455c">kaldi::OnlineCmvn::frozen_state_</a></div><div class="ttdeci">Matrix&lt; double &gt; frozen_state_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00393">online-feature.h:393</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a33a20a5700c3883769ce49801bc80839"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a33a20a5700c3883769ce49801bc80839">kaldi::OnlineCmvn::orig_state_</a></div><div class="ttdeci">OnlineCmvnState orig_state_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00391">online-feature.h:391</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a023608b4ebeadd89bac7a8bbfcb7b72f"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a023608b4ebeadd89bac7a8bbfcb7b72f">kaldi::OnlineCmvn::opts_</a></div><div class="ttdeci">OnlineCmvnOptions opts_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00389">online-feature.h:389</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a57b7e0b87dbf1038195e05d4626ecc6f"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a57b7e0b87dbf1038195e05d4626ecc6f">kaldi::OnlineCmvn::ComputeStatsForFrame</a></div><div class="ttdeci">void ComputeStatsForFrame(int32 frame, MatrixBase&lt; double &gt; *stats)</div><div class="ttdoc">Computes the raw CMVN stats for this frame, making use of (and updating if necessary) the cached stat...</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8cc_source.html#l00237">online-feature.cc:237</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a01a55231d7eef11d4049e3f1cc7dafdb"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a01a55231d7eef11d4049e3f1cc7dafdb">kaldi::OnlineCmvn::SmoothOnlineCmvnStats</a></div><div class="ttdeci">static void SmoothOnlineCmvnStats(const MatrixBase&lt; double &gt; &amp;speaker_stats, const MatrixBase&lt; double &gt; &amp;global_stats, const OnlineCmvnOptions &amp;opts, MatrixBase&lt; double &gt; *stats)</div><div class="ttdoc">Smooth the CMVN stats &quot;stats&quot; (which are stored in the normal format as a 2 x (dim+1) matrix)...</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8cc_source.html#l00272">online-feature.cc:272</a></div></div>
<div class="ttc" id="structkaldi_1_1OnlineCmvnState_html_a8d6a490cb46075f60cd7466764d47542"><div class="ttname"><a href="structkaldi_1_1OnlineCmvnState.html#a8d6a490cb46075f60cd7466764d47542">kaldi::OnlineCmvnState::global_cmvn_stats</a></div><div class="ttdeci">Matrix&lt; double &gt; global_cmvn_stats</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00244">online-feature.h:244</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afeef84368a0238c6c170d37e2c6b07dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeef84368a0238c6c170d37e2c6b07dc">&#9670;&nbsp;</a></span>GetFrame()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void GetFrame </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; *&#160;</td>
          <td class="paramname"><em>feat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the feature vector for this frame. </p>
<p>Before calling this for a given frame, it is assumed that you called <a class="el" href="classkaldi_1_1OnlineCmvn.html#a60b0869d95fc438d1723671fef3e2c08" title="returns the feature dimension. ">NumFramesReady()</a> and it returned a number greater than "frame". Otherwise this call will likely crash with an assert failure. This function is not declared const, in case there is some kind of caching going on, but most of the time it shouldn't modify the class. </p>

<p>Implements <a class="el" href="classkaldi_1_1OnlineFeatureInterface.html#a7ee271dbb4707753e1ee4b0aa45eae37">OnlineFeatureInterface</a>.</p>

<p class="definition">Definition at line <a class="el" href="online-feature_8cc_source.html#l00309">309</a> of file <a class="el" href="online-feature_8cc_source.html">online-feature.cc</a>.</p>

<p class="reference">References <a class="el" href="cmvn_8cc_source.html#l00064">kaldi::ApplyCmvn()</a>, <a class="el" href="online-feature_8cc_source.html#l00237">OnlineCmvn::ComputeStatsForFrame()</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l00861">MatrixBase&lt; Real &gt;::CopyFromMat()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00228">VectorBase&lt; Real &gt;::CopyFromVec()</a>, <a class="el" href="kaldi-vector_8h_source.html#l00063">VectorBase&lt; Real &gt;::Dim()</a>, <a class="el" href="online-feature_8h_source.html#l00297">OnlineCmvn::Dim()</a>, <a class="el" href="cmvn_8cc_source.html#l00176">kaldi::FakeStatsForSomeDims()</a>, <a class="el" href="online-feature_8h_source.html#l00393">OnlineCmvn::frozen_state_</a>, <a class="el" href="classkaldi_1_1OnlineFeatureInterface.html#a7ee271dbb4707753e1ee4b0aa45eae37">OnlineFeatureInterface::GetFrame()</a>, <a class="el" href="online-feature_8h_source.html#l00244">OnlineCmvnState::global_cmvn_stats</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="online-feature_8h_source.html#l00178">OnlineCmvnOptions::normalize_mean</a>, <a class="el" href="online-feature_8h_source.html#l00179">OnlineCmvnOptions::normalize_variance</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00061">MatrixBase&lt; Real &gt;::NumRows()</a>, <a class="el" href="online-feature_8h_source.html#l00389">OnlineCmvn::opts_</a>, <a class="el" href="online-feature_8h_source.html#l00391">OnlineCmvn::orig_state_</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00185">MatrixBase&lt; Real &gt;::Row()</a>, <a class="el" href="online-feature_8h_source.html#l00390">OnlineCmvn::skip_dims_</a>, <a class="el" href="online-feature_8cc_source.html#l00272">OnlineCmvn::SmoothOnlineCmvnStats()</a>, <a class="el" href="online-feature_8h_source.html#l00239">OnlineCmvnState::speaker_cmvn_stats</a>, and <a class="el" href="online-feature_8h_source.html#l00406">OnlineCmvn::src_</a>.</p>
<div class="fragment"><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                                                       {</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <a class="code" href="classkaldi_1_1OnlineCmvn.html#a322065dc5fc38765ec548e481e1fc29d">src_</a>-&gt;<a class="code" href="classkaldi_1_1OnlineFeatureInterface.html#a7ee271dbb4707753e1ee4b0aa45eae37">GetFrame</a>(frame, feat);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(feat-&gt;Dim() == this-&gt;<a class="code" href="classkaldi_1_1OnlineCmvn.html#a1a121442e95f6b43f46a61cefffb2252">Dim</a>());</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  int32 dim = feat-&gt;Dim();</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  Matrix&lt;double&gt; stats(2, dim + 1);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1OnlineCmvn.html#a680635335d7ce64a8c4cb6285309455c">frozen_state_</a>.<a class="code" href="classkaldi_1_1MatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">NumRows</a>() != 0) {  <span class="comment">// the CMVN state has been frozen.</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    stats.CopyFromMat(<a class="code" href="classkaldi_1_1OnlineCmvn.html#a680635335d7ce64a8c4cb6285309455c">frozen_state_</a>);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">// first get the raw CMVN stats (this involves caching..)</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    this-&gt;<a class="code" href="classkaldi_1_1OnlineCmvn.html#a57b7e0b87dbf1038195e05d4626ecc6f">ComputeStatsForFrame</a>(frame, &amp;stats);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">// now smooth them.</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <a class="code" href="classkaldi_1_1OnlineCmvn.html#a01a55231d7eef11d4049e3f1cc7dafdb">SmoothOnlineCmvnStats</a>(<a class="code" href="classkaldi_1_1OnlineCmvn.html#a33a20a5700c3883769ce49801bc80839">orig_state_</a>.<a class="code" href="structkaldi_1_1OnlineCmvnState.html#a9cc9f620f9068a0d8ac8ad656fb02d87">speaker_cmvn_stats</a>,</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                          <a class="code" href="classkaldi_1_1OnlineCmvn.html#a33a20a5700c3883769ce49801bc80839">orig_state_</a>.<a class="code" href="structkaldi_1_1OnlineCmvnState.html#a8d6a490cb46075f60cd7466764d47542">global_cmvn_stats</a>,</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                          <a class="code" href="classkaldi_1_1OnlineCmvn.html#a023608b4ebeadd89bac7a8bbfcb7b72f">opts_</a>,</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                          &amp;stats);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  }</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classkaldi_1_1OnlineCmvn.html#ab66ecef3ba859e18a3d4fb31ab4d780b">skip_dims_</a>.empty())</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <a class="code" href="namespacekaldi.html#a771f08f18f71bf75d3b022725144d04b">FakeStatsForSomeDims</a>(<a class="code" href="classkaldi_1_1OnlineCmvn.html#ab66ecef3ba859e18a3d4fb31ab4d780b">skip_dims_</a>, &amp;stats);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="comment">// call the function ApplyCmvn declared in ../transform/cmvn.h, which</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="comment">// requires a matrix.</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  Matrix&lt;BaseFloat&gt; feat_mat(1, dim);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  feat_mat.Row(0).CopyFromVec(*feat);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="comment">// the function ApplyCmvn takes a matrix, so form a one-row matrix to give it.</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1OnlineCmvn.html#a023608b4ebeadd89bac7a8bbfcb7b72f">opts_</a>.<a class="code" href="structkaldi_1_1OnlineCmvnOptions.html#ac04b8fca1a7786a2a873c1f6e4830563">normalize_mean</a>)</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <a class="code" href="namespacekaldi.html#aedc890351c44990fe9c3d7f1d0e2c69a">ApplyCmvn</a>(stats, <a class="code" href="classkaldi_1_1OnlineCmvn.html#a023608b4ebeadd89bac7a8bbfcb7b72f">opts_</a>.<a class="code" href="structkaldi_1_1OnlineCmvnOptions.html#a40f7b19187468610ab1325176ad9f812">normalize_variance</a>, &amp;feat_mat);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!<a class="code" href="classkaldi_1_1OnlineCmvn.html#a023608b4ebeadd89bac7a8bbfcb7b72f">opts_</a>.<a class="code" href="structkaldi_1_1OnlineCmvnOptions.html#a40f7b19187468610ab1325176ad9f812">normalize_variance</a>);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  feat-&gt;CopyFromVec(feat_mat.Row(0));</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;}</div><div class="ttc" id="structkaldi_1_1OnlineCmvnState_html_a9cc9f620f9068a0d8ac8ad656fb02d87"><div class="ttname"><a href="structkaldi_1_1OnlineCmvnState.html#a9cc9f620f9068a0d8ac8ad656fb02d87">kaldi::OnlineCmvnState::speaker_cmvn_stats</a></div><div class="ttdeci">Matrix&lt; double &gt; speaker_cmvn_stats</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00239">online-feature.h:239</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a1a121442e95f6b43f46a61cefffb2252"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a1a121442e95f6b43f46a61cefffb2252">kaldi::OnlineCmvn::Dim</a></div><div class="ttdeci">virtual int32 Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00297">online-feature.h:297</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineFeatureInterface_html_a7ee271dbb4707753e1ee4b0aa45eae37"><div class="ttname"><a href="classkaldi_1_1OnlineFeatureInterface.html#a7ee271dbb4707753e1ee4b0aa45eae37">kaldi::OnlineFeatureInterface::GetFrame</a></div><div class="ttdeci">virtual void GetFrame(int32 frame, VectorBase&lt; BaseFloat &gt; *feat)=0</div><div class="ttdoc">Gets the feature vector for this frame. </div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a680635335d7ce64a8c4cb6285309455c"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a680635335d7ce64a8c4cb6285309455c">kaldi::OnlineCmvn::frozen_state_</a></div><div class="ttdeci">Matrix&lt; double &gt; frozen_state_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00393">online-feature.h:393</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a322065dc5fc38765ec548e481e1fc29d"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a322065dc5fc38765ec548e481e1fc29d">kaldi::OnlineCmvn::src_</a></div><div class="ttdeci">OnlineFeatureInterface * src_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00406">online-feature.h:406</a></div></div>
<div class="ttc" id="structkaldi_1_1OnlineCmvnOptions_html_a40f7b19187468610ab1325176ad9f812"><div class="ttname"><a href="structkaldi_1_1OnlineCmvnOptions.html#a40f7b19187468610ab1325176ad9f812">kaldi::OnlineCmvnOptions::normalize_variance</a></div><div class="ttdeci">bool normalize_variance</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00179">online-feature.h:179</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_ab66ecef3ba859e18a3d4fb31ab4d780b"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#ab66ecef3ba859e18a3d4fb31ab4d780b">kaldi::OnlineCmvn::skip_dims_</a></div><div class="ttdeci">std::vector&lt; int32 &gt; skip_dims_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00390">online-feature.h:390</a></div></div>
<div class="ttc" id="structkaldi_1_1OnlineCmvnOptions_html_ac04b8fca1a7786a2a873c1f6e4830563"><div class="ttname"><a href="structkaldi_1_1OnlineCmvnOptions.html#ac04b8fca1a7786a2a873c1f6e4830563">kaldi::OnlineCmvnOptions::normalize_mean</a></div><div class="ttdeci">bool normalize_mean</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00178">online-feature.h:178</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a33a20a5700c3883769ce49801bc80839"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a33a20a5700c3883769ce49801bc80839">kaldi::OnlineCmvn::orig_state_</a></div><div class="ttdeci">OnlineCmvnState orig_state_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00391">online-feature.h:391</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a023608b4ebeadd89bac7a8bbfcb7b72f"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a023608b4ebeadd89bac7a8bbfcb7b72f">kaldi::OnlineCmvn::opts_</a></div><div class="ttdeci">OnlineCmvnOptions opts_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00389">online-feature.h:389</a></div></div>
<div class="ttc" id="namespacekaldi_html_aedc890351c44990fe9c3d7f1d0e2c69a"><div class="ttname"><a href="namespacekaldi.html#aedc890351c44990fe9c3d7f1d0e2c69a">kaldi::ApplyCmvn</a></div><div class="ttdeci">void ApplyCmvn(const MatrixBase&lt; double &gt; &amp;stats, bool var_norm, MatrixBase&lt; BaseFloat &gt; *feats, bool mean_norm)</div><div class="ttdoc">Apply cepstral mean and variance normalization to a matrix of features. </div><div class="ttdef"><b>Definition:</b> <a href="cmvn_8cc_source.html#l00064">cmvn.cc:64</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1MatrixBase_html_a01cf7fccddf8deddc75b34408144ded1"><div class="ttname"><a href="classkaldi_1_1MatrixBase.html#a01cf7fccddf8deddc75b34408144ded1">kaldi::MatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const</div><div class="ttdoc">Returns number of rows (or zero for emtpy matrix). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l00061">kaldi-matrix.h:61</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a57b7e0b87dbf1038195e05d4626ecc6f"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a57b7e0b87dbf1038195e05d4626ecc6f">kaldi::OnlineCmvn::ComputeStatsForFrame</a></div><div class="ttdeci">void ComputeStatsForFrame(int32 frame, MatrixBase&lt; double &gt; *stats)</div><div class="ttdoc">Computes the raw CMVN stats for this frame, making use of (and updating if necessary) the cached stat...</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8cc_source.html#l00237">online-feature.cc:237</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a01a55231d7eef11d4049e3f1cc7dafdb"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a01a55231d7eef11d4049e3f1cc7dafdb">kaldi::OnlineCmvn::SmoothOnlineCmvnStats</a></div><div class="ttdeci">static void SmoothOnlineCmvnStats(const MatrixBase&lt; double &gt; &amp;speaker_stats, const MatrixBase&lt; double &gt; &amp;global_stats, const OnlineCmvnOptions &amp;opts, MatrixBase&lt; double &gt; *stats)</div><div class="ttdoc">Smooth the CMVN stats &quot;stats&quot; (which are stored in the normal format as a 2 x (dim+1) matrix)...</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8cc_source.html#l00272">online-feature.cc:272</a></div></div>
<div class="ttc" id="structkaldi_1_1OnlineCmvnState_html_a8d6a490cb46075f60cd7466764d47542"><div class="ttname"><a href="structkaldi_1_1OnlineCmvnState.html#a8d6a490cb46075f60cd7466764d47542">kaldi::OnlineCmvnState::global_cmvn_stats</a></div><div class="ttdeci">Matrix&lt; double &gt; global_cmvn_stats</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00244">online-feature.h:244</a></div></div>
<div class="ttc" id="namespacekaldi_html_a771f08f18f71bf75d3b022725144d04b"><div class="ttname"><a href="namespacekaldi.html#a771f08f18f71bf75d3b022725144d04b">kaldi::FakeStatsForSomeDims</a></div><div class="ttdeci">void FakeStatsForSomeDims(const std::vector&lt; int32 &gt; &amp;dims, MatrixBase&lt; double &gt; *stats)</div><div class="ttdoc">Modify the stats so that for some dimensions (specified in &quot;dims&quot;), we replace them with &quot;fake&quot; stats...</div><div class="ttdef"><b>Definition:</b> <a href="cmvn_8cc_source.html#l00176">cmvn.cc:176</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a984d80cbec6e4b952e1438dee0a473b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a984d80cbec6e4b952e1438dee0a473b1">&#9670;&nbsp;</a></span>GetMostRecentCachedFrame()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void GetMostRecentCachedFrame </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32 *&#160;</td>
          <td class="paramname"><em>cached_frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>stats</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the most recent cached frame of CMVN stats. </p>
<p>[If no frames were cached, sets up empty stats for frame zero and returns that]. </p>

<p class="definition">Definition at line <a class="el" href="online-feature_8cc_source.html#l00161">161</a> of file <a class="el" href="online-feature_8cc_source.html">online-feature.cc</a>.</p>

<p class="reference">References <a class="el" href="online-feature_8h_source.html#l00401">OnlineCmvn::cached_stats_modulo_</a>, <a class="el" href="online-feature_8h_source.html#l00404">OnlineCmvn::cached_stats_ring_</a>, <a class="el" href="online-feature_8h_source.html#l00297">OnlineCmvn::Dim()</a>, <a class="el" href="online-feature_8cc_source.html#l00197">OnlineCmvn::InitRingBufferIfNeeded()</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="online-feature_8h_source.html#l00181">OnlineCmvnOptions::modulus</a>, <a class="el" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">rnnlm::n</a>, <a class="el" href="online-feature_8h_source.html#l00389">OnlineCmvn::opts_</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l00818">Matrix&lt; Real &gt;::Resize()</a>, and <a class="el" href="online-feature_8h_source.html#l00184">OnlineCmvnOptions::ring_buffer_size</a>.</p>

<p class="reference">Referenced by <a class="el" href="online-feature_8cc_source.html#l00237">OnlineCmvn::ComputeStatsForFrame()</a>.</p>
<div class="fragment"><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                                                                 {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(frame &gt;= 0);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <a class="code" href="classkaldi_1_1OnlineCmvn.html#a92641d93c3b407c3c2e63124ed783d6f">InitRingBufferIfNeeded</a>();</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="comment">// look for a cached frame on a previous frame as close as possible in time</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="comment">// to &quot;frame&quot;.  Return if we get one.</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keywordflow">for</span> (int32 t = frame; t &gt;= 0 &amp;&amp; t &gt;= frame - <a class="code" href="classkaldi_1_1OnlineCmvn.html#a023608b4ebeadd89bac7a8bbfcb7b72f">opts_</a>.<a class="code" href="structkaldi_1_1OnlineCmvnOptions.html#ae67de23b4650a5335632052f5d29317a">ring_buffer_size</a>; t--) {</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">if</span> (t % <a class="code" href="classkaldi_1_1OnlineCmvn.html#a023608b4ebeadd89bac7a8bbfcb7b72f">opts_</a>.<a class="code" href="structkaldi_1_1OnlineCmvnOptions.html#abaa9b3622a4dd9d14c5dcf93611a2664">modulus</a> == 0) {</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="comment">// if this frame should be cached in cached_stats_modulo_, then</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="comment">// we&#39;ll look there, and we won&#39;t go back any further in time.</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    }</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    int32 index = t % <a class="code" href="classkaldi_1_1OnlineCmvn.html#a023608b4ebeadd89bac7a8bbfcb7b72f">opts_</a>.<a class="code" href="structkaldi_1_1OnlineCmvnOptions.html#ae67de23b4650a5335632052f5d29317a">ring_buffer_size</a>;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1OnlineCmvn.html#a4290d1d4db51bdeff3b3cad91c904ae9">cached_stats_ring_</a>[index].first == t) {</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      *cached_frame = t;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      *stats = <a class="code" href="classkaldi_1_1OnlineCmvn.html#a4290d1d4db51bdeff3b3cad91c904ae9">cached_stats_ring_</a>[index].second;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    }</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  int32 <a class="code" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">n</a> = frame / <a class="code" href="classkaldi_1_1OnlineCmvn.html#a023608b4ebeadd89bac7a8bbfcb7b72f">opts_</a>.<a class="code" href="structkaldi_1_1OnlineCmvnOptions.html#abaa9b3622a4dd9d14c5dcf93611a2664">modulus</a>;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keywordflow">if</span> (n &gt;= <a class="code" href="classkaldi_1_1OnlineCmvn.html#a7ce1d4486b9d32ecf34ea6b7ff24d721">cached_stats_modulo_</a>.size()) {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1OnlineCmvn.html#a7ce1d4486b9d32ecf34ea6b7ff24d721">cached_stats_modulo_</a>.size() == 0) {</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      *cached_frame = -1;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      stats-&gt;Resize(2, this-&gt;<a class="code" href="classkaldi_1_1OnlineCmvn.html#a1a121442e95f6b43f46a61cefffb2252">Dim</a>() + 1);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      n = <span class="keyword">static_cast&lt;</span>int32<span class="keyword">&gt;</span>(<a class="code" href="classkaldi_1_1OnlineCmvn.html#a7ce1d4486b9d32ecf34ea6b7ff24d721">cached_stats_modulo_</a>.size() - 1);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  }</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  *cached_frame = n * <a class="code" href="classkaldi_1_1OnlineCmvn.html#a023608b4ebeadd89bac7a8bbfcb7b72f">opts_</a>.<a class="code" href="structkaldi_1_1OnlineCmvnOptions.html#abaa9b3622a4dd9d14c5dcf93611a2664">modulus</a>;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1OnlineCmvn.html#a7ce1d4486b9d32ecf34ea6b7ff24d721">cached_stats_modulo_</a>[n] != NULL);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  *stats = *(<a class="code" href="classkaldi_1_1OnlineCmvn.html#a7ce1d4486b9d32ecf34ea6b7ff24d721">cached_stats_modulo_</a>[<a class="code" href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">n</a>]);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;}</div><div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a1a121442e95f6b43f46a61cefffb2252"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a1a121442e95f6b43f46a61cefffb2252">kaldi::OnlineCmvn::Dim</a></div><div class="ttdeci">virtual int32 Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00297">online-feature.h:297</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a92641d93c3b407c3c2e63124ed783d6f"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a92641d93c3b407c3c2e63124ed783d6f">kaldi::OnlineCmvn::InitRingBufferIfNeeded</a></div><div class="ttdeci">void InitRingBufferIfNeeded()</div><div class="ttdoc">Initialize ring buffer for caching stats. </div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8cc_source.html#l00197">online-feature.cc:197</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a4290d1d4db51bdeff3b3cad91c904ae9"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a4290d1d4db51bdeff3b3cad91c904ae9">kaldi::OnlineCmvn::cached_stats_ring_</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; int32, Matrix&lt; double &gt; &gt; &gt; cached_stats_ring_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00404">online-feature.h:404</a></div></div>
<div class="ttc" id="namespacernnlm_html_ab4871778d570f724a07823e0a2fb9884"><div class="ttname"><a href="namespacernnlm.html#ab4871778d570f724a07823e0a2fb9884">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@11::@12 n</div></div>
<div class="ttc" id="structkaldi_1_1OnlineCmvnOptions_html_abaa9b3622a4dd9d14c5dcf93611a2664"><div class="ttname"><a href="structkaldi_1_1OnlineCmvnOptions.html#abaa9b3622a4dd9d14c5dcf93611a2664">kaldi::OnlineCmvnOptions::modulus</a></div><div class="ttdeci">int32 modulus</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00181">online-feature.h:181</a></div></div>
<div class="ttc" id="structkaldi_1_1OnlineCmvnOptions_html_ae67de23b4650a5335632052f5d29317a"><div class="ttname"><a href="structkaldi_1_1OnlineCmvnOptions.html#ae67de23b4650a5335632052f5d29317a">kaldi::OnlineCmvnOptions::ring_buffer_size</a></div><div class="ttdeci">int32 ring_buffer_size</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00184">online-feature.h:184</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a023608b4ebeadd89bac7a8bbfcb7b72f"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a023608b4ebeadd89bac7a8bbfcb7b72f">kaldi::OnlineCmvn::opts_</a></div><div class="ttdeci">OnlineCmvnOptions opts_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00389">online-feature.h:389</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a7ce1d4486b9d32ecf34ea6b7ff24d721"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a7ce1d4486b9d32ecf34ea6b7ff24d721">kaldi::OnlineCmvn::cached_stats_modulo_</a></div><div class="ttdeci">std::vector&lt; Matrix&lt; double &gt; * &gt; cached_stats_modulo_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00401">online-feature.h:401</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae245a5a0b840f3e5e028956d0bff5141"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae245a5a0b840f3e5e028956d0bff5141">&#9670;&nbsp;</a></span>GetState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GetState </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>cur_frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structkaldi_1_1OnlineCmvnState.html">OnlineCmvnState</a> *&#160;</td>
          <td class="paramname"><em>cmvn_state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="online-feature_8cc_source.html#l00355">355</a> of file <a class="el" href="online-feature_8cc_source.html">online-feature.cc</a>.</p>

<p class="reference">References <a class="el" href="kaldi-vector_8cc_source.html#l00228">VectorBase&lt; Real &gt;::CopyFromVec()</a>, <a class="el" href="online-feature_8h_source.html#l00297">OnlineCmvn::Dim()</a>, <a class="el" href="online-feature_8h_source.html#l00249">OnlineCmvnState::frozen_state</a>, <a class="el" href="online-feature_8h_source.html#l00393">OnlineCmvn::frozen_state_</a>, <a class="el" href="classkaldi_1_1OnlineFeatureInterface.html#a7ee271dbb4707753e1ee4b0aa45eae37">OnlineFeatureInterface::GetFrame()</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00061">MatrixBase&lt; Real &gt;::NumRows()</a>, <a class="el" href="online-feature_8h_source.html#l00391">OnlineCmvn::orig_state_</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l00818">Matrix&lt; Real &gt;::Resize()</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00185">MatrixBase&lt; Real &gt;::Row()</a>, <a class="el" href="online-feature_8h_source.html#l00239">OnlineCmvnState::speaker_cmvn_stats</a>, and <a class="el" href="online-feature_8h_source.html#l00406">OnlineCmvn::src_</a>.</p>
<div class="fragment"><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                                                      {</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  *state_out = this-&gt;<a class="code" href="classkaldi_1_1OnlineCmvn.html#a33a20a5700c3883769ce49801bc80839">orig_state_</a>;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  { <span class="comment">// This block updates state_out-&gt;speaker_cmvn_stats</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    int32 dim = this-&gt;<a class="code" href="classkaldi_1_1OnlineCmvn.html#a1a121442e95f6b43f46a61cefffb2252">Dim</a>();</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordflow">if</span> (state_out-&gt;speaker_cmvn_stats.NumRows() == 0)</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      state_out-&gt;speaker_cmvn_stats.Resize(2, dim + 1);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    Vector&lt;BaseFloat&gt; feat(dim);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    Vector&lt;double&gt; feat_dbl(dim);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">for</span> (int32 t = 0; t &lt;= cur_frame; t++) {</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <a class="code" href="classkaldi_1_1OnlineCmvn.html#a322065dc5fc38765ec548e481e1fc29d">src_</a>-&gt;<a class="code" href="classkaldi_1_1OnlineFeatureInterface.html#a7ee271dbb4707753e1ee4b0aa45eae37">GetFrame</a>(t, &amp;feat);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      feat_dbl.CopyFromVec(feat);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      state_out-&gt;speaker_cmvn_stats(0, dim) += 1.0;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      state_out-&gt;speaker_cmvn_stats.Row(0).Range(0, dim).AddVec(1.0, feat_dbl);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      state_out-&gt;speaker_cmvn_stats.Row(1).Range(0, dim).AddVec2(1.0, feat_dbl);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    }</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  }</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="comment">// Store any frozen state (the effect of the user possibly</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="comment">// having called Freeze().</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  state_out-&gt;frozen_state = <a class="code" href="classkaldi_1_1OnlineCmvn.html#a680635335d7ce64a8c4cb6285309455c">frozen_state_</a>;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;}</div><div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a1a121442e95f6b43f46a61cefffb2252"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a1a121442e95f6b43f46a61cefffb2252">kaldi::OnlineCmvn::Dim</a></div><div class="ttdeci">virtual int32 Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00297">online-feature.h:297</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineFeatureInterface_html_a7ee271dbb4707753e1ee4b0aa45eae37"><div class="ttname"><a href="classkaldi_1_1OnlineFeatureInterface.html#a7ee271dbb4707753e1ee4b0aa45eae37">kaldi::OnlineFeatureInterface::GetFrame</a></div><div class="ttdeci">virtual void GetFrame(int32 frame, VectorBase&lt; BaseFloat &gt; *feat)=0</div><div class="ttdoc">Gets the feature vector for this frame. </div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a680635335d7ce64a8c4cb6285309455c"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a680635335d7ce64a8c4cb6285309455c">kaldi::OnlineCmvn::frozen_state_</a></div><div class="ttdeci">Matrix&lt; double &gt; frozen_state_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00393">online-feature.h:393</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a322065dc5fc38765ec548e481e1fc29d"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a322065dc5fc38765ec548e481e1fc29d">kaldi::OnlineCmvn::src_</a></div><div class="ttdeci">OnlineFeatureInterface * src_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00406">online-feature.h:406</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a33a20a5700c3883769ce49801bc80839"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a33a20a5700c3883769ce49801bc80839">kaldi::OnlineCmvn::orig_state_</a></div><div class="ttdeci">OnlineCmvnState orig_state_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00391">online-feature.h:391</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a92641d93c3b407c3c2e63124ed783d6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92641d93c3b407c3c2e63124ed783d6f">&#9670;&nbsp;</a></span>InitRingBufferIfNeeded()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void InitRingBufferIfNeeded </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize ring buffer for caching stats. </p>

<p class="definition">Definition at line <a class="el" href="online-feature_8cc_source.html#l00197">197</a> of file <a class="el" href="online-feature_8cc_source.html">online-feature.cc</a>.</p>

<p class="reference">References <a class="el" href="online-feature_8h_source.html#l00404">OnlineCmvn::cached_stats_ring_</a>, <a class="el" href="online-feature_8h_source.html#l00297">OnlineCmvn::Dim()</a>, <a class="el" href="online-feature_8h_source.html#l00389">OnlineCmvn::opts_</a>, and <a class="el" href="online-feature_8h_source.html#l00184">OnlineCmvnOptions::ring_buffer_size</a>.</p>

<p class="reference">Referenced by <a class="el" href="online-feature_8cc_source.html#l00205">OnlineCmvn::CacheFrame()</a>, and <a class="el" href="online-feature_8cc_source.html#l00161">OnlineCmvn::GetMostRecentCachedFrame()</a>.</p>
<div class="fragment"><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                                        {</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1OnlineCmvn.html#a4290d1d4db51bdeff3b3cad91c904ae9">cached_stats_ring_</a>.empty() &amp;&amp; <a class="code" href="classkaldi_1_1OnlineCmvn.html#a023608b4ebeadd89bac7a8bbfcb7b72f">opts_</a>.<a class="code" href="structkaldi_1_1OnlineCmvnOptions.html#ae67de23b4650a5335632052f5d29317a">ring_buffer_size</a> &gt; 0) {</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    Matrix&lt;double&gt; temp(2, this-&gt;<a class="code" href="classkaldi_1_1OnlineCmvn.html#a1a121442e95f6b43f46a61cefffb2252">Dim</a>() + 1);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="classkaldi_1_1OnlineCmvn.html#a4290d1d4db51bdeff3b3cad91c904ae9">cached_stats_ring_</a>.resize(<a class="code" href="classkaldi_1_1OnlineCmvn.html#a023608b4ebeadd89bac7a8bbfcb7b72f">opts_</a>.<a class="code" href="structkaldi_1_1OnlineCmvnOptions.html#ae67de23b4650a5335632052f5d29317a">ring_buffer_size</a>,</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                              std::pair&lt;int32, Matrix&lt;double&gt; &gt;(-1, temp));</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  }</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;}</div><div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a1a121442e95f6b43f46a61cefffb2252"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a1a121442e95f6b43f46a61cefffb2252">kaldi::OnlineCmvn::Dim</a></div><div class="ttdeci">virtual int32 Dim() const</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00297">online-feature.h:297</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a4290d1d4db51bdeff3b3cad91c904ae9"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a4290d1d4db51bdeff3b3cad91c904ae9">kaldi::OnlineCmvn::cached_stats_ring_</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; int32, Matrix&lt; double &gt; &gt; &gt; cached_stats_ring_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00404">online-feature.h:404</a></div></div>
<div class="ttc" id="structkaldi_1_1OnlineCmvnOptions_html_ae67de23b4650a5335632052f5d29317a"><div class="ttname"><a href="structkaldi_1_1OnlineCmvnOptions.html#ae67de23b4650a5335632052f5d29317a">kaldi::OnlineCmvnOptions::ring_buffer_size</a></div><div class="ttdeci">int32 ring_buffer_size</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00184">online-feature.h:184</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a023608b4ebeadd89bac7a8bbfcb7b72f"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a023608b4ebeadd89bac7a8bbfcb7b72f">kaldi::OnlineCmvn::opts_</a></div><div class="ttdeci">OnlineCmvnOptions opts_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00389">online-feature.h:389</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a09424857e2822aa52300244882a1307b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09424857e2822aa52300244882a1307b">&#9670;&nbsp;</a></span>IsLastFrame()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classbool.html">bool</a> IsLastFrame </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>frame</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns true if this is the last frame. </p>
<p>Frame indices are zero-based, so the first frame is zero. IsLastFrame(-1) will return false, unless the file is empty (which is a case that I'm not sure all the code will handle, so be careful). This function may return false for some frame if we haven't yet decided to terminate decoding, but later true if we decide to terminate decoding. This function exists mainly to correctly handle end effects in feature extraction, and is not a mechanism to determine how many frames are in the decodable object (as it used to be, and for backward compatibility, still is, in the Decodable interface). </p>

<p>Implements <a class="el" href="classkaldi_1_1OnlineFeatureInterface.html#a9e2dede1c20fce727f2666fe45a06ab3">OnlineFeatureInterface</a>.</p>

<p class="definition">Definition at line <a class="el" href="online-feature_8h_source.html#l00299">299</a> of file <a class="el" href="online-feature_8h_source.html">online-feature.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                              {</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1OnlineCmvn.html#a322065dc5fc38765ec548e481e1fc29d">src_</a>-&gt;<a class="code" href="classkaldi_1_1OnlineFeatureInterface.html#a9e2dede1c20fce727f2666fe45a06ab3">IsLastFrame</a>(frame);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  }</div><div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a322065dc5fc38765ec548e481e1fc29d"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a322065dc5fc38765ec548e481e1fc29d">kaldi::OnlineCmvn::src_</a></div><div class="ttdeci">OnlineFeatureInterface * src_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00406">online-feature.h:406</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineFeatureInterface_html_a9e2dede1c20fce727f2666fe45a06ab3"><div class="ttname"><a href="classkaldi_1_1OnlineFeatureInterface.html#a9e2dede1c20fce727f2666fe45a06ab3">kaldi::OnlineFeatureInterface::IsLastFrame</a></div><div class="ttdeci">virtual bool IsLastFrame(int32 frame) const =0</div><div class="ttdoc">Returns true if this is the last frame. </div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a60b0869d95fc438d1723671fef3e2c08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60b0869d95fc438d1723671fef3e2c08">&#9670;&nbsp;</a></span>NumFramesReady()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual int32 NumFramesReady </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>returns the feature dimension. </p>
<p>Returns the total number of frames, since the start of the utterance, that are now available. In an online-decoding context, this will likely increase with time as more data becomes available. </p>

<p>Implements <a class="el" href="classkaldi_1_1OnlineFeatureInterface.html#a6d4812ed73de799c457bea7f483f3593">OnlineFeatureInterface</a>.</p>

<p class="definition">Definition at line <a class="el" href="online-feature_8h_source.html#l00307">307</a> of file <a class="el" href="online-feature_8h_source.html">online-feature.h</a>.</p>

<p class="reference">References <a class="el" href="online-feature_8cc_source.html#l00028">OnlineGenericBaseFeature&lt; C &gt;::GetFrame()</a>.</p>

<p class="reference">Referenced by <a class="el" href="online-feature_8cc_source.html#l00237">OnlineCmvn::ComputeStatsForFrame()</a>, and <a class="el" href="online-feature_8cc_source.html#l00392">OnlineSpliceFrames::GetFrame()</a>.</p>
<div class="fragment"><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1OnlineCmvn.html#a322065dc5fc38765ec548e481e1fc29d">src_</a>-&gt;<a class="code" href="classkaldi_1_1OnlineFeatureInterface.html#a6d4812ed73de799c457bea7f483f3593">NumFramesReady</a>(); }</div><div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a322065dc5fc38765ec548e481e1fc29d"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a322065dc5fc38765ec548e481e1fc29d">kaldi::OnlineCmvn::src_</a></div><div class="ttdeci">OnlineFeatureInterface * src_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00406">online-feature.h:406</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineFeatureInterface_html_a6d4812ed73de799c457bea7f483f3593"><div class="ttname"><a href="classkaldi_1_1OnlineFeatureInterface.html#a6d4812ed73de799c457bea7f483f3593">kaldi::OnlineFeatureInterface::NumFramesReady</a></div><div class="ttdeci">virtual int32 NumFramesReady() const =0</div><div class="ttdoc">returns the feature dimension. </div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a98d07ab5d7731e6fb8233a090f8327ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98d07ab5d7731e6fb8233a090f8327ad">&#9670;&nbsp;</a></span>SetState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetState </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1OnlineCmvnState.html">OnlineCmvnState</a> &amp;&#160;</td>
          <td class="paramname"><em>cmvn_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="online-feature_8cc_source.html#l00377">377</a> of file <a class="el" href="online-feature_8cc_source.html">online-feature.cc</a>.</p>

<p class="reference">References <a class="el" href="online-feature_8h_source.html#l00401">OnlineCmvn::cached_stats_modulo_</a>, <a class="el" href="online-feature_8h_source.html#l00249">OnlineCmvnState::frozen_state</a>, <a class="el" href="online-feature_8h_source.html#l00393">OnlineCmvn::frozen_state_</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, and <a class="el" href="online-feature_8h_source.html#l00391">OnlineCmvn::orig_state_</a>.</p>

<p class="reference">Referenced by <a class="el" href="online-feature_8cc_source.html#l00143">OnlineCmvn::OnlineCmvn()</a>.</p>
<div class="fragment"><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                                                           {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1OnlineCmvn.html#a7ce1d4486b9d32ecf34ea6b7ff24d721">cached_stats_modulo_</a>.empty() &amp;&amp;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;               <span class="stringliteral">&quot;You cannot call SetState() after processing data.&quot;</span>);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <a class="code" href="classkaldi_1_1OnlineCmvn.html#a33a20a5700c3883769ce49801bc80839">orig_state_</a> = cmvn_state;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <a class="code" href="classkaldi_1_1OnlineCmvn.html#a680635335d7ce64a8c4cb6285309455c">frozen_state_</a> = cmvn_state.frozen_state;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;}</div><div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a680635335d7ce64a8c4cb6285309455c"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a680635335d7ce64a8c4cb6285309455c">kaldi::OnlineCmvn::frozen_state_</a></div><div class="ttdeci">Matrix&lt; double &gt; frozen_state_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00393">online-feature.h:393</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a33a20a5700c3883769ce49801bc80839"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a33a20a5700c3883769ce49801bc80839">kaldi::OnlineCmvn::orig_state_</a></div><div class="ttdeci">OnlineCmvnState orig_state_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00391">online-feature.h:391</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1OnlineCmvn_html_a7ce1d4486b9d32ecf34ea6b7ff24d721"><div class="ttname"><a href="classkaldi_1_1OnlineCmvn.html#a7ce1d4486b9d32ecf34ea6b7ff24d721">kaldi::OnlineCmvn::cached_stats_modulo_</a></div><div class="ttdeci">std::vector&lt; Matrix&lt; double &gt; * &gt; cached_stats_modulo_</div><div class="ttdef"><b>Definition:</b> <a href="online-feature_8h_source.html#l00401">online-feature.h:401</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a01a55231d7eef11d4049e3f1cc7dafdb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01a55231d7eef11d4049e3f1cc7dafdb">&#9670;&nbsp;</a></span>SmoothOnlineCmvnStats()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SmoothOnlineCmvnStats </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>speaker_stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>global_stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1OnlineCmvnOptions.html">OnlineCmvnOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>stats</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Smooth the CMVN stats "stats" (which are stored in the normal format as a 2 x (dim+1) matrix), by possibly adding some stats from "global_stats" and/or "speaker_stats", controlled by the config. </p>
<p>The best way to understand the smoothing rule we use is just to look at the code. </p>

<p class="definition">Definition at line <a class="el" href="online-feature_8cc_source.html#l00272">272</a> of file <a class="el" href="online-feature_8cc_source.html">online-feature.cc</a>.</p>

<p class="reference">References <a class="el" href="kaldi-matrix_8cc_source.html#l00355">MatrixBase&lt; Real &gt;::AddMat()</a>, <a class="el" href="online-feature_8h_source.html#l00175">OnlineCmvnOptions::cmn_window</a>, <a class="el" href="online-feature_8h_source.html#l00177">OnlineCmvnOptions::global_frames</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00126">KALDI_ERR</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00064">MatrixBase&lt; Real &gt;::NumCols()</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00061">MatrixBase&lt; Real &gt;::NumRows()</a>, and <a class="el" href="online-feature_8h_source.html#l00176">OnlineCmvnOptions::speaker_frames</a>.</p>

<p class="reference">Referenced by <a class="el" href="online-feature_8cc_source.html#l00342">OnlineCmvn::Freeze()</a>, and <a class="el" href="online-feature_8cc_source.html#l00309">OnlineCmvn::GetFrame()</a>.</p>
<div class="fragment"><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                                                                  {</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  int32 dim = stats-&gt;NumCols() - 1;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keywordtype">double</span> cur_count = (*stats)(0, dim);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="comment">// If count exceeded cmn_window it would be an error in how &quot;window_stats&quot;</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="comment">// was accumulated.</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cur_count &lt;= 1.001 * opts.cmn_window);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keywordflow">if</span> (cur_count &gt;= opts.cmn_window) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keywordflow">if</span> (speaker_stats.NumRows() != 0) {  <span class="comment">// if we have speaker stats..</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordtype">double</span> count_from_speaker = opts.cmn_window - cur_count,</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        speaker_count = speaker_stats(0, dim);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">if</span> (count_from_speaker &gt; opts.speaker_frames)</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      count_from_speaker = opts.speaker_frames;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">if</span> (count_from_speaker &gt; speaker_count)</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      count_from_speaker = speaker_count;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">if</span> (count_from_speaker &gt; 0.0)</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      stats-&gt;AddMat(count_from_speaker / speaker_count,</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                             speaker_stats);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    cur_count = (*stats)(0, dim);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  }</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="keywordflow">if</span> (cur_count &gt;= opts.cmn_window) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="keywordflow">if</span> (global_stats.NumRows() != 0) {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordtype">double</span> count_from_global = opts.cmn_window - cur_count,</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        global_count = global_stats(0, dim);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(global_count &gt; 0.0);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">if</span> (count_from_global &gt; opts.global_frames)</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      count_from_global = opts.global_frames;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">if</span> (count_from_global &gt; 0.0)</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      stats-&gt;AddMat(count_from_global / global_count,</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                    global_stats);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Global CMN stats are required&quot;</span>;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  }</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;}</div><div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00126">kaldi-error.h:126</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a7ce1d4486b9d32ecf34ea6b7ff24d721"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ce1d4486b9d32ecf34ea6b7ff24d721">&#9670;&nbsp;</a></span>cached_stats_modulo_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>&lt;double&gt;*&gt; cached_stats_modulo_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="online-feature_8h_source.html#l00401">401</a> of file <a class="el" href="online-feature_8h_source.html">online-feature.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="online-feature_8cc_source.html#l00205">OnlineCmvn::CacheFrame()</a>, <a class="el" href="online-feature_8cc_source.html#l00161">OnlineCmvn::GetMostRecentCachedFrame()</a>, <a class="el" href="online-feature_8cc_source.html#l00377">OnlineCmvn::SetState()</a>, and <a class="el" href="online-feature_8cc_source.html#l00231">OnlineCmvn::~OnlineCmvn()</a>.</p>

</div>
</div>
<a id="a4290d1d4db51bdeff3b3cad91c904ae9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4290d1d4db51bdeff3b3cad91c904ae9">&#9670;&nbsp;</a></span>cached_stats_ring_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::pair&lt;int32, <a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>&lt;double&gt; &gt; &gt; cached_stats_ring_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="online-feature_8h_source.html#l00404">404</a> of file <a class="el" href="online-feature_8h_source.html">online-feature.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="online-feature_8cc_source.html#l00205">OnlineCmvn::CacheFrame()</a>, <a class="el" href="online-feature_8cc_source.html#l00161">OnlineCmvn::GetMostRecentCachedFrame()</a>, and <a class="el" href="online-feature_8cc_source.html#l00197">OnlineCmvn::InitRingBufferIfNeeded()</a>.</p>

</div>
</div>
<a id="a680635335d7ce64a8c4cb6285309455c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a680635335d7ce64a8c4cb6285309455c">&#9670;&nbsp;</a></span>frozen_state_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>&lt;double&gt; frozen_state_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="online-feature_8h_source.html#l00393">393</a> of file <a class="el" href="online-feature_8h_source.html">online-feature.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="online-feature_8cc_source.html#l00342">OnlineCmvn::Freeze()</a>, <a class="el" href="online-feature_8cc_source.html#l00309">OnlineCmvn::GetFrame()</a>, <a class="el" href="online-feature_8cc_source.html#l00355">OnlineCmvn::GetState()</a>, and <a class="el" href="online-feature_8cc_source.html#l00377">OnlineCmvn::SetState()</a>.</p>

</div>
</div>
<a id="a023608b4ebeadd89bac7a8bbfcb7b72f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a023608b4ebeadd89bac7a8bbfcb7b72f">&#9670;&nbsp;</a></span>opts_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structkaldi_1_1OnlineCmvnOptions.html">OnlineCmvnOptions</a> opts_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="online-feature_8h_source.html#l00389">389</a> of file <a class="el" href="online-feature_8h_source.html">online-feature.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="online-feature_8cc_source.html#l00205">OnlineCmvn::CacheFrame()</a>, <a class="el" href="online-feature_8cc_source.html#l00237">OnlineCmvn::ComputeStatsForFrame()</a>, <a class="el" href="online-feature_8cc_source.html#l00342">OnlineCmvn::Freeze()</a>, <a class="el" href="online-feature_8cc_source.html#l00309">OnlineCmvn::GetFrame()</a>, <a class="el" href="online-feature_8cc_source.html#l00161">OnlineCmvn::GetMostRecentCachedFrame()</a>, and <a class="el" href="online-feature_8cc_source.html#l00197">OnlineCmvn::InitRingBufferIfNeeded()</a>.</p>

</div>
</div>
<a id="a33a20a5700c3883769ce49801bc80839"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33a20a5700c3883769ce49801bc80839">&#9670;&nbsp;</a></span>orig_state_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structkaldi_1_1OnlineCmvnState.html">OnlineCmvnState</a> orig_state_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="online-feature_8h_source.html#l00391">391</a> of file <a class="el" href="online-feature_8h_source.html">online-feature.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="online-feature_8cc_source.html#l00342">OnlineCmvn::Freeze()</a>, <a class="el" href="online-feature_8cc_source.html#l00309">OnlineCmvn::GetFrame()</a>, <a class="el" href="online-feature_8cc_source.html#l00355">OnlineCmvn::GetState()</a>, and <a class="el" href="online-feature_8cc_source.html#l00377">OnlineCmvn::SetState()</a>.</p>

</div>
</div>
<a id="ab66ecef3ba859e18a3d4fb31ab4d780b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab66ecef3ba859e18a3d4fb31ab4d780b">&#9670;&nbsp;</a></span>skip_dims_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int32&gt; skip_dims_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="online-feature_8h_source.html#l00390">390</a> of file <a class="el" href="online-feature_8h_source.html">online-feature.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="online-feature_8cc_source.html#l00309">OnlineCmvn::GetFrame()</a>, and <a class="el" href="online-feature_8cc_source.html#l00143">OnlineCmvn::OnlineCmvn()</a>.</p>

</div>
</div>
<a id="a322065dc5fc38765ec548e481e1fc29d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a322065dc5fc38765ec548e481e1fc29d">&#9670;&nbsp;</a></span>src_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1OnlineFeatureInterface.html">OnlineFeatureInterface</a>* src_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="online-feature_8h_source.html#l00406">406</a> of file <a class="el" href="online-feature_8h_source.html">online-feature.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="online-feature_8cc_source.html#l00237">OnlineCmvn::ComputeStatsForFrame()</a>, <a class="el" href="online-feature_8cc_source.html#l00309">OnlineCmvn::GetFrame()</a>, <a class="el" href="online-feature_8cc_source.html#l00392">OnlineSpliceFrames::GetFrame()</a>, <a class="el" href="online-feature_8cc_source.html#l00355">OnlineCmvn::GetState()</a>, and <a class="el" href="online-feature_8cc_source.html#l00384">OnlineSpliceFrames::NumFramesReady()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>feat/<a class="el" href="online-feature_8h_source.html">online-feature.h</a></li>
<li>feat/<a class="el" href="online-feature_8cc_source.html">online-feature.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacekaldi.html">kaldi</a></li><li class="navelem"><a class="el" href="classkaldi_1_1OnlineCmvn.html">OnlineCmvn</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
