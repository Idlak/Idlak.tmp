<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Kaldi: ComputationStepsComputer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" /> 
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
 <td id="projectlogo"><a href="http://kaldi-asr.org/"><img alt="Logo" src="KaldiTextAndLogoSmall.png"/ style="padding: 3px 5px 1px 5px"></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname" style="display:none">Kaldi
   </div>
  </td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief" style="display:none"></div>
    </td>
   <!--END PROJECT_BRIEF-->
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classkaldi_1_1nnet3_1_1ComputationStepsComputer.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ComputationStepsComputer Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This class arranges the cindex_ids of the computation into a sequence of lists called "steps", which will correspond roughly to the commands in the compiled computation.  
 <a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="nnet-computation-graph_8h_source.html">nnet-computation-graph.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for ComputationStepsComputer:</div>
<div class="dyncontent">
<div class="center"><img src="classkaldi_1_1nnet3_1_1ComputationStepsComputer__coll__graph.png" border="0" usemap="#ComputationStepsComputer_coll__map" alt="Collaboration graph"/></div>
<map name="ComputationStepsComputer_coll__map" id="ComputationStepsComputer_coll__map">
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:abaef12fa058947650eb4e48572dbd01b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#abaef12fa058947650eb4e48572dbd01b">ComputationStepsComputer</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, <a class="el" href="structkaldi_1_1nnet3_1_1ComputationGraph.html">ComputationGraph</a> *graph, std::vector&lt; std::vector&lt; int32 &gt; &gt; *steps, std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; *locations)</td></tr>
<tr class="memdesc:abaef12fa058947650eb4e48572dbd01b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#abaef12fa058947650eb4e48572dbd01b">More...</a><br /></td></tr>
<tr class="separator:abaef12fa058947650eb4e48572dbd01b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae65fd7aafe0a4a887e6fdf3ee8b97a13"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ae65fd7aafe0a4a887e6fdf3ee8b97a13">ComputeForSegment</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> &amp;request, const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;phases)</td></tr>
<tr class="memdesc:ae65fd7aafe0a4a887e6fdf3ee8b97a13"><td class="mdescLeft">&#160;</td><td class="mdescRight">You call this once for each segment, in order (note: for normal, non-online computations, there is only one segment).  <a href="#ae65fd7aafe0a4a887e6fdf3ee8b97a13">More...</a><br /></td></tr>
<tr class="separator:ae65fd7aafe0a4a887e6fdf3ee8b97a13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c47fd4f163011eb1939870d25aa656a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a4c47fd4f163011eb1939870d25aa656a">Check</a> () const</td></tr>
<tr class="memdesc:a4c47fd4f163011eb1939870d25aa656a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is only to be called after you have called ComputeForSegment for all the segments.  <a href="#a4c47fd4f163011eb1939870d25aa656a">More...</a><br /></td></tr>
<tr class="separator:a4c47fd4f163011eb1939870d25aa656a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a8c079dc88d7030933c6209f03e84b257"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a8c079dc88d7030933c6209f03e84b257">ProcessSubPhase</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> &amp;request, const std::vector&lt; <a class="el" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> &gt; &amp;sub_phase)</td></tr>
<tr class="separator:a8c079dc88d7030933c6209f03e84b257"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bf7e70ed658ec686d094a87bf01040c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a8bf7e70ed658ec686d094a87bf01040c">ProcessDimRangeSubPhase</a> (const std::vector&lt; <a class="el" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> &gt; &amp;sub_phase)</td></tr>
<tr class="separator:a8bf7e70ed658ec686d094a87bf01040c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1ba98152caee70149eecf30d58fb975"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ab1ba98152caee70149eecf30d58fb975">ProcessInputOrOutputStep</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> &amp;request, <a class="el" href="classbool.html">bool</a> is_output, const std::vector&lt; <a class="el" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> &gt; &amp;sub_phase)</td></tr>
<tr class="separator:ab1ba98152caee70149eecf30d58fb975"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cfba18e7848b9258cb311dd68eddb05"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a6cfba18e7848b9258cb311dd68eddb05">ProcessComponentStep</a> (const std::vector&lt; <a class="el" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> &gt; &amp;step)</td></tr>
<tr class="separator:a6cfba18e7848b9258cb311dd68eddb05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a704d97dd332b0327ae16a0fc377629c0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a704d97dd332b0327ae16a0fc377629c0">SplitIntoSubPhases</a> (const std::vector&lt; int32 &gt; &amp;phase, std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> &gt; &gt; *sub_phase) const</td></tr>
<tr class="separator:a704d97dd332b0327ae16a0fc377629c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ab8ccc5876ce94af013464511dca26c"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a8ab8ccc5876ce94af013464511dca26c">AddStep</a> (const std::vector&lt; <a class="el" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> &gt; &amp;cindexes, <a class="el" href="classbool.html">bool</a> add_if_absent=false)</td></tr>
<tr class="separator:a8ab8ccc5876ce94af013464511dca26c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9563e0ce40b01f8cb5670fccde79a734"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a9563e0ce40b01f8cb5670fccde79a734">AddStep</a> (std::vector&lt; int32 &gt; *cindex_ids)</td></tr>
<tr class="separator:a9563e0ce40b01f8cb5670fccde79a734"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a274c4b9215d2e1d0b8a37aa79193883b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a274c4b9215d2e1d0b8a37aa79193883b">ConvertToCindexes</a> (const std::vector&lt; int32 &gt; &amp;cindex_ids, std::vector&lt; <a class="el" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> &gt; *cindexes) const</td></tr>
<tr class="separator:a274c4b9215d2e1d0b8a37aa79193883b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab08827e539a965039328f52cb2ce2c62"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ab08827e539a965039328f52cb2ce2c62">ConvertToCindexIds</a> (const std::vector&lt; <a class="el" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> &gt; &amp;cindexes, std::vector&lt; int32 &gt; *cindex_ids) const</td></tr>
<tr class="separator:ab08827e539a965039328f52cb2ce2c62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a756818ae128e31e80a0f09c79f584675"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a756818ae128e31e80a0f09c79f584675">ConvertToLocations</a> (const std::vector&lt; int32 &gt; &amp;cindex_ids, std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; *locations) const</td></tr>
<tr class="separator:a756818ae128e31e80a0f09c79f584675"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:aeec16f10bd8cbba592a5053a89eacfff"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#aeec16f10bd8cbba592a5053a89eacfff">ConvertToIndexes</a> (const std::vector&lt; <a class="el" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> &gt; &amp;cindexes, std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; *indexes)</td></tr>
<tr class="separator:aeec16f10bd8cbba592a5053a89eacfff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8db9dc43d66ef32442d039a38c83bc21"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a8db9dc43d66ef32442d039a38c83bc21">ConvertToCindexes</a> (const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; &amp;indexes, int32 node_index, std::vector&lt; <a class="el" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> &gt; *cindexes)</td></tr>
<tr class="separator:a8db9dc43d66ef32442d039a38c83bc21"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:adbabf05a7702103113a02a113015205f"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#adbabf05a7702103113a02a113015205f">nnet_</a></td></tr>
<tr class="separator:adbabf05a7702103113a02a113015205f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9329bf8ff1dbf0f1e0f49ded8dc83fd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structkaldi_1_1nnet3_1_1ComputationGraph.html">ComputationGraph</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ad9329bf8ff1dbf0f1e0f49ded8dc83fd">graph_</a></td></tr>
<tr class="separator:ad9329bf8ff1dbf0f1e0f49ded8dc83fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cb7e5f1e5b76a6bbca03b3a83ad02f5"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; int32 &gt; &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a3cb7e5f1e5b76a6bbca03b3a83ad02f5">steps_</a></td></tr>
<tr class="memdesc:a3cb7e5f1e5b76a6bbca03b3a83ad02f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">steps_ is a pointer to an output that's passed in in the constructor.  <a href="#a3cb7e5f1e5b76a6bbca03b3a83ad02f5">More...</a><br /></td></tr>
<tr class="separator:a3cb7e5f1e5b76a6bbca03b3a83ad02f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a849951c8cab13300f78b0ec8baa30c0c"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a849951c8cab13300f78b0ec8baa30c0c">locations_</a></td></tr>
<tr class="memdesc:a849951c8cab13300f78b0ec8baa30c0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">locations_ is a map from cindex_id to the pair of indexes into steps_ where that cindex_id resides, so if (*locations_)[c] = (i,j), then (*steps_)[i][j] == c.  <a href="#a849951c8cab13300f78b0ec8baa30c0c">More...</a><br /></td></tr>
<tr class="separator:a849951c8cab13300f78b0ec8baa30c0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2780f70b419f18227193b7c14015ec6f"><td class="memItemLeft" align="right" valign="top">std::unordered_set&lt; std::pair&lt; int32, int32 &gt;, <a class="el" href="structkaldi_1_1PairHasher.html">PairHasher</a>&lt; int32 &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a2780f70b419f18227193b7c14015ec6f">dim_range_nodes_</a></td></tr>
<tr class="memdesc:a2780f70b419f18227193b7c14015ec6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">dim_range_nodes_ is used when allocating steps for nodes of type kDimRangeNode.  <a href="#a2780f70b419f18227193b7c14015ec6f">More...</a><br /></td></tr>
<tr class="separator:a2780f70b419f18227193b7c14015ec6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class arranges the cindex_ids of the computation into a sequence of lists called "steps", which will correspond roughly to the commands in the compiled computation. </p>
<p>The steps are finer than phases. (See <a class="el" href="dnn3_code_compilation.html#dnn3_compile_steps">Organizing the computation into steps</a> for more info). To summarize the properties that these steps will satisfy:</p>
<ul>
<li>All cindex_ids within a given step correspond to the same node in the graph</li>
<li>All dependencies of cindex_ids within a given step have been computed in earlier steps.</li>
<li>All cindex_ids within a given step share the same location when computed (i.e. a matrix or submatix)</li>
</ul>
<p>There are also some extra, more obscure properties that the sequence of steps must satisfy:</p>
<ul>
<li>Any input or output specified in a <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> must be in one step, with the Indexes in the same order as specified in the <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a>. (Note: inputs can be for nodes of type kComponent as well as kInput).</li>
<li>If a step corresponds to a node of type kComponent (and does not correspond to an input in the <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a>), then the immediately preceding step must correspond to a node of type kDescriptor, and the sequence of Indexes in the two steps must be identical.</li>
<li>If a step corresponds to a node of type kDimRange, then there must be a preceding step corresponding to the source node, with exactly the same Indexes appearing in the same order. (This lets us use a sub-matrix for the kDimRange node). We guarantee this by adding extra cindexes to the kDimRange steps as needed.</li>
</ul>
<p>The reason why <a class="el" href="namespacekaldi_1_1nnet3_1_1computation__graph.html">computation_graph</a> is not provided as a const argument is that in order to ensure the final property we may have to add a few new cindex_ids. </p>

<p class="definition">Definition at line <a class="el" href="nnet-computation-graph_8h_source.html#l00414">414</a> of file <a class="el" href="nnet-computation-graph_8h_source.html">nnet-computation-graph.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="abaef12fa058947650eb4e48572dbd01b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abaef12fa058947650eb4e48572dbd01b">&#9670;&nbsp;</a></span>ComputationStepsComputer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html">ComputationStepsComputer</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structkaldi_1_1nnet3_1_1ComputationGraph.html">ComputationGraph</a> *&#160;</td>
          <td class="paramname"><em>graph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>steps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>locations</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nnet</td><td>The neural network that this computation is for. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">graph</td><td>The computation graph that we're computing the steps for. It's only non-const because there are couple of unusual situations in which we may need to add new cindexes: (1) For nodes of type kDimRange, we may add cindexes to enable the node to span a contiguous range of the input indexes. (2) For certain non-simple Components (principally CNN-related components), we may need to add 'blank' cindexes (defined as cindexes where the 't' indexes are replaced by kNoTime), for zero-padding and to turn irregularly structured computations into regularly structured ones as needed by the component's implementation. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">steps</td><td>The main output of this class, which is a sequence of steps, each step being an ordered list of cindex_ids. It just gets cleared in the constructor; it's set up when you call <a class="el" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ae65fd7aafe0a4a887e6fdf3ee8b97a13" title="You call this once for each segment, in order (note: for normal, non-online computations, there is only one segment). ">ComputeForSegment()</a>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">locations</td><td>The additional output of this class, which is a function of the information in 'steps'. The array 'locations' is indexed by cindex_id, and each one is a pair (step-index, index-into-step), so that for any cindex_id c, (*steps)[locations[c].first][locations[c].second] == c. It's possible in principle if there are non-simple Components, that for nodes corresponding to component-input descriptors, a cindex might be present in more than one step, so it doesn't follow that if (*steps)[i][j] == c, then locations[c] == (i,j). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="nnet-computation-graph_8cc_source.html#l01539">1539</a> of file <a class="el" href="nnet-computation-graph_8cc_source.html">nnet-computation-graph.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-computation-graph_8h_source.html#l00046">ComputationGraph::cindexes</a>, <a class="el" href="nnet-computation-graph_8h_source.html#l00542">ComputationStepsComputer::graph_</a>, <a class="el" href="nnet-computation-graph_8h_source.html#l00549">ComputationStepsComputer::locations_</a>, and <a class="el" href="nnet-computation-graph_8h_source.html#l00544">ComputationStepsComputer::steps_</a>.</p>
<div class="fragment"><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                                                 :</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#adbabf05a7702103113a02a113015205f">nnet_</a>(nnet), <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ad9329bf8ff1dbf0f1e0f49ded8dc83fd">graph_</a>(graph), <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a3cb7e5f1e5b76a6bbca03b3a83ad02f5">steps_</a>(steps), <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a849951c8cab13300f78b0ec8baa30c0c">locations_</a>(locations) {</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a3cb7e5f1e5b76a6bbca03b3a83ad02f5">steps_</a>-&gt;clear();</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a849951c8cab13300f78b0ec8baa30c0c">locations_</a>-&gt;clear();</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;  int32 num_cindexes = <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ad9329bf8ff1dbf0f1e0f49ded8dc83fd">graph_</a>-&gt;<a class="code" href="structkaldi_1_1nnet3_1_1ComputationGraph.html#a297d5616d3920cb01d699e7a0e4d2a67">cindexes</a>.size();</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;  <span class="comment">// leave a little space in case a few cindexes are added (unlikely</span></div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;  <span class="comment">// but could happen with dim-range nodes).</span></div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a849951c8cab13300f78b0ec8baa30c0c">locations_</a>-&gt;reserve(num_cindexes + num_cindexes / 10);</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a849951c8cab13300f78b0ec8baa30c0c">locations_</a>-&gt;resize(num_cindexes, std::pair&lt;int32,int32&gt;(-1, -1));</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_ad9329bf8ff1dbf0f1e0f49ded8dc83fd"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ad9329bf8ff1dbf0f1e0f49ded8dc83fd">kaldi::nnet3::ComputationStepsComputer::graph_</a></div><div class="ttdeci">ComputationGraph * graph_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00542">nnet-computation-graph.h:542</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_a849951c8cab13300f78b0ec8baa30c0c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a849951c8cab13300f78b0ec8baa30c0c">kaldi::nnet3::ComputationStepsComputer::locations_</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; * locations_</div><div class="ttdoc">locations_ is a map from cindex_id to the pair of indexes into steps_ where that cindex_id resides...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00549">nnet-computation-graph.h:549</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationGraph_html_a297d5616d3920cb01d699e7a0e4d2a67"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationGraph.html#a297d5616d3920cb01d699e7a0e4d2a67">kaldi::nnet3::ComputationGraph::cindexes</a></div><div class="ttdeci">std::vector&lt; Cindex &gt; cindexes</div><div class="ttdoc">The mapping of cindex_id to Cindex. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00046">nnet-computation-graph.h:46</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_a3cb7e5f1e5b76a6bbca03b3a83ad02f5"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a3cb7e5f1e5b76a6bbca03b3a83ad02f5">kaldi::nnet3::ComputationStepsComputer::steps_</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int32 &gt; &gt; * steps_</div><div class="ttdoc">steps_ is a pointer to an output that&amp;#39;s passed in in the constructor. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00544">nnet-computation-graph.h:544</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_adbabf05a7702103113a02a113015205f"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#adbabf05a7702103113a02a113015205f">kaldi::nnet3::ComputationStepsComputer::nnet_</a></div><div class="ttdeci">const Nnet &amp; nnet_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00541">nnet-computation-graph.h:541</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a8ab8ccc5876ce94af013464511dca26c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ab8ccc5876ce94af013464511dca26c">&#9670;&nbsp;</a></span>AddStep() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 AddStep </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>cindexes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>add_if_absent</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-computation-graph_8cc_source.html#l01607">1607</a> of file <a class="el" href="nnet-computation-graph_8cc_source.html">nnet-computation-graph.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-computation-graph_8cc_source.html#l00028">ComputationGraph::GetCindexId()</a>, <a class="el" href="nnet-computation-graph_8h_source.html#l00542">ComputationStepsComputer::graph_</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="nnet-computation-graph_8h_source.html#l00549">ComputationStepsComputer::locations_</a>, and <a class="el" href="nnet-computation-graph_8h_source.html#l00544">ComputationStepsComputer::steps_</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-computation-graph_8cc_source.html#l01741">ComputationStepsComputer::ProcessComponentStep()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01852">ComputationStepsComputer::ProcessDimRangeSubPhase()</a>, and <a class="el" href="nnet-computation-graph_8cc_source.html#l01567">ComputationStepsComputer::ProcessInputOrOutputStep()</a>.</p>
<div class="fragment"><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;                                                            {</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;  <span class="comment">// note: we can&#39;t assert that cindexes is nonempty, because it&#39;s possible for</span></div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;  <span class="comment">// input steps for GeneralComponents to be empty if they require no input</span></div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  <span class="comment">// indexes; and because the compiler code expects component steps to be</span></div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;  <span class="comment">// preceded by component-input steps, we can&#39;t just omit these empty steps.</span></div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;  <span class="comment">// [note: a component-input step is about preparing the input for a component&#39;s</span></div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;  <span class="comment">// propagation.]</span></div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;  int32 step_index = <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a3cb7e5f1e5b76a6bbca03b3a83ad02f5">steps_</a>-&gt;size();</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a3cb7e5f1e5b76a6bbca03b3a83ad02f5">steps_</a>-&gt;push_back(std::vector&lt;int32&gt;());</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;  std::vector&lt;int32&gt; &amp;step = <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a3cb7e5f1e5b76a6bbca03b3a83ad02f5">steps_</a>-&gt;back();  <span class="comment">// vector of cindex_id.</span></div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  step.resize(cindexes.size());</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;  <span class="keywordtype">size_t</span> row_index = 0;</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  std::vector&lt;Cindex&gt;::const_iterator iter = cindexes.begin(),</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;      end = cindexes.end();</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;  std::vector&lt;int32&gt;::iterator out_iter = step.begin();</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  std::pair&lt;int32, int32&gt; *locations = &amp;((*locations_)[0]);</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;  <span class="keywordflow">if</span> (!add_if_absent) {</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    <span class="comment">// this version of GetCindexId will not add CindexIds, and</span></div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <span class="comment">// will crash if CindexIds not present in the graph are</span></div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="comment">// encountered.</span></div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    <span class="keywordflow">for</span> (; iter != end; ++iter, ++out_iter, ++row_index) {</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;      int32 cindex_id = <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ad9329bf8ff1dbf0f1e0f49ded8dc83fd">graph_</a>-&gt;<a class="code" href="structkaldi_1_1nnet3_1_1ComputationGraph.html#a5e1647c5b37c6759f88249b823cc90f5">GetCindexId</a>(*iter);</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;      *out_iter = cindex_id;</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;      locations[cindex_id].first = step_index;</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;      locations[cindex_id].second = row_index;</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    }</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    <span class="keywordflow">for</span> (; iter != end; ++iter, ++out_iter, ++row_index) {</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;      <span class="keywordtype">bool</span> is_input = <span class="keyword">false</span>;  <span class="comment">// only relevant if we have to add the cindex to</span></div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                              <span class="comment">// the computation graph, which we won&#39;t for</span></div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                              <span class="comment">// inputs (we only might for dim-range nodes</span></div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                              <span class="comment">// and for the component-input and component</span></div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                              <span class="comment">// steps of non-simple Components.</span></div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;      <span class="keywordtype">bool</span> added;</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;      int32 cindex_id = <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ad9329bf8ff1dbf0f1e0f49ded8dc83fd">graph_</a>-&gt;<a class="code" href="structkaldi_1_1nnet3_1_1ComputationGraph.html#a5e1647c5b37c6759f88249b823cc90f5">GetCindexId</a>(*iter, is_input, &amp;added);</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;      *out_iter = cindex_id;</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;      <span class="keywordflow">if</span> (added) {</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;        <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cindex_id == static_cast&lt;int32&gt;(<a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a849951c8cab13300f78b0ec8baa30c0c">locations_</a>-&gt;size()));</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;        <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a849951c8cab13300f78b0ec8baa30c0c">locations_</a>-&gt;resize(cindex_id + 1, std::pair&lt;int32, int32&gt;(-1, -1));</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;        <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a849951c8cab13300f78b0ec8baa30c0c">locations_</a>-&gt;back().first = step_index;</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;        <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a849951c8cab13300f78b0ec8baa30c0c">locations_</a>-&gt;back().second = row_index;</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;        locations = &amp;((*locations_)[0]);  <span class="comment">// in case it was reallocated</span></div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;        locations[cindex_id].first = step_index;</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;        locations[cindex_id].second = row_index;</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;      }</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    }</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  }</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;  <span class="keywordflow">return</span> step_index;</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_ad9329bf8ff1dbf0f1e0f49ded8dc83fd"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ad9329bf8ff1dbf0f1e0f49ded8dc83fd">kaldi::nnet3::ComputationStepsComputer::graph_</a></div><div class="ttdeci">ComputationGraph * graph_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00542">nnet-computation-graph.h:542</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_a849951c8cab13300f78b0ec8baa30c0c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a849951c8cab13300f78b0ec8baa30c0c">kaldi::nnet3::ComputationStepsComputer::locations_</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; * locations_</div><div class="ttdoc">locations_ is a map from cindex_id to the pair of indexes into steps_ where that cindex_id resides...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00549">nnet-computation-graph.h:549</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationGraph_html_a5e1647c5b37c6759f88249b823cc90f5"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationGraph.html#a5e1647c5b37c6759f88249b823cc90f5">kaldi::nnet3::ComputationGraph::GetCindexId</a></div><div class="ttdeci">int32 GetCindexId(const Cindex &amp;cindex, bool is_input, bool *is_new)</div><div class="ttdoc">Maps a Cindex to an integer cindex_id. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l00028">nnet-computation-graph.cc:28</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_a3cb7e5f1e5b76a6bbca03b3a83ad02f5"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a3cb7e5f1e5b76a6bbca03b3a83ad02f5">kaldi::nnet3::ComputationStepsComputer::steps_</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int32 &gt; &gt; * steps_</div><div class="ttdoc">steps_ is a pointer to an output that&amp;#39;s passed in in the constructor. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00544">nnet-computation-graph.h:544</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9563e0ce40b01f8cb5670fccde79a734"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9563e0ce40b01f8cb5670fccde79a734">&#9670;&nbsp;</a></span>AddStep() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 AddStep </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; int32 &gt; *&#160;</td>
          <td class="paramname"><em>cindex_ids</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-computation-graph_8cc_source.html#l01660">1660</a> of file <a class="el" href="nnet-computation-graph_8cc_source.html">nnet-computation-graph.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-computation-graph_8h_source.html#l00046">ComputationGraph::cindexes</a>, <a class="el" href="nnet-computation-graph_8h_source.html#l00542">ComputationStepsComputer::graph_</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, and <a class="el" href="nnet-computation-graph_8h_source.html#l00544">ComputationStepsComputer::steps_</a>.</p>
<div class="fragment"><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;                                                                    {</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;  int32 step_index = <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a3cb7e5f1e5b76a6bbca03b3a83ad02f5">steps_</a>-&gt;size();</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a3cb7e5f1e5b76a6bbca03b3a83ad02f5">steps_</a>-&gt;push_back(std::vector&lt;int32&gt;());</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a3cb7e5f1e5b76a6bbca03b3a83ad02f5">steps_</a>-&gt;back().swap(*cindex_ids);</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;  std::vector&lt;int32&gt;::const_iterator iter = <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a3cb7e5f1e5b76a6bbca03b3a83ad02f5">steps_</a>-&gt;back().begin(),</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;      end = <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a3cb7e5f1e5b76a6bbca03b3a83ad02f5">steps_</a>-&gt;back().end();</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;  int32 row_index = 0;</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  std::pair&lt;int32,int32&gt; *locations = &amp;((*locations_)[0]);</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;  <span class="keywordtype">size_t</span> num_cindexes = <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ad9329bf8ff1dbf0f1e0f49ded8dc83fd">graph_</a>-&gt;<a class="code" href="structkaldi_1_1nnet3_1_1ComputationGraph.html#a297d5616d3920cb01d699e7a0e4d2a67">cindexes</a>.size();</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;  <span class="keywordflow">for</span> (; iter != end; ++iter, ++row_index) {</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    int32 cindex_id = *iter;</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(static_cast&lt;size_t&gt;(cindex_id) &lt; num_cindexes);</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    locations[cindex_id].first = step_index;</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    locations[cindex_id].second = row_index;</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;  }</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;  <span class="keywordflow">return</span> step_index;</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_ad9329bf8ff1dbf0f1e0f49ded8dc83fd"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ad9329bf8ff1dbf0f1e0f49ded8dc83fd">kaldi::nnet3::ComputationStepsComputer::graph_</a></div><div class="ttdeci">ComputationGraph * graph_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00542">nnet-computation-graph.h:542</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationGraph_html_a297d5616d3920cb01d699e7a0e4d2a67"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationGraph.html#a297d5616d3920cb01d699e7a0e4d2a67">kaldi::nnet3::ComputationGraph::cindexes</a></div><div class="ttdeci">std::vector&lt; Cindex &gt; cindexes</div><div class="ttdoc">The mapping of cindex_id to Cindex. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00046">nnet-computation-graph.h:46</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_a3cb7e5f1e5b76a6bbca03b3a83ad02f5"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a3cb7e5f1e5b76a6bbca03b3a83ad02f5">kaldi::nnet3::ComputationStepsComputer::steps_</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int32 &gt; &gt; * steps_</div><div class="ttdoc">steps_ is a pointer to an output that&amp;#39;s passed in in the constructor. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00544">nnet-computation-graph.h:544</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4c47fd4f163011eb1939870d25aa656a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c47fd4f163011eb1939870d25aa656a">&#9670;&nbsp;</a></span>Check()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Check </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is only to be called after you have called ComputeForSegment for all the segments. </p>

<p class="definition">Definition at line <a class="el" href="nnet-computation-graph_8cc_source.html#l01946">1946</a> of file <a class="el" href="nnet-computation-graph_8cc_source.html">nnet-computation-graph.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-computation-graph_8h_source.html#l00046">ComputationGraph::cindexes</a>, <a class="el" href="nnet-computation-graph_8h_source.html#l00542">ComputationStepsComputer::graph_</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00126">KALDI_ERR</a>, <a class="el" href="nnet-common_8cc_source.html#l00573">kaldi::nnet3::kNoTime</a>, <a class="el" href="nnet-computation-graph_8h_source.html#l00549">ComputationStepsComputer::locations_</a>, and <a class="el" href="nnet-computation-graph_8h_source.html#l00544">ComputationStepsComputer::steps_</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-compile_8cc_source.html#l00050">Compiler::CreateComputation()</a>.</p>
<div class="fragment"><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;                                           {</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;  int32 num_cindexes = <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ad9329bf8ff1dbf0f1e0f49ded8dc83fd">graph_</a>-&gt;<a class="code" href="structkaldi_1_1nnet3_1_1ComputationGraph.html#a297d5616d3920cb01d699e7a0e4d2a67">cindexes</a>.size();</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a849951c8cab13300f78b0ec8baa30c0c">locations_</a>-&gt;size() == num_cindexes);</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;  <span class="keywordflow">for</span> (int32 c = 0; c &lt; num_cindexes; c++) {</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    int32 step = (*locations_)[c].first,</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        row = (*locations_)[c].second;</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    <span class="keywordflow">if</span> (!(step &gt;= 0 &amp;&amp; row &gt;= 0 &amp;&amp; (*<a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a3cb7e5f1e5b76a6bbca03b3a83ad02f5">steps_</a>)[step][row] == c)) {</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;      <span class="comment">// normally the &#39;locations&#39; of cindexes should be unique, so we should</span></div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;      <span class="comment">// never normally reach this point; but it&#39;s not an error to have</span></div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;      <span class="comment">// duplicates of the cindexes used for &#39;padding&#39; by the ReorderIndexes()</span></div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;      <span class="comment">// function of non-simple Components.  So we check whether that&#39;s the case</span></div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;      <span class="comment">// before we die.</span></div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ad9329bf8ff1dbf0f1e0f49ded8dc83fd">graph_</a>-&gt;<a class="code" href="structkaldi_1_1nnet3_1_1ComputationGraph.html#a297d5616d3920cb01d699e7a0e4d2a67">cindexes</a>[c].second.t != <a class="code" href="namespacekaldi_1_1nnet3.html#ac952f0840a7950dff80c1a89e69656d7">kNoTime</a>) {</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;        <span class="comment">// if this happens it will likely require some debugging by Dan.</span></div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;        <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Error in computing computation steps (likely code error)&quot;</span>;</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;      }</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    }</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;  }</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_ad9329bf8ff1dbf0f1e0f49ded8dc83fd"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ad9329bf8ff1dbf0f1e0f49ded8dc83fd">kaldi::nnet3::ComputationStepsComputer::graph_</a></div><div class="ttdeci">ComputationGraph * graph_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00542">nnet-computation-graph.h:542</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_a849951c8cab13300f78b0ec8baa30c0c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a849951c8cab13300f78b0ec8baa30c0c">kaldi::nnet3::ComputationStepsComputer::locations_</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; * locations_</div><div class="ttdoc">locations_ is a map from cindex_id to the pair of indexes into steps_ where that cindex_id resides...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00549">nnet-computation-graph.h:549</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationGraph_html_a297d5616d3920cb01d699e7a0e4d2a67"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationGraph.html#a297d5616d3920cb01d699e7a0e4d2a67">kaldi::nnet3::ComputationGraph::cindexes</a></div><div class="ttdeci">std::vector&lt; Cindex &gt; cindexes</div><div class="ttdoc">The mapping of cindex_id to Cindex. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00046">nnet-computation-graph.h:46</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_a3cb7e5f1e5b76a6bbca03b3a83ad02f5"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a3cb7e5f1e5b76a6bbca03b3a83ad02f5">kaldi::nnet3::ComputationStepsComputer::steps_</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int32 &gt; &gt; * steps_</div><div class="ttdoc">steps_ is a pointer to an output that&amp;#39;s passed in in the constructor. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00544">nnet-computation-graph.h:544</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00126">kaldi-error.h:126</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ac952f0840a7950dff80c1a89e69656d7"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ac952f0840a7950dff80c1a89e69656d7">kaldi::nnet3::kNoTime</a></div><div class="ttdeci">const int kNoTime</div><div class="ttdef"><b>Definition:</b> <a href="nnet-common_8cc_source.html#l00573">nnet-common.cc:573</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae65fd7aafe0a4a887e6fdf3ee8b97a13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae65fd7aafe0a4a887e6fdf3ee8b97a13">&#9670;&nbsp;</a></span>ComputeForSegment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ComputeForSegment </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>phases</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>You call this once for each segment, in order (note: for normal, non-online computations, there is only one segment). </p>

<p class="definition">Definition at line <a class="el" href="nnet-computation-graph_8cc_source.html#l01554">1554</a> of file <a class="el" href="nnet-computation-graph_8cc_source.html">nnet-computation-graph.cc</a>.</p>

<p class="reference">References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01920">ComputationStepsComputer::ProcessSubPhase()</a>, and <a class="el" href="nnet-computation-graph_8cc_source.html#l01967">ComputationStepsComputer::SplitIntoSubPhases()</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-compile_8cc_source.html#l00050">Compiler::CreateComputation()</a>.</p>
<div class="fragment"><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;                                                {</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;  int32 this_num_phases = phases.size();</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  <span class="keywordflow">for</span> (int32 <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; this_num_phases; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    std::vector&lt;std::vector&lt;Cindex&gt; &gt; sub_phases;</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a704d97dd332b0327ae16a0fc377629c0">SplitIntoSubPhases</a>(phases[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>], &amp;sub_phases);</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; sub_phases.size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;      <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a8c079dc88d7030933c6209f03e84b257">ProcessSubPhase</a>(request, sub_phases[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>]);</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    }</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  }</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;}</div><div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_a704d97dd332b0327ae16a0fc377629c0"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a704d97dd332b0327ae16a0fc377629c0">kaldi::nnet3::ComputationStepsComputer::SplitIntoSubPhases</a></div><div class="ttdeci">void SplitIntoSubPhases(const std::vector&lt; int32 &gt; &amp;phase, std::vector&lt; std::vector&lt; Cindex &gt; &gt; *sub_phase) const</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l01967">nnet-computation-graph.cc:1967</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_a8c079dc88d7030933c6209f03e84b257"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a8c079dc88d7030933c6209f03e84b257">kaldi::nnet3::ComputationStepsComputer::ProcessSubPhase</a></div><div class="ttdeci">void ProcessSubPhase(const ComputationRequest &amp;request, const std::vector&lt; Cindex &gt; &amp;sub_phase)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l01920">nnet-computation-graph.cc:1920</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a274c4b9215d2e1d0b8a37aa79193883b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a274c4b9215d2e1d0b8a37aa79193883b">&#9670;&nbsp;</a></span>ConvertToCindexes() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ConvertToCindexes </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>cindex_ids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> &gt; *&#160;</td>
          <td class="paramname"><em>cindexes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-computation-graph_8cc_source.html#l01679">1679</a> of file <a class="el" href="nnet-computation-graph_8cc_source.html">nnet-computation-graph.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-computation-graph_8h_source.html#l00046">ComputationGraph::cindexes</a>, <a class="el" href="nnet-computation-graph_8h_source.html#l00542">ComputationStepsComputer::graph_</a>, and <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-computation-graph_8cc_source.html#l01741">ComputationStepsComputer::ProcessComponentStep()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01852">ComputationStepsComputer::ProcessDimRangeSubPhase()</a>, and <a class="el" href="nnet-computation-graph_8cc_source.html#l01967">ComputationStepsComputer::SplitIntoSubPhases()</a>.</p>
<div class="fragment"><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;                                       {</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;  cindexes-&gt;resize(cindex_ids.size());</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;  <span class="keywordtype">size_t</span> num_cindexes = <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ad9329bf8ff1dbf0f1e0f49ded8dc83fd">graph_</a>-&gt;<a class="code" href="structkaldi_1_1nnet3_1_1ComputationGraph.html#a297d5616d3920cb01d699e7a0e4d2a67">cindexes</a>.size();</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;  std::vector&lt;int32&gt;::const_iterator iter = cindex_ids.begin(),</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;      end = cindex_ids.end();</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;  std::vector&lt;Cindex&gt;::iterator out_iter = cindexes-&gt;begin();</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;  <span class="keywordflow">for</span> (; iter != end; ++iter, ++out_iter) {</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    int32 cindex_id = *iter;</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(static_cast&lt;size_t&gt;(cindex_id) &lt; num_cindexes);</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    *out_iter = <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ad9329bf8ff1dbf0f1e0f49ded8dc83fd">graph_</a>-&gt;<a class="code" href="structkaldi_1_1nnet3_1_1ComputationGraph.html#a297d5616d3920cb01d699e7a0e4d2a67">cindexes</a>[cindex_id];</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;  }</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_ad9329bf8ff1dbf0f1e0f49ded8dc83fd"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ad9329bf8ff1dbf0f1e0f49ded8dc83fd">kaldi::nnet3::ComputationStepsComputer::graph_</a></div><div class="ttdeci">ComputationGraph * graph_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00542">nnet-computation-graph.h:542</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationGraph_html_a297d5616d3920cb01d699e7a0e4d2a67"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationGraph.html#a297d5616d3920cb01d699e7a0e4d2a67">kaldi::nnet3::ComputationGraph::cindexes</a></div><div class="ttdeci">std::vector&lt; Cindex &gt; cindexes</div><div class="ttdoc">The mapping of cindex_id to Cindex. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00046">nnet-computation-graph.h:46</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8db9dc43d66ef32442d039a38c83bc21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8db9dc43d66ef32442d039a38c83bc21">&#9670;&nbsp;</a></span>ConvertToCindexes() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ConvertToCindexes </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>indexes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>node_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> &gt; *&#160;</td>
          <td class="paramname"><em>cindexes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-computation-graph_8cc_source.html#l01723">1723</a> of file <a class="el" href="nnet-computation-graph_8cc_source.html">nnet-computation-graph.cc</a>.</p>

<p class="reference">References <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>.</p>
<div class="fragment"><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;                                 {</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(node_index &gt;= 0);</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  cindexes-&gt;resize(indexes.size());</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;  std::vector&lt;Index&gt;::const_iterator iter = indexes.begin(),</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;      end = indexes.end();</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;  std::vector&lt;Cindex&gt;::iterator out_iter = cindexes-&gt;begin();</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;  <span class="keywordflow">for</span> (; iter != end; ++iter, ++out_iter) {</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    out_iter-&gt;first = node_index;</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    out_iter-&gt;second = *iter;</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;  }</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;}</div><div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab08827e539a965039328f52cb2ce2c62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab08827e539a965039328f52cb2ce2c62">&#9670;&nbsp;</a></span>ConvertToCindexIds()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ConvertToCindexIds </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>cindexes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32 &gt; *&#160;</td>
          <td class="paramname"><em>cindex_ids</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-computation-graph_8cc_source.html#l01695">1695</a> of file <a class="el" href="nnet-computation-graph_8cc_source.html">nnet-computation-graph.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-computation-graph_8cc_source.html#l00028">ComputationGraph::GetCindexId()</a>, <a class="el" href="nnet-computation-graph_8h_source.html#l00542">ComputationStepsComputer::graph_</a>, and <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-computation-graph_8cc_source.html#l01741">ComputationStepsComputer::ProcessComponentStep()</a>, and <a class="el" href="nnet-computation-graph_8cc_source.html#l01852">ComputationStepsComputer::ProcessDimRangeSubPhase()</a>.</p>
<div class="fragment"><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;                                        {</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;  cindex_ids-&gt;resize(cindexes.size());</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;  std::vector&lt;Cindex&gt;::const_iterator iter = cindexes.begin(),</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;      end = cindexes.end();</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;  std::vector&lt;int32&gt;::iterator out_iter = cindex_ids-&gt;begin();</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  <span class="keywordflow">for</span> (; iter != end; ++iter, ++out_iter) {</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    int32 cindex_id = <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ad9329bf8ff1dbf0f1e0f49ded8dc83fd">graph_</a>-&gt;<a class="code" href="structkaldi_1_1nnet3_1_1ComputationGraph.html#a5e1647c5b37c6759f88249b823cc90f5">GetCindexId</a>(*iter);</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cindex_id &gt;= 0);</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    *out_iter = cindex_id;</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;  }</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_ad9329bf8ff1dbf0f1e0f49ded8dc83fd"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ad9329bf8ff1dbf0f1e0f49ded8dc83fd">kaldi::nnet3::ComputationStepsComputer::graph_</a></div><div class="ttdeci">ComputationGraph * graph_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00542">nnet-computation-graph.h:542</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationGraph_html_a5e1647c5b37c6759f88249b823cc90f5"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationGraph.html#a5e1647c5b37c6759f88249b823cc90f5">kaldi::nnet3::ComputationGraph::GetCindexId</a></div><div class="ttdeci">int32 GetCindexId(const Cindex &amp;cindex, bool is_input, bool *is_new)</div><div class="ttdoc">Maps a Cindex to an integer cindex_id. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l00028">nnet-computation-graph.cc:28</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aeec16f10bd8cbba592a5053a89eacfff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeec16f10bd8cbba592a5053a89eacfff">&#9670;&nbsp;</a></span>ConvertToIndexes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ConvertToIndexes </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>cindexes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; *&#160;</td>
          <td class="paramname"><em>indexes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-computation-graph_8cc_source.html#l01711">1711</a> of file <a class="el" href="nnet-computation-graph_8cc_source.html">nnet-computation-graph.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-computation-graph_8cc_source.html#l01741">ComputationStepsComputer::ProcessComponentStep()</a>.</p>
<div class="fragment"><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                               {</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  indexes-&gt;resize(cindexes.size());</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;  std::vector&lt;Cindex&gt;::const_iterator iter = cindexes.begin(),</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;      end = cindexes.end();</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;  std::vector&lt;Index&gt;::iterator out_iter = indexes-&gt;begin();</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  <span class="keywordflow">for</span> (; iter != end; ++iter, ++out_iter)</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    *out_iter = iter-&gt;second;</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a756818ae128e31e80a0f09c79f584675"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a756818ae128e31e80a0f09c79f584675">&#9670;&nbsp;</a></span>ConvertToLocations()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ConvertToLocations </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>cindex_ids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>locations</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-computation-graph_8cc_source.html#l01830">1830</a> of file <a class="el" href="nnet-computation-graph_8cc_source.html">nnet-computation-graph.cc</a>.</p>

<p class="reference">References <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, and <a class="el" href="nnet-computation-graph_8h_source.html#l00549">ComputationStepsComputer::locations_</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-computation-graph_8cc_source.html#l01852">ComputationStepsComputer::ProcessDimRangeSubPhase()</a>.</p>
<div class="fragment"><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;                                                        {</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;  locations-&gt;resize(cindex_ids.size());</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;  std::vector&lt;int32&gt;::const_iterator iter = cindex_ids.begin(),</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;      end = cindex_ids.end();</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;  std::vector&lt;std::pair&lt;int32, int32&gt; &gt;::iterator out_iter =</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;      locations-&gt;begin();</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;  <span class="comment">// note, locations_ and locations are different variables.</span></div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;  std::pair&lt;int32, int32&gt; *locations_ptr = &amp;((*locations_)[0]);</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;  <span class="keywordtype">size_t</span> num_cindexes = <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a849951c8cab13300f78b0ec8baa30c0c">locations_</a>-&gt;size();</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;  <span class="keywordflow">for</span> (; iter != end; ++iter, ++out_iter) {</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    int32 cindex_id = *iter;</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(static_cast&lt;size_t&gt;(cindex_id) &lt; num_cindexes);</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    int32 step = locations_ptr[cindex_id].first,</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;        row = locations_ptr[cindex_id].second;</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(step &gt;= 0);</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    out_iter-&gt;first = step;</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    out_iter-&gt;second = row;</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;  }</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_a849951c8cab13300f78b0ec8baa30c0c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a849951c8cab13300f78b0ec8baa30c0c">kaldi::nnet3::ComputationStepsComputer::locations_</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; * locations_</div><div class="ttdoc">locations_ is a map from cindex_id to the pair of indexes into steps_ where that cindex_id resides...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00549">nnet-computation-graph.h:549</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6cfba18e7848b9258cb311dd68eddb05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cfba18e7848b9258cb311dd68eddb05">&#9670;&nbsp;</a></span>ProcessComponentStep()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProcessComponentStep </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>step</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-computation-graph_8cc_source.html#l01741">1741</a> of file <a class="el" href="nnet-computation-graph_8cc_source.html">nnet-computation-graph.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-computation-graph_8cc_source.html#l01607">ComputationStepsComputer::AddStep()</a>, <a class="el" href="nnet-computation-graph_8h_source.html#l00046">ComputationGraph::cindexes</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00087">NetworkNode::component_index</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01679">ComputationStepsComputer::ConvertToCindexes()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01695">ComputationStepsComputer::ConvertToCindexIds()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01711">ComputationStepsComputer::ConvertToIndexes()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00064">rnnlm::d</a>, <a class="el" href="nnet-computation-graph_8h_source.html#l00063">ComputationGraph::dependencies</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00150">Nnet::GetComponent()</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00146">Nnet::GetNode()</a>, <a class="el" href="nnet-computation-graph_8h_source.html#l00542">ComputationStepsComputer::graph_</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00132">Nnet::IsComponentNode()</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00058">kaldi::nnet3::kReordersIndexes</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00038">kaldi::nnet3::kSimpleComponent</a>, <a class="el" href="nnet-computation-graph_8h_source.html#l00541">ComputationStepsComputer::nnet_</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">Component::Properties()</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00272">Component::ReorderIndexes()</a>, and <a class="el" href="structkaldi_1_1nnet3_1_1NetworkNode.html#a1350345f237cf9f9ce2f2e2b39800dd7">NetworkNode::u</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-computation-graph_8cc_source.html#l01920">ComputationStepsComputer::ProcessSubPhase()</a>.</p>
<div class="fragment"><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;                                   {</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!step.empty());</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;  int32 component_node_index = step.front().first;</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  int32 component_input_index = component_node_index - 1;</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#adbabf05a7702103113a02a113015205f">nnet_</a>.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a9167816d5d30fa49f76019d83cf6d652">IsComponentNode</a>(component_node_index));</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;  <span class="keyword">const</span> NetworkNode &amp;node = <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#adbabf05a7702103113a02a113015205f">nnet_</a>.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a7c9670858b79ae4a8e1c054b5d5231b8">GetNode</a>(component_node_index);</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;  int32 c = node.<a class="code" href="structkaldi_1_1nnet3_1_1NetworkNode.html#a1350345f237cf9f9ce2f2e2b39800dd7">u</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NetworkNode.html#a270421a70b3bbf94bcad52d82772ed3c">component_index</a>;</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;  <span class="keyword">const</span> Component *component = <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#adbabf05a7702103113a02a113015205f">nnet_</a>.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#aec8d6dfed3e4ab080d3ff4cf6a1126e3">GetComponent</a>(c);</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;  <span class="keywordflow">if</span> (component-&gt;Properties() &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a5530b2f8f01fac9e6e73fd29a65d4127">kSimpleComponent</a>) {</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    <span class="comment">// for simple components, the input cindexes will be the same as the</span></div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <span class="comment">// output ones except for the node index, so we do a shortcut that&#39;s</span></div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    <span class="comment">// faster (no following dependencies).</span></div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    std::vector&lt;Cindex&gt; input_step(step.size());</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    input_step.resize(step.size());</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    std::vector&lt;Cindex&gt;::iterator iter = input_step.begin(),</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        end = input_step.end();</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    std::vector&lt;Cindex&gt;::const_iterator src = step.begin();</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <span class="keywordflow">for</span> (; iter != end; ++iter,++src) {</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;      iter-&gt;first = component_input_index;</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;      iter-&gt;second = src-&gt;second;</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    }</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a8ab8ccc5876ce94af013464511dca26c">AddStep</a>(input_step);</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a8ab8ccc5876ce94af013464511dca26c">AddStep</a>(step);</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    std::vector&lt;int32&gt; step_cindex_ids;</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ab08827e539a965039328f52cb2ce2c62">ConvertToCindexIds</a>(step, &amp;step_cindex_ids);</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    <span class="comment">// to get the input cindexes we need to follow dependencies back.</span></div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    unordered_set&lt;int32&gt; input_cindex_ids;</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    std::vector&lt;int32&gt;::iterator iter = step_cindex_ids.begin(),</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;        end = step_cindex_ids.end();</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    <span class="keywordflow">for</span> (; iter != end; ++iter) {</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;      int32 c = *iter;</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;      <span class="keyword">const</span> std::vector&lt;int32&gt; &amp;dependencies = <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ad9329bf8ff1dbf0f1e0f49ded8dc83fd">graph_</a>-&gt;<a class="code" href="structkaldi_1_1nnet3_1_1ComputationGraph.html#ac5de41a87e16d0cb72ab76d026525216">dependencies</a>[c];</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;      std::vector&lt;int32&gt;::const_iterator dep_iter = dependencies.begin(),</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;          dep_end = dependencies.end();</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;      <span class="keywordflow">for</span> (; dep_iter != dep_end; ++dep_iter) {</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;        int32 <a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = *dep_iter;</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;        input_cindex_ids.insert(d);</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;      }</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    }</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    <span class="comment">// Convert to Cindexes so we can sort them as Cindexes.</span></div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    std::vector&lt;Cindex&gt; input_step;</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    input_step.reserve(input_cindex_ids.size());</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    unordered_set&lt;int32&gt;::iterator set_iter = input_cindex_ids.begin(),</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;        set_end = input_cindex_ids.end();</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    <span class="keywordflow">for</span> (; set_iter != set_end; ++set_iter) {</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;      int32 c = *set_iter;</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;      input_step.push_back(<a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ad9329bf8ff1dbf0f1e0f49ded8dc83fd">graph_</a>-&gt;<a class="code" href="structkaldi_1_1nnet3_1_1ComputationGraph.html#a297d5616d3920cb01d699e7a0e4d2a67">cindexes</a>[c]);</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    }</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    <span class="comment">// sort the input cindexes.</span></div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    std::sort(input_step.begin(), input_step.end());</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    <span class="keywordflow">if</span> (component-&gt;Properties() &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a6c12dbc12f9d02024f66b4b0d160ee67">kReordersIndexes</a>) {</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;      std::vector&lt;Index&gt; indexes, input_indexes;</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;      <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#aeec16f10bd8cbba592a5053a89eacfff">ConvertToIndexes</a>(input_step, &amp;input_indexes);</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;      <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#aeec16f10bd8cbba592a5053a89eacfff">ConvertToIndexes</a>(step, &amp;indexes);</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;      <span class="keywordtype">size_t</span> orig_size = indexes.size() + input_indexes.size();</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;      <span class="comment">// the component wants to have the opportunity to change the</span></div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;      <span class="comment">// order of these indexes from their default.</span></div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;      component-&gt;ReorderIndexes(&amp;input_indexes, &amp;indexes);</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;      <span class="keywordtype">bool</span> added_padding = (orig_size != indexes.size() + input_indexes.size());</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;      <span class="comment">// Now convert back from indexes to cindexes (we know the</span></div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;      <span class="comment">// node-index in each case)</span></div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;      std::vector&lt;Cindex&gt; reordered_step;</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;      <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a274c4b9215d2e1d0b8a37aa79193883b">ConvertToCindexes</a>(indexes, component_node_index, &amp;reordered_step);</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;      <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a274c4b9215d2e1d0b8a37aa79193883b">ConvertToCindexes</a>(input_indexes, component_input_index, &amp;input_step);</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;      <span class="comment">// the &#39;added_padding&#39; argument becomes the &#39;add_if_absent&#39; arg of</span></div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;      <span class="comment">// AddStep, so it knows to expect that it might have to add new CindexIds.</span></div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;      <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a8ab8ccc5876ce94af013464511dca26c">AddStep</a>(input_step, added_padding);</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;      <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a8ab8ccc5876ce94af013464511dca26c">AddStep</a>(reordered_step, added_padding);</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;      <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a8ab8ccc5876ce94af013464511dca26c">AddStep</a>(input_step);</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;      <span class="comment">// it&#39;s more efficient to add the step with cindex_ids; and we have these</span></div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;      <span class="comment">// available, so we do it that way.  (in the other branch where</span></div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;      <span class="comment">// the flag kReordersIndexes was present, we couldn&#39;t do this because</span></div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;      <span class="comment">// of the reordering).</span></div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;      <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a8ab8ccc5876ce94af013464511dca26c">AddStep</a>(&amp;step_cindex_ids);</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;    }</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;  }</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_ad9329bf8ff1dbf0f1e0f49ded8dc83fd"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ad9329bf8ff1dbf0f1e0f49ded8dc83fd">kaldi::nnet3::ComputationStepsComputer::graph_</a></div><div class="ttdeci">ComputationGraph * graph_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00542">nnet-computation-graph.h:542</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_ab08827e539a965039328f52cb2ce2c62"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ab08827e539a965039328f52cb2ce2c62">kaldi::nnet3::ComputationStepsComputer::ConvertToCindexIds</a></div><div class="ttdeci">void ConvertToCindexIds(const std::vector&lt; Cindex &gt; &amp;cindexes, std::vector&lt; int32 &gt; *cindex_ids) const</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l01695">nnet-computation-graph.cc:1695</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NetworkNode_html_a270421a70b3bbf94bcad52d82772ed3c"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NetworkNode.html#a270421a70b3bbf94bcad52d82772ed3c">kaldi::nnet3::NetworkNode::component_index</a></div><div class="ttdeci">int32 component_index</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00087">nnet-nnet.h:87</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a9167816d5d30fa49f76019d83cf6d652"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a9167816d5d30fa49f76019d83cf6d652">kaldi::nnet3::Nnet::IsComponentNode</a></div><div class="ttdeci">bool IsComponentNode(int32 node) const</div><div class="ttdoc">Returns true if this is a component node, meaning that it is of type kComponent. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00132">nnet-nnet.cc:132</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_aeec16f10bd8cbba592a5053a89eacfff"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#aeec16f10bd8cbba592a5053a89eacfff">kaldi::nnet3::ComputationStepsComputer::ConvertToIndexes</a></div><div class="ttdeci">static void ConvertToIndexes(const std::vector&lt; Cindex &gt; &amp;cindexes, std::vector&lt; Index &gt; *indexes)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l01711">nnet-computation-graph.cc:1711</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationGraph_html_a297d5616d3920cb01d699e7a0e4d2a67"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationGraph.html#a297d5616d3920cb01d699e7a0e4d2a67">kaldi::nnet3::ComputationGraph::cindexes</a></div><div class="ttdeci">std::vector&lt; Cindex &gt; cindexes</div><div class="ttdoc">The mapping of cindex_id to Cindex. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00046">nnet-computation-graph.h:46</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a7c9670858b79ae4a8e1c054b5d5231b8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a7c9670858b79ae4a8e1c054b5d5231b8">kaldi::nnet3::Nnet::GetNode</a></div><div class="ttdeci">const NetworkNode &amp; GetNode(int32 node) const</div><div class="ttdoc">returns const reference to a particular numbered network node. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00146">nnet-nnet.h:146</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_a274c4b9215d2e1d0b8a37aa79193883b"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a274c4b9215d2e1d0b8a37aa79193883b">kaldi::nnet3::ComputationStepsComputer::ConvertToCindexes</a></div><div class="ttdeci">void ConvertToCindexes(const std::vector&lt; int32 &gt; &amp;cindex_ids, std::vector&lt; Cindex &gt; *cindexes) const</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l01679">nnet-computation-graph.cc:1679</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationGraph_html_ac5de41a87e16d0cb72ab76d026525216"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationGraph.html#ac5de41a87e16d0cb72ab76d026525216">kaldi::nnet3::ComputationGraph::dependencies</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int32 &gt; &gt; dependencies</div><div class="ttdoc">dependencies[cindex_id] gives you the list of other cindex_ids that this particular cindex_id directl...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00063">nnet-computation-graph.h:63</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a5530b2f8f01fac9e6e73fd29a65d4127"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a5530b2f8f01fac9e6e73fd29a65d4127">kaldi::nnet3::kSimpleComponent</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00038">nnet-component-itf.h:38</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_aec8d6dfed3e4ab080d3ff4cf6a1126e3"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#aec8d6dfed3e4ab080d3ff4cf6a1126e3">kaldi::nnet3::Nnet::GetComponent</a></div><div class="ttdeci">Component * GetComponent(int32 c)</div><div class="ttdoc">Return component indexed c. Not a copy; not owned by caller. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00150">nnet-nnet.cc:150</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a6c12dbc12f9d02024f66b4b0d160ee67"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a6c12dbc12f9d02024f66b4b0d160ee67">kaldi::nnet3::kReordersIndexes</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00058">nnet-component-itf.h:58</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_a8ab8ccc5876ce94af013464511dca26c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a8ab8ccc5876ce94af013464511dca26c">kaldi::nnet3::ComputationStepsComputer::AddStep</a></div><div class="ttdeci">int32 AddStep(const std::vector&lt; Cindex &gt; &amp;cindexes, bool add_if_absent=false)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l01607">nnet-computation-graph.cc:1607</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NetworkNode_html_a1350345f237cf9f9ce2f2e2b39800dd7"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NetworkNode.html#a1350345f237cf9f9ce2f2e2b39800dd7">kaldi::nnet3::NetworkNode::u</a></div><div class="ttdeci">union kaldi::nnet3::NetworkNode::@14 u</div></div>
<div class="ttc" id="namespacernnlm_html_a873684cefeb665f3d5e6b495de57fc0d"><div class="ttname"><a href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">rnnlm::d</a></div><div class="ttdeci">double d</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00064">mikolov-rnnlm-lib.cc:64</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_adbabf05a7702103113a02a113015205f"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#adbabf05a7702103113a02a113015205f">kaldi::nnet3::ComputationStepsComputer::nnet_</a></div><div class="ttdeci">const Nnet &amp; nnet_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00541">nnet-computation-graph.h:541</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8bf7e70ed658ec686d094a87bf01040c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bf7e70ed658ec686d094a87bf01040c">&#9670;&nbsp;</a></span>ProcessDimRangeSubPhase()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProcessDimRangeSubPhase </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>sub_phase</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-computation-graph_8cc_source.html#l01852">1852</a> of file <a class="el" href="nnet-computation-graph_8cc_source.html">nnet-computation-graph.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-computation-graph_8cc_source.html#l01607">ComputationStepsComputer::AddStep()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01679">ComputationStepsComputer::ConvertToCindexes()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01695">ComputationStepsComputer::ConvertToCindexIds()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01830">ComputationStepsComputer::ConvertToLocations()</a>, <a class="el" href="nnet-computation-graph_8h_source.html#l00558">ComputationStepsComputer::dim_range_nodes_</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00146">Nnet::GetNode()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00138">Nnet::IsDimRangeNode()</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="nnet-computation-graph_8h_source.html#l00541">ComputationStepsComputer::nnet_</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00090">NetworkNode::node_index</a>, and <a class="el" href="structkaldi_1_1nnet3_1_1NetworkNode.html#a1350345f237cf9f9ce2f2e2b39800dd7">NetworkNode::u</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-computation-graph_8cc_source.html#l01920">ComputationStepsComputer::ProcessSubPhase()</a>.</p>
<div class="fragment"><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;                                        {</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;  int32 dim_range_node = sub_phase[0].first;</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#adbabf05a7702103113a02a113015205f">nnet_</a>.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a38ed67486324e56fe851bd3ccb06a4ab">IsDimRangeNode</a>(dim_range_node));</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;  <span class="keyword">const</span> NetworkNode &amp;node = <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#adbabf05a7702103113a02a113015205f">nnet_</a>.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a7c9670858b79ae4a8e1c054b5d5231b8">GetNode</a>(dim_range_node);</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;  <span class="comment">// &#39;input_node_index&#39; is the node index of the component or input node</span></div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;  <span class="comment">// that this dim-range node gets its input from.</span></div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;  int32 input_node_index = node.<a class="code" href="structkaldi_1_1nnet3_1_1NetworkNode.html#a1350345f237cf9f9ce2f2e2b39800dd7">u</a>.<a class="code" href="structkaldi_1_1nnet3_1_1NetworkNode.html#ab58113c3d0868442962af6f30d589d48">node_index</a>;</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;  <span class="comment">// input_cindexes will give us the cindexes of the component or input node</span></div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;  <span class="comment">// that is the input to this dim-range node</span></div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;  std::vector&lt;Cindex&gt; input_cindexes(sub_phase);</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;  <span class="keywordflow">for</span> (std::vector&lt;Cindex&gt;::iterator iter = input_cindexes.begin(),</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;           end = input_cindexes.end(); iter != end; ++iter)</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    iter-&gt;first = input_node_index;</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;  std::vector&lt;int32&gt; input_cindex_ids;</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ab08827e539a965039328f52cb2ce2c62">ConvertToCindexIds</a>(input_cindexes, &amp;input_cindex_ids);</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;  std::vector&lt;std::pair&lt;int32, int32&gt; &gt; locations;</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a756818ae128e31e80a0f09c79f584675">ConvertToLocations</a>(input_cindex_ids, &amp;locations);</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;  <span class="comment">// get a list of the source step indexes (corresponding to computations for the</span></div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;  <span class="comment">// source component-node)</span></div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;  std::unordered_set&lt;int32&gt; source_step_indexes;</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!locations.empty());</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;  std::vector&lt;std::pair&lt;int32, int32&gt; &gt;::const_iterator</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;      locations_iter = locations.begin(),</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;      locations_end = locations.end();</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;  <span class="comment">// &#39;cur_source_step_index&#39; is just an optimization to prevent unnecessary</span></div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;  <span class="comment">// unordered_set inserts.</span></div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;  int32 cur_source_step_index = -1;</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;  <span class="keywordflow">for</span> (; locations_iter != locations_end; ++locations_iter) {</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    int32 source_step_index = locations_iter-&gt;first;</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    <span class="keywordflow">if</span> (source_step_index != cur_source_step_index) {</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;      cur_source_step_index = source_step_index;</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;      source_step_indexes.insert(cur_source_step_index);</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    }</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;  }</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;  std::unordered_set&lt;int32&gt;::const_iterator</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;      source_step_iter = source_step_indexes.begin(),</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;      source_step_end = source_step_indexes.end();</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;  <span class="comment">// iterating over the indexes of the source steps.</span></div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;  <span class="keywordflow">for</span> (; source_step_iter != source_step_end; ++source_step_iter) {</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    int32 source_step_index = *source_step_iter;</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    std::pair&lt;int32, int32&gt; p(source_step_index, dim_range_node);</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a2780f70b419f18227193b7c14015ec6f">dim_range_nodes_</a>.count(p) &gt; 0) {</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;      <span class="comment">// We don&#39;t need to do anything; a dim-range node already exists for this</span></div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;      <span class="comment">// step and this node index.</span></div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    }</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a2780f70b419f18227193b7c14015ec6f">dim_range_nodes_</a>.insert(p);</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    <span class="keyword">const</span> std::vector&lt;int32&gt; &amp;source_step = (*steps_)[source_step_index];</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    <span class="comment">// &#39;cindexes&#39; will be the cindexes of the new step that we&#39;re going to add.</span></div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    std::vector&lt;Cindex&gt; cindexes;</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a274c4b9215d2e1d0b8a37aa79193883b">ConvertToCindexes</a>(source_step, &amp;cindexes);</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    std::vector&lt;Cindex&gt;::iterator iter = cindexes.begin(),</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;        end = cindexes.end();</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    <span class="keywordflow">for</span> (; iter != end; ++iter)</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;      iter-&gt;first = dim_range_node;</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    <span class="keywordtype">bool</span> add_if_absent = <span class="keyword">true</span>;</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    <span class="comment">// this add_if_absent says, even if cindexes were not in the graph,</span></div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    <span class="comment">// add them.  This is possible; the step will contain all cindexes for the</span></div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    <span class="comment">// input step, even if they won&#39;t be needed.  (This is costless; it&#39;s just</span></div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    <span class="comment">// setting up a sub-matrix).</span></div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a8ab8ccc5876ce94af013464511dca26c">AddStep</a>(cindexes, add_if_absent);</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;  }</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_a756818ae128e31e80a0f09c79f584675"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a756818ae128e31e80a0f09c79f584675">kaldi::nnet3::ComputationStepsComputer::ConvertToLocations</a></div><div class="ttdeci">void ConvertToLocations(const std::vector&lt; int32 &gt; &amp;cindex_ids, std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; *locations) const</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l01830">nnet-computation-graph.cc:1830</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_ab08827e539a965039328f52cb2ce2c62"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ab08827e539a965039328f52cb2ce2c62">kaldi::nnet3::ComputationStepsComputer::ConvertToCindexIds</a></div><div class="ttdeci">void ConvertToCindexIds(const std::vector&lt; Cindex &gt; &amp;cindexes, std::vector&lt; int32 &gt; *cindex_ids) const</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l01695">nnet-computation-graph.cc:1695</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a7c9670858b79ae4a8e1c054b5d5231b8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a7c9670858b79ae4a8e1c054b5d5231b8">kaldi::nnet3::Nnet::GetNode</a></div><div class="ttdeci">const NetworkNode &amp; GetNode(int32 node) const</div><div class="ttdoc">returns const reference to a particular numbered network node. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00146">nnet-nnet.h:146</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_a274c4b9215d2e1d0b8a37aa79193883b"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a274c4b9215d2e1d0b8a37aa79193883b">kaldi::nnet3::ComputationStepsComputer::ConvertToCindexes</a></div><div class="ttdeci">void ConvertToCindexes(const std::vector&lt; int32 &gt; &amp;cindex_ids, std::vector&lt; Cindex &gt; *cindexes) const</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l01679">nnet-computation-graph.cc:1679</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_a2780f70b419f18227193b7c14015ec6f"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a2780f70b419f18227193b7c14015ec6f">kaldi::nnet3::ComputationStepsComputer::dim_range_nodes_</a></div><div class="ttdeci">std::unordered_set&lt; std::pair&lt; int32, int32 &gt;, PairHasher&lt; int32 &gt; &gt; dim_range_nodes_</div><div class="ttdoc">dim_range_nodes_ is used when allocating steps for nodes of type kDimRangeNode. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00558">nnet-computation-graph.h:558</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NetworkNode_html_ab58113c3d0868442962af6f30d589d48"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NetworkNode.html#ab58113c3d0868442962af6f30d589d48">kaldi::nnet3::NetworkNode::node_index</a></div><div class="ttdeci">int32 node_index</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00090">nnet-nnet.h:90</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_a8ab8ccc5876ce94af013464511dca26c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a8ab8ccc5876ce94af013464511dca26c">kaldi::nnet3::ComputationStepsComputer::AddStep</a></div><div class="ttdeci">int32 AddStep(const std::vector&lt; Cindex &gt; &amp;cindexes, bool add_if_absent=false)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l01607">nnet-computation-graph.cc:1607</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a38ed67486324e56fe851bd3ccb06a4ab"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a38ed67486324e56fe851bd3ccb06a4ab">kaldi::nnet3::Nnet::IsDimRangeNode</a></div><div class="ttdeci">bool IsDimRangeNode(int32 node) const</div><div class="ttdoc">Returns true if this is a dim-range node, meaning that it is of type kDimRange. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00138">nnet-nnet.cc:138</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NetworkNode_html_a1350345f237cf9f9ce2f2e2b39800dd7"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NetworkNode.html#a1350345f237cf9f9ce2f2e2b39800dd7">kaldi::nnet3::NetworkNode::u</a></div><div class="ttdeci">union kaldi::nnet3::NetworkNode::@14 u</div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_adbabf05a7702103113a02a113015205f"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#adbabf05a7702103113a02a113015205f">kaldi::nnet3::ComputationStepsComputer::nnet_</a></div><div class="ttdeci">const Nnet &amp; nnet_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00541">nnet-computation-graph.h:541</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab1ba98152caee70149eecf30d58fb975"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1ba98152caee70149eecf30d58fb975">&#9670;&nbsp;</a></span>ProcessInputOrOutputStep()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProcessInputOrOutputStep </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>is_output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>sub_phase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-computation-graph_8cc_source.html#l01567">1567</a> of file <a class="el" href="nnet-computation-graph_8cc_source.html">nnet-computation-graph.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-computation-graph_8cc_source.html#l01607">ComputationStepsComputer::AddStep()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l00028">ComputationGraph::GetCindexId()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00684">Nnet::GetNodeName()</a>, <a class="el" href="nnet-computation-graph_8h_source.html#l00542">ComputationStepsComputer::graph_</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-computation_8h_source.html#l00115">ComputationRequest::inputs</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00120">Nnet::IsInputNode()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00112">Nnet::IsOutputNode()</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="nnet-computation-graph_8h_source.html#l00549">ComputationStepsComputer::locations_</a>, <a class="el" href="nnet-computation-graph_8h_source.html#l00541">ComputationStepsComputer::nnet_</a>, and <a class="el" href="nnet-computation_8h_source.html#l00116">ComputationRequest::outputs</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-computation-graph_8cc_source.html#l01920">ComputationStepsComputer::ProcessSubPhase()</a>.</p>
<div class="fragment"><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;                                        {</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  int32 io_node = sub_phase[0].first;</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;  <span class="keywordflow">if</span> (is_output){</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#adbabf05a7702103113a02a113015205f">nnet_</a>.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a6c50812e1be80ab06573493276ec2ca5">IsOutputNode</a>(io_node));</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#adbabf05a7702103113a02a113015205f">nnet_</a>.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a514bcd8b42cec993b29ccbc6714457fb">IsInputNode</a>(io_node));</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;  }</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;  std::string node_name = <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#adbabf05a7702103113a02a113015205f">nnet_</a>.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a9edcc586b832dbe99e36da6d62d4ad96">GetNodeName</a>(io_node);</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;  <span class="keyword">const</span> std::vector&lt;IoSpecification&gt; &amp;inputs_or_outputs =</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;      (is_output ? request.outputs : request.inputs);</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;  int32 io_index = -1;</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; inputs_or_outputs.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    <span class="keywordflow">if</span> (inputs_or_outputs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].name == node_name)</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;      io_index = <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(io_index &gt;= 0);</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;  <span class="keyword">const</span> std::vector&lt;Index&gt; &amp;io_indexes = inputs_or_outputs[io_index].indexes;</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  std::vector&lt;Cindex&gt; io_cindexes(io_indexes.size());</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, size = io_cindexes.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; size; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    io_cindexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].first = io_node;</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    io_cindexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].second = io_indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;  }</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(io_cindexes.size() == sub_phase.size());</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;  <span class="comment">// we expect the list of cindexes in &#39;io_cindexes&#39; to be identical to</span></div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;  <span class="comment">// that in &#39;sub_phase&#39; (but they don&#39;t have to be in the same order)... for now we check the size, we&#39;ll spot-check</span></div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  <span class="comment">// that they are the same later.</span></div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;  <span class="comment">// The actual output in &#39;steps&#39; must be in the same order as</span></div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;  int32 step_index = <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a8ab8ccc5876ce94af013464511dca26c">AddStep</a>(io_cindexes);</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;  <span class="comment">// Now spot-check that the cindexes in &#39;sub_phase&#39; are the same as those</span></div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;  <span class="comment">// we just added.  [note: they don&#39;t have to be in the same order, but</span></div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;  <span class="comment">// they should be the same set.]</span></div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; sub_phase.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> += 10) {</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> &amp;cindex = sub_phase[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    int32 cindex_id = <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ad9329bf8ff1dbf0f1e0f49ded8dc83fd">graph_</a>-&gt;<a class="code" href="structkaldi_1_1nnet3_1_1ComputationGraph.html#a5e1647c5b37c6759f88249b823cc90f5">GetCindexId</a>(cindex);</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cindex_id &gt;= 0 &amp;&amp; (*<a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a849951c8cab13300f78b0ec8baa30c0c">locations_</a>)[cindex_id].first == step_index);</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;  }</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_ad9329bf8ff1dbf0f1e0f49ded8dc83fd"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ad9329bf8ff1dbf0f1e0f49ded8dc83fd">kaldi::nnet3::ComputationStepsComputer::graph_</a></div><div class="ttdeci">ComputationGraph * graph_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00542">nnet-computation-graph.h:542</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a9edcc586b832dbe99e36da6d62d4ad96"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a9edcc586b832dbe99e36da6d62d4ad96">kaldi::nnet3::Nnet::GetNodeName</a></div><div class="ttdeci">const std::string &amp; GetNodeName(int32 node_index) const</div><div class="ttdoc">returns individual node name. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00684">nnet-nnet.cc:684</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_a849951c8cab13300f78b0ec8baa30c0c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a849951c8cab13300f78b0ec8baa30c0c">kaldi::nnet3::ComputationStepsComputer::locations_</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; * locations_</div><div class="ttdoc">locations_ is a map from cindex_id to the pair of indexes into steps_ where that cindex_id resides...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00549">nnet-computation-graph.h:549</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a514bcd8b42cec993b29ccbc6714457fb"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a514bcd8b42cec993b29ccbc6714457fb">kaldi::nnet3::Nnet::IsInputNode</a></div><div class="ttdeci">bool IsInputNode(int32 node) const</div><div class="ttdoc">Returns true if this is an output node, meaning that it is of type kInput. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00120">nnet-nnet.cc:120</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ac8344e7587df9247d6cc492874901d4d"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">kaldi::nnet3::Cindex</a></div><div class="ttdeci">std::pair&lt; int32, Index &gt; Cindex</div><div class="ttdef"><b>Definition:</b> <a href="nnet-common_8h_source.html#l00115">nnet-common.h:115</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationGraph_html_a5e1647c5b37c6759f88249b823cc90f5"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationGraph.html#a5e1647c5b37c6759f88249b823cc90f5">kaldi::nnet3::ComputationGraph::GetCindexId</a></div><div class="ttdeci">int32 GetCindexId(const Cindex &amp;cindex, bool is_input, bool *is_new)</div><div class="ttdoc">Maps a Cindex to an integer cindex_id. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l00028">nnet-computation-graph.cc:28</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a6c50812e1be80ab06573493276ec2ca5"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a6c50812e1be80ab06573493276ec2ca5">kaldi::nnet3::Nnet::IsOutputNode</a></div><div class="ttdeci">bool IsOutputNode(int32 node) const</div><div class="ttdoc">Returns true if this is an output node, meaning that it is of type kDescriptor and is not directly fo...</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00112">nnet-nnet.cc:112</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_a8ab8ccc5876ce94af013464511dca26c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a8ab8ccc5876ce94af013464511dca26c">kaldi::nnet3::ComputationStepsComputer::AddStep</a></div><div class="ttdeci">int32 AddStep(const std::vector&lt; Cindex &gt; &amp;cindexes, bool add_if_absent=false)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l01607">nnet-computation-graph.cc:1607</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_adbabf05a7702103113a02a113015205f"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#adbabf05a7702103113a02a113015205f">kaldi::nnet3::ComputationStepsComputer::nnet_</a></div><div class="ttdeci">const Nnet &amp; nnet_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00541">nnet-computation-graph.h:541</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8c079dc88d7030933c6209f03e84b257"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c079dc88d7030933c6209f03e84b257">&#9670;&nbsp;</a></span>ProcessSubPhase()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProcessSubPhase </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>sub_phase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-computation-graph_8cc_source.html#l01920">1920</a> of file <a class="el" href="nnet-computation-graph_8cc_source.html">nnet-computation-graph.cc</a>.</p>

<p class="reference">References <a class="el" href="_2nnet-nnet_8cc_source.html#l00172">Nnet::IsComponentInputNode()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00132">Nnet::IsComponentNode()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00138">Nnet::IsDimRangeNode()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00120">Nnet::IsInputNode()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00112">Nnet::IsOutputNode()</a>, <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00126">KALDI_ERR</a>, <a class="el" href="nnet-computation-graph_8h_source.html#l00541">ComputationStepsComputer::nnet_</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01741">ComputationStepsComputer::ProcessComponentStep()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01852">ComputationStepsComputer::ProcessDimRangeSubPhase()</a>, and <a class="el" href="nnet-computation-graph_8cc_source.html#l01567">ComputationStepsComputer::ProcessInputOrOutputStep()</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-computation-graph_8cc_source.html#l01554">ComputationStepsComputer::ComputeForSegment()</a>.</p>
<div class="fragment"><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;                                        {</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!sub_phase.empty());</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;  int32 node_index = sub_phase[0].first;</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(sub_phase.back().first == node_index);</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#adbabf05a7702103113a02a113015205f">nnet_</a>.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a9167816d5d30fa49f76019d83cf6d652">IsComponentNode</a>(node_index)) {</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a6cfba18e7848b9258cb311dd68eddb05">ProcessComponentStep</a>(sub_phase);</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#adbabf05a7702103113a02a113015205f">nnet_</a>.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a514bcd8b42cec993b29ccbc6714457fb">IsInputNode</a>(node_index)) {</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ab1ba98152caee70149eecf30d58fb975">ProcessInputOrOutputStep</a>(request, <span class="keyword">false</span>, sub_phase);</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#adbabf05a7702103113a02a113015205f">nnet_</a>.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a6c50812e1be80ab06573493276ec2ca5">IsOutputNode</a>(node_index)) {</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ab1ba98152caee70149eecf30d58fb975">ProcessInputOrOutputStep</a>(request, <span class="keyword">true</span>, sub_phase);</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#adbabf05a7702103113a02a113015205f">nnet_</a>.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a38ed67486324e56fe851bd3ccb06a4ab">IsDimRangeNode</a>(node_index)) {</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <span class="comment">// this might turn out to be multiple steps, see the code.</span></div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a8bf7e70ed658ec686d094a87bf01040c">ProcessDimRangeSubPhase</a>(sub_phase);</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#adbabf05a7702103113a02a113015205f">nnet_</a>.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#ace963c54d5f404914f1ce1953a9112c6">IsComponentInputNode</a>(node_index)) {</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    <span class="comment">// We actually do nothing with these sub-phases, because they are processed</span></div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    <span class="comment">// when we process the associated component&#39;s sub-phase/step.  Doing it this</span></div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    <span class="comment">// way resolves certain problems.</span></div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Unknown node type.&quot;</span>;</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;  }</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a514bcd8b42cec993b29ccbc6714457fb"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a514bcd8b42cec993b29ccbc6714457fb">kaldi::nnet3::Nnet::IsInputNode</a></div><div class="ttdeci">bool IsInputNode(int32 node) const</div><div class="ttdoc">Returns true if this is an output node, meaning that it is of type kInput. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00120">nnet-nnet.cc:120</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_a8bf7e70ed658ec686d094a87bf01040c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a8bf7e70ed658ec686d094a87bf01040c">kaldi::nnet3::ComputationStepsComputer::ProcessDimRangeSubPhase</a></div><div class="ttdeci">void ProcessDimRangeSubPhase(const std::vector&lt; Cindex &gt; &amp;sub_phase)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l01852">nnet-computation-graph.cc:1852</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a9167816d5d30fa49f76019d83cf6d652"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a9167816d5d30fa49f76019d83cf6d652">kaldi::nnet3::Nnet::IsComponentNode</a></div><div class="ttdeci">bool IsComponentNode(int32 node) const</div><div class="ttdoc">Returns true if this is a component node, meaning that it is of type kComponent. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00132">nnet-nnet.cc:132</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a6c50812e1be80ab06573493276ec2ca5"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a6c50812e1be80ab06573493276ec2ca5">kaldi::nnet3::Nnet::IsOutputNode</a></div><div class="ttdeci">bool IsOutputNode(int32 node) const</div><div class="ttdoc">Returns true if this is an output node, meaning that it is of type kDescriptor and is not directly fo...</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00112">nnet-nnet.cc:112</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00126">kaldi-error.h:126</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_a6cfba18e7848b9258cb311dd68eddb05"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a6cfba18e7848b9258cb311dd68eddb05">kaldi::nnet3::ComputationStepsComputer::ProcessComponentStep</a></div><div class="ttdeci">void ProcessComponentStep(const std::vector&lt; Cindex &gt; &amp;step)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l01741">nnet-computation-graph.cc:1741</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_ab1ba98152caee70149eecf30d58fb975"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#ab1ba98152caee70149eecf30d58fb975">kaldi::nnet3::ComputationStepsComputer::ProcessInputOrOutputStep</a></div><div class="ttdeci">void ProcessInputOrOutputStep(const ComputationRequest &amp;request, bool is_output, const std::vector&lt; Cindex &gt; &amp;sub_phase)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l01567">nnet-computation-graph.cc:1567</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a38ed67486324e56fe851bd3ccb06a4ab"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a38ed67486324e56fe851bd3ccb06a4ab">kaldi::nnet3::Nnet::IsDimRangeNode</a></div><div class="ttdeci">bool IsDimRangeNode(int32 node) const</div><div class="ttdoc">Returns true if this is a dim-range node, meaning that it is of type kDimRange. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00138">nnet-nnet.cc:138</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_ace963c54d5f404914f1ce1953a9112c6"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#ace963c54d5f404914f1ce1953a9112c6">kaldi::nnet3::Nnet::IsComponentInputNode</a></div><div class="ttdeci">bool IsComponentInputNode(int32 node) const</div><div class="ttdoc">Returns true if this is component-input node, i.e. </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00172">nnet-nnet.cc:172</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_adbabf05a7702103113a02a113015205f"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#adbabf05a7702103113a02a113015205f">kaldi::nnet3::ComputationStepsComputer::nnet_</a></div><div class="ttdeci">const Nnet &amp; nnet_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8h_source.html#l00541">nnet-computation-graph.h:541</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a704d97dd332b0327ae16a0fc377629c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a704d97dd332b0327ae16a0fc377629c0">&#9670;&nbsp;</a></span>SplitIntoSubPhases()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SplitIntoSubPhases </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> &gt; &gt; *&#160;</td>
          <td class="paramname"><em>sub_phase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-computation-graph_8cc_source.html#l01967">1967</a> of file <a class="el" href="nnet-computation-graph_8cc_source.html">nnet-computation-graph.cc</a>.</p>

<p class="reference">References <a class="el" href="nnet-computation-graph_8cc_source.html#l01679">ComputationStepsComputer::ConvertToCindexes()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, and <a class="el" href="kaldi-error_8h_source.html#l00168">KALDI_ASSERT</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-computation-graph_8cc_source.html#l01554">ComputationStepsComputer::ComputeForSegment()</a>.</p>
<div class="fragment"><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;                                                     {</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;  std::vector&lt;Cindex&gt; phase_cindexes;</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a274c4b9215d2e1d0b8a37aa79193883b">ConvertToCindexes</a>(phase, &amp;phase_cindexes);</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!phase_cindexes.empty());</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;  std::sort(phase_cindexes.begin(), phase_cindexes.end());</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;  <span class="comment">// &#39;sub_phase_begins&#39; is the indexes onto &#39;phase_cindees&#39; that</span></div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;  <span class="comment">// start a run of the same node-index</span></div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;  std::vector&lt;size_t&gt; segment_begins;</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;  int32 cur_node_index = -1;</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;  <span class="keywordtype">size_t</span> size = phase_cindexes.size();</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; size; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    <span class="keywordflow">if</span> (phase_cindexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].first != cur_node_index) {</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;      cur_node_index = phase_cindexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].first;</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;      segment_begins.push_back(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    }</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;  }</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;  <span class="keywordtype">size_t</span> num_sub_phases = segment_begins.size();</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;  segment_begins.push_back(size);</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;  sub_phases-&gt;clear();</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;  sub_phases-&gt;resize(num_sub_phases);</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; num_sub_phases; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    <span class="keywordtype">size_t</span> this_begin = segment_begins[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>],</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;        this_end = segment_begins[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>+1];</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    (*sub_phases)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].insert((*sub_phases)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].end(),</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;                            phase_cindexes.begin() + this_begin,</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;                            phase_cindexes.begin() + this_end);</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;  }</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;}</div><div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationStepsComputer_html_a274c4b9215d2e1d0b8a37aa79193883b"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html#a274c4b9215d2e1d0b8a37aa79193883b">kaldi::nnet3::ComputationStepsComputer::ConvertToCindexes</a></div><div class="ttdeci">void ConvertToCindexes(const std::vector&lt; int32 &gt; &amp;cindex_ids, std::vector&lt; Cindex &gt; *cindexes) const</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l01679">nnet-computation-graph.cc:1679</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00168">kaldi-error.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a2780f70b419f18227193b7c14015ec6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2780f70b419f18227193b7c14015ec6f">&#9670;&nbsp;</a></span>dim_range_nodes_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_set&lt;std::pair&lt;int32, int32&gt;, <a class="el" href="structkaldi_1_1PairHasher.html">PairHasher</a>&lt;int32&gt; &gt; dim_range_nodes_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>dim_range_nodes_ is used when allocating steps for nodes of type kDimRangeNode. </p>
<p>This is a set of (source_step, dim_range_node_index), where source_step is the step in which we computed of the input of the dim-range node (this step will be for a node of type kComponentNode). This just tells us whether we've already added a particular dim-range node for this step, so we know whether we need to add it again. </p>

<p class="definition">Definition at line <a class="el" href="nnet-computation-graph_8h_source.html#l00558">558</a> of file <a class="el" href="nnet-computation-graph_8h_source.html">nnet-computation-graph.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-computation-graph_8cc_source.html#l01852">ComputationStepsComputer::ProcessDimRangeSubPhase()</a>.</p>

</div>
</div>
<a id="ad9329bf8ff1dbf0f1e0f49ded8dc83fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9329bf8ff1dbf0f1e0f49ded8dc83fd">&#9670;&nbsp;</a></span>graph_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structkaldi_1_1nnet3_1_1ComputationGraph.html">ComputationGraph</a>* graph_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-computation-graph_8h_source.html#l00542">542</a> of file <a class="el" href="nnet-computation-graph_8h_source.html">nnet-computation-graph.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-computation-graph_8cc_source.html#l01607">ComputationStepsComputer::AddStep()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01946">ComputationStepsComputer::Check()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01539">ComputationStepsComputer::ComputationStepsComputer()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01679">ComputationStepsComputer::ConvertToCindexes()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01695">ComputationStepsComputer::ConvertToCindexIds()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01741">ComputationStepsComputer::ProcessComponentStep()</a>, and <a class="el" href="nnet-computation-graph_8cc_source.html#l01567">ComputationStepsComputer::ProcessInputOrOutputStep()</a>.</p>

</div>
</div>
<a id="a849951c8cab13300f78b0ec8baa30c0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a849951c8cab13300f78b0ec8baa30c0c">&#9670;&nbsp;</a></span>locations_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::pair&lt;int32, int32&gt; &gt;* locations_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>locations_ is a map from cindex_id to the pair of indexes into steps_ where that cindex_id resides, so if (*locations_)[c] = (i,j), then (*steps_)[i][j] == c. </p>
<p>This is also an output (we get the pointer in the constructor). </p>

<p class="definition">Definition at line <a class="el" href="nnet-computation-graph_8h_source.html#l00549">549</a> of file <a class="el" href="nnet-computation-graph_8h_source.html">nnet-computation-graph.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-computation-graph_8cc_source.html#l01607">ComputationStepsComputer::AddStep()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01946">ComputationStepsComputer::Check()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01539">ComputationStepsComputer::ComputationStepsComputer()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01830">ComputationStepsComputer::ConvertToLocations()</a>, and <a class="el" href="nnet-computation-graph_8cc_source.html#l01567">ComputationStepsComputer::ProcessInputOrOutputStep()</a>.</p>

</div>
</div>
<a id="adbabf05a7702103113a02a113015205f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbabf05a7702103113a02a113015205f">&#9670;&nbsp;</a></span>nnet_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a>&amp; nnet_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nnet-computation-graph_8h_source.html#l00541">541</a> of file <a class="el" href="nnet-computation-graph_8h_source.html">nnet-computation-graph.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-computation-graph_8cc_source.html#l01741">ComputationStepsComputer::ProcessComponentStep()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01852">ComputationStepsComputer::ProcessDimRangeSubPhase()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01567">ComputationStepsComputer::ProcessInputOrOutputStep()</a>, and <a class="el" href="nnet-computation-graph_8cc_source.html#l01920">ComputationStepsComputer::ProcessSubPhase()</a>.</p>

</div>
</div>
<a id="a3cb7e5f1e5b76a6bbca03b3a83ad02f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cb7e5f1e5b76a6bbca03b3a83ad02f5">&#9670;&nbsp;</a></span>steps_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;int32&gt; &gt;* steps_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>steps_ is a pointer to an output that's passed in in the constructor. </p>

<p class="definition">Definition at line <a class="el" href="nnet-computation-graph_8h_source.html#l00544">544</a> of file <a class="el" href="nnet-computation-graph_8h_source.html">nnet-computation-graph.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="nnet-computation-graph_8cc_source.html#l01607">ComputationStepsComputer::AddStep()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01946">ComputationStepsComputer::Check()</a>, and <a class="el" href="nnet-computation-graph_8cc_source.html#l01539">ComputationStepsComputer::ComputationStepsComputer()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>nnet3/<a class="el" href="nnet-computation-graph_8h_source.html">nnet-computation-graph.h</a></li>
<li>nnet3/<a class="el" href="nnet-computation-graph_8cc_source.html">nnet-computation-graph.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacekaldi.html">kaldi</a></li><li class="navelem"><a class="el" href="namespacekaldi_1_1nnet3.html">nnet3</a></li><li class="navelem"><a class="el" href="classkaldi_1_1nnet3_1_1ComputationStepsComputer.html">ComputationStepsComputer</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
